{"pages":[{"title":"about","text":"æƒ³ç”¨æ–‡å­—è®°å½•ä¸€äº›äººç”Ÿä¸­çš„äº‹æƒ…","link":"/about/index.html"},{"title":"åˆ†ç±»","text":"","link":"/categories/index.html"},{"title":"æ ‡ç­¾","text":"","link":"/tags/index.html"},{"title":"å‹æƒ…é“¾æ¥","text":"","link":"/links/index.html"}],"posts":[{"title":"Androidç½‘ç»œåŸºç¡€","text":"1.HttpClientApacheæä¾›çš„é«˜æ•ˆçš„ç½‘ç»œè®¿é—®æ¨¡å—ã€‚ Android 2.2(API 8)åŠä»¥å‰ä½¿ç”¨HttpClientæ¯”ä»·å¥½ï¼Œbugå°‘ã€‚ ä½†æ˜¯åœ¨æœ€æ–°çš„Androidç‰ˆæœ¬ä¸­ç§»é™¤äº†ï¼Œå¦‚æœä½ è¿˜æƒ³ä½¿ç”¨è¿™ä¸ªï¼Œåœ¨build.gradleé‡Œé¢æ·»åŠ ï¼š android { useLibrary &apos;org.apache.http.legacy&apos; }å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼šString urlAddress = &quot;http://192.168.1.102:8080/qualityserver/login.do&quot;; // å‘é€GETè¯·æ±‚ public String doGet(String username,String password){ String getUrl = urlAddress + &quot;?username=&quot;+username+&quot;&amp;password=&quot;+password; HttpGet httpGet = new HttpGet(getUrl); HttpParams hp = httpGet.getParams(); hp.getParameter(&quot;true&quot;); HttpClient hc = new DefaultHttpClient(); try { HttpResponse ht = hc.execute(httpGet); if(ht.getStatusLine().getStatusCode() == HttpStatus.SC_OK){ HttpEntity he = ht.getEntity(); InputStream is = he.getContent(); BufferedReader br = new BufferedReader(new InputStreamReader(is)); String response = &quot;&quot;; String readLine = null; while((readLine =br.readLine()) != null){ //response = br.readLine(); response = response + readLine; } is.close(); br.close(); //String str = EntityUtils.toString(he); System.out.println(&quot;=========&quot;+response); return response; }else{ return &quot;error&quot;; } } catch (ClientProtocolException e) { e.printStackTrace(); return &quot;exception&quot;; } catch (IOException e) { e.printStackTrace(); return &quot;exception&quot;; } } public String doPost(String username,String password){ //String getUrl = urlAddress + &quot;?username=&quot;+username+&quot;&amp;password=&quot;+password; HttpPost httpPost = new HttpPost(urlAddress); List params = new ArrayList(); NameValuePair pair1 = new BasicNameValuePair(&quot;username&quot;, username); NameValuePair pair2 = new BasicNameValuePair(&quot;password&quot;, password); params.add(pair1); params.add(pair2); HttpEntity he; try { he = new UrlEncodedFormEntity(params, &quot;gbk&quot;); httpPost.setEntity(he); } catch (UnsupportedEncodingException e1) { e1.printStackTrace(); } HttpClient hc = new DefaultHttpClient(); try { HttpResponse ht = hc.execute(httpPost); //è¿æ¥æˆåŠŸ if(ht.getStatusLine().getStatusCode() == HttpStatus.SC_OK){ HttpEntity het = ht.getEntity(); InputStream is = het.getContent(); BufferedReader br = new BufferedReader(new InputStreamReader(is)); String response = &quot;&quot;; String readLine = null; while((readLine =br.readLine()) != null){ //response = br.readLine(); response = response + readLine; } is.close(); br.close(); //String str = EntityUtils.toString(he); System.out.println(&quot;=========&amp;&amp;&quot;+response); return response; }else{ return &quot;error&quot;; } } catch (ClientProtocolException e) { e.printStackTrace(); return &quot;exception&quot;; } catch (IOException e) { e.printStackTrace(); return &quot;exception&quot;; } }2.HttpURLConnectionHttpURLConnectionæ˜¯ä¸€ç§å¤šç”¨é€”ã€è½»é‡æçš„HTTPå®¢æˆ·ç«¯ï¼Œä½¿ç”¨å®ƒæ¥è¿›è¡ŒHTTPæ“ä½œå¯ä»¥é€‚ç”¨äºå¤§å¤šæ•°çš„åº”ç”¨ç¨‹åºã€‚ æ³¨æ„äº‹é¡¹ HttpURLConnectionåœ¨Android 2.2åŠä»¥å‰æœ‰ä¸€äº›bugã€‚ å‚çœ‹ç¬”è®°ï¼šAndroid 4.0 Ice Cream Sandwich GETè¯·æ±‚å˜POSTè¯·æ±‚ å…·ä½“ä½¿ç”¨æ–¹æ³•ï¼šString urlAddress = &quot;http://192.168.1.102:8080/AndroidServer/login.do&quot;; URL url; HttpURLConnection uRLConnection; //å‘æœåŠ¡å™¨å‘é€getè¯·æ±‚ public String doGet(String username,String password){ String getUrl = urlAddress + &quot;?username=&quot;+username+&quot;&amp;password=&quot;+password; try { url = new URL(getUrl); uRLConnection = (HttpURLConnection)url.openConnection(); InputStream is = uRLConnection.getInputStream(); BufferedReader br = new BufferedReader(new InputStreamReader(is)); String response = &quot;&quot;; String readLine = null; while((readLine =br.readLine()) != null){ //response = br.readLine(); response = response + readLine; } is.close(); br.close(); uRLConnection.disconnect(); return response; } catch (MalformedURLException e) { e.printStackTrace(); return null; } catch (IOException e) { e.printStackTrace(); return null; } } //å‘æœåŠ¡å™¨å‘é€postè¯·æ±‚ public String doPost(String username,String password){ try { url = new URL(urlAddress); uRLConnection = (HttpURLConnection)url.openConnection(); uRLConnection.setDoInput(true); uRLConnection.setDoOutput(true); uRLConnection.setRequestMethod(&quot;POST&quot;); uRLConnection.setUseCaches(false); uRLConnection.setInstanceFollowRedirects(false); uRLConnection.setRequestProperty(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;); uRLConnection.connect(); DataOutputStream out = new DataOutputStream(uRLConnection.getOutputStream()); String content = &quot;username=&quot;+username+&quot;&amp;password=&quot;+password; out.writeBytes(content); out.flush(); out.close(); InputStream is = uRLConnection.getInputStream(); BufferedReader br = new BufferedReader(new InputStreamReader(is)); String response = &quot;&quot;; String readLine = null; while((readLine =br.readLine()) != null){ //response = br.readLine(); response = response + readLine; } is.close(); br.close(); uRLConnection.disconnect(); return response; } catch (MalformedURLException e) { e.printStackTrace(); return null; } catch (IOException e) { e.printStackTrace(); return null; } }å‚è€ƒèµ„æ–™http://blog.csdn.net/guolin_blog/article/details/12452307","link":"/2015/12/02/Android/Android%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"},{"title":"Android Studioå¯¼å‡ºå¹¶ä½¿ç”¨aarå’Œjar","text":"ä»Šå¤©æƒ³å¾€é¡¹ç›®ä¸­å¯¼å…¥Zxing,ä¸çŸ¥é“æ€ä¹ˆå°±æƒ³åˆ°ä¸ä½¿ç”¨libraryçš„æ–¹å¼è€Œä½¿ç”¨åŒ…çš„æ–¹å¼æ¥å¯¼å…¥,ç„¶åå°±æœ‰äº†ä¸‹é¢çš„ä¸œè¥¿äº†. AARAARæ˜¯Android Libraryçš„ä¸€ç§æ–°çš„äºŒè¿›åˆ¶åˆ†å‘æ ¼å¼ï¼Œå®ƒæŠŠèµ„æºä¹Ÿä¸€èµ·æ‰“åŒ…ï¼Œè¿™æ ·ä¸€æ¥å›¾ç‰‡å’Œå¸ƒå±€èµ„æºæ–‡ä»¶ä¹Ÿèƒ½å¤Ÿè¢«åŒæ—¶åˆ†å‘ã€‚åŒæ—¶AARè¿˜å¯ä»¥åŒ…å«jaråŒ…. 1.ç”ŸæˆAARå½“æˆ‘ä»¬è¿è¡Œå·¥ç¨‹å,è¯¥å·¥ç¨‹çš„/build/outputs/arrä¸‹åŒ…å«Android Studioè‡ªåŠ¨æ‰“åŒ…çš„AARæ–‡ä»¶ 2.ä½¿ç”¨AARå°†AARæ–‡ä»¶æ‹·è´åˆ°é¡¹ç›®çš„libsç›®å½•ä¸‹,ç„¶ååœ¨é¡¹ç›®çš„build.gradleæ–‡ä»¶ä¸­é…ç½®å³å¯ apply plugin: &apos;com.android.application&apos; android { compileSdkVersion 23 buildToolsVersion &quot;23.0.3&quot; defaultConfig { applicationId &quot;com.qtparking.btool_as&quot; minSdkVersion 11 targetSdkVersion 23 versionCode 1 versionName &quot;1.0&quot; } buildTypes { release { minifyEnabled false proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos; } } } // æ·»åŠ arræ–‡ä»¶çš„å¼•ç”¨ è¿˜è¦åœ¨dependenciesé‡Œé¢æ·»åŠ å¼•ç”¨ repositories { flatDir { dirs &apos;libs&apos; } } dependencies { compile fileTree(dir: &apos;libs&apos;, include: [&apos;*.jar&apos;]) testCompile &apos;junit:junit:4.12&apos; compile &apos;com.android.support:appcompat-v7:23.3.0&apos; compile &apos;com.android.support:design:23.3.0&apos; // æ·»åŠ AARæ–‡ä»¶çš„å¼•ç”¨,æ–‡ä»¶åå­—ä¸ºzxing,ç±»å‹ä¸ºaar compile(name:&apos;zxing&apos;, ext:&apos;aar&apos;) }JarJaråŒ…åº”è¯¥ä¸é™Œç”Ÿäº†,ä½†æ˜¯å¦‚ä½•ä½¿ç”¨Android Studioå¯¼å‡ºjaråŒ…å‘¢? 1.é…ç½®gradleä»»åŠ¡åœ¨éœ€è¦æ‰“åŒ…æˆjaråŒ…çš„é¡¹ç›®çš„build.gradleæ·»åŠ gradleä»»åŠ¡: apply plugin: &apos;com.android.library&apos; android { compileSdkVersion 21 buildToolsVersion &quot;21.1.2&quot; defaultConfig { minSdkVersion 9 targetSdkVersion 21 testApplicationId &quot;com.android.volley.tests&quot; testInstrumentationRunner &quot;android.test.InstrumentationTestRunner&quot; } lintOptions { abortOnError false } buildTypes { release { minifyEnabled false proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.txt&apos; } } } task makeJar(type: Copy) { delete &apos;build/libs/lfVolley.jar&apos; //åˆ é™¤æ—§çš„jaråŒ… from(&apos;build/intermediates/bundles/release/&apos;) // æ–‡ä»¶æ¥è‡ªå“ªé‡Œ into(&apos;build/libs/&apos;) // ç”Ÿæˆçš„jaråŒ…å­˜æ”¾ç›®å½• include(&apos;classes.jar&apos;) rename (&apos;classes.jar&apos;, &apos;lfVolley.jar&apos;) // é‡å‘½åæˆæˆ‘ä»¬çš„jaråŒ… } makeJar.dependsOn(build) dependencies { compile &apos;com.android.support:support-v4:21.0.3&apos; }2.æ‰§è¡Œgradleä»»åŠ¡æœ‰çš„æ–‡ç« ä¸­æ¨èæˆ‘ä»¬æ‰§è¡Œ:./gradview makeJar.ä½†æ˜¯,æˆ‘ä¸ªäººæµ‹è¯•æ˜¯æ— æ³•æˆåŠŸçš„.å¯ä»¥é€šè¿‡Android Studioæ¥æ‰§è¡Œgradleä»»åŠ¡: 2.1åœ¨Gradle projectsä¸­å¯»æ‰¾éœ€è¦æ‰“åŒ…çš„Module: 2.2æ‰¾åˆ°makeJarçš„gradleä»»åŠ¡å¹¶åŒå‡»æ‰§è¡Œ: 2.3gradleä»»åŠ¡æ‰§è¡Œå®Œæˆåæ˜¾ç¤ºå¦‚ä¸‹: è‡³æ­¤,å°±å®Œæˆäº†jaråŒ…çš„ç”Ÿæˆ,å¯ä»¥ç›´æ¥æ‹·è´åˆ°å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨äº†. TODO:1.æœ‰ä¸€ä¸ªå°æƒ³æ³•,è¿™ä¸ªæ˜¯ä¸æ˜¯å’Œæ’ä»¶åŒ–æœ‰ç‚¹å…³ç³»å‘¢,ä»æ¥æ²¡æœ‰äº†è§£è¿‡æ’ä»¶åŒ–,è¿˜ä¸çŸ¥é“æ€ä¹ˆå¼„å‘¢.åé¢æœ‰æ—¶é—´å†è¯´å§.2.åé¢ç ”ç©¶ä¸‹å¦‚ä½•å¯¼å‡ºæ··æ·†çš„aarå’Œjar,ç°åœ¨æ²¡æœ‰æ—¶é—´ç ”ç©¶å‘¢è¿˜.","link":"/2016/06/27/Android/Android-Studio%E5%AF%BC%E5%87%BA%E5%B9%B6%E4%BD%BF%E7%94%A8aar%E5%92%8Cjar/"},{"title":"Androidç½‘ç»œå±‚äºŒæ¬¡å°è£…","text":"é¡¹ç›®ä»‹ç»å¯¹Volleyè¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæ–¹ä¾¿ä½¿ç”¨å’Œæ‰©å±•ã€‚ä¸»è¦æ˜¯å­¦ä¹ å°è£…çš„æ€æƒ³ã€‚ è¯¥ç¤ºä¾‹ä¸»ä½“ä»£ç æ¥è‡ªä¼ æ™ºçš„æŸä½Androidè®²å¸ˆï¼Œå…·ä½“ä¸æ¸…æ¥šã€‚ ç½‘ç»œå±‚å°è£…ç¤ºæ„å›¾ æ¥ä¸‹æ¥å‰æœŸå‡†å¤‡public class App extends Application { public static Context application; public static HttpLoader HL; @Override public void onCreate() { super.onCreate(); application = this; // åˆå§‹åŒ–ç½‘ç»œè¯·æ±‚ç›¸å…³çš„æ ¸å¿ƒç±» HL = HttpLoader.getInstance(this); } }ä¸ç”¨æˆ‘ä»‹ç»äº†å§ï¼Œè®°å¾—åœ¨AndroidManiFestæ–‡ä»¶ä¸­æ·»åŠ nameå±æ€§&amp;&amp;&amp;&amp;&amp;&amp;&amp;è”ç½‘æƒé™ 1.Activityå®ç°HttpListeneræ¥å£HttpListeneræ˜¯æˆ‘ä»¬è¿æ¥ç½‘ç»œå±‚å’ŒUIå±‚çš„æ¡¥æ¢ï¼Œè®°å¾—é‡å†™æ¥å£ä¸­çš„æˆåŠŸå’Œå¤±è´¥çš„æ–¹æ³•ã€‚ 2.åˆ›å»ºProtocolç±»å‘èµ·ç½‘ç»œè¯·æ±‚new MainProtocol(MainActivity.this,&quot;15613566958&quot;).doRequest(this);è¿™æ ·æˆ‘ä»¬å°±å‘èµ·äº†ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œæ„Ÿè§‰ç®€å•äº†å¥½å¤šã€‚ å…·ä½“MainProtocolçš„å…·ä½“å®ç° public class MainProtocol extends BaseProtrocol { private String phone; private Context actContext; // ä¼ å…¥å¿…å¤‡å‚æ•° public MainProtocol(Context actContext,String phone) { this.actContext = actContext; this.phone = phone; } @Override public void doRequest(HttpLoader loader, HttpLoader.HttpListener listener) { HttpParams params = new HttpParams().put(&quot;phone&quot;, phone); // å‘èµ·GETè¯·æ±‚ loader.get(actContext, AppConstants.URL_COUPONS, params, AppConstants.REQUEST_CODE_COUPONS, listener); } }3.HttpLoaderâ€“ç½‘ç»œè¯·æ±‚ç±»å•ä¾‹ç±»ï¼Œä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆï¼Œè¿™æ˜¯ç½‘ç»œè¯·æ±‚çš„ç±»å•Šï¼Œèƒ½ä¸å•åˆ©å—ï¼ï¼ï¼ï¼ å…¶ä¸­mRequestQueueæ˜¯ä¿å­˜è¯·æ±‚é˜Ÿåˆ—çš„ï¼ŒmInFlightRequestsæ˜¯ç”¨æ¥ä¿å­˜å·²ç»ç­‰å¾…çš„è¯·æ±‚ï¼ŒåŒæ—¶å…·æœ‰è¿‡æ»¤é‡å¤è¯·æ±‚çš„åŠŸèƒ½ã€‚ getæ–¹æ³•ä¼šè°ƒç”¨requestæ–¹æ³•ï¼Œè¿™é‡Œæ‰æ˜¯è¯·æ±‚çš„ä¸»ä½“ï¼Œrequestæ–¹æ³•åœ¨å‘èµ·è¯·æ±‚å‰ä¼šé€šè¿‡tryLoadCacheResponseæ–¹æ³•é¦–å…ˆè¯»å–ç¼“å­˜ï¼Œç„¶ååœ¨è¿›è¡Œè®¿é—®ç½‘ç»œçš„æ“ä½œã€‚ç„¶åæ ¹æ®è¿”å›ç»“æœçš„ä¸åŒï¼Œåˆ†åˆ«è°ƒç”¨HttpListenerçš„ä¸åŒçš„å›è°ƒæ–¹æ³•ï¼Œè¿™æ ·å°±æŠŠæœåŠ¡å™¨çš„ç»“æœè¿”å›åˆ°UIå±‚äº†ã€‚ /** * ResponseListenerï¼Œå°è£…äº†Volleyçš„é”™è¯¯å’ŒæˆåŠŸçš„å›è°ƒç›‘å¬ï¼Œå¹¶æ‰§è¡Œä¸€äº›é»˜è®¤å¤„ç†ï¼ŒåŒæ—¶ä¼šå°†äº‹ä»¶é€šè¿‡HttpListeneråˆ†å‘åˆ°UIå±‚ */ private class ResponseListener implements Response.ErrorListener, Response.Listener&lt;String&gt; { private HttpListener listener; private int requestCode; public ResponseListener(int requestCode, HttpListener listener) { this.listener = listener; this.requestCode = requestCode; } @Override public void onErrorResponse(VolleyError volleyError) { LLog.w(&quot;Request error from network!&quot;); volleyError.printStackTrace(); mInFlightRequests.remove(requestCode);// è¯·æ±‚é”™è¯¯ï¼Œä»è¯·æ±‚é›†åˆä¸­åˆ é™¤è¯¥è¯·æ±‚ if (listener != null) { listener.onGetResponseError(requestCode, volleyError); } } @Override public void onResponse(String response) { mInFlightRequests.remove(requestCode);// è¯·æ±‚æˆåŠŸï¼Œä»è¯·æ±‚é›†åˆä¸­åˆ é™¤è¯¥è¯·æ±‚ if (response != null) { //SystemClock.sleep(2000); LLog.i(&quot;Request success from network!&quot;); try { JSONObject jsonObject = new JSONObject(response);// å¤„ç†åˆ†å‘æ•°æ®---è§£æjson String status = jsonObject.getString(&quot;status&quot;); if (listener != null &amp;&amp; response != null) {// åˆ†å‘æ•°æ® if ((&quot;success&quot;.equals(status) || &quot;ok&quot;.equals(status))) { String data = null; try { data = jsonObject.getString(&quot;data&quot;); listener.onGetResponseSuccess(requestCode, data); } catch (Exception e) { // ä¸æ˜¯æ ‡å‡†æ ¼å¼çš„æ—¶å€™å°±æŠŠåŸå§‹æ•°æ®ä¼ å›å» listener.onGetResponseSuccess(requestCode, response); } } else if ((&quot;fail&quot;.equals(status) || &quot;error&quot;.equals(status))) { String errMsg = null; try { errMsg = jsonObject.getString(&quot;msg&quot;); } catch (Exception e) { errMsg = jsonObject.getString(&quot;message&quot;); } finally { listener.onGetResponseError(requestCode, new VolleyError(errMsg)); } } } } catch (Exception e) { e.printStackTrace(); listener.onGetResponseError(requestCode, new VolleyError(&quot;è§£æé—®é¢˜&quot;)); } } } }è¿™ä¹‹ä¸­ResponseListeneræ˜¯å…³é”®ï¼Œä»–å…³è”äº†ä¸‰æ–¹æ¡†æ¶çš„å›è°ƒæ–¹æ³•å’ŒHttpListenerçš„å›è°ƒæ–¹æ³•ã€‚ç„¶åä¸è¦é—®æˆ‘ä¸ºå˜›onResponseé‡Œé¢å†™äº†è¿™ä¹ˆå¤šï¼Œä½ æ˜¯ä¸ºäº†å¥å£®æ€§æ›´å¥½å—ï¼Ÿ æˆ‘èƒ½éª‚è¡—å—ï¼Ÿåå°è¿”å›æ•°æ®æ˜¯ä¹±ä¸ƒå…«ç³Ÿçš„å¥½ä¸ï¼Ÿ å°ç»“å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œä½ è‚¯å®šè¿˜æ²¡æœ‰çœ‹æ‡‚ï¼ŒåºŸè¯ï¼Œæˆ‘æ‰å†™äº†å‡ ç¯‡æ–‡ç« ï¼Œå“ªæœ‰é‚£ä¹ˆå¿«å°±å†™çš„è®©ä½ çœ‹æ‡‚ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰çœ‹æ‡‚çš„è¯å°±çœ‹æˆ‘çš„ä»£ç å»å§ï¼Œæˆ‘ä¸æ˜¯é“¾æ¥ è¿˜æ˜¯çœ‹ä¸æ‡‚ï¼Ÿ æ‰¾æˆ‘è¦è§†é¢‘å•Š~ çœ‹å®Œäº†å†çœ‹è¿™å‡ ç¯‡æ–‡ç« å°±å¥½äº† å¤šææå°±å¥½äº†","link":"/2016/05/18/Android/Android%E7%BD%91%E7%BB%9C%E5%B1%82%E4%BA%8C%E6%AC%A1%E5%B0%81%E8%A3%85/"},{"title":"Volleyå­¦ä¹ ç¬¬ä¸€ç¯‡-æ¡†æ¶å…¥å£.md","text":"å‰æ–‡æ¦‚è¦è¿™æ˜¯æˆ‘çš„Volleyå­¦ä¹ ç¬¬ä¸€ç¯‡çš„ç¬”è®°.çœ‹äº†ä¸€ä¸ªæ˜ŸæœŸçš„å„ç±»æ•™ç¨‹ä¹‹åçš„æ€»ç»“,å‡†å¤‡æŠŠVolleyçš„æ•´ä½“æµç¨‹éƒ½æ€»ç»“ä¸€é,åŒæ—¶ä¼šå¯¹Volleyè¿›è¡Œä¸€äº›æ‰©å±•,æœ€åä¼šè·Ÿç€å¤§ç¥çš„è„šæ­¥æ¨¡ä»¿ä¸€ä¸ªVolleyå‡ºæ¥. æ°´å¹³æœ‰é™,æœ›å¤šæŒ‡æ•™. èµ„æº éƒ­éœ–å¤§ç¥çš„åšå®¢ codeKK Volleyæºç è§£æ Volleyæºç  åˆ›å»ºå…¨å±€çš„RequestQueueä½¿ç”¨Volleyçš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„RequestQueue,ä¸€èˆ¬ä¼šåœ¨è‡ªå®šä¹‰çš„Applicationç±»é‡Œé¢åˆ›å»º. RequestQueue requestQueue = Volley.newRequestQueue(appContext);Volleyæ¡†æ¶çš„å…¥å£ç‚¹è¿™é‡Œæˆ‘ä»¬å°±å‘ç°åŸæ¥Volleyçš„å…¥å£æ˜¯Volleyç±»é‡Œé¢çš„ä¸€ä¸ªé™æ€æ–¹æ³•newRequestQueue() public static RequestQueue newRequestQueue(Context context) { return newRequestQueue(context, null); }Volleyæ¡†æ¶çš„çœŸæ­£çš„å…¥å£è¿™æ˜¯ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•,ä¼šè°ƒç”¨ä¸¤ä¸ªå‚æ•°çš„newRequestQueueæ–¹æ³•,ä¼ å…¥ä¸€ä¸ªé»˜è®¤çš„null. public static RequestQueue newRequestQueue(Context context, HttpStack stack) { File cacheDir = new File(context.getCacheDir(), DEFAULT_CACHE_DIR); String userAgent = &quot;volley/0&quot;; try { String packageName = context.getPackageName(); PackageInfo info = context.getPackageManager().getPackageInfo(packageName, 0); userAgent = packageName + &quot;/&quot; + info.versionCode; } catch (NameNotFoundException e) { } if (stack == null) { if (Build.VERSION.SDK_INT &gt;= 9) { stack = new HurlStack(); } else { // Prior to Gingerbread, HttpUrlConnection was unreliable. // See: http://android-developers.blogspot.com/2011/09/androids-http-clients.html stack = new HttpClientStack(AndroidHttpClient.newInstance(userAgent)); } } Network network = new BasicNetwork(stack); RequestQueue queue = new RequestQueue(new DiskBasedCache(cacheDir), network); queue.start(); return queue; }è¿™é‡Œæ‰æ˜¯çœŸæ­£çš„åˆ›å»ºRequestQueueçš„åœ°æ–¹,å› ä¸ºä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯null,æ‰€ä»¥stack== nullæ˜¯æˆç«‹çš„,è¿™æ˜¯å°±ä¼šæ ¹æ®ä¸åŒçš„ç³»ç»Ÿç‰ˆæœ¬åˆ›å»ºä¸åŒçš„HttpStackå­ç±»çš„å®ä¾‹å¯¹è±¡,ç„¶åå°†å®ƒåŒ…è£…æˆBasicNetworkå¯¹è±¡. åŒæ—¶ç¬¬ä¸€è¡Œçš„æ—¶å€™å°±åˆ›å»ºäº†Volleyçš„ç¼“å­˜ç›®å½•(å½“ç„¶ä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€æ±‚éšæ„æ›´æ”¹ç¼“å­˜ç›®å½•çš„ä½ç½®),å¹¶å°†ç¼“å­˜ç›®å½•åŒ…è£…æˆä¸€ä¸ªDiskBasedCacheå¯¹è±¡. è‡³æ­¤,RequestQueueéœ€è¦çš„ç¼“å­˜å’Œç½‘ç»œè¯·æ±‚å¯¹è±¡å°±åˆ›å»ºæˆåŠŸäº†,ç„¶åæˆ‘ä»¬çš„RequestQueueè¯·æ±‚é˜Ÿåˆ—å°±åˆ›å»ºæˆåŠŸäº†. é€šè¿‡start()æ–¹æ³•å°±å¯åŠ¨äº†æˆ‘ä»¬çš„è¯·æ±‚é˜Ÿåˆ—. å°ç»“ä¸¤ä¸ªnewRequestQueueæ–¹æ³•ä½¿ç”¨çš„è¿™ç§æ–¹å¼å…¶å®éå¸¸å·§å¦™,ä»¥å‰æˆ‘çœ‹åˆ°è¿™ç§æ–¹å¼å°±å«ä»–é‡è½½è°ƒç”¨(ä¸çŸ¥é“å«çš„å¯¹ä¸å¯¹,å“ˆå“ˆ). è¿™æ˜¯æˆ‘çš„Volleyç³»åˆ—çš„ç¬¬ä¸€ç¯‡,å¥½çš„å¼€å§‹,åŠ æ²¹â†–(^Ï‰^)â†—!","link":"/2016/05/21/Android/Volley%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E7%AF%87-%E6%A1%86%E6%9E%B6%E5%85%A5%E5%8F%A3/"},{"title":"Volleyå­¦ä¹ ç¬¬ä¸‰ç¯‡-ç½‘ç»œçº¿ç¨‹","text":"å‰æ–‡æ¦‚è¦å…¶å®NetworkDispatcherå’ŒCacheDispatcheræ˜¯å¾ˆç›¸åƒçš„.æ„Ÿè§‰çœ‹NetworkDispatcherè¦æ¯”CacheDispatcherè¦ç®€å•. å› ä¸ºå®ƒä¸éœ€è¦è¿›è¡Œåˆ¤æ–­ç¼“å­˜çš„è¿‡æœŸæ—¶é—´å’Œæ–°é²œæ—¶é—´,ä»…ä»…æ˜¯æ‰§è¡Œè¯·æ±‚,ç„¶ååœ¨ç¼“å­˜å“åº”ç»“æœ,æ‰€ä»¥è¦ç®€å•äº›. æµç¨‹åˆ†æ åŒæ ·çš„ç»§æ‰¿Thread,åªçœ‹run()æ–¹æ³•é‡Œé¢çš„å°±å¥½äº† åŒæ ·çš„æ­»å¾ªç¯,é˜Ÿåˆ—æ— å†…å®¹æ—¶é˜»å¡ 1.é¦–å…ˆä»é˜Ÿåˆ—ä¸­å–å‡ºRequestè¯·æ±‚ request = mQueue.take(); 2.åˆ¤æ–­è¯·æ±‚æ˜¯å¦å–æ¶ˆ if (request.isCanceled()) { request.finish(&quot;network-discard-cancelled&quot;); continue; } 3.è¯·æ±‚æœªå–æ¶ˆ,æ‰§è¡Œç½‘ç»œè¯·æ±‚å¹¶å¾—åˆ°NetworkResponseå¯¹è±¡ NetworkResponse networkResponse = mNetwork.performRequest(request);å…·ä½“çš„ç½‘ç»œè¯·æ±‚è¿˜æ˜¯éœ€è¦çœ‹Networkæ¥å£çš„å®ç°ç±»ä¸­æ˜¯å¦‚ä½•æ“ä½œçš„. 4.åˆ¤æ–­æœåŠ¡å™¨è¿”å›ç æ˜¯å¦æ˜¯304(èµ„æºæœªæ›´æ–°) if (networkResponse.notModified &amp;&amp; request.hasHadResponseDelivered()) { request.finish(&quot;not-modified&quot;); continue; } 5.æ˜¯å¦ç¼“å­˜è¯·æ±‚çš„å“åº” if (request.shouldCache() &amp;&amp; response.cacheEntry != null) { mCache.put(request.getCacheKey(), response.cacheEntry); request.addMarker(&quot;network-cache-written&quot;); } 6.åˆ†å‘ mDelivery.postResponse(request, response); å°ç»“å…¶å®çœ‹æ˜ç™½å…ˆå‰çš„ç¼“å­˜çº¿ç¨‹ä¹‹å,ç†è§£ç½‘ç»œçº¿ç¨‹ä¹Ÿä¸æ˜¯éš¾äº‹äº†. æ˜å¤©è¯¦ç»†è§£é‡Šä¸‹å…·ä½“å“åº”çš„è½¬åŒ–å’Œåˆ†å‘æµç¨‹.","link":"/2016/05/23/Android/Volley%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%89%E7%AF%87-%E7%BD%91%E7%BB%9C%E7%BA%BF%E7%A8%8B/"},{"title":"åŸºç¡€åŠ å¼º--æ¡†æ¶åŠ å¼º","text":"æ–°ç‰¹æ€§Static Import : é™æ€å¯¼å…¥ï¼Œå½“å‰ç±»ä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨é™æ€èµ„æºï¼ˆå­—æ®µ|æ–¹æ³•ï¼‰ æ ¼å¼ï¼šimport static java.lang.Math.*;Varargs ï¼šå¯å˜å‚æ•° public void demo(String... args){ å½“æˆæ•°ç»„ä½¿ç”¨ }Autoboxing/Unboxing è‡ªåŠ¨è£…ç®±ã€è‡ªåŠ¨æ‹†ç®±ï¼ˆåŸºæœ¬ç±»å‹ &lt;â€“&gt; åŒ…è£…ç±»ï¼‰ è£…ç®±ï¼šåŸºæœ¬ç±»å‹ --&gt; åŒ…è£…ç±»ã€‚ä¾‹å¦‚ï¼šInteger i = 10; --&gt; Integer m = new Integer(10); æ‹†ç®±ï¼šåŒ…è£…ç±» --&gt; åŸºæœ¬ç±»å‹ã€‚ä¾‹å¦‚ï¼šint j = i; --&gt; int n = m.intValue();Enhanced for Loop å¢å¼ºforå¾ªç¯ for(ç±»å‹ å˜é‡ : å®¹å™¨){} --&gt; å®¹å™¨ï¼šæ•°ç»„ã€Iterableæ¥å£ï¼ˆiteratoræ–¹æ³•ï¼‰Typesafe Enums æšä¸¾ public class Hello {} public enum Color {}æ³›å‹ç‰¹ç‚¹ 1.å°†è¿è¡Œæ—¶çš„é—®é¢˜æå‡åˆ°ç¼–è¯‘æ—¶ 2.æ–¹æ³•çº§åˆ«çš„æ³›å‹å®šä¹‰ä¸»è¦æ˜¯ç”¨åœ¨å·¥å…·ç±»ä¸­çš„ public class TestGeneric2 { public void demo(){ int m = 10; String s = init(&quot;abc&quot;); Integer i = init(123); } //æ–¹æ³•çº§åˆ«çš„å®šä¹‰ MyBeanUtils public &lt;T&gt; T init(T obj){ //ç®—æ³• System.out.println(obj); return obj; } }æ³›å‹æ“¦é™¤ ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ä¸èƒ½åŒæ—¶å­˜åœ¨ public void init(List&lt;String&gt; list){} public void init(List&lt;Integer&gt; list){} ç±»å‹æ“¦é™¤ä¹‹åï¼Œä¸¤ä¸ªæ–¹æ³•æ˜¯å®Œå…¨ç›¸åŒåå°„ä¸­Classå¯¹è±¡çš„ä¸‰ç§è·å–æ–¹å¼: Class.forName(&quot;å…¨é™å®šç±»å&quot;); String.class obj.getClassåå°„å’Œæ³›å‹æ··åˆä½¿ç”¨çš„ä¾‹å­: public class Dao&lt;T&gt; { private Session session; private Class beanClass; public Dao() { //1 åœ¨è¿è¡Œæ—¶ï¼Œè·å¾—å½“å‰è¿è¡Œç±» çˆ¶ç±»ä¸­æ³›å‹çš„å®é™…å‚æ•° //this.getClass().getSuperclass(); //jdk1.4ä¹‹å‰ï¼Œè·å¾—çˆ¶ç±»ï¼Œä¸å«æ³›å‹ä¿¡æ¯ // * è·å¾—è¢«å‚æ•°åŒ–çš„ç±»å‹ ArrayList&lt;Integer&gt; ï¼Œå«æœ‰æ³›å‹ä¿¡æ¯ ParameterizedType type = (ParameterizedType) this.getClass().getGenericSuperclass(); //2 è·å¾—æ‰€æœ‰çš„å®é™…å‚æ•°ç±»å‹ã€‚ç±»&lt;A,B,C,D&gt; ,è¿”å›æ•°ç»„ï¼Œè·å¾—ç¬¬ä¸€ä¸ªå®é™…å‚æ•° Type firstType = type.getActualTypeArguments()[0]; this.beanClass = (Class) firstType; /* //å›é¡¾ åå°„ api beanClass.getName(); //ç±»å beanClass.getMethod(name, parameterTypes) //æ–¹æ³• beanClass.getConstructor(parameterTypes) //æ„é€  beanClass.getField(name) //å­—æ®µ */ System.out.println(beanClass); } /* æ³›å‹ ï¼Œå°†è¿è¡Œæ—¶é—®é¢˜ æå‡ ç¼–è¯‘æ—¶ * æ³›å‹å®å‚åªæœ‰åœ¨è¿è¡Œæ—¶æ‰å¯ä»¥ç¡®å®šï¼Œç¼–è¯‘æ—¶ T ä¸èƒ½ç¡®å®šç±»å‹ï¼ˆUser | Bookï¼‰ åªæœ‰åœ¨è¿è¡Œæ—¶æ‰å¯ä»¥ç¡®å®š * æ€æƒ³ï¼šå¦‚ä½•åœ¨è¿è¡Œæ—¶è·å¾—å®é™…ç±»å‹å‚æ•°ï¼Ÿ */ public T findById(Integer id){ return (T) session.get(beanClass, id); } }æ³¨è§£ä»‹ç» æ³¨è§£å°±æ˜¯ç±»,ç”¨äºä¿®é¥°å¯¹è±¡(ç±»/æ„é€ /å­—æ®µ/æ–¹æ³•ç­‰),å¸¸ç”¨è¯­å–ä»£xmlé…ç½®. ä½†æ˜¯,å¼€å‘ä¸­å¸¸ç”¨æ³¨è§£+xmlæ··åˆä½¿ç”¨JDKæä¾›çš„å¸¸ç”¨æ³¨è§£ @Override åœ¨jdk1.5è¡¨ç¤ºå­ç±»è¦†å†™çˆ¶ç±»çš„æ–¹æ³• åœ¨jdk1.6è¡¨ç¤ºå­ç±»å®ç°çˆ¶æ¥å£çš„æ–¹æ³• @Deprecated è¡¨ç¤ºè¢«ä¿®é¥°å¯¹è±¡å·²ç»è¿‡æœŸäº†,è¿‡æœŸçš„æ–¹æ³•ä¾æ—§å¯ä»¥ä½¿ç”¨. ä»¥ä¸‹æƒ…å†µè¢«æ ‡è®°è¿‡æœŸ:1.å®‰å…¨é—®é¢˜ 2.æœ‰æ–°çš„API @SuppressWarnings æŠ‘åˆ¶è­¦å‘Š,å¦‚æœæœ‰è­¦å‘Šé€šè¿‡ç¼–è¾‘å™¨ä¸è¿›è¡Œè­¦å‘Š deprecation:å¦‚æœè¿‡æœŸä¸è­¦å‘Š rawtypes:æ²¡æœ‰æ³›å‹ unused:æœªä½¿ç”¨ null:ç©ºæŒ‡é’ˆ serial:åºåˆ—åŒ– all:æ‰€æœ‰ å»ºè®®:å°½é‡ä¸ä½¿ç”¨æŠ‘åˆ¶è‡ªå®šä¹‰æ³¨è§£æ³¨è§£æ¶æ„ å®šä¹‰æ³¨è§£ ä½¿ç”¨æ³¨è§£ è§£ææ³¨è§£åŸºæœ¬è¯­æ³• å®šä¹‰æ³¨è§£ä½¿ç”¨å…³é”®å­— : `@interface` ,å’Œå®šä¹‰ç±»classç›¸ä¼¼ public @interface xxx{} æˆå‘˜æ ¼å¼: ä¿®é¥°ç¬¦ è¿”å›å€¼ å±æ€§å() [default é»˜è®¤å€¼] eg: public String username(); æ³¨æ„ç‚¹: 1.ä¿®é¥°ç¬¦:é»˜è®¤å€¼ public abstract,ä¸”åªèƒ½æ˜¯è¿™ä¸¤ä¸ª 2.è¿”å›å€¼:åªèƒ½æ˜¯åŸºæœ¬ç±»å‹/å­—ç¬¦ä¸²String/Class/æ³¨è§£/æšä¸¾,ä»¥åŠä»¥ä¸Šç±»å‹çš„ä¸€ç»´æ•°ç»„.ä½¿ç”¨æ³¨è§£â€”é‡ç‚¹!!! æ³¨è§£å‡ºç°çš„ç›®çš„å°±æ˜¯ç”¨æ¥ä»£æ›¿xmlçš„","link":"/2016/07/29/Android/%E5%9F%BA%E7%A1%80%E5%8A%A0%E5%BC%BA--%E6%A1%86%E6%9E%B6%E5%8A%A0%E5%BC%BA/"},{"title":"Docker Composeæ— æ³•éƒ¨ç½²Vueé¡¹ç›®","text":"è¿‘æœŸåœ¨è¿›è¡ŒVueé¡¹ç›®è‡ªåŠ¨åŒ–æ„å»ºï¼Œé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œä¸‹é¢è®°å½•ä¸€ä¸ªå…¸å‹çš„é—®é¢˜ã€‚ 1. é—®é¢˜å‡ºç°åœ¨ä½¿ç”¨dockeréƒ¨ç½²vueé¡¹ç›®çš„æ—¶å€™ï¼Œä½¿ç”¨äº†multi-stage-buildæ¥æ„å»ºæœ€ç»ˆé•œåƒï¼Œç„¶é¹…åœ¨æ„å»ºæ—¶å´å‡ºç°äº†å¦‚ä¸‹é—®é¢˜ï¼š 12345678Building nginx_managerStep 1/12 : FROM node:lts-alpine as baseService 'nginx_manager' failed to build: Error parsing reference: &quot;node:lts-alpine as base&quot; \\is not a valid repository/tag: invalid reference formatSSH: EXEC: completed after 1,636 msSSH: Disconnecting configuration [tencent_server] ...ERROR: Exception when publishing, exception message [Exec exit status not zero. Status [1]]Finished: UNSTABLE è¿™è´´ä¸€ä¸‹æˆ‘æœ€åŸå§‹çš„Dockerfileå’Œdocker-compose.yml 12345678910111213FROM node:lts-alpine as base-buildWORKDIR /appCOPY package*.json ./RUN npm installCOPY . .RUN npm run build:prod# production stageFROM nginx:stable-alpine as nginx-build# å°†ä¿®æ”¹çš„æ–‡ä»¶æ›¿æ¢æ‰å®¹å™¨ä¸­çš„nginxé…ç½®# COPY default.conf /etc/nginx/conf.d/default.confCOPY --from=base-build /app/dist /usr/share/nginx/htmlEXPOSE 80CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;] 1234567891011version: &quot;3&quot;services: nginx: container_name: manager build: context: ./manager dockerfile: Dockerfile ports: - 8080:80 environment: HOST: 0.0.0.0 2. æŸ¥æ‰¾è§£å†³æ–¹æ¡ˆäºæ˜¯å¼€å±•å„ç§æœç´¢ï¼Œæœç´¢åˆ°ä¸€ä¸ªç›¸å…³é—®é¢˜ï¼Œæ¨èä½¿ç”¨targetçš„æ–¹å¼æ¥æŒ‡å®šå…·ä½“çš„æ„å»ºé˜¶æ®µ ç›¸å…³é“¾æ¥ï¼šhttps://stackoverflow.com/questions/53093487/multi-stage-build-in-docker-compose ä¿®æ”¹åçš„docker-compose.yml 123456789101112version: &quot;3.4&quot;services: nginx_manager: container_name: manager build: context: ./manager dockerfile: Dockerfile target: nginx-build ports: - 8080:80 environment: HOST: 0.0.0.0 æ‰§è¡Œåä¾æ—§æ˜¯ä¸Šé¢çš„é”™è¯¯ã€‚ã€‚ã€‚ äºæ˜¯åˆè¿›è¡Œäº†æœç´¢ï¼Œåœ¨GitHubä¸Šæœç´¢åˆ°ç›¸å…³é—®é¢˜ï¼ŒåŸå› ç«Ÿç„¶åœ¨äºdockerç‰ˆæœ¬è¿‡ä½ï¼ ç›¸å…³é“¾æ¥ï¼šhttps://github.com/tootsuite/mastodon/issues/8240 GitHubä¸Šçš„è®¨è®ºæŒ‡å‡ºï¼š 1Docker's &quot;multi stage build&quot; with keyword &quot;as&quot; is supported on Docker 17.05 or later. æŸ¥çœ‹æœåŠ¡å™¨dockerç‰ˆæœ¬ï¼Œç¡®å®æ˜¯ä½äº17.05ï¼Œäºæ˜¯é‡è£…äº†dockerã€‚ 123456789# å®‰è£…ä¾èµ–yum install -y yum-utils device-mapper-persistent-data lvm2# ä¿®æ”¹ä¸ºé˜¿é‡Œäº‘çš„æºyum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo# åˆ é™¤åŸæ¥çš„dockeryum remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate \\ docker-logrotate docker-selinux docker-engine-selinux docker-engine# å®‰è£…docker ceyum install docker-ce å®‰è£…æˆåŠŸåå¯åŠ¨dockerï¼Œç»“æœå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š 12Error response from daemon: Unknown runtime specified docker-runcError: failed to start containers: 7253e1be7fb3 çœŸæ˜¯ä¸€æ³¢æœªå¹³ä¸€æ³¢åˆèµ·å•Šï¼Œä¸è¿‡æœ‰è§£å†³æ–¹æ¡ˆï¼š 12345678910111213[root@VM_12_255_centos ~]# cd /var/lib/docker/containers/[root@VM_12_255_centos containers]# grep -rl &quot;docker-runc&quot; ../550dc5fda621f02b5079e0d70d502c01752fef6a03f0bf3dbf533f0634fc6013/hostconfig.json./d2bc485ef863b5742c29d4e95e5de641aaf5b474657eb16c47b51bc3d679ca1a/hostconfig.json./afa79db1bd41284e99446404afee1f43f06a7381889fd90961493d83ffb31658/hostconfig.json./b405ade18866912841727c384c4eb71625d59865dc72676c39dfdde1592c8748/hostconfig.json./9c291209f3e09e5cdf6f7333873d8216be531aba940d185f12160a1ff98fdc6e/hostconfig.json./9c291209f3e09e5cdf6f7333873d8216be531aba940d185f12160a1ff98fdc6e/config.v2.json./e5a7f498b6a8501f4e625e4e8598b819577141dbb137f945356777d3c9c0c077/hostconfig.json./c58152c4ceeb6506aeca1eacf029c51e53cfc3848bc588120b51e97ee6463f74/hostconfig.json./b4b59541feb03b0f102f521da336f358be4c70f23ecdc837644e3835c024535d/hostconfig.json./b4b59541feb03b0f102f521da336f358be4c70f23ecdc837644e3835c024535d/config.v2.json[root@VM_12_255_centos containers]# sed -i &quot;s/docker-runc//g&quot; ./550dc5fda621f02b5079e0d70d502c01752fef6a03f0bf3dbf533f0634fc6013/hostconfig.json å°†ä¸Šé¢grepæœç´¢å‡ºæ¥çš„æ–‡ä»¶å…¨éƒ½æ‰§è¡Œsedå‘½ä»¤æ›¿æ¢ï¼Œä¹‹åæ­£å¸¸é‡å¯å³å¯ ç›¸å…³é“¾æ¥ï¼šhttps://forums.docker.com/t/after-upgrade-to-docker-ce-containers-will-not-start/40243/3 3. æ€»ç»“è‡³æ­¤ï¼Œæ­¤æ¬¡é—®é¢˜å‘Šä¸€æ®µè½ï¼Œç‰ˆæœ¬å…¼å®¹é—®é¢˜ç¡®å®ä¸å®¹å°è§‘å•Šï¼ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/12/CI&CD/Docker%20Compose%E6%97%A0%E6%B3%95%E9%83%A8%E7%BD%B2Vue%E9%A1%B9%E7%9B%AE/"},{"title":"Dockeræ•™ç¨‹(ä¸€)---Dockerç®€ä»‹","text":"è™šæ‹ŸåŒ–æŠ€æœ¯ä¼ ç»Ÿè™šæ‹ŸåŒ–æ–¹å¼æ˜¯è™šæ‹Ÿæœºè™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶å,åœ¨ä¸Šé¢è¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿ;è€Œå®¹å™¨æŠ€æœ¯æ˜¯ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„èµ„æº,æ˜¯ä¸€ç§è½»é‡çº§çš„è™šæ‹ŸæŠ€æœ¯. Docker åœ¨å®¹å™¨çš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œä»æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œäº’è”åˆ°è¿›ç¨‹éš”ç¦»ç­‰ç­‰ï¼Œæå¤§çš„ç®€åŒ–äº†å®¹å™¨çš„åˆ›å»ºå’Œç»´æŠ¤ã€‚ä½¿å¾— Docker æŠ€æœ¯æ¯”è™šæ‹ŸæœºæŠ€æœ¯æ›´ä¸ºè½»ä¾¿ã€å¿«æ·ã€‚ è¿™å¹…å›¾æ¯”è¾ƒäº† Docker å’Œä¼ ç»Ÿè™šæ‹ŸåŒ–æ–¹å¼çš„ä¸åŒä¹‹å¤„ï¼Œå¯è§å®¹å™¨æ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šå®ç°è™šæ‹ŸåŒ–ï¼Œç›´æ¥å¤ç”¨æœ¬åœ°ä¸»æœºçš„æ“ä½œç³»ç»Ÿï¼Œè€Œä¼ ç»Ÿæ–¹å¼åˆ™æ˜¯åœ¨ç¡¬ä»¶å±‚é¢å®ç°ã€‚ è™šæ‹Ÿæœºå’Œå®¹å™¨çš„åŒºåˆ«ç›¸åŒç‚¹: å‡å¯åœ¨ä¸åŒä¸»æœºä¹‹é—´è¿›è¡Œè¿ç§» æƒé™çº§åˆ«æ“ä½œç›¸åŒ ä¸åŒç‚¹: è™šæ‹Ÿæœºæ˜¯ç¡¬ä»¶è™šæ‹ŸåŒ–,å®¹å™¨æ˜¯ç³»ç»Ÿå±‚é¢è™šæ‹ŸåŒ– è™šæ‹Ÿæœºè‡ƒè‚¿æ€§èƒ½æœ‰é™,è¿ç§»éš¾åº¦è¾ƒå¤§;å®¹å™¨è½»é‡å ç”¨ç©ºé—´å°,è¿ç§»æ–¹ä¾¿,æ€§èƒ½æ¥è¿‘åŸç”Ÿç³»ç»Ÿ ä¸€å°æœåŠ¡å™¨æ”¯æŒè™šæ‹Ÿæœºæ•°é‡æœ‰é™,å®¹å™¨å´å¯ä»¥è¾¾åˆ°ä¸Šåƒä¸ª å®¹å™¨å’Œè™šæ‹Ÿæœºå„æœ‰å„çš„ä¼˜ç¼ºç‚¹ï¼Œå®¹å™¨ä¹Ÿå¹¶ä¸æ˜¯è™šæ‹Ÿæœºçš„æ›¿ä»£å“ï¼Œåªæ˜¯äºŒè€…åœ¨é€‚åº”ä¸åŒçš„éœ€æ±‚ä¸‹å„æœ‰ç‰¹ç‚¹ Dockeræ€æƒ³åŠç†å¿µ docker å°è£…æ€æƒ³å’Œ Java çš„è·¨å¹³å°æ€æƒ³éå¸¸ç›¸ä¼¼ å»ºè®®ä¸€ä¸ªå®¹å™¨åªéƒ¨ç½²ä¸€ä¸ªåº”ç”¨(å½“ç„¶ä¹Ÿå¯ä»¥éƒ¨ç½²å¤šä¸ª) Dockeråº”ç”¨åœºæ™¯ å¤§é‡éƒ¨ç½²ç›¸åŒç›¸ä¼¼ç¯å¢ƒæœåŠ¡å™¨(ä¾‹å¦‚å¾®ä¿¡å…¬ä¼—å·ç¯å¢ƒ) ä¸ºå¼€å‘ã€æµ‹è¯•æä¾›ä¸€ä¸ªè½»é‡çº§çš„ç‹¬ç«‹æ²™ç›’ç¯å¢ƒ,è®©åº”ç”¨ç¨‹åºåœ¨ä¸åŒçš„ç¯å¢ƒä¸­ï¼Œå¾—åˆ°ç›¸åŒçš„è¿è¡Œç»“æœ åº”ç”¨çš„è‡ªåŠ¨åŒ–æµ‹è¯•/æŒç»­é›†æˆ/è‡ªåŠ¨åŒ–æ‰“åŒ…/å‘å¸ƒ é«˜æ€§èƒ½ã€è¶…å¤§è§„æ¨¡çš„å®¿ä¸»æœºéƒ¨ç½² æ¬¢è¿å¤§å®¶å…³æ³¨ : LFå·¥ä½œå®¤ ç®€ä¹¦ : https://www.jianshu.com/u/e61935d18b09 æ˜é‡‘ : https://juejin.im/user/59239002570c350069c5f0bb å¾®ä¿¡å…¬ä¼—å· :å¤´æ¡å· :","link":"/2017/02/19/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E4%B8%80-Docker%E7%AE%80%E4%BB%8B/"},{"title":"Simpleblogåšå®¢ç³»ç»Ÿ(ä¸€)---DaoCloudæŒç»­é›†æˆ","text":"DaoCloudæŒç»­é›†æˆ DaoCloudæä¾›äº†éå¸¸æ£’çš„CIç³»ç»Ÿ,é…åˆgithubå®Œç¾æŒç»­é›†æˆåº”ç”¨éƒ¨ç½². æ“ä½œæ­¥éª¤ åˆ›å»ºé¡¹ç›® 02åˆ›å»ºé¡¹ç›® 03åˆå§‹ç•Œé¢ 04æµç¨‹ 05å®‰å…¨æ„å»º 06æ„å»ºå‡†å¤‡ å®‰å…¨æ„å»º 08æ‰‹åŠ¨è§¦å‘ 09masteråˆ†æ”¯è§¦å‘ 10æŸ¥çœ‹æ—¥å¿— 11æ‰§è¡ŒæˆåŠŸ 12åº”ç”¨-åˆ›å»ºåº”ç”¨ 13éƒ¨ç½²æœ€æ–°ç‰ˆæœ¬ 14åŸºæœ¬ä¿¡æ¯ 15åº”ç”¨è®¾ç½® 16å¯åŠ¨åº”ç”¨ æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2018/03/21/Docker%E6%95%99%E7%A8%8B/DaoCloud%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"},{"title":"å¾®ä¿¡æ”¯ä»˜","text":"å†™åœ¨å‰é¢çš„è¯ å°è±ªä»æ¥éƒ½æ˜¯ä¸€ä¸ªè®¤è®¤çœŸçœŸå†™æ€»ç»“çš„äºº(â—â€™â—¡â€™â—) å¾®ä¿¡æ”¯ä»˜ APPç«¯å¼€å‘æ­¥éª¤è¯´æ˜ Androidæ¥å…¥æŒ‡å— demoä¸‹è½½ ç¬¬ä¸€ä¸ªå‘å¥½åƒä¿®æ”¹äº†åº”ç”¨ç­¾åçš„æ—¶å€™éœ€è¦ç­‰ç€å®ƒå®¡æ ¸ã€‚ Androidé›†æˆå¾®ä¿¡æ”¯ä»˜æ­£ç¡®å§¿åŠ¿ å¼•å…¥å¾®ä¿¡çš„jaråŒ… åˆå§‹åŒ–æ³¨å†Œåˆ°å¾®ä¿¡ IWXAPI msgApi = WXAPIFactory.createWXAPI(this,Constants.APP_ID, true);// ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ˜¯å¦æ ¡éªŒç­¾åï¼Œå‘ï¼ï¼ï¼ msgApi.registerApp(Constants.APP_ID); å®˜æ–¹çš„ä»€ä¹ˆé¬¼ï¼Œä¸è¦ç†ä»–ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è®°å¾—è¦å¡«trueï¼ è§£æåå°ä¼ å…¥çš„è®¢å•ä¿¡æ¯ å°±æ˜¯é€ä¸ªè§£æï¼Œä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆä¸ç”¨Gsonå‘¢ï¼Ÿ { &quot;appId&quot;: &quot;ä½ çš„APPID&quot;, &quot;money&quot;: 4, &quot;nonceStr&quot;: &quot;d33JjYv6I8a8DmPG&quot;, &quot;partnerId&quot;: &quot;1264518301&quot;, &quot;paySign&quot;: &quot;1ADA353C0A710E144B77804F3B1A525F&quot;, &quot;prepay_id&quot;: &quot;wx2016041117561365055d7bd30985662433&quot;, &quot;timeStamp&quot;: &quot;1460368573&quot;, &quot;wxPackage&quot;: &quot;Sign=WXPay&quot; } å°†è®¢å•ä¿¡æ¯ä¼ å…¥è¯·æ±‚ï¼Œè°ƒèµ·å¾®ä¿¡æ”¯ä»˜ PayReq request = new PayReq(); request.appId = wx.getAppId(); request.partnerId = wx.getPartnerId(); request.prepayId = wx.getPrepay_id(); request.nonceStr = wx.getNonceStr(); request.timeStamp = wx.getTimeStamp(); request.packageValue = wx.getWxPackage(); request.sign = wx.getPaySign(); //request.extData = &quot;app data&quot;; // optional msgApi.sendReq(request);// è°ƒèµ·å¾®ä¿¡æ”¯ä»˜ æ­¤æ—¶ï¼Œä½ ä»¥ä¸ºå°±å¯ä»¥æˆåŠŸè°ƒèµ·å¾®ä¿¡æ”¯ä»˜äº†ã€‚ æ”¯ä»˜ç»“æœçš„å›è°ƒ æƒ³è¦æˆåŠŸå›è°ƒï¼Œè¿˜éœ€è¦ç¼–å†™WXPayEntryActivityç±»(åŒ…åæˆ–ç±»åä¸ä¸€è‡´ä¼šé€ æˆæ— æ³•å›è°ƒ) å¿…é¡»æ”¾åœ¨wxapiåŒ…ä¸‹ï¼Œä¸”è¿™ä¸ªåŒ…å¿…é¡»æ˜¯åœ¨æ ¹ç›®å½•ä¸‹ ä¸èƒ½æ”¾åœ¨å…¶ä»–åŒ…ä¸‹ åº”è¯¥æ˜¯è¿™æ ·çš„ç»“æ„ï¼š æ¸…å•æ–‡ä»¶åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š &lt;activity android:name=&quot;.wxapi.WXPayEntryActivity&quot; android:exported=&quot;true&quot; android:launchMode=&quot;singleTop&quot; /&gt; å¿…é¡»è¿™æ ·å†™ï¼ï¼ï¼å›è°ƒçš„Activityå¿…é¡»æ˜¯ï¼šä½ çš„åŒ…åï¼ˆå¾®ä¿¡demoé‡Œæ˜¯ï¼šnet.sourceforge.simcpuxï¼‰+.wxapi.WXPayEntryActivity.javaä½ å°±ä¸ï¼å¥½ï¼Œé‚£ä½ å°±åˆ«æƒ³å›è°ƒæˆåŠŸã€‚ æˆ‘ä»¿ä½›çœ‹åˆ°äº†è¿™æ ·çš„å˜´è„¸ è¿™ä¸€åˆ‡æ–‡æ¡£é‡Œæ²¡æœ‰ï¼Œdemoé‡Œå†™é”™çš„ï¼ éœ€è¦æ³¨æ„,å¦‚æœerrorCodeæ€»æ˜¯ä¸º -1è¯·å°è¯•é€šè¿‡ä¸‹é¢æ–¹æ³•è§£å†³ï¼š ç”¨æäº¤çš„ç­¾åçš„keystoreæ–‡ä»¶æ‰“åŒ… æ¸…ç†å¾®ä¿¡çš„ç¼“å­˜ çœ‹ä¸Šé¢å†æ¥ä¸€é å…¶ä»–äººçš„æ€»ç»“ Androidå¸¸ç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜ ç§»åŠ¨åº”ç”¨å¾®ä¿¡æ”¯ä»˜é›†æˆå°ç»“ http://www.th7.cn/Program/Android/201501/351050.shtml http://www.tqcto.com/article/mobile/57931.html æœ€åçš„æé†’çœ‹å®Œè¿™ç¯‡å¦‚æœè¿˜æ²¡æœ‰æˆåŠŸï¼Œé‚£ä½ å°±å»éª‚è…¾è®¯å§","link":"/2016/04/12/Android/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98/"},{"title":"Dockeræ•™ç¨‹(ä¸ƒ)---æ„å»ºTomcaté•œåƒ","text":"è¿™æ¬¡é•œåƒæ„å»ºæ˜¯åŸºäºä¸Šç¯‡çš„JDKé•œåƒæ„å»ºçš„. DockerfileFROM lujiahao/jdk1.7 MAINTAINER lujiahao ADD apache-tomcat-7.0.75.tar.gz /usr/local/ RUN mv /usr/local/apache-tomcat-7.0.75 /usr/local/tomcat7 WORKDIR /usr/local/tomcat7/bin EXPOSE 8080æ„å»ºå‘½ä»¤docker build -t=&quot;lujiahao/tomcat7&quot; .å¯åŠ¨å®¹å™¨æµ‹è¯•docker run --name tomcat7 -p 8080:8080 -d lujiahao/tomcat7 ./catalina.sh run æ³¨æ„ï¼šåœ¨è¿è¡Œè£…æœ‰tomcatçš„å®¹å™¨çš„æ—¶å€™ä½¿ç”¨catalina.sh run (è°ƒè¯•æ¨¡å¼ï¼Œåœ¨å‰å°è¿è¡Œ)æ¥å¯åŠ¨ï¼Œå¦‚æœä½¿ç”¨startup.sh çš„è¯ä¼šåœ¨åå°è¿è¡Œï¼Œå®¹å™¨ä¼šè®¤ä¸ºè¿›ç¨‹downæ‰ï¼Œå®¹å™¨ä¹Ÿä¼šè‡ªåŠ¨åœæ­¢ã€‚ ç„¶ååœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹èƒ½å¦è®¿é—®tomcatä¸»é¡µ","link":"/2017/03/07/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E4%B8%83-%E6%9E%84%E5%BB%BATomcat%E9%95%9C%E5%83%8F/"},{"title":"Dockeræ•™ç¨‹(ä¸‰)---å®¹å™¨å‘½ä»¤","text":"Docker å®¹å™¨å‘½ä»¤äº¤äº’å¼æ“ä½œæµç¨‹ è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼ˆäº¤äº’å¼ï¼‰docker run -i -t centos /bin/bash -i è¡¨ç¤ºstdinæ ‡å‡†è¾“å…¥ -tè¡¨ç¤ºttyç»ˆç«¯ç¬¬ä¸€æ¬¡æ‰§è¡Œdocker runå‘½ä»¤ä¼šå…ˆä»è¿œç¨‹ä»“åº“ä¸­æ‹‰å–centosçš„é•œåƒå†…éƒ¨æµç¨‹å¦‚ä¸‹å›¾ é€€å‡ºå®¹å™¨exité‡å‘½åå®¹å™¨docker rename æ—§åç§° æ–°åç§° å¦ä¸€ç§æ–¹æ³•,å¯åŠ¨æ—¶é‡å‘½å docker run --name crxy -t -i centos /bin/bash åˆæ³•çš„å®¹å™¨åç§°æ­£åˆ™[a-zA-Z0-9_.-]æŸ¥çœ‹å®¹å™¨åˆ—è¡¨docker ps [-a] [-l] [-n num]é‡æ–°å¯åŠ¨å·²ç»åœæ­¢çš„å®¹å™¨docker start å®¹å™¨åç§°/å®¹å™¨IDé™„ç€åˆ°ä¸€ä¸ªå®¹å™¨ä¸Šdocker attach å®¹å™¨åç§°/å®¹å™¨ID ä½¿ç”¨`exit`é€€å‡ºå®¹å™¨å,é‡æ–°ç”±`docker start`å‘½ä»¤å¯åŠ¨äº†å®¹å™¨ æ­¤æ—¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤é‡æ–°è¿›å…¥åˆ°å®¹å™¨é‡Œé¢ å¯ä»¥ç†è§£ä¸ºä»å¤–éƒ¨è¿›å…¥åˆ°è¿™ä¸ªå®¹å™¨å†…éƒ¨ ä»…ä»…é€‚ç”¨äºä½¿ç”¨-itå¯åŠ¨çš„å®¹å™¨,åƒä¸‹é¢çš„åå°å¯åŠ¨çš„æ˜¯æ— æ³•ä½¿ç”¨è¿™ä¸ªå‘½ä»¤çš„åå°é•¿æœŸè¿è¡Œ åˆ›å»ºé•¿æœŸè¿è¡Œçš„å®¹å™¨docker run --name lujiahao -d centos /bin/bash -c &quot;while true;do echo hello world;sleep 1;done&quot;ä¼šè¿”å›è¯¥å®¹å™¨çš„é•¿id : 55ba56913bb5666ecb352a031503b5191cc8f186558e2f22380c2adadecc7c14 æˆ‘ä»¬é€šè¿‡docker psè·å¾—çš„æ˜¯è¿™ä¸ªé•¿idçš„å‰åäºŒä½ docker runåé¢è¿½åŠ -d=trueæˆ–è€…-dï¼Œé‚£ä¹ˆå®¹å™¨å°†ä¼šè¿è¡Œåœ¨åå°æ¨¡å¼. è·å–å®¹å™¨æ—¥å¿—docker logs [--tail num] [-t] [-f] å®¹å™¨åç§°/å®¹å™¨ID æ—§ç‰ˆæœ¬çš„æ—¥å¿—ä½ç½®/var/lib/docker/containers/ID/ID-json.log ä½†æ˜¯æ–°ç‰ˆæœ¬çš„å®éªŒå¹¶æ²¡æœ‰å‘ç°è¿™ä¸ªlogå­˜åœ¨ä½ç½® -t æ˜¯æ¥æ·»åŠ æ—¶é—´æˆ³çš„ -f æŒç»­è¾“å‡ºæŸ¥çœ‹å®¹å™¨å†…çš„è¿›ç¨‹docker top å®¹å™¨åç§°/å®¹å™¨IDæ“ä½œä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨åœ¨å®¹å™¨å†…éƒ¨è¿è¡Œè¿›ç¨‹(docker1.3ä¹‹åæ‰æ”¯æŒ) docker exec -d lujiahao touch /etc/lujiahao.txt åœ¨åå°è¿è¡Œçš„å®¹å™¨é‡Œé¢åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ docker exec -it lujiahao /bin/bash è¿åˆ°ä¸€ä¸ªåœ¨åå°è¿è¡Œçš„å®¹å™¨,æ­¤æ—¶æ‰§è¡Œexité€€å‡º,åå°å®¹å™¨è¿˜åœ¨è¿è¡Œåœæ­¢å®¹å™¨docker stop å®¹å™¨åç§°/å®¹å™¨ID å‘å®¹å™¨å‘é€åœæ­¢æŒ‡ä»¤,å®¹å™¨è‡ªå·±åœæ­¢,å»ºè®®ä½¿ç”¨ docker kill å®¹å™¨åç§°/å®¹å™¨ID ç›´æ¥åœæ‰,ä¸å»ºè®®ä½¿ç”¨è·å–å®¹å™¨è¯¦ç»†ä¿¡æ¯docker inspect [--format | -f] å®¹å™¨åç§°/å®¹å™¨ID ä¾‹å­ï¼šdocker inspect --format=&apos;{{.State.Running}}&apos; lujiahao å®¹å™¨å­˜å‚¨ä½ç½®ï¼š/var/lib/docker/containersåˆ é™¤å®¹å™¨docker rm å®¹å™¨åç§°/å®¹å™¨IDæ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨æ˜¯æ— æ³•åˆ é™¤çš„,ä¼šå‡ºç°ä¸‹é¢çš„æç¤º Error response from daemon: You cannot remove a running container 55ba56913bb5666ecb352a031503b5191cc8f186558e2f22380c2adadecc7c14. Stop the container before attempting removal or use -få¯ä»¥å…ˆåœæ­¢å®¹å™¨,æˆ–è€…ä½¿ç”¨ -f å‚æ•° æ‰¹é‡åˆ é™¤æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨docker rm `docker ps -a -q` docker ps -a -q : è¿™ä¸ªå‘½ä»¤ç”¨æ¥è·å–æ‰€æœ‰å®¹å™¨çš„idå®¹å™¨çš„å¯¼å…¥å’Œå¯¼å‡ºå¯¼å‡ºï¼šdocker export å®¹å™¨ID/åç§° &gt; my_container.tar å¯¼å…¥ï¼šcat mycontainer.tar | docker import - é•œåƒåç§°:æ ‡ç­¾é•œåƒçš„ä¿å­˜å’ŒåŠ è½½(æš‚æ—¶è¿˜æ²¡è®²åˆ°)ä¿å­˜ï¼šdocker save é•œåƒID &gt; my_image.tar åŠ è½½ï¼šdocker load&lt; my_image.tar","link":"/2017/02/24/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E4%B8%89-%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4/"},{"title":"Dockeræ•™ç¨‹(äº”)---Azureè™šæ‹Ÿå®‰è£…Docker","text":"è€å¤§æŠŠAzureçš„æƒé™ç»™æˆ‘äº†,å“ˆå“ˆ,å¯æƒœæˆ‘å·²ç»å‡†å¤‡ç¦»èŒäº†,ä½†æ˜¯å·¥ä½œè¿˜æ˜¯è¦ç»§ç»­çš„. ä¸€åˆ‡è¿›è¡Œçš„éå¸¸é¡ºåˆ©,ç™»å½•Azureäº‘å¹³å°,åˆ›å»ºè™šæœº,ç„¶ååˆ‡æ¢rootæƒé™å®‰è£…docker,é€€å‡ºrootç”¨æˆ·,å‡†å¤‡docker pull centosâ€¦æ— æ³•è¿è¡Œ,å§æ§½! è¿è¡Œdockerå‘½ä»¤å¼¹å‡ºå¦‚ä¸‹æç¤º: Cannot connect to the Docker daemon. Is the docker daemon running on this host?dockerå‡ºäºå®‰å…¨çš„è€ƒè™‘æ‰ä¼šè¿™æ ·åš(http://dockone.io/article/589). è§£å†³æ–¹æ¡ˆ åˆ‡æ¢rootæƒé™ visudo -f /etc/sudoers åœ¨ /etc/sudoers ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ azureuser ALL=(ALL) NOPASSWD: /usr/bin/docker é€€å‡ºrootç”¨æˆ· æ‰§è¡Œ vim ~/.bashrc æ·»åŠ  alias docker=&apos;sudo /usr/bin/docker&apos; ä¿å­˜åæ‰§è¡Œ source ~/.bashrc æ­¤æ—¶å°±å¯ä»¥è‡ªç”±çš„ä½¿ç”¨dockerå‘½ä»¤äº†.","link":"/2017/03/06/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E4%BA%94-Azure%E8%99%9A%E6%8B%9F%E5%AE%89%E8%A3%85Docker/"},{"title":"Dockeræ•™ç¨‹(äºŒ)---å®‰è£…Docker","text":"Docker æ ¸å¿ƒç»„ä»¶é•œåƒ(Image)é•œåƒæ˜¯æ„å»ºdockerä¸–ç•Œçš„åŸºçŸ³,ä¹Ÿæ˜¯dockerç”Ÿå‘½å‘¨æœŸä¸­çš„æ„å»ºé˜¶æ®µ. ä»“åº“(Registry)å­˜å‚¨ç”¨æˆ·æ„å»ºçš„é•œåƒä»¥åŠå®˜æ–¹çš„é•œåƒ,åˆ†ä¸ºå…¬æœ‰å’Œç§æœ‰.Dockerå…¬å¸è¿è¥çš„å…¬æœ‰ä»“åº“å«åš Docker Hub å®¹å™¨(Container)å®¹å™¨æ˜¯åŸºäºé•œåƒå¯åŠ¨çš„ï¼Œå®¹å™¨ä¸­å¯ä»¥è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ã€‚å®¹å™¨æ˜¯dockerç”Ÿå‘½å‘¨æœŸä¸­çš„å¯åŠ¨æˆ–æ‰§è¡Œé˜¶æ®µã€‚ ä»“åº“é‡Œé¢å­˜å‚¨ç€é•œåƒ,åŸºäºé•œåƒå¯ä»¥å¯åŠ¨å®¹å™¨container = image + docker run Dockerå·¥ä½œæµ å®‰è£…Docker å®¿ä¸»æœºCentos7 64ä½,å› ä¸º Docker æ˜¯åŸºäº64ä½ç³»ç»Ÿæ„å»ºçš„. éªŒè¯linuxå†…æ ¸ç‰ˆæœ¬uname -a,å®˜æ–¹å»ºè®®ä½¿ç”¨3.8ç‰ˆæœ¬ä»¥ä¸Š æ£€æŸ¥Device Mapper(Dockerçš„å­˜å‚¨é©±åŠ¨) grep device-mapper /proc/devices å¦‚æœä¸å­˜åœ¨åˆ™å®‰è£…yum install -y device-mapper åŠ è½½dm_modå†…æ ¸æ¨¡å— modprobe dm_mod å®‰è£… yum -y install docker(é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆ) å®‰è£…æŒ‡å®šç‰ˆæœ¬ Docker æŸ¥çœ‹å¯å®‰è£…çš„ç‰ˆæœ¬ yum makecache fast(ç›¸å½“äºæ›´æ–°æœ¬åœ°ç¼“å­˜) yum list docker --showduplicates å®‰è£…æŒ‡å®šç‰ˆæœ¬ yum install 2:1.12.5-14.el7.centos éªŒè¯ å¯åŠ¨docker systemctl start docker(centos7) æ·»åŠ å¼€æœºå¯åŠ¨é¡¹ systemctl enable docker(centos7) éªŒè¯dockeræ˜¯å¦æ­£å¸¸ systemctl status docker docker infoå‡ºç°ä¸‹é¢å›¾ç‰‡è¡¨ç¤ºå®‰è£…æˆåŠŸäº† æ€»ç»“è‡³æ­¤,Dockerå·²ç»é¡ºåˆ©å®‰è£…äº†,ä¸‹é¢è¿›å…¥åˆ°åŸºç¡€å‘½ä»¤å­¦ä¹ é˜¶æ®µå§! æ¬¢è¿å¤§å®¶å…³æ³¨ : LFå·¥ä½œå®¤ ç®€ä¹¦ : https://www.jianshu.com/u/e61935d18b09 æ˜é‡‘ : https://juejin.im/user/59239002570c350069c5f0bb å¾®ä¿¡å…¬ä¼—å· :å¤´æ¡å· :","link":"/2017/02/23/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E4%BA%8C-%E5%AE%89%E8%A3%85Docker/"},{"title":"Dockeræ•™ç¨‹(å…­)---æ„å»ºJDKé•œåƒ","text":"1.åˆ›å»ºæ–‡ä»¶å¤¹jdkå› ä¸ºä¼šæŠŠå½“å‰æ„å»ºç›®å½•ä¸­çš„å†…å®¹æ·»åŠ åˆ°é•œåƒé‡Œé¢ æ‰€ä»¥è¦å•ç‹¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹2.ç¼–å†™Dockerfileæ–‡ä»¶FROM centos MAINTAINER lujiahao ADD jdk-7u80-linux-x64.tar.gz /usr/local RUN mv /usr/local/jdk1.7.0_80 /usr/local/jdk1.7 ENV JAVA_HOME /usr/local/jdk1.7 ENV JRE_HOME /usr/local/jdk1.7/jre ENV CLASSPATH .:$JAVA_HOME/jre/lib/rt.jar :$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar ENV PATH $JAVA_HOME/bin:$PATH3.æ„å»ºé•œåƒdocker build -t=&quot;lujiahao/jdk1.7&quot; .4.æ„å»ºå®Œæˆä¹‹åå¯åŠ¨ä¸€ä¸ªä¸´æ—¶æ€§å®¹å™¨æ¥æµ‹è¯•docker run --rm -it lujiahao/jdk1.7 /bin/bash åœ¨è¿è¡Œjavaå’Œjavacçœ‹çœ‹,java -versionçœ‹ç‰ˆæœ¬ç›¸å…³èµ„æºå¯ä»¥åˆ° DockerfileCollection ä¸­å¯»æ‰¾å¯¹åº”çš„ Dockerfile æ–‡ä»¶","link":"/2017/03/06/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E5%85%AD-%E6%9E%84%E5%BB%BAJDK%E9%95%9C%E5%83%8F/"},{"title":"Dockeræ•™ç¨‹(å…«)---æ„å»ºKafkaé•œåƒ","text":"Kafka è¯¥å®¹å™¨çš„å‰æä¾èµ–æ˜¯ä½¿ç”¨æˆ‘çš„JDKçš„é•œåƒçš„ä¾èµ–,åé¢æˆ‘ä¼šæŠŠé•œåƒåŒæ­¥åˆ°çº¿ä¸Š. æ„å»ºé•œåƒä¸‹è½½å¥½Dockerfileæ–‡ä»¶æ‰§è¡Œ docker build -t=&quot;lujiahao/kafkatest&quot; .å¯åŠ¨å®¹å™¨docker run --name test_kafka -it -p 2181:2181 -p 9092:9092 lujiahao/kafkatest /bin/bashé¢å¤–é…ç½®å®¹å™¨ä¸­ä½¿ç”¨kafkaè¿˜éœ€è¦å°†å®¹å™¨çš„å†…éƒ¨IPé…ç½®åˆ°config/server.propertiesä¸­ docker inspcet test_kafkaæŸ¥çœ‹å®¹å™¨çš„å†…éƒ¨IPç„¶åæ›´æ”¹configç›®å½•ä¸­çš„server.propertiesä¸­çš„ä¸‰ä¸ªé…ç½® #å®¹å™¨çš„ipåœ°å€ host.name=172.17.0.1 #å®¹å™¨çš„ipåœ°å€ listeners=PLAINTEXT://172.17.0.1:9092 #å®¿ä¸»æœºçš„IPåœ°å€,ç”¨äºå¤–éƒ¨Producerå’ŒConsumerä½¿ç”¨(å…¬å¸æœåŠ¡å™¨ä½ æ‡‚å¾—) advertised.listeners=PLAINTEXT://xx.xx.xx.xx:9092å¯åŠ¨Kafka./kafkastart.shé”™è¯¯æ€»ç»“1.æ— æ³•åˆ†é…å†…å­˜Java HotSpot(TM) 64-Bit Server VM warning: INFO: os::commit_memory(0x00000000c0000000, 1073741824, 0) failed; error=&apos;Cannot allocate memory&apos; (errno=12)è§£å†³æ–¹æ¡ˆ vi zookeeper-server-start.sh å°† export KAFKA_HEAP_OPTS=&quot;-Xmx512M -Xms512M&quot; æ”¹æˆ export KAFKA_HEAP_OPTS=&quot;-Xmx512M -Xms128M&quot; vi kafka-server-start.sh å°† export KAFKA_HEAP_OPTS=&quot;-Xmx1G -Xms1G&quot; æ”¹æˆ export KAFKA_HEAP_OPTS=&quot;-Xmx512M -Xms128M&quot; æŠŠè¿™ä¸¤ä¸ªå€¼æ”¹æˆç›¸åŒçš„å°±è¡Œäº†å‚è€ƒèµ„æ–™ 2.æ— æ³•å‘é€æ¶ˆæ¯Error when sending message to topic TESTTOPIC with key: null, value: 9 bytes with error: Failed to update metadata after 60000 ms. (org.apache.kafka.clients.producer.internals.ErrorLoggingCallback)è§£å†³æ–¹æ¡ˆ åœ¨ server.properties ä¸­æ·»åŠ  advertised.listeners=PLAINTEXT://xx.xx.xx.xx:9092 ,å¯¹åº”çš„IPä¸ºå®¿ä¸»æœºçš„IPå‚è€ƒèµ„æ–™ Kafkaçš„åŸºæœ¬æ“ä½œ åˆ›å»ºtopic kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic test æŸ¥çœ‹topic kafka-topics.sh --list --zookeeper localhost:2181 ç”Ÿäº§è€… kafka-console-producer.sh --broker-list localhost:9092 --topic test æ¶ˆè´¹è€… kafka-console-consumer.sh --zookeeper localhost:2181 --topic test --from-beginning","link":"/2017/03/22/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E5%85%AB-%E6%9E%84%E5%BB%BAKafka%E9%95%9C%E5%83%8F/"},{"title":"Travis CIæŒç»­é›†æˆGitHubä¸ªäººåšå®¢","text":"ä»€ä¹ˆæ˜¯Travis CI Travis CI æ˜¯ç›®å‰æ–°å…´çš„å¼€æºæŒç»­é›†æˆæ„å»ºé¡¹ç›®ï¼Œå®ƒä¸jenkinsï¼ŒGOçš„å¾ˆæ˜æ˜¾çš„ç‰¹åˆ«åœ¨äºé‡‡ç”¨yamlæ ¼å¼ï¼ŒåŒæ—¶ä»–æ˜¯åœ¨åœ¨çº¿çš„æœåŠ¡ï¼Œä¸åƒjenkinséœ€è¦ä½ æœ¬åœ°æ‰“æ¶æœåŠ¡å™¨ï¼Œç®€æ´æ¸…æ–°ç‹¬æ ‘ä¸€å¸œã€‚ç›®å‰å¤§å¤šæ•°çš„githubé¡¹ç›®éƒ½å·²ç»ç§»å…¥åˆ°Travis CIçš„æ„å»ºé˜Ÿåˆ—ä¸­ï¼Œæ®è¯´Travis CIæ¯å¤©è¿è¡Œè¶…è¿‡4000æ¬¡å®Œæ•´æ„å»ºã€‚å¯¹äºåšå¼€æºé¡¹ç›®æˆ–è€…githubçš„ä½¿ç”¨è€…ï¼Œå¿«å°†ä½ çš„é¡¹ç›®åŠ å…¥Travis CIæ„å»ºé˜Ÿåˆ—å§! ç›®æ ‡ä½¿ç”¨Hexoæ­å»ºæ‰˜ç®¡åœ¨Githubä¸Šçš„ä¸ªäººåšå®¢,æ¯æ¬¡æ¨é€æ–°åšå®¢åˆ°Github,Travis CI è‡ªåŠ¨æ„å»ºå¹¶æ¨é€åˆ°åšå®¢é¡¹ç›®çš„masteråˆ†æ”¯ä¸Š.ç”±äºGitPagesæœåŠ¡è§„å®šç½‘é¡µæ–‡ä»¶å¿…é¡»åœ¨masteråˆ†æ”¯ä¸Š,æ‰€ä»¥åšå®¢æºç å†…å®¹åœ¨é¡¹ç›®çš„hexo-sourceåˆ†æ”¯. æ­¥éª¤1.TravisCIåˆ›å»ºè´¦æˆ·æœ€å¥½ä½¿ç”¨Githubè´¦æˆ·ç›´æ¥ç™»å½•,ç™»å½•åç•Œé¢å¦‚ä¸‹,å‹¾é€‰ä¸ªäººåšå®¢é¡¹ç›®å³å¯. 2.ç”Ÿæˆå¹¶é…ç½®Access Tokenåœ¨GitHubç”ŸæˆTravis CI çš„token ç”Ÿæˆä¹‹åä¸€å®šè¦ä¿å­˜å¥½ï¼Œå› ä¸ºåªä¼šå‡ºç°ä¸€æ¬¡ï¼Œä¸¢å¤±äº†å°±åªèƒ½å†é‡æ–°ç”Ÿæˆäº†ã€‚ ä¹‹åå°†ç”Ÿæˆçš„tokené…ç½®åˆ°Travis CIä¸­ 3.åˆ›å»º.travis.ymlé…ç½®æ–‡ä»¶åœ¨é¡¹ç›®çš„hexo-sourceåˆ†æ”¯ä¸­,é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»º.travis.ymlé…ç½®æ–‡ä»¶ : 1234567891011121314151617181920212223242526272829language: node_jsnode_js: 6# S: Build Lifecycleinstall: - npm install#before_script: # - npm install -g gulpscript: - hexo gafter_script: - cd ./public - git init - git config user.name \"lujiahao0708\" - git config user.email \"lujiahao0708@gmail.com\" - git add . - git commit -m \"Update docs\" - git push --force --quiet \"https://${GH_TOKEN}@${GH_REF}\" master:master# E: Build LifeCyclebranches: only: - hexo-sourceenv: global: - GH_REF: github.com/lujiahao0708/lujiahao0708.github.io.git æ›¿æ¢git configä¿¡æ¯ä¸ºä½ è‡ªå·±çš„,GH_REFçš„å€¼æ›´æ”¹ä¸ºä½ çš„ä»“åº“åœ°å€. 4.å‘å¸ƒæ–°åšå®¢å°†åšå®¢å†…å®¹æ¨é€åˆ°hexo-sourceåˆ†æ”¯ä¸Š,å°±ä¼šè§¦å‘Travis CI çš„è‡ªåŠ¨æ„å»º. Q&amp;A1.Travis CIç¼–è¯‘é”™è¯¯æˆ‘å‚ç…§çš„æ•™ç¨‹ä¸­.travis.ymlé…ç½®æ–‡ä»¶çš„node_jsç‰ˆæœ¬ä½¿ç”¨`stable`,ä½†æ˜¯ä¼šå‡ºç°é”™è¯¯. è§£å†³æ–¹æ¡ˆ : ä½¿ç”¨ä½ç‰ˆæœ¬çš„NodeJSç‰ˆæœ¬ https://segmentfault.com/q/10100000113177832.è‡ªå®šä¹‰åŸŸåæ— æ³•è·³è½¬CNAMEæ–‡ä»¶ç›´æ¥æ”¾åˆ°äº†å·¥ç¨‹çš„æ ¹ç›®å½•ä¸‹,å°†æ— æ³•æ‰“åŒ…è¿›å» è§£å†³æ–¹æ¡ˆ : å°†CNAMEæ–‡ä»¶æ”¾åˆ°sourceç›®å½•ä¸‹å‚è€ƒæ•™ç¨‹https://blog.csdn.net/woblog/article/details/51319364https://www.jianshu.com/p/5691815b81b6 æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2018/06/27/Docker%E6%95%99%E7%A8%8B/Travis%20CI%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"},{"title":"07.JavaWebåŸºç¡€_Servletç¬”è®°","text":"ServletåŸºç¡€æ˜¯ç”¨Javaç¼–å†™çš„æœåŠ¡å™¨ç«¯ç¨‹åº ç±»å…³ç³» æ ¹æ®ç”Ÿå‘½å‘¨æœŸæ‰“æ–­ç‚¹ ç”Ÿå‘½å‘¨æœŸæ‰§è¡Œæµç¨‹init()æ–¹æ³•å½“æˆ‘ä»¬é¦–æ¬¡è®¿é—®HelloServletæ—¶,ä¼šåœ¨tomcatä¸­åˆ›å»ºè¯¥Servlet,æ­¤æ—¶ä¼šæ‰§è¡Œinit()æ–¹æ³•,Javaä¸­æ–¹æ³•æ‰§è¡Œæ˜¯é¦–å…ˆä»å½“å‰ç±»ä¸­æ‰¾æ˜¯å¦æœ‰æ­¤æ–¹æ³•,å¦‚æœæ²¡æœ‰çš„è¯å°±ä¼šå¾€è¯¥ç±»çš„çˆ¶ç±»é‡Œé¢æ‰¾.è¿™å°±åˆ°äº†HttpServletæ–¹æ³•,å‘ç°é‡Œé¢ä¹Ÿæ²¡æœ‰init()æ–¹æ³•,ç»§ç»­å¾€ä¸Šæ‰¾.è€ŒGenericServletä¸­æœ‰ç›¸å…³çš„ä¸œè¥¿ public void init(ServletConfig config) throws ServletException { this.config = config; this.init(); } public void init() throws ServletException { }ç¬¬ä¸€ä¸ªæ˜¯ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•,è€Œä¸‹é¢çš„æ–¹æ³•æ˜¯ç”¨æ¥è¢«å­ç±»è¦†å†™çš„åˆå§‹åŒ–æ–¹æ³•,è¿™æ ·çš„å†™æ³•æ—¢å¯ä»¥å®ç°åˆå§‹åŒ–Servlet,åˆå¯ä»¥é¿å…å­ç±»è¦†å†™çˆ¶ç±»çš„æ–¹æ³•é€ æˆçˆ¶ç±»æ–¹æ³•æ— æ³•æ‰§è¡Œçš„é—®é¢˜. service()æ–¹æ³•service()æ–¹æ³•å’Œè¿™ä¸ªæ˜¯ç±»ä¼¼çš„æµç¨‹.é¦–å…ˆä¼šä»HelloServletä¸­å¯»æ‰¾service()æ–¹æ³•,æ²¡æœ‰,è¿›å…¥åˆ°HttpServletä¸­å¯»æ‰¾,æ‰¾åˆ° public void service(ServletRequest req, ServletResponse res) throws ServletException, IOException { HttpServletRequest request; HttpServletResponse response; try { request = (HttpServletRequest)req; response = (HttpServletResponse)res; } catch (ClassCastException var6) { throw new ServletException(&quot;non-HTTP request or response&quot;); } this.service(request, response); }è¿™é‡Œä¼šè°ƒç”¨ä¸€ä¸ªservice()çš„é‡è½½æ–¹æ³•,è¿™ä¸ªé‡è½½æ–¹æ³•é‡Œé¢æœ‰æ‰§è¡Œå…¶ä¸­æ“ä½œçš„å…·ä½“æ–¹æ³•,ä»¥doGet()ä¸ºä¾‹,è™½ç„¶HttpServletä¸­æœ‰doGet()çš„å®ç°,ä½†æ˜¯æˆ‘ä»¬çš„HelloServletä¸­è¦†å†™äº†doGet()æ–¹æ³•,å…·ä½“çš„å®ç°å°±çœ‹æˆ‘ä»¬çš„è¦†å†™çš„æ–¹æ³•ä¸­çš„æ“ä½œäº†. destory()æ–¹æ³•è¿™ä¸ªæ²¡å•¥å¥½å†™çš„,å°±æ˜¯é”€æ¯ Servletæ€»ç»“ Servletæ˜¯å•ä¾‹ï¼Œä¸€ç”Ÿåªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚ å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡ŒdoGetæ–¹æ³•ï¼Œå­˜åœ¨çº¿ç¨‹å¹¶å‘é—®é¢˜ï¼ˆå®‰å…¨é—®é¢˜ï¼‰è§£å†³æ–¹æ¡ˆï¼šä¸è¦ä½¿ç”¨æˆå‘˜å˜é‡ åˆå§‹åŒ–æ“ä½œï¼šå¤å†™init() ä¸šåŠ¡æ“ä½œï¼šåœ¨doGet()å’ŒdoPost() æ‰€æœ‰çš„servletéƒ½å¿…é¡»åœ¨web.xmlé…ç½® æ³¨æ„ï¼šé…ç½®å½“å‰ä½¿ç”¨çš„servletï¼ˆçˆ¶ç±»HttpServletå’Œçˆ·ç±»GenericServletä¸è¦é…ç½®çš„ï¼‰","link":"/2016/11/20/JavaWeb%E5%9F%BA%E7%A1%80/07-JavaWeb%E5%9F%BA%E7%A1%80-Servlet%E7%AC%94%E8%AE%B0/"},{"title":"10-JavaWebåŸºç¡€-JSPç¬”è®°","text":"ä»€ä¹ˆæ˜¯JSP tomcatå®‰è£…ç›®å½•ä¸‹çš„workç›®å½•å°±æ˜¯tomcatå¤„ç†jspçš„å·¥ä½œç›®å½• JSPæ˜¯ä»¥Javaè¯­è¨€ä¸ºåŸºç¡€çš„åŠ¨æ€ç½‘é¡µå¼€å‘æŠ€æœ¯(Servletä¹Ÿæ˜¯åŠ¨æ€ç½‘é¡µå¼€å‘æŠ€æœ¯) äºŒè€…ç‰¹ç‚¹ servletç‰¹ç‚¹:åœ¨javaä»£ç ä¸­åµŒå…¥htmlä»£ç  jspç‰¹ç‚¹:åœ¨htmlä»£ç ä¸­åµŒå…¥javaä»£ç  JSPæœ¬è´¨ä¸Šå°±æ˜¯servlet tomcatè·å¾—jspæ–‡ä»¶å,å°†jspè½¬åŒ–æˆservlet,ä¼šäº§ç”Ÿxxx_jsp.java(servletæºç ) D:\\java\\tomcat\\apache-tomcat-7.0.53\\work\\Catalina\\localhost\\day10\\org\\apache\\jsp\\b_005fdemo_jsp.java tomcatå®‰è£…ç›®å½• å¼•æ“ ä¸»æœº é¡¹ç›® å›ºå®šåŒ…å jspæ–‡ä»¶å¯¹åº”servle tomcatå°†javaæ–‡ä»¶ç¼–è¯‘äº§ç”Ÿclassæ–‡ä»¶ tomcatè¿è¡Œclassæ–‡ä»¶,å¹¶å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨ æºç åˆ†æ: public final class xxx_jsp extends org.apache.jasper.runtime.HttpJspBase public abstract class HttpJspBase extends HttpServlet æ³¨æ„:jspç”Ÿæˆjavaä»£ç ,é»˜è®¤æ˜¯ç¬¬ä¸€æ¬¡ç”Ÿæˆ,ä¹‹åç›´æ¥æ‰§è¡Œ,é™¤éå†…å®¹ä¿®æ”¹ JSPè„šæœ¬å…ƒç´  è¡¨è¾¾å¼:&lt;%= è¡¨è¾¾å¼ %&gt; å°†è¡¨è¾¾å¼ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨,åº•å±‚è§£æä½¿ç”¨out.print(è¡¨è¾¾å¼); ä»£ç ç‰‡æ®µ:&lt;% javaä»£ç  %&gt; å°†â€javaä»£ç â€å®Œæ•´å¤åˆ¶åˆ°serviceæ–¹æ³•ä½“ä¸­ è„šæœ¬å£°æ˜:&lt;%! å£°æ˜å†…å®¹ %&gt; å°†â€å£°æ˜å†…å®¹â€å®Œæ•´å¤åˆ¶åˆ°classç±»ä¸­(æˆå‘˜å˜é‡oræˆå‘˜æ–¹æ³•) æ³¨æ„:è„šæœ¬ä¸èƒ½åµŒå¥— JSPæ³¨é‡ŠJSPæ³¨é‡Šå°†jspæºç å†…å®¹æ³¨é‡Šæ‰,tomcatç”Ÿæˆjavaæºç ä¸­å°†æ²¡æœ‰æ³¨é‡Šæ‰çš„å†…å®¹ &lt;%-- æ³¨é‡Šå†…å®¹ --%&gt;JSPæŒ‡ä»¤é…ç½®ç»™tomcat,tomcatå°†jspç”Ÿæˆjavaæºç (servlet)ä¾æ®. æ ¼å¼:`&lt;%@ æŒ‡ä»¤åç§° å±æ€§=å€¼ å±æ€§=å€¼ ...%&gt;` æŒ‡ä»¤åŒ…æ‹¬:page/include/taglibpageæŒ‡ä»¤ ç¼–ç [*] pageEncoding:å½“å‰é¡µé¢çš„ç¼–ç  contentType:jspç”Ÿæˆservletå“åº”ç»™æµè§ˆå™¨ç¼–ç  æ³¨æ„:ä¸€èˆ¬ä¸€è‡´ å¯¹æ¯”: å¦‚æœåªæœ‰pageEncoding,è®¾ç½®å½“å‰é¡µé¢ç¼–ç ,ä¹Ÿå¯ä»¥è®¾ç½®å“åº”ç¼–ç  å¦‚æœåªæœ‰contentType,å¯ä»¥è®¾ç½®å“åº”ç¼–ç ,ä¹Ÿå¯ä»¥è®¾ç½®å½“å‰é¡µé¢ç¼–ç  jspç¼“å­˜æœºåˆ¶ buffer:è®¾ç½®ç¼“å­˜å¤§å°,é»˜è®¤8Kb autoFlash:ç¼“å­˜å¦‚æœæº¢å‡º,å°†è‡ªåŠ¨åˆ·æ–° å¦‚æœè®¾ç½®ä¸ºfalseå¯èƒ½å¼‚å¸¸:java.io.IOException:Error:JSP Buffer overflow jspé”™è¯¯å¤„ç†æœºåˆ¶ errorPage:è®¾ç½®é”™è¯¯é¡µé¢. å½“å‰jspé¡µé¢å‡ºç°å¼‚å¸¸,å°†æ˜¾ç¤ºé”™è¯¯ç•Œé¢(å‹å¥½ç•Œé¢). isErrorPage:æŒ‡å®šå½“å‰é¡µé¢å‘ç”Ÿé”™è¯¯æ—¶çš„é”™è¯¯å¤„ç†é¡µ,å¯ä»¥æ•è·å¼‚å¸¸ä¿¡æ¯. æ€è€ƒï¼šå½“é¡µé¢è¿‡å¤šæ—¶å¦‚ä½•é…ç½®é”™è¯¯é¡µé¢? ä½¿ç”¨ç»Ÿä¸€ç®¡ç†ï¼Œç»™æ•´ä¸ªwebé¡¹ç›®é…ç½®å‹å¥½é¡µé¢ã€‚web.xml Element : error-page éœ€è¦ä½¿ç”¨&lt;error-page&gt;æ ‡ç­¾æŒ‡å®š Content Model : ((error-code | exception-type), location) &lt;error-code&gt; é”™è¯¯ç ï¼ˆçŠ¶æ€ç ï¼‰ï¼š500ã€404ç­‰ &lt;exception-type&gt; javaå¼‚å¸¸ç±»å‹ï¼šjava.lang.RuntimeException &lt;location&gt; å‡ºç°æŒ‡å®šé”™è¯¯æ—¶ï¼ŒæŒ‡å®šçš„æ˜¾ç¤ºé¡µé¢ å¸¸ç”¨ session:è¡¨ç¤ºå½“å‰jspé¡µé¢æ˜¯å¦å¯ä»¥ä½¿ç”¨sessionå†…ç½®å¯¹è±¡. true:å¯ä»¥åœ¨jspè„šæœ¬(è¡¨è¾¾å¼/ä»£ç å—)ä¸­ä½¿ç”¨session import:jspä½¿ç”¨å…¶ä»–ç±»ï¼Œè¿›è¡Œå¯¼åŒ…ã€‚ã€ã€‘ åˆ†åˆ«å¯¼å…¥ï¼šjava.util.List ä¸€æ¬¡æ€§å¯¼å…¥ï¼šjava.util.List,java.util.ArrayList æ˜Ÿå·ï¼šjava.util.* language :è¡¨ç¤ºjspæ”¯æŒåµŒå…¥è¯­è¨€(java) info : ä½¿ç”¨åœ¨servletæ¥å£ç¬¬5ä¸ªæ–¹æ³•ï¼ŒgetServletInfo() æŒ‡ä»¤çš„ä½¿ç”¨æ³¨æ„ ä¸€ä¸ªæŒ‡ä»¤å¯ä»¥ç¼–å†™å¤šä¸ªå±æ€§ ä¸€ä¸ªæŒ‡ä»¤å¯ä»¥å¤šæ¬¡ä½¿ç”¨ æŒ‡ä»¤å¯ä»¥ä½¿ç”¨åœ¨jspé¡µé¢ä»»ä½•ä½ç½® å¤§éƒ¨åˆ†æŒ‡ä»¤åªèƒ½ä½¿ç”¨ä¸€æ¬¡,ä½†æ˜¯`import`å¯ä»¥ä½¿ç”¨å¤šæ¬¡. includeæŒ‡ä»¤æ ¼å¼:&lt;%@include file=&quot;&quot;%&gt; åˆ†ç±»: taglibæŒ‡ä»¤å…·ä½“è¯·å‚çœ‹EL&amp;JSTLç¬”è®°. JSPä¹å¤§å†…ç½®å¯¹è±¡[***]å¯ä»¥åœ¨jspè¡¨è¾¾å¼è„šæœ¬&lt;%= &amp;&gt;å’Œä»£ç ç‰‡æ®µè„šæœ¬&lt;% %&gt;å¯ä»¥ä½¿ç”¨çš„å˜é‡.éƒ½åœ¨service()æ–¹æ³•ä¸­,åŠservice()æ–¹æ³•æä¾›çš„å˜é‡. page â€”â€“&gt; è¡¨ç¤ºå½“å‰é¡µé¢.å°±æ˜¯thiså¼•ç”¨ config â€”â€“&gt; è¡¨ç¤ºservleté…ç½®.ç±»å‹æ˜¯:ServletConfig application â€”â€“&gt; è¡¨ç¤ºwebåº”ç”¨çš„ä¸Šä¸‹æ–‡.ç±»å‹æ˜¯:ServeltContext request â€”â€“&gt; è¡¨ç¤ºä¸€æ¬¡è¯·æ±‚.ç±»å‹:HttpServletRequest response â€”â€“&gt; è¡¨ç¤ºä¸€æ¬¡å“åº”.ç±»å‹:HttpServletResponse session â€”â€“&gt; è¡¨ç¤ºä¸€æ¬¡ä¼šè¯.ç±»å‹:HttpSession out â€”â€“&gt; è¡¨ç¤ºè¾“å‡ºå“åº”ä½“.ç±»å‹:JspWriter exception â€”â€“&gt; è¡¨ç¤ºå¼‚å¸¸.ç±»å‹:Throwable pageContext â€”â€“&gt; è¡¨ç¤ºjspé¡µé¢çš„ä¸Šä¸‹æ–‡(jspç®¡ç†è€…).ç±»å‹:PageContext JSPå››ä¸ªä½œç”¨åŸŸ page â€”â€“&gt; å½“å‰é¡µé¢(ä¸€ä¸ªé¡µé¢) request â€”â€“&gt; ä¸€æ¬¡è¯·æ±‚(é»˜è®¤å°±ä¸€ä¸ªé¡µé¢,å¦‚æœä½¿ç”¨è¯·æ±‚è½¬å‘å¯ä»¥å¤šä¸ªé¡µé¢) session â€”â€“&gt; ä¸€æ¬¡ä¼šè¯(å¯ä»¥æœ‰å¤šæ¬¡è¯·æ±‚) application â€”â€“&gt; ä¸€ä¸ªåº”ç”¨(å¯ä»¥å¤šæ¬¡ä¼šè¯) JSPè¾“å‡º è¾“å‡ºç±»å‹:JspWriter jspè¾“å‡ºåº•å±‚ä½¿ç”¨çš„æ˜¯response.getWriter() private void initOut() throws IOException { if(out == null){ out = response.getWriter(); } } ä¸‹é¢ä»£ç è¾“å‡ºæƒ…å†µ: &lt;% out.print(&quot;aaa&quot;); response.getWriter().print(&quot;bbb&quot;); out.print(&quot;ccc&quot;); %&gt; è¾“å‡ºç»“æœ:bbbaaaccc åŸç†è§£æ:jspå’Œservletå„è‡ªéƒ½æœ‰è‡ªå·±çš„ç¼“å­˜,jspé¦–å…ˆå†™å…¥åˆ°jspè‡ªå·±çš„ç¼“å­˜ä¸­(JspWriter), ç„¶åå†åˆ·æ–°åˆ°servletç¼“å­˜(response.getWriter();) å°çŸ¥è¯†ç‚¹:å¦‚æœåœ¨jspç‰‡æ®µä¸­ä½¿ç”¨response.getOutputStream().print(&quot;abc&quot;);çš„è¯ä¼šæŠ¥é”™java.lang.IllegalStateExceptionåŸå› æ˜¯å› ä¸ºjspåº•å±‚ä½¿ç”¨äº†getWriter(),ä¸èƒ½å’ŒgetOutputStream()æ··åˆä½¿ç”¨. JSPåŠ¨ä½œæ ‡ç­¾JSP å†…ç½®æ ‡ç­¾ï¼Œå¯ä»¥å–ä»£ jspè„šæœ¬ã€‚ æ ¼å¼ï¼š &lt;jsp:æ ‡ç­¾å /&gt; &lt;jsp:include page=&quot;&quot; /&gt; åŠ¨æ€åŒ…å« &lt;jsp:forward /&gt; è½¬å‘ &lt;jsp:param/&gt; å¤„ç†è¯·æ±‚å‚æ•°çš„ ï¼Œ å¯ä»¥å°†ä¸­æ–‡å†…å®¹è¿›è¡Œ URLç¼–ç ï¼Œ ç±»ä¼¼ &lt;form enctype=&quot;application/x-www-form-urlencoded&quot;&gt; &lt;jsp:include page=&quot;/error.jsp&quot;&gt; &lt;jsp:param value=&quot;å±Œä¸&quot; name=&quot;username&quot;/&gt; &lt;/jsp:include&gt; &lt;jsp:useBean id=&quot;user&quot; class=&quot;com.itheima.User&quot;&gt;&lt;/jsp:useBean&gt; &lt;%-- User user = new User(); pageContext.setAttribute(&quot;user&quot;,user)--%&gt; &lt;jsp:setProperty property=&quot;username&quot; name=&quot;user&quot; value=&quot;jack&quot;/&gt; &lt;%-- user.setUsername(&quot;jack&quot;) --%&gt; &lt;jsp:getProperty property=&quot;username&quot; name=&quot;user&quot;/&gt; &lt;%-- user.getUsername() --%&gt;JavaBeanå±æ€§public class User{ private String id2;// å­—æ®µ(Field) public String getId(){ return id2; } public void setId(String id){ this.id2 = id; } // javabeanå±æ€§(property) --&gt; ç”±setteræˆ–getteræ–¹æ³•è·å¾— --&gt; setId --&gt; Id --&gt; id // è¿™ä¸ªbeançš„å±æ€§å«id }ç”¨æˆ·ç™»å½•æ¡ˆä¾‹// ç™»å½•å¤„ç† if (userLogin != null) { // ç™»å½•æˆåŠŸ sessionä¿å­˜ç”¨æˆ·ä¿¡æ¯ é‡å®šå‘åˆ°æˆåŠŸç•Œé¢ request.getSession().setAttribute(&quot;userLogin&quot;,userLogin); // é‡å®šå‘ String url = request.getContextPath() + &quot;/login_success.jsp&quot;; response.sendRedirect(url); } else { // ç™»å½•å¤±è´¥ requestè®¾ç½®é”™è¯¯,è¯·æ±‚è½¬å‘,åœ¨ç™»å½•é¡µé¢æ˜¾ç¤ºæç¤ºä¿¡æ¯ // requestä½œç”¨åŸŸä¿å­˜é”™è¯¯ä¿¡æ¯ request.setAttribute(&quot;msg&quot;,&quot;ç”¨æˆ·åå’Œå¯†ç ä¸åŒ¹é…&quot;); request.setAttribute(&quot;username&quot;,username); // ä½¿ç”¨è¯·æ±‚è½¬å‘(ä¸€æ¬¡è¯·æ±‚æ¶‰åŠåˆ°å¤šä¸ªé¡µé¢) request.getRequestDispatcher(&quot;/login.jsp&quot;).forward(request,response); }","link":"/2016/12/05/JavaWeb%E5%9F%BA%E7%A1%80/10-JavaWeb%E5%9F%BA%E7%A1%80-JSP%E7%AC%94%E8%AE%B0/"},{"title":"Hibernateç¬”è®°ä¸€","text":"Hibernateä»‹ç»Hibernateæ˜¯è½»é‡çº§JavaEEåº”ç”¨çš„æŒä¹…å±‚è§£å†³æ–¹æ¡ˆï¼Œæ˜¯ä¸€ä¸ªå…³ç³»æ•°æ®åº“ORMæ¡†æ¶.Hibernateçš„æŒä¹…åŒ–æ–¹æ¡ˆï¼Œå°†ç”¨æˆ·ä»åŸå§‹çš„JDBCåº•å±‚SQLè®¿é—®ä¸­è§£æ”¾å‡ºæ¥,ç”¨æˆ·æ— é¡»å…³æ³¨åº•å±‚æ•°æ®åº“æ“ä½œï¼Œåªè¦é€šè¿‡æ“ä½œæ˜ å°„åˆ°æ•°æ®è¡¨çš„Javaå¯¹è±¡ï¼Œå°±å¯ä»¥å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥ ORM (Object Relational Mappingå¯¹è±¡å…³ç³»æ˜ å°„) ORM å°±æ˜¯é€šè¿‡å°†Javaå¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“è¡¨ï¼Œé€šè¿‡æ“ä½œJavaå¯¹è±¡ï¼Œå°±å¯ä»¥å®Œæˆå¯¹æ•°æ®è¡¨çš„æ“ä½œ æµè¡Œæ•°æ®åº“æ¡†æ¶ 1. JPA(Java Persistence API) : é€šè¿‡æ³¨è§£æè¿°å¯¹è±¡ä¸æ•°æ®è¡¨æ˜ å°„å…³ç³» ï¼ˆåªæœ‰æ¥å£è§„èŒƒï¼‰ 2. Hibernate : æœ€æµè¡ŒORMæ¡†æ¶ï¼Œé€šè¿‡å¯¹è±¡-å…³ç³»æ˜ å°„é…ç½®ï¼Œå¯ä»¥å®Œå…¨è„±ç¦»åº•å±‚SQL ï¼Œ Hibernateå®ç°JPAè§„èŒƒ 3. MyBatis : æœ¬æ˜¯apacheçš„ä¸€ä¸ªå¼€æºé¡¹ç›® iBatisï¼Œæ”¯æŒæ™®é€š SQLæŸ¥è¯¢ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œé«˜çº§æ˜ å°„çš„ä¼˜ç§€æŒä¹…å±‚æ¡†æ¶ ï¼ˆä¼ä¸šä¸»æµï¼‰ * MyBaits å¹¶ä¸æ˜¯å®Œå…¨ORM ï¼Œ éœ€è¦åœ¨xmlä¸­é…ç½®SQLè¯­å¥ 4. Apache DBUtils(è¶…é“¾æ¥åˆ°DBUtilsé‚£èŠ‚ç¬”è®°é‡Œé¢å») 5. Spring JDBCTemplate SQLè¯­å¥å°è£…ç¨‹åº¦ Hibernate &gt; MyBatis &gt; Apache DBUtils ã€Spring JDBCTemplateHibernateä¸­çš„ORMå®ç°æ•°æ®åº“ä¸­çš„è¡¨ä¸javaä¸­çš„ç±»å¯¹åº”è¡¨ä¸­çš„è®°å½•æ˜¯ä¸ç±»ä¸­çš„å¯¹è±¡å¯¹åº”è¡¨ä¸­çš„å­—æ®µæ˜¯ä¸ç±»ä¸­çš„å±æ€§å¯¹åº” Hibernateä½“ç³»ç»“æ„ Hibernateç›®å½•ç»“æ„ Hibernateä½¿ç”¨1.å¯¼å…¥jaråŒ…å¯¼åŒ…çš„å†…å®¹å‚è§ä¸Šä¸€æ­¥,ç›®å½•ç»“æ„ä¸­å¯¼å…¥å³å¯ ç‰¹åˆ«ä»‹ç»: log4j(é“¾æ¥ä¸Šlog4jçš„å•ç‹¬çš„ç¬”è®°å†…å®¹) 2.ç¼–å†™ç±»å’Œå…³ç³»æ˜ å°„é…ç½®xx.hbm.xmlpublic class Customer { private int id; private String name; private int age; private String city; ... }hibernate å®Œå…¨ORMï¼Œåªéœ€è¦æ“ä½œCustomerç±»å¯¹è±¡ï¼Œ è‡ªåŠ¨ç”ŸæˆSQL æ“ä½œcustomer è¡¨ä½†æ˜¯éœ€è¦ä¸ºå®ä½“ç±»å’Œæ•°æ®è¡¨è¿›è¡Œå…³ç³»æ˜ å°„é…ç½® 1.åœ¨å®ä½“ç±»æ‰€åœ¨çš„åŒ…ä¸‹åˆ›å»ºåä¸º:ç±»å.hbm.xmlæ–‡ä»¶,eg:Customer.hbm.xml 2.é…ç½®è§„åˆ™å‚è§ hibernate3.jar org/hibernate/hibernate-mapping-3.0.dtd é…ç½®å±æ€§åˆ°åˆ—æ˜ å°„æ—¶ï¼ŒæŒ‡å®šç±»å‹ï¼Œç±»å‹æœ‰ä¸‰ç§å†™æ³• ç¬¬ä¸€ç§ javaç±»å‹ java.lang.String ç¬¬äºŒç§ hibernateç±»å‹ string ç¬¬ä¸‰ç§ SQLç±»å‹ varchar(20) 3.é…ç½®æ ¸å¿ƒé…ç½®æ–‡ä»¶hibernate.cfg.xmlHibernateæ¡†æ¶æ”¯æŒä¸¤ç§ Hibernateå±æ€§é…ç½®æ–¹å¼ 1.hibernate.properties é‡‡ç”¨propertiesæ–¹å¼ï¼Œå¿…é¡»æ‰‹åŠ¨ç¼–ç¨‹åŠ è½½ hbmæ–‡ä»¶æˆ–è€… æŒä¹…åŒ–ç±» 2.hibernate.cfg.xml é‡‡ç”¨XMLé…ç½®æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®æ·»åŠ hbmæ–‡ä»¶ è§„åˆ™å‚è§ hibernate3.jar /org/hibernate/hibernate-configuration-3.0.dtd &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE hibernate-configuration PUBLIC &quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot; &quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;&gt; &lt;hibernate-configuration&gt; &lt;!-- ä¼šè¯è¿æ¥å·¥å‚ï¼Œå»ºç«‹æ•°æ®åº“è¿æ¥éœ€è¦SessionFactory --&gt; &lt;session-factory&gt; &lt;!-- JDBCè¿æ¥åŸºæœ¬å‚æ•° --&gt; &lt;property name=&quot;hibernate.connection.driver_class&quot;&gt;com.mysql.jdbc.Driver&lt;/property&gt; &lt;property name=&quot;hibernate.connection.url&quot;&gt;jdbc:mysql:///hibernatetest&lt;/property&gt; &lt;property name=&quot;hibernate.connection.username&quot;&gt;root&lt;/property&gt; &lt;property name=&quot;hibernate.connection.password&quot;&gt;1234&lt;/property&gt; &lt;!-- é…ç½®æ•°æ®åº“æ–¹è¨€ï¼Œä¾¿äºç”Ÿæˆä¸€äº›ä¸æ•°æ®åº“ç›¸å…³SQLæ–¹è¨€ --&gt; &lt;property name=&quot;hibernate.dialect&quot;&gt;org.hibernate.dialect.MySQL5Dialect&lt;/property&gt; &lt;!-- DDLç­–ç•¥ å¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨åˆ›å»ºæ•°æ®è¡¨ --&gt; &lt;property name=&quot;hibernate.hbm2ddl.auto&quot;&gt;update&lt;/property&gt; &lt;!-- å°†SQLè¯­å¥ è¾“å‡ºåˆ°æ§åˆ¶å° --&gt; &lt;property name=&quot;hibernate.show_sql&quot;&gt;true&lt;/property&gt; &lt;property name=&quot;hibernate.format_sql&quot;&gt;true&lt;/property&gt; &lt;!-- å¯¼å…¥æ˜ å°„çš„poç±»çš„xx.hbm.xmlæ˜ å°„æ–‡ä»¶--&gt; &lt;mapping resource=&quot;cn/itcast/domain/Customer.hbm.xml&quot;&gt;&lt;/mapping&gt; &lt;/session-factory&gt; &lt;/hibernate-configuration&gt;æ³¨æ„: é…ç½®æ–‡ä»¶å¿…é¡»æ”¾åœ¨æ ¹ç›®å½•ä¸‹ é€šå¸¸é‡‡ç”¨æ–¹å¼2æ¥é…ç½® ç¼–ç¨‹æ“ä½œä½¿ç”¨Hibernateæ¡†æ¶webå±‚çš„javabeanå«vo viewobject serviceå±‚ bo business object daoå±‚ po æŒä¹…åŒ–å¯¹è±¡poç±»éœ€è¦æœ‰ä¸ªæ— å‚æ„é€ ,get/setæ–¹æ³•,ç§æœ‰åŒ–å±æ€§,å±æ€§ä½¿ç”¨åŒ…è£…ç±»å‹,ä¸è¦ç”¨åŸºæœ¬ç±»å‹,ç±»ä¸èƒ½ä¸ºfinal(å› ä¸ºè¦ä¸ºä»–ç”Ÿæˆä»£ç†),è¿˜éœ€è¦æœ‰ä¸€ä¸ªä¸è¡¨ä¸­ä¸»é”®æ˜ å°„çš„å­—æ®µ hbmæ˜ å°„ä»‹ç» pojoæ˜¯ä¸ªå•¥? è§†é¢‘ä¸¤åˆ†é’Ÿçš„æ—¶å€™ä»‹ç»äº†ä¸‹","link":"/2016/08/08/JavaWeb%E5%9F%BA%E7%A1%80/Hibernate%E7%AC%94%E8%AE%B0%E4%B8%80/"},{"title":"MySQLç¬”è®°-SQLè¯­å¥åˆ†ç±»","text":"SQLè¯­å¥å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç±» : æ•°æ®æ“ä½œè¯­è¨€(DML) , æ•°æ®å®šä¹‰è¯­è¨€(DDL) , æ•°æ®æ§åˆ¶è¯­è¨€(DCL) , äº‹åŠ¡æ§åˆ¶è¯­è¨€(TCL). æ•°æ®å®šä¹‰è¯­è¨€(DDL : Data Definition Language)ç”¨äºå®šä¹‰SQLæ¨¡å¼,åŸºæœ¬è¡¨,è§†å›¾å’Œç´¢å¼•çš„åˆ›å»ºå’Œæ’¤æ¶ˆæ“ä½œ.ä¸»è¦åŒ…å«CREATE , ALTER , DROP , TRUNCATE , COMMENT , REPLACE(RENAME)ç­‰è¯­å¥,ä¸€èˆ¬ä¸éœ€è¦commitç­‰äº‹åŠ¡æ“ä½œ. æ•°æ®æ“ä½œè¯­è¨€(DML : Data Manipulation Language)ç”±æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(DBMS) æä¾›,ç”¨äºè®©ç”¨æˆ·æˆ–ç¨‹åºå‘˜ä½¿ç”¨ï¼Œå®ç°å¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ“ä½œ.ä¸»è¦åŒ…å«SELECT , INSERT , UPDATE , DELETE , MERGE , CALL , EXPLAIN PLAN , LOCK TABLEç­‰è¯­å¥. æ•°æ®æ§åˆ¶è¯­è¨€(DCLï¼šData Control Language)æˆæƒç”¨æˆ·æˆ–ç”¨æˆ·ç»„æ“ä½œå’Œè®¿é—®æ•°æ®çš„æƒé™.ä¸»è¦åŒ…å«GRANT , REVOKEç­‰è¯­å¥. äº‹åŠ¡æ§åˆ¶è¯­è¨€(TCLï¼šTransaction Control Language)ç”¨äºæ•°æ®åº“çš„äº‹åŠ¡ç®¡ç†,ç¡®ä¿è¢«DMLè¯­å¥å½±å“çš„è¡¨çš„æ‰€æœ‰è¡ŒåŠæ—¶å¾—ä»¥æ›´æ–°.ä¸»è¦åŒ…å«SAVEPOINT , SET TRANSACTION , BEGIN TRANSACTION , COMMIT , ROLLBACKç­‰è¯­å¥ã€‚ éå®˜æ–¹åˆ†æ³•##æ•°æ®æŸ¥è¯¢è¯­è¨€(DQL : Data Queries Language)ç”¨ä»¥ä»è¡¨ä¸­è·å¾—æ•°æ®.ä¸»è¦åŒ…å«SELECT , WHERE , GROUP BY , HAVINGå’ŒORDER BY.","link":"/2017/05/23/JavaWeb%E5%9F%BA%E7%A1%80/MySQL%E7%AC%94%E8%AE%B0-SQL%E8%AF%AD%E5%8F%A5%E5%88%86%E7%B1%BB/"},{"title":"Listener-ç›‘å¬å™¨","text":"TODO:è¿™ä¸€éƒ¨åˆ†ä¸å¤ªæ˜ç™½,éœ€è¦åé¢åœ¨å¥½å¥½çœ‹çœ‹å§","link":"/2016/07/26/JavaWeb%E5%9F%BA%E7%A1%80/Listener-%E7%9B%91%E5%90%AC%E5%99%A8/"},{"title":"IntellJåˆ›å»ºWebé¡¹ç›®","text":"ç…§ç€ä»–ä»¬çš„æ•™ç¨‹å°±è¡Œäº† http://blog.csdn.net/guyue35/article/details/50551305 http://blog.csdn.net/wo541075754/article/details/46348135 å…¶å®ç¬¬ä¸€ä¸ªæ•™ç¨‹æ¯”ä»·å¥½","link":"/2016/06/22/JavaWeb%E5%9F%BA%E7%A1%80/IntellJ%E5%88%9B%E5%BB%BAWeb%E9%A1%B9%E7%9B%AE/"},{"title":"MVCä»‹ç»&amp;ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ","text":"MVCMVCåŸºæœ¬å®šä¹‰ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ŒB/Sæ¶æ„éƒ½æ”¯æŒã€‚ä¾‹å¦‚ï¼šjavaã€.netã€phpç­‰æ€æƒ³ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†ä¸æ•°æ®æ˜¾ç¤ºç›¸åˆ†ç¦»ã€‚ Modelï¼šæ¨¡å‹ï¼Œç”¨äºå°è£…æ•°æ® Viewï¼šè§†å›¾ï¼Œç”¨äºæ˜¾ç¤ºæ•°æ® Controllerï¼šæ§åˆ¶å™¨ï¼Œç”¨äºæ§åˆ¶æ­£å¸¸æ‰§è¡Œã€‚ Webé¡¹ç›®åˆ†åŒ…ç»“æ„ é¢å‘æ¥å£ç¼–ç¨‹ ç”¨æˆ·ç®¡ç†ç³»ç»ŸåŠŸèƒ½åˆ†æ æ³¨å†Œ ç™»å½• æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· æŸ¥è¯¢è¯¦æƒ… ä¿®æ”¹ç”¨æˆ· åˆ é™¤ç”¨æˆ· æŠ€æœ¯åˆ†æ MVCä¸‰å±‚æ¶æ„ xml/dom4j servlet/jsp/javabean å¯¼å…¥éœ€è¦çš„jaråŒ…è§£æxmléœ€è¦ åŒ…ç»“æ„com.lujiahao.web.servlet webå±‚ com.lujiahao.service serviceå±‚ com.lujiahao.dao daoå±‚ com.lujiahao.domain javabean com.lujiahao.utils å·¥å…·åŒ…æ•°æ®åº“æš‚å®šä½¿ç”¨xml xmlå†…å®¹: &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;users&gt; &lt;user id=&quot;u001&quot;&gt; &lt;username&gt;jack&lt;/username&gt; &lt;password&gt;1234&lt;/password&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;age&gt;18&lt;/age&gt; &lt;/user&gt; &lt;/users&gt;JavaBeanæ•°æ®åº“å®šä¹‰å®Œæˆä¹‹åå°±å¼€å§‹ç¼–å†™JavaBean daoå±‚å®ç°éšä¾¿å†™ç‚¹æ•°æ®çš„å¢åˆ æ”¹æŸ¥åŠŸèƒ½ æ•°æ®æ ¡éªŒè¡¨å•æ ¡éªŒBean - UserFormBeanä¸€èˆ¬éƒ½æ˜¯å†™åœ¨å’ŒservletåŒçº§çš„åŒ…é‡Œé¢è¿™ç§ç±»å‹çš„beané‡Œé¢æ‰€æœ‰çš„å­—æ®µéƒ½æ˜¯å­—ç¬¦ä¸²ç”¨äºè·å¾—æµè§ˆå™¨å‘é€çš„æ•°æ®,å¹¶å¯¹æ•°æ®çš„æœ‰æ•ˆæ€§è¿›è¡Œæ ¡éªŒ æä¾›æ ¡éªŒvalidate() è®°å½•æ¯ä¸€é¡¹çš„æ ¡éªŒç»“æœ å…·ä½“ä»£ç å®ç°: public class UserFormBean { private String id; private String username; private String password; private String repassword; private String gender; private String age;// å› ä¸ºæœåŠ¡å™¨ä¼ è¿‡æ¥çš„æ•°æ®éƒ½æ˜¯stringç±»å‹çš„ public UserFormBean() {} public UserFormBean(String id, String username, String password, String repassword, String gender, String age) { this.id = id; this.username = username; this.password = password; this.repassword = repassword; this.gender = gender; this.age = age; } public String getId() { return id; } public void setId(String id) { this.id = id; } public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } public String getPassword() { return password; } public void setPassword(String password) { this.password = password; } public String getRepassword() { return repassword; } public void setRepassword(String repassword) { this.repassword = repassword; } public String getGender() { return gender; } public void setGender(String gender) { this.gender = gender; } public String getAge() { return age; } public void setAge(String age) { this.age = age; } // è®°å½•é”™è¯¯ä¿¡æ¯ key:å¯¹åº”å­—æ®µ value:æç¤ºä¿¡æ¯ private Map&lt;String,String&gt; errorMsg = new HashMap&lt;&gt;(); /** * æ ¡éªŒæ–¹æ³• */ public boolean validate() { boolean temp = true; // ç”¨æˆ·åä¸èƒ½ä¸ºç©º if (username == null || &quot;&quot;.equals(username)) { errorMsg.put(&quot;usernameMsg&quot;,&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;); temp = false; } if (password == null || &quot;&quot;.equals(password)) { errorMsg.put(&quot;passwordMsg&quot;,&quot;å¯†ç ä¸èƒ½ä¸ºç©º&quot;); temp = false; } else if (! password.equals(repassword)){ errorMsg.put(&quot;repasswordMsg&quot;,&quot;ç¡®è®¤å¯†ç å’Œå¯†ç ä¸ä¸€è‡´&quot;); temp = false; } return temp; } public Map&lt;String, String&gt; getErrorMsg() { return errorMsg; } }ä½¿ç”¨æ¥å£ä¸‰å±‚ç»“æ„æ¯ä¸€å±‚éƒ½åº”è¯¥æ˜¯æœ‰æ¥å£å’Œå…·ä½“çš„å®ç°ç±» ä½¿ç”¨Intelljé‡æ„ä»£ç  BeanUtils é€šè¿‡å°è£…çš„ç±»æ¥ç®€åŒ–å‚æ•°çš„è‡ªåŠ¨å°è£…ä½¿ç”¨äº†åå°„å’Œå†…çœ åˆå§‹ä»£ç : // 1.è·å–è¯·æ±‚å‚æ•° String id = request.getParameter(&quot;id&quot;); String username = request.getParameter(&quot;username&quot;); String password = request.getParameter(&quot;password&quot;); String repassword = request.getParameter(&quot;repassword&quot;); String gender = request.getParameter(&quot;gender&quot;); String age = request.getParameter(&quot;age&quot;); /** * æ•°æ®æ ¡éªŒ */ UserFormBean userFormBean = new UserFormBean(id,username,password,repassword,gender,age);å°è£…åçš„ä»£ç : UserFormBean userFormBean = MyBeanUtils.populate(UserFormBean.class,request.getParameterMap());BeanUtilsè¯¦ç»†ä»£ç : public class MyBeanUtils { /** * åˆ›å»ºJavaBeanå®ä¾‹,å¹¶è‡ªåŠ¨å°†å¯¹åº”çš„å‚æ•°è¿›è¡Œå°è£… * @param beanClass * @param parameterMap * @param &lt;T&gt; * @return */ public static &lt;T&gt; T populate(Class&lt;T&gt; beanClass, Map&lt;String,String[]&gt; parameterMap){ try { // 1.ä½¿ç”¨åå°„åˆ›å»ºjavabeanå®ä¾‹ T bean = beanClass.newInstance(); // 2.è·å¾—javabeanå±æ€§(property username--&gt;setUsername()--&gt;æ‰§è¡Œsetæ–¹æ³•,æ•°æ®æ¥è‡ªmap // 2.1è·å¾—æ‰€æœ‰å±æ€§--ä½¿ç”¨å†…çœ(java.beans.Introspector):jdkæä¾›å·¥å…·ç±»,ç”¨äºæ“ä½œjavabean // BeanInfo jdkæä¾›ç”¨äºå¯¹javabeanè¿›è¡Œæè¿°(å°è£…)å¯¹è±¡ BeanInfo beanInfo = Introspector.getBeanInfo(beanClass, Object.class); // 2.2 è·å¾—æ‰€æœ‰çš„å±æ€§æè¿°å¯¹è±¡ PropertyDescriptor[] allPd = beanInfo.getPropertyDescriptors(); for (PropertyDescriptor pd : allPd) { // 2.3 è·å¾—å±æ€§åç§° String propName = pd.getName(); // 2.4 è·å¾—è¡¨å•ä¸­å¯¹åº”çš„æ•°æ® String[] allValue = parameterMap.get(propName); if (allValue == null) { continue;// å½“æ²¡æœ‰å€¼çš„æ—¶å€™å°±è·³è¿‡è¿™ä¸ªå­—æ®µ } String propValue = allValue[0]; // 2.5 å¦‚æœæœ‰å€¼,å°†æ‰§è¡Œsetæ–¹æ³• if (propValue != null &amp;&amp; !&quot;&quot;.equals(propValue)) { Method writeMethod = pd.getWriteMethod();// ç›¸å½“äºsetæ–¹æ³• getReadMethod--ç›¸å½“äºgetæ–¹æ³• if (writeMethod != null) { writeMethod.invoke(bean,propValue); } } } return bean; } catch (Exception e){ throw new RuntimeException(e); } } }","link":"/2016/06/24/JavaWeb%E5%9F%BA%E7%A1%80/MVC%E4%BB%8B%E7%BB%8D&%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"},{"title":"emallå•†åŸ-SSOå•ç‚¹ç™»å½•","text":"1. å‰æœŸå‡†å¤‡ å‡†å¤‡ä¸€å°RedisæœåŠ¡å™¨ æ·»åŠ host127.0.0.1 sso.emall.com æ­å»ºemall-ssoå·¥ç¨‹å¹¶æ•´åˆå“åº”çš„æ¡†æ¶ 2. å®ç°åŸç† å•ç‚¹ç™»å½•çš„åœºæ™¯éšå¤„å¯è§,æ­¤åŠŸèƒ½æå¤§çš„ç®€åŒ–äº†ç”¨æˆ·åœ¨ç½‘ç«™é—´çš„é‡å¤ç™»å½•,ä½¿å¾—ç”¨æˆ·ä½“éªŒæ›´åŠ è‰¯å¥½.æœ¬æ•™ç¨‹å•ç‚¹ç™»å½•çš„å®ç°åŸç†:ç”¨æˆ·æ ¹æ®ç”¨æˆ·åå’Œå¯†ç ç™»å½•,æˆåŠŸåæœåŠ¡å™¨è¿”å›tokenä¿¡æ¯,å¹¶å°†tokenä¿¡æ¯å†™å…¥Rediså’ŒCookieä¸­,ç”¨æˆ·å†æ¬¡ç™»å½•æ—¶,é¦–å…ˆåˆ¤æ–­Cookieä¸­æ˜¯å¦æœ‰tokenä¿¡æ¯,å¦‚æœæœ‰åˆ™æ ¹æ®tokenå»åå°æ¢å–ç”¨æˆ·ä¿¡æ¯;å¦åˆ™æç¤ºç”¨æˆ·é‡æ–°ç™»å½•. 3. å®ç°æ­¥éª¤3.1 ç™»å½•æ¥å£/** * ç”¨æˆ·ç™»å½• */ @Override public CommonResult userLogin(UserDTO userDTO, HttpServletRequest request, HttpServletResponse response) { String username = userDTO.getUsername(); String password = userDTO.getPassword(); TbUserExample example = new TbUserExample(); TbUserExample.Criteria criteria = example.createCriteria(); criteria.andUsernameEqualTo(username); List&lt;TbUser&gt; list = tbUserMapper.selectByExample(example); // å¦‚æœæ²¡æœ‰æ­¤ç”¨æˆ·å æ²¡ç”¨ç”¨æˆ·åä¹Ÿè¿”å›è¿™ä¸ªä¿¡æ¯æ˜¯å› ä¸ºé˜²æ­¢çŒœæµ‹ç”¨æˆ·å if (list == null || list.size() == 0) { return CommonResult.build(400, &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;); } TbUser tbUser = list.get(0); // å¯¹æ¯”å¯†ç  if (!DigestUtils.md5DigestAsHex(password.getBytes()).equals(tbUser.getPassword())) { return CommonResult.build(400, &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;); } // ç”Ÿæˆtoken String token = UUID.randomUUID().toString(); // ä¿å­˜ç”¨æˆ·ä¿¡æ¯å‰å…ˆæŠŠå¯†ç æ¸…é™¤,ä¸ºäº†å®‰å…¨èµ·è§ tbUser.setPassword(null); // ç”¨æˆ·ä¿¡æ¯å­˜å…¥Redis saveUserInfoToRedis(tbUser, token); // æ·»åŠ å†™cookieçš„é€»è¾‘ cookieæœ‰æ•ˆæœŸæ˜¯å…³é—­æµè§ˆå™¨å¤±æ•ˆ CookieUtils.setCookie(request, response, COOKIE_TOKEN, token); return CommonResult.ok(token); }3.2 æ ¹æ®tokenæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯/** * æ ¹æ®tokenæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ */ @Override public CommonResult getUserByToken(String token) { // æ ¹æ®tokenä»redisä¸­æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ String json = jedisClientDao.get(REDIS_USER_SESSION_KEY + &quot;:&quot; + token); if (StringUtils.isBlank(json)) { return CommonResult.build(400, &quot;æ­¤Sessionå·²ç»è¿‡æœŸ,è¯·é‡æ–°ç™»å½•&quot;); } // æ›´æ–°è¿‡æœŸæ—¶é—´ jedisClientDao.expire(REDIS_USER_SESSION_KEY + &quot;:&quot; + token, SSO_SESSION_EXPIRE); // è¿”å›ç”¨æˆ·ä¿¡æ¯ return CommonResult.ok(JsonUtils.jsonToPojo(json, TbUser.class)); }4. è·¨åŸŸ4.1 JSONPJSONPçš„å®ç°ä¸ ajax æ²¡æœ‰ä»»ä½•å…³ç³»ï¼ŒJSONPæ˜¯é€šè¿‡scriptçš„srcå®ç°çš„ï¼Œæœ€ç»ˆéƒ½æ˜¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ•°æ®ç„¶åå›è°ƒï¼Œè€Œä¸”æ–¹ä¾¿èµ·è§ï¼ŒjqueryæŠŠ JSONP å°è£…åœ¨äº† $.ajax æ–¹æ³•ä¸­ï¼Œè°ƒç”¨æ–¹å¼ä¸ ajax è°ƒç”¨æ–¹å¼ç•¥æœ‰åŒºåˆ«ã€‚JSONPæœ¬è´¨æ˜¯:åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾ï¼Œç„¶åé€šè¿‡ä»–çš„srcå±æ€§å‘é€è·¨åŸŸè¯·æ±‚. /** * é€šè¿‡tokenæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ * * @param token * @return */ @RequestMapping(value = &quot;/token/{token}&quot;) @ResponseBody public Object getUserByToken(@PathVariable String token, String callback) { CommonResult result = null; try { result = userService.getUserByToken(token); } catch (Exception e) { e.printStackTrace(); result = CommonResult.build(500, ExceptionUtil.getStackTrace(e)); } // åˆ¤æ–­æ˜¯å¦ä¸ºjsonpè°ƒç”¨ if (StringUtils.isBlank(callback)) { // ä¸æ˜¯jsonpè°ƒç”¨ return result; } else { MappingJacksonValue mappingJacksonValue = new MappingJacksonValue(result); mappingJacksonValue.setJsonpFunction(callback); return mappingJacksonValue; } }4.2 CORSæ­¤ç§æ–¹å¼åç«¯å®ç°æœ‰ä¸¤ç§æ–¹å¼: è®©æ‰€æœ‰çš„controllerç±»ç»§æ‰¿è‡ªå®šä¹‰çš„BaseControllerç±»ï¼Œæ”¹ç±»ä¸­å°†å¯¹è¿”å›çš„å¤´éƒ¨åšäº›ç‰¹æ®Šå¤„ç†; é€šè¿‡filterå®ç°æ‰€æœ‰çš„è¯·æ±‚å°è£…è·¨åŸŸ.4.2.1 ç»§æ‰¿BaseControllerpublic abstract class BaseController { /** * description:send the ajax response back to the client side * @param responseObj * @param response */ protected void writeAjaxJSONResponse(Object responseObj, HttpServletResponse response) { response.setCharacterEncoding(&quot;UTF-8&quot;); response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache, no-store, must-revalidate&quot;); // HTTP 1.1 response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;); // HTTP 1.0 /** * for ajax-cross-domain request TODO get the ip address from * configration(ajax-cross-domain.properties) */ response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;); response.setDateHeader(&quot;Expires&quot;, 0); // Proxies. PrintWriter writer = getWriter(response); writeAjaxJSONResponse(responseObj, writer); } /** * * @param response * @return */ protected PrintWriter getWriter(HttpServletResponse response) { if(null == response){ return null; } PrintWriter writer = null; try { writer = response.getWriter(); } catch (IOException e) { logger.error(&quot;unknow exception&quot;, e); } return writer; } /** * description:send the ajax response back to the client side. * * @param responseObj * @param writer * @param writer */ protected void writeAjaxJSONResponse(Object responseObj, PrintWriter writer) { if (writer == null || responseObj == null) { return; } try { writer.write(JSON.toJSONString(responseObj,SerializerFeature.DisableCircularReferenceDetect)); } finally { writer.flush(); writer.close(); } } }4.2.2 Filterå®ç°/** * @author lujiahao * @version 1.0 * @date 2017-10-15 22:20 */ public class HeadersCORSFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletResponse response = (HttpServletResponse) servletResponse; response.setHeader(&quot;Access-Control-Allow-Origin&quot;,&quot;*&quot;); filterChain.doFilter(servletRequest, response); } @Override public void destroy() { } }web.xmlä¸­é…ç½®: &lt;!-- Ajax Access-Control-Allow-Origin è·¨åŸŸ æ‹¦æˆªå™¨è§£å†³æ–¹æ¡ˆ --&gt; &lt;filter&gt; &lt;filter-name&gt;ACAOFilter&lt;/filter-name&gt; &lt;filter-class&gt;com.lujiahao.sso.filter.HeadersCORSFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;ACAOFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt;5. ä»£ç è¯¦è§emall-sso6. å®ç°æ•ˆæœ 7. è¯´æ˜emallå•†åŸç³»åˆ—æ˜¯æ•´åˆ[æ·˜æ·˜å•†åŸ]å’Œ[æ…•è¯¾ç½‘Javaä»é›¶åˆ°ä¼ä¸šçº§ç”µå•†é¡¹ç›®å®æˆ˜]çš„ç³»åˆ—,è¿™ä¸¤éƒ¨æ•™ç¨‹æ¥è‡ªäº’è”ç½‘.","link":"/2017/10/18/JavaWeb%E5%9F%BA%E7%A1%80/emall%E5%95%86%E5%9F%8E-SSO%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/"},{"title":"Mac iTerm2 é…ç½® rz&#x2F;sz ä¸Šä¼ ä¸‹è½½åŠŸèƒ½","text":"ä½¿ç”¨macçš„åŒå­¦è¦è¿›è¡Œè¿œç¨‹æœåŠ¡å™¨æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½ï¼Œæ¨èä½¿ç”¨ sz å’Œ rz å‘½ä»¤ï¼Œä¸‹æ–‡ä¸ºiTerm2é…ç½®çš„æ–¹æ³•ã€‚ 1. å®‰è£…lrzsz1brew install lrzsz 2. ä¸‹è½½è„šæœ¬https://github.com/mmastrac/iterm2-zmodem 3. å¤åˆ¶è„šæœ¬å°†è„šæœ¬iterm2-send-zmodem.shå’Œiterm2-recv-zmodem.shå¤åˆ¶åˆ°/usr/local/bin/ç›®å½•ä¸­å³å¯ 1cp iterm2-recv-zmodem.sh iterm2-send-zmodem.sh /usr/local/bin/ 4. é…ç½® iTerm2æ‰“å¼€ iTerm2,æŒ‰âŒ˜+,æ‰“å¼€Perfencesï¼Œé€‰æ‹©Profilesæ ‡ç­¾é¡µï¼Œåœ¨Profilesæ ‡ç­¾é¡µä¸‹é€‰æ‹©Advancedæ ‡ç­¾é¡µï¼Œç¼–è¾‘Triggers Regular expression: rz waiting to receive.\\*\\*B0100 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-send-zmodem.sh Instant: checked Regular expression: \\*\\*B00000000000000 Action: Run Silent Coprocess Parameters: /usr/local/bin/iterm2-recv-zmodem.sh Instant: checkedå›¾ç¤º : 5. è¿œç¨‹æœåŠ¡å™¨å®‰è£…lrzszCentOSå®‰è£…æ–¹æ³• : yum -y install lrzsz 6. ä½¿ç”¨æ–¹æ³• æœ¬åœ°ä¸Šä¼ æ–‡ä»¶åˆ°è¿œç¨‹æœåŠ¡å™¨ ç™»å½•åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œåœ¨è¿œç«¯æœåŠ¡å™¨ä¸Šè¾“å…¥ rz ï¼Œå›è½¦ å¼¹æ¡†ä¸­é€‰æ‹©æœ¬åœ°è¦ä¸Šä¼ çš„æ–‡ä»¶ ç¡®å®šåç­‰å¾…ä¸Šä¼ å®Œæˆ è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ° åœ¨è¿œç¨‹æœåŠ¡å™¨è¾“å…¥ sz filename filename1 ... filenameN å¼¹æ¡†ä¸­é€‰æ‹©æœ¬åœ°çš„å­˜å‚¨ç›®å½• ç¡®å®šåç­‰å¾…ä¸‹è½½å®Œæˆ è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™é¡¹é»‘ç§‘æŠ€äº†ï¼ Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜ å„ä½å¤§ä½¬ç‚¹ç‚¹å¹¿å‘Šï¼Œä¸‡åˆ†æ„Ÿè°¢ï¼ï¼ï¼","link":"/2019/01/31/JavaWeb%E5%9F%BA%E7%A1%80/mac-iterm2-%E9%85%8D%E7%BD%AE%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E5%8A%9F%E8%83%BD/"},{"title":"åˆ†é¡µ","text":"å®ç°æ€è·¯ åˆ†é¡µè¯­æ³•select ..... limit å‚æ•°1,å‚æ•°2; å‚æ•°1 ï¼Œè¡¨ç¤ºå¼€å§‹ç´¢å¼•ï¼Œä»0å¼€å§‹ã€‚startIndex ï¼Œç®—æ³• (pageNum - 1) * pageSize å‚æ•°2 ï¼Œè¡¨ç¤ºæ¯é¡µæ˜¾ç¤ºä¸ªæ•°ã€‚pageSizeServletçš„å†™æ³•/** * æŸ¥è¯¢æ‰€æœ‰--åˆ†é¡µæŸ¥è¯¢ */ private void findAllWithPage(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException{ try { // 1.è·å¾—æ•°æ®å¹¶å°è£… // è·å¾—å½“å‰é¡µç  String pageNumStr = request.getParameter(&quot;pageNum&quot;); int pageNum = 1; try { // è¿™ç§å¤„ç†æ–¹å¼å¯ä»¥é˜²æ­¢åœ¨åœ°å€æ é‡Œé¢è¾“å…¥éæ•°å­—å¯¼è‡´è½¬åŒ–å¼‚å¸¸ pageNum = Integer.parseInt(pageNumStr); } catch (Exception e){ } // * æ¯é¡µæ˜¾ç¤ºä¸ªæ•°(å›ºå®šå€¼) int pageSize = 5; // 2.é€šçŸ¥serviceæŸ¥è¯¢æ‰€æœ‰ CustomerServeice customerServeice = new CustomerServiceImpl(); PageBean&lt;Customer&gt; pageBean = customerServeice.findAllCustomerWithPage(pageNum, pageSize); // 3.æ˜¾ç¤º // å­˜æ”¾åˆ°requestä½œç”¨åŸŸä¸­--æ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½æ˜¯æ–°çš„æ•°æ® request.setAttribute(&quot;pageBean&quot;,pageBean); // servletåˆ°jspä¸­æ˜¾ç¤º,ä¸€æ¬¡è¯·æ±‚éœ€è¦ä½¿ç”¨è¯·æ±‚è½¬å‘ request.getRequestDispatcher(&quot;/pages/show_all_page.jsp&quot;).forward(request,response); } catch (Exception e){ // 1.æ‰“å°æ—¥å¿— e.printStackTrace(); // 2.è¯·æ±‚è½¬å‘åˆ°æ¶ˆæ¯ç•Œé¢ request.setAttribute(&quot;msg&quot;,&quot;æŸ¥è¯¢å¤±è´¥,è¯·ç¨åé‡è¯•.&quot;); request.getRequestDispatcher(&quot;/pages/message.jsp&quot;).forward(request,response); } }Serviceå†™æ³•@Override public PageBean&lt;Customer&gt; findAllCustomerWithPage(int pageNum, int pageSize) { // ä¸€èˆ¬åˆ†é¡µçš„é€»è¾‘æ˜¯è¦åœ¨serviceé‡Œé¢æ¥å†™ // åˆ›å»ºPageBeanå°è£…åˆ†é¡µæ‰€æœ‰çš„æ•°æ®,å¹¶å°†å°è£…åçš„æ•°æ®è¿”å› // 1.æŸ¥è¯¢æ€»è®°å½•æ•° int totalRecord = customerDao.getTotalRecord(); // 2.åˆ›å»ºPageBean PageBean&lt;Customer&gt; pageBean = new PageBean&lt;&gt;(pageNum,pageSize,totalRecord); // 3.æŸ¥è¯¢ç»“æœ List&lt;Customer&gt; data = customerDao.findAll(pageBean.getStartIndex(), pageBean.getPageSize()); pageBean.setData(data); return pageBean; }Daoå†™æ³•@Override public List&lt;Customer&gt; findAll(int startIndex, int pageSize) { try { String sql = &quot;select * from t_customer limit ?,?&quot;; Object[] params = {startIndex,pageSize}; return runner.query(sql,new BeanListHandler&lt;Customer&gt;(Customer.class),params); } catch (Exception e){ throw new DaoException(e); } }JSPç•Œé¢å½“å‰${pageBean.pageNum}é¡µ,å…±${pageBean.totalPage}é¡µ,æ€»æ¡æ•°${pageBean.totalRecord}æ¡&lt;br/&gt; &lt;c:url value=&quot;${pageContext.request.contextPath}/CustomerServlet&quot; var=&quot;baseUrl&quot;&gt; &lt;c:param name=&quot;method&quot; value=&quot;findAllWithPage&quot;&gt;&lt;/c:param&gt; &lt;c:param name=&quot;pageNum&quot; value=&quot;&quot;&gt;&lt;/c:param&gt; &lt;/c:url&gt; &lt;c:if test=&quot;${pageBean.pageNum &gt; 1}&quot;&gt; &lt;a href=&quot;${baseUrl}1&quot;&gt;é¦–é¡µ&lt;/a&gt; &lt;a href=&quot;${baseUrl}${pageBean.pageNum-1}&quot;&gt;ä¸Šä¸€é¡µ&lt;/a&gt; &lt;/c:if&gt; &lt;c:forEach begin=&quot;${pageBean.start}&quot; end=&quot;${pageBean.end}&quot; var=&quot;num&quot;&gt; &lt;a href=&quot;${baseUrl}${num}&quot;&gt;${num}&lt;/a&gt; &lt;/c:forEach&gt; &lt;c:if test=&quot;${pageBean.pageNum &lt; pageBean.totalPage}&quot;&gt; &lt;a href=&quot;${baseUrl}${pageBean.pageNum+1}&quot;&gt;ä¸‹ä¸€é¡µ&lt;/a&gt; &lt;a href=&quot;${baseUrl}${pageBean.totalPage}&quot;&gt;å°¾é¡µ&lt;/a&gt; &lt;/c:if&gt;PageBeançš„å°è£…/** * åˆ†é¡µçš„å°è£…ç±» * å°è£…çš„ä¸¤ç§æ€è·¯: * -- é›†åˆMap(Androidä¸­å¸¸è§çš„è¯·æ±‚å‚æ•°çš„å°è£…) * -- è‡ªå®šä¹‰JavaBeanå¯¹è±¡ * Created by lujiahao on 2016/7/25. */ public class PageBean&lt;T&gt; { // åˆ†é¡µå¿…å¤‡é€‰é¡¹,ä¸ºä¸‹é¢è®¡ç®—æä¾›æ•°æ® private int pageNum; // å½“å‰é¡µ(ç¬¬å‡ é¡µ) private int pageSize; // æ¯é¡µæ˜¾ç¤ºä¸ªæ•° private int totalRecord; // æ€»è®°å½•æ•°(æ€»æ¡æ•°)---è¿™ä¸ªæ•°æ®éœ€è¦é€šè¿‡æŸ¥è¯¢æ¥è·å¾— // é€šè¿‡è®¡ç®—è·å¾—çš„æ•°æ® private int startIndex; // åˆ†é¡µå¼€å§‹çš„ç´¢å¼• private int totalPage; // æ€»åˆ†é¡µæ•° // åˆ†é¡µæŸ¥è¯¢çš„ç»“æœ private List&lt;T&gt; data; // æŸ¥è¯¢åˆ†é¡µçš„æ•°æ®--ä½¿ç”¨æ³›å‹çš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿å¤ç”¨ // å¯¼èˆªæ¡åŠ¨æ€æ˜¾ç¤º é¦–é¡µ ä¸Šä¸€é¡µ 1 2 3 4 ä¸‹ä¸€é¡µ å°¾é¡µ private int start; // å¾ªç¯å¼€å§‹ private int end; // å¾ªç¯ç»“æŸ public PageBean(int pageNum, int pageSize, int totalRecord) { // æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸‰ä¸ªå¿…å¤‡é€‰é¡¹ this.pageNum = pageNum; this.pageSize = pageSize; this.totalRecord = totalRecord; // å¤„ç†åœ°å€æ è¾“å…¥è´Ÿé¡µæ•° if (this.pageNum &lt; 1) { this.pageNum = 1; } // è®¡ç®—åˆ†é¡µå¼€å§‹çš„ç´¢å¼•:(å½“å‰é¡µ - 1) * æ¯é¡µæ˜¾ç¤ºä¸ªæ•° this.startIndex = (this.pageNum - 1) * this.pageSize; // è®¡ç®—æ€»åˆ†é¡µæ•° if (this.totalRecord % this.pageSize == 0){ // èƒ½æ•´é™¤,æ€»åˆ†é¡µæ•° = æ€»è®°å½•æ•° / æ¯é¡µæ˜¾ç¤ºä¸ªæ•° this.totalPage = this.totalRecord / this.pageSize; } else { // ä¸èƒ½æ•´é™¤,éœ€è¦åŠ ä¸€é¡µç”¨æ¥å­˜ä¸å¤Ÿä¸€é¡µçš„æ•°æ® this.totalPage = this.totalRecord / this.pageSize + 1; } // ä¸Šé¢çš„å¿«æ·ç®—æ³•---æš‚æ—¶ç†è§£ä¸äº†å•Š //this.totalPage = (this.totalRecord + (this.pageSize - 1)) / this.pageSize; // å¯¼èˆªæ¡åŠ¨æ€æ˜¾ç¤º é»˜è®¤æ˜¾ç¤º10é¡µ this.start = 1; this.end = 10; // æ€»é¡µæ•°ä¸å¤Ÿ10é¡µ if (this.totalPage &lt;= 10){ this.end = this.totalPage; } else { // æ€»é¡µæ•°å¤§äº10é¡µ // é¡µæ•°è¦æ±‚ å‰äº”åå›› this.start = this.pageNum -5; this.end = this.pageNum +4; // å½“pageNum=1æ—¶,å…¶å®é¡µæ•°è‡³å°‘æ˜¯1 if (this.start &lt; 1){ this.start = 1; this.end = 10; } // å½“pageNumåˆ°æœ€åä¸€é¡µäº‹ if (this.end &gt; this.totalPage){ this.end = this.totalPage; this.start = this.totalPage -9; // 9 = 5 + 4 } } } ...get/set }æ³¨æ„ç‚¹å®¹é”™çš„å¤„ç†éå¸¸å·§å¦™:è¿™æ˜¯åœ¨Servletä¸­çš„å¤„ç†æ–¹å¼ String pageNumStr = request.getParameter(&quot;pageNum&quot;); int pageNum = 1; try { // è¿™ç§å¤„ç†æ–¹å¼å¯ä»¥é˜²æ­¢åœ¨åœ°å€æ é‡Œé¢è¾“å…¥éæ•°å­—å¯¼è‡´è½¬åŒ–å¼‚å¸¸ pageNum = Integer.parseInt(pageNumStr); } catch (Exception e){ }è¿™æ˜¯åœ¨PageBeanä¸­çš„å¤„ç†æ–¹å¼ // å¤„ç†åœ°å€æ è¾“å…¥è´Ÿé¡µæ•° if (this.pageNum &lt; 1) { this.pageNum = 1; }","link":"/2016/07/25/JavaWeb%E5%9F%BA%E7%A1%80/%E5%88%86%E9%A1%B5/"},{"title":"æ—¥å¿—è§„èŒƒ(ä¸€)","text":"æ—¥å¿—è§„èŒƒ(ä¸€) è®°å½•åœ¨é¦–çº¦çš„å·¥ä½œä¸­é‡åˆ°çš„æ—¥å¿—éœ€è¦è§„èŒƒçš„åœ°æ–¹,æ„Ÿè°¢é‘«å“¥æ•™æˆ‘è¿™ä¹ˆå¤šè§„èŒƒ. 1. å…¨å±€æŸ¥æ‰¾æ ‡è¯†å®Œæ•´çš„æ—¥å¿—æ˜¯å¯ä»¥é€šè¿‡æ—¥å¿—çœ‹åˆ°æ•´ä¸ªä»£ç çš„æµç¨‹.è¿™å°±éœ€è¦ä¸€ä¸ªå…¨å±€æŸ¥æ‰¾çš„æ ‡è¯†,å½“æˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ ‡è¯†æœç´¢æ—¥å¿—æ—¶,å¯ä»¥å°†ä»£ç æ‰§è¡Œçš„æµç¨‹æ¢³ç†å‡ºæ¥,ç”±æ­¤å¯ä»¥å¿«é€Ÿå®šä½å‡ºé—®é¢˜,åŠæ—¶ä¿®å¤bug. eg : æœ€å¸¸è§çš„å°±æ˜¯è®¢å•å·ä¹‹ç±» 1LOGGER.info(\"æ ¹æ®è®¢å•å·æŸ¥è¯¢ä¼˜æƒ åˆ¸id orderNo:{} response:{}\", orderNo, response); 2. Httpè¯·æ±‚ è°ƒç”¨Httpè¯·æ±‚æ—¶å°†è°ƒç”¨çš„urlå’Œå‚æ•°è¾“å‡ºå‡ºæ¥,è¿™æ ·å¯ä»¥é¿å…ç”±äºæ¥å£æˆ–å‚æ•°é…ç½®é”™è¯¯å¯¼è‡´æ— æ³•è”è°ƒæˆåŠŸ. åŒæ—¶æ¥å£çš„è¿”å›å€¼ä¹Ÿè¦æ‰“è¾“å‡ºå‡ºæ¥,è¿™æ ·å¯ä»¥é¿å…æ¥å£è¿”å›å€¼æ ¼å¼é”™è¯¯å¯¼è‡´çš„å¼‚å¸¸. è°ƒç”¨æ¥å£çš„å“åº”æ—¶é—´ä¹Ÿè¦è¾“å‡º,è°ƒç”¨æ¥å£çš„å“åº”æ—¶é—´å¤§å¤§å½±å“äº†è‡ªèº«æ¥å£çš„æ€§èƒ½,å› æ­¤è¾“å‡ºæ¥å£å“åº”æ—¶é—´æ˜¯éå¸¸å¿…è¦çš„. 1234567891011121314151617181920212223242526272829303132public void cancelOrderFee(Order order) { long startTime = System.currentTimeMillis(); String orderNo = order.getOrderNo(); try { Map&lt;String, Object&gt; paramMap = new HashMap&lt;&gt;(); paramMap.put(\"customerId\", order.getBookingUserId()); paramMap.put(\"phone\", order.getBookingUserPhone()); paramMap.put(\"orderNo\", orderNo); LOGGER.info(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹ orderNo:{} url:{} param:{}\", orderNo, REFUND_CANCELORDER_FEE_URL, paramMap); String response = HttpUtil.getIntance().post(REFUND_CANCELORDER_FEE_URL, paramMap); LOGGER.info(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹ orderNo:{} æ¥å£å“åº”:{}\", orderNo, response); if (StringUtils.isNotBlank(response)) { ResponseResult responseResult = JsonUtils.fromJson(response, ResponseResult.class); if (ResponseResult.SUCCESS_CODE == responseResult.getCode()) { int data = (int) responseResult.getData(); if (0 == data) { LOGGER.info(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹[æˆåŠŸ] orderNo:{}\", orderNo); } else { LOGGER.error(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹[å¤±è´¥] orderNo:{} å¤±è´¥åŸå› :{}\", orderNo, responseResult.getMsg()); } } else { LOGGER.error(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹[å¤±è´¥] orderNo:{} æ¥å£è°ƒç”¨å¤±è´¥ å¤±è´¥åŸå› :{}\", orderNo, responseResult.getMsg()); } } else { LOGGER.error(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹[å¤±è´¥] orderNo:{} æ¥å£è¿”å›å€¼é”™è¯¯ response:{}\", orderNo, response); } } catch (Exception e) { LOGGER.error(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹[å¼‚å¸¸] orderNo:{} å¼‚å¸¸ä¿¡æ¯:\", orderNo, e); } finally { LOGGER.info(\"é€€è¿˜æŒ‡å®šå¸æœºè´¹ orderNo:{} æ¥å£è€—æ—¶:{}ms\", orderNo, System.currentTimeMillis() - startTime); }} 3. æŸ¥è¯¢ç»“æœæ•°ç»„æˆ–é›†åˆè¾“å‡ºä¸ªæ•°1234567891011121314151617List&lt;OrderTasks&gt; unArrivedOrders = orderTaskService.getUnArrivedOrders();if (unArrivedOrders != null &amp;&amp; unArrivedOrders.size() &gt; 0) { LOGGER.info(\"å®šæ—¶ä»»åŠ¡-è®¢å•è‡ªåŠ¨å–æ¶ˆé€»è¾‘ listSize:\" + unArrivedOrders.size() + \" threadId:\" + threadId); for (OrderTasks orderTasks : unArrivedOrders) { try { CarFactOrderMongo order = carFactOrderSlaveMapper.selectVOByOrderNo(orderTasks.getOrderNo()); if (order != null &amp;&amp; StringUtils.isNotBlank(order.getRiderPhone()) &amp;&amp; orderTaskService.validCityAndServiceType(order)) { LOGGER.info(\"å®šæ—¶ä»»åŠ¡-è®¢å•è‡ªåŠ¨å–æ¶ˆé€»è¾‘-å°†è¦æ‰§è¡Œå–æ¶ˆ orderNo:\" + order.getOrderNo() + \" threadId:\" + threadId); orderTaskService.cancelOrder(order, orderTasks.getNotArraiveCancelPeriod()); } else { LOGGER.info(\"å®šæ—¶ä»»åŠ¡-è®¢å•è‡ªåŠ¨å–æ¶ˆé€»è¾‘-æ¡ä»¶ä¸æ»¡è¶³ orderNo:\" + order.getOrderNo()); } } catch (Exception e) { LOGGER.error(\"å®šæ—¶ä»»åŠ¡-è®¢å•è‡ªåŠ¨å–æ¶ˆé€»è¾‘-å¼‚å¸¸ orderNo:\" + orderTasks.getOrderNo() + \" threadId:\" + threadId, e); } }} 4. å®šæ—¶ä»»åŠ¡éœ€è¦æ‰“å°çº¿ç¨‹Id12long threadId = Thread.currentThread().getId();LOGGER.info(\"å®šæ—¶ä»»åŠ¡-è®¢å•è‡ªåŠ¨å–æ¶ˆé€»è¾‘-job start threadId:{}\", threadId);","link":"/2017/11/14/JavaWeb%E5%9F%BA%E7%A1%80/%E6%97%A5%E5%BF%97%E8%A7%84%E8%8C%83-%E4%B8%80/"},{"title":"emallå•†åŸ-é¢å‘æ¥å£ç¼–ç¨‹å®è·µ","text":"1. é¢å‘æ¥å£ç¼–ç¨‹åœ¨ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿçš„å„ç§åŠŸèƒ½æ˜¯ç”±è®¸è®¸å¤šå¤šçš„ä¸åŒå¯¹è±¡åä½œå®Œæˆçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ å„ä¸ªå¯¹è±¡å†…éƒ¨æ˜¯å¦‚ä½•å®ç°è‡ªå·±çš„,å¯¹ç³»ç»Ÿè®¾è®¡äººå‘˜æ¥è®²å°±ä¸é‚£ä¹ˆé‡è¦äº†ï¼›è€Œå„ä¸ªå¯¹è±¡ä¹‹é—´çš„åä½œå…³ ç³»åˆ™æˆä¸ºç³»ç»Ÿè®¾è®¡çš„å…³é”®ã€‚å°åˆ°ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¤§åˆ°å„æ¨¡å—ä¹‹é—´çš„äº¤äº’ï¼Œåœ¨ç³»ç»Ÿè®¾è®¡ä¹‹åˆéƒ½ æ˜¯è¦ç€é‡è€ƒè™‘çš„ï¼Œè¿™ä¹Ÿæ˜¯ç³»ç»Ÿè®¾è®¡çš„ä¸»è¦å·¥ä½œå†…å®¹ã€‚é¢å‘æ¥å£ç¼–ç¨‹å°±æ˜¯æŒ‡æŒ‰ç…§è¿™ç§æ€æƒ³æ¥ç¼–ç¨‹ã€‚ä¸Šè¿°å†…å®¹æ¥è‡ªç™¾åº¦ç™¾ç§‘(è¯´å®è¯æˆ‘æ²¡çœ‹æ‡‚). 2. éœ€æ±‚emallå•†åŸä¸­æœ‰ç”¨æˆ·ç™»å½•åéœ€è¦å°†ç”¨æˆ·çš„tokenä¿¡æ¯åœ¨æœåŠ¡ç«¯ä¿å­˜ä¸€ä»½,å®ç°è¿™ä¸ªåŠŸèƒ½æœ‰ä¸¤ä¸ªæ€è·¯: Redis Guavaçš„LoadingCache æ­¤å¤„å°±éœ€è¦å°†å­˜å‚¨tokençš„è¿™ä¸€é€»è¾‘æŠ½è±¡æˆæ¥å£,ä¸¤ç§æ–¹å¼åˆ†åˆ«å®ç°æ­¤æ¥å£,ä»è€Œè¾¾åˆ°ä¸šåŠ¡é€»è¾‘ä¸åº•å±‚å®ç°åˆ†ç¦». 3. å®ç°3.1 æŠ½è±¡ILocalCacheæ¥å£1234567891011121314151617181920212223242526272829/** * æœ¬åœ°ç¼“å­˜ * @author lujiahao * @version 1.0 * @date 2017-10-20 17:24 */public interface ILocalCache&lt;T&gt; { /** * è®¾ç½®ç¼“å­˜ * @param key * @param value * @return */ boolean setCache(String key, T value); /** * åˆ é™¤ç¼“å­˜ * @param key * @return */ boolean cleanCache(String key); /** * è·å–ç¼“å­˜ * @param key * @return */ Object getCache(String key);} 3.2 Rediså®ç°æ–¹å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354/** * Rediså®ç°ç¼“å­˜ * @author lujiahao * @version 1.0 * @date 2017-10-20 17:33 */public class RedisCacheImpl&lt;T&gt; implements ILocalCache&lt;T&gt; { public static final Logger LOGGER = LoggerFactory.getLogger(RedisCacheImpl.class); @Autowired private JedisClientDao jedisClientDao; @Override public boolean setCache(String key, T value) { // æŠŠç”¨æˆ·ä¿¡æ¯å†™å…¥redis jedisClientDao.set(Const.CACHE_TOKEN + \":\" + key, JsonUtils.objectToJson(value)); // è®¾ç½®sessionè¿‡æœŸæ—¶é—´ jedisClientDao.expire(Const.CACHE_TOKEN + \":\" + key, Const.CACHE_TOKEN_EXPIRE); return true; } @Override public boolean cleanCache(String key) { try { // æ ¹æ®tokenä»redisä¸­æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ String json = jedisClientDao.get(Const.CACHE_TOKEN + \":\" + key); if (StringUtils.isNoneBlank(json)) { // æ›´æ–°è¿‡æœŸæ—¶é—´--æ¸…é™¤key jedisClientDao.expire(Const.CACHE_TOKEN + \":\" + key, 0); } return true; } catch (Exception e) { return false; } } @Override public Object getCache(String key) { try { // æ ¹æ®tokenä»redisä¸­æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ String json = jedisClientDao.get(Const.CACHE_TOKEN + \":\" + key); if (StringUtils.isBlank(json)) { return ServerResponse.build(400, \"æ­¤Sessionå·²ç»è¿‡æœŸ,è¯·é‡æ–°ç™»å½•\"); } // æ›´æ–°è¿‡æœŸæ—¶é—´ jedisClientDao.expire(Const.CACHE_TOKEN + \":\" + key, Const.CACHE_TOKEN_EXPIRE); // è¿”å›ç”¨æˆ·ä¿¡æ¯ EmallUser emallUser = JsonUtils.jsonToPojo(json, EmallUser.class); return ServerResponse.success(emallUser); } catch (Exception e) { return ServerResponse.error(\"æ— æ³•è·å–ç”¨æˆ·ä¿¡æ¯\"); } }} 3.3 Guavaçš„LoadingCacheå®ç°æ–¹å¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/** * Guavaå®ç°ç¼“å­˜ * @author lujiahao * @version 1.0 * @date 2017-10-20 17:33 */public class GuavaCacheImpl&lt;T&gt; implements ILocalCache&lt;T&gt; { public static final Logger LOGGER = LoggerFactory.getLogger(GuavaCacheImpl.class); // LRUç®—æ³• private static LoadingCache&lt;String, Object&gt; localCache = CacheBuilder.newBuilder().initialCapacity(1000) .maximumSize(10000).expireAfterAccess(12, TimeUnit.HOURS) .build(new CacheLoader&lt;String, Object&gt;() { // é»˜è®¤çš„æ•°æ®åŠ è½½å®ç°,å½“è°ƒç”¨getå–å€¼æ˜¯,å¦‚æœæ²¡æœ‰key,å°±æ‰§è¡Œè¿™ä¸ªæ–¹æ³• @Override public Object load(String s) throws Exception { return null; } }); @Override public boolean setCache(String key, T value) { try { localCache.put(key, value); } catch (Exception e) { return false; } return true; } @Override public boolean cleanCache(String key) { try { localCache.invalidate(key); } catch (Exception e) { return false; } return true; } @Override public Object getCache(String key) { try { return localCache.get(key); } catch (Exception e) { LOGGER.error(\"========== localCache get error ==========\", e); } return null; }} 3.4 applicationContext.xmlä¸­é…ç½®123&lt;!--æ ¹æ®å…·ä½“å®ç°é‡‡ç”¨ç¼“å­˜å®ç°æ–¹å¼--&gt;&lt;!--&lt;bean class=\"com.lujiahao.sso.utils.cache.RedisCacheImpl\"/&gt;--&gt;&lt;bean class=\"com.lujiahao.sso.utils.cache.GuavaCacheImpl\"/&gt; 3.5 ä»£ç ä¸­ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536@Servicepublic class IUserServiceImpl implements IUserService { private static final Logger LOGGER = LoggerFactory.getLogger(IUserServiceImpl.class); @Autowired private EmallUserMapper emallUserMapper; @Autowired private ILocalCache iLocalCache; @Override public ServerResponse userLogin(String username, String password) { try { String md5Password = DigestUtils.md5DigestAsHex(password.getBytes()); EmallUser emallUser = emallUserMapper.userLogin(username, md5Password); if (emallUser == null) { // ä¸èƒ½è¿”å›æ²¡æœ‰æ­¤ç”¨æˆ·å æ²¡ç”¨ç”¨æˆ·åä¹Ÿè¿”å›è¿™ä¸ªä¿¡æ¯æ˜¯å› ä¸ºé˜²æ­¢çŒœæµ‹ç”¨æˆ·å return ServerResponse.error(\"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\"); } // ä¿å­˜ç”¨æˆ·ä¿¡æ¯å‰å…ˆæŠŠå¯†ç æ¸…é™¤,ä¸ºäº†å®‰å…¨èµ·è§ emallUser.setPassword(StringUtils.EMPTY); String token = UUID.randomUUID().toString(); // è¿™é‡Œé‡‡ç”¨æ¥å£ç¼–ç¨‹çš„æ–¹å¼,åˆ°åº•ç”¨redisè¿˜æ˜¯ç”¨guava boolean isSaveSuccess = iLocalCache.setCache(token, emallUser); if (isSaveSuccess) { return ServerResponse.success(token); } else { LOGGER.info(\"========== ç”¨æˆ·ä¿¡æ¯ä¿å­˜ç¼“å­˜å¤±è´¥ ==========\"); return ServerResponse.error(\"ç™»å½•å¤±è´¥,è¯·é‡è¯•!\"); } } catch (Exception e) { ExceptionUtil.getStackTrace(e); return ServerResponse.error(\"æœåŠ¡å™¨å¼‚å¸¸\"); } }} åœ¨ä»£ç ä¸­ä½¿ç”¨çš„æ—¶å€™,å°†æ¥å£ILocalCacheæ³¨å…¥,åœ¨applicationContex.xmlä¸­æ ¹æ®å…·ä½“è¦æ±‚é…ç½®ä¸åŒçš„bean,ç”±æ­¤å°±å¯ä»¥å®ç°å°†ç¼“å­˜ä¸šåŠ¡ä¸ç¼“å­˜å®ç°è§£è€¦. 4. æ€»ç»“æˆ‘ç†è§£çš„é¢å‘æ¥å£ç¼–ç¨‹å°±æ˜¯å°†ä¸šåŠ¡ä¸­çš„éœ€æ±‚æŠ½å–å‡ºå…¬å…±çš„å‡ ç§æ–¹å¼æˆ–æ­¥éª¤,åº•å±‚ç”±ä¸åŒçš„ç±»æ¥å®ç°è¿™ä¸ªæ¥å£,ç”±æ­¤è¾¾åˆ°è§£è€¦çš„ç›®çš„.ä¸ªäººç†è§£,æ¬¢è¿å¤§å®¶æ‹ç –^_^.","link":"/2017/10/22/JavaWeb%E5%9F%BA%E7%A1%80/emall%E5%95%86%E5%9F%8E-%E9%9D%A2%E5%90%91%E6%8E%A5%E5%8F%A3%E7%BC%96%E7%A8%8B%E5%AE%9E%E8%B7%B5/"},{"title":"æ·˜æ·˜å•†åŸ-Nginx+FTPæ­å»ºå›¾ç‰‡æœåŠ¡å™¨","text":"Nginxå‚çœ‹[æ·˜æ·˜å•†åŸ-Nginxç¬”è®°] FTPé…ç½®http://blog.sina.com.cn/s/blog_a97c78020101o8fv.html å‚çœ‹[æ·˜æ·˜å•†åŸ-æ­å»ºFTPæœåŠ¡å™¨] æ•´åˆNginxå’ŒFTP1.ç”¨æˆ·ç™»å½•ftpçš„æ ¹ç›®å½•vi /etc/vsftpd/vsftpd.confæ·»åŠ å¦‚ä¸‹å†…å®¹ # ç”¨æˆ·ç™»å½•è·¯å¾„ local_root=/home/ # é”å®šç”¨æˆ·åˆ°å„è‡ªç›®å½•ä¸ºå…¶æ ¹ç›®å½• chroot_local_user=YES # ç”¨æˆ·é…ç½®ç›®å½• user_config_dir=/etc/vsftpd/userconfigåˆ›å»º/etc/vsftpd/userconfig mkdir userconfig cd userconfig/é…ç½®å„è‡ªç”¨æˆ·è®¿é—®æ ¹ç›®å½• vim ftpuseræ·»åŠ  local_root=/home/ftpuser/www/é‡å¯æœåŠ¡ /etc/init.d/vsftpd restart2.é…ç½®nginx rootè·¯å¾„ä¸ºftpè·¯å¾„é…ç½®Nginxä¸»ç›®å½• vi /usr/local/nginx/conf/nginx.confä¿®æ”¹å†…å®¹ server { listen 80; server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / { root /home/ftpuser/www/; index index.html index.htm; }æ­¤æ—¶: Nginxä¸»ç›®å½•:/home/ftpuser/www/ Vsftpd.config : local_root=/home/ Userconfig/ftpuser : local_root=/home/ftpuser/www/ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰rootè·¯å¾„ï¼Œå¦‚æœæƒé™ä¸å¤Ÿï¼Œåœ¨è®¿é—®å›¾ç‰‡çš„æ—¶å€™å¯èƒ½ä¼šæŠ¥403é”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨nginx.conf é‡Œé…ç½®user root æ·»åŠ å¦‚ä¸‹å†…å®¹ æ­¤æ—¶ä¸Šä¼ çš„æ ¹ç›®å½•å˜æˆäº† : /imagesèµ„æºçš„è®¿é—®url : http://192.168.2.11/images/a.jpg æ‚é¡¹å®¢æˆ·ç«¯è¿æ¥FTPæœåŠ¡å™¨: CentOSä½¿ç”¨å‘½ä»¤è¡Œå¯åŠ¨æ‰“å¼€/etc/inittab æ–‡ä»¶ vi /etc/inittabåœ¨é»˜è®¤çš„ run level è®¾ç½®ä¸­,å¯ä»¥çœ‹åˆ°ç¬¬ä¸€è¡Œä¹¦å†™å¦‚:id:5:initdefault:(é»˜è®¤çš„ run level ç­‰çº§ä¸º 5,å³å›¾å½¢ç•Œé¢) å°†ç¬¬ä¸€è¡Œçš„ 5 ä¿®æ”¹ä¸º 3 å³å¯ã€‚ä¿å­˜æ–‡ä»¶åé‡å¯ç³»ç»Ÿä½ å°±å¯ä»¥çœ‹è§æ˜¯å¯åŠ¨çš„æ–‡æœ¬ç•Œé¢äº†ã€‚","link":"/2016/11/02/JavaWeb%E5%9F%BA%E7%A1%80/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E-Nginx+FTP%E6%90%AD%E5%BB%BA%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"title":"æ·˜æ·˜å•†åŸ-Nginxç¬”è®°","text":"Nginx1.ä»‹ç»Nginx(â€œengine xâ€)æ˜¯ä¸€æ¬¾æ˜¯ç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆIgor Sysoevæ‰€å¼€å‘é«˜æ€§èƒ½çš„ Webå’Œ åå‘ä»£ç† æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª IMAP/POP3/SMTP ä»£ç†æœåŠ¡å™¨ã€‚åœ¨é«˜è¿æ¥å¹¶å‘çš„æƒ…å†µä¸‹ï¼ŒNginxæ˜¯ApacheæœåŠ¡å™¨ä¸é”™çš„æ›¿ä»£å“ã€‚ 2.å®‰è£…Nginx2.1 å®‰è£…ç¯å¢ƒé…ç½®Nginxçš„å®‰è£…ç¯å¢ƒ: yum install gcc-c++ yum install -y pcre pcre-devel yum install -y zlib zlib-devel yum install -y openssl openssl-devel2.2 å®‰è£…Nginxä¸‹è½½nginx wget http://nginx.org/download/nginx-1.8.0.tar.gzè§£å‹ tar -zxvf nginx-1.8.0.tar.gzè¿›å…¥ç›®å½• cd nginx-1.8.0é…ç½®configure ./configure \\ --prefix=/usr/local/nginx \\ --pid-path=/var/run/nginx/nginx.pid \\ --lock-path=/var/lock/nginx.lock \\ --error-log-path=/var/log/nginx/error.log \\ --http-log-path=/var/log/nginx/access.log \\ --with-http_gzip_static_module \\ --http-client-body-temp-path=/var/temp/nginx/client \\ --http-proxy-temp-path=/var/temp/nginx/proxy \\ --http-fastcgi-temp-path=/var/temp/nginx/fastcgi \\ --http-uwsgi-temp-path=/var/temp/nginx/uwsgi \\ --http-scgi-temp-path=/var/temp/nginx/scgiæ³¨æ„ï¼šä¸Šè¾¹å°†ä¸´æ—¶æ–‡ä»¶ç›®å½•æŒ‡å®šä¸º/var/temp/nginxï¼Œéœ€è¦åœ¨/varä¸‹åˆ›å»ºtempåŠnginxç›®å½• ç¼–è¯‘ç”ŸæˆMakefile makeå®‰è£… make installnginxå®‰è£…æˆåŠŸæˆªå›¾ 3.Nginxå¸¸ç”¨å‘½ä»¤3.1 å¯åŠ¨Nginxcd /usr/local/nginx/sbin/ ./nginx æŸ¥è¯¢nginxè¿›ç¨‹ï¼š 4780æ˜¯nginxä¸»è¿›ç¨‹çš„è¿›ç¨‹idï¼Œ4781æ˜¯nginxå·¥ä½œè¿›ç¨‹çš„è¿›ç¨‹id æ³¨æ„ï¼šæ‰§è¡Œ./nginxå¯åŠ¨nginxï¼Œè¿™é‡Œå¯ä»¥-cæŒ‡å®šåŠ è½½çš„nginxé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š./nginx -c /usr/local/nginx/conf/nginx.confå¦‚æœä¸æŒ‡å®š-cï¼Œnginxåœ¨å¯åŠ¨æ—¶é»˜è®¤åŠ è½½conf/nginx.confæ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶çš„åœ°å€ä¹Ÿå¯ä»¥åœ¨ç¼–è¯‘å®‰è£…nginxæ—¶æŒ‡å®š./configureçš„å‚æ•°ï¼ˆâ€“conf-path= æŒ‡å‘é…ç½®æ–‡ä»¶ï¼ˆnginx.confï¼‰ï¼‰ 3.2 åœæ­¢nginxæ–¹å¼1 : å¿«é€Ÿåœæ­¢ cd /usr/local/nginx/sbin ./nginx -s stopæ­¤æ–¹å¼ç›¸å½“äºå…ˆæŸ¥å‡ºnginxè¿›ç¨‹idå†ä½¿ç”¨killå‘½ä»¤å¼ºåˆ¶æ€æ‰è¿›ç¨‹ã€‚æ–¹å¼2 : å®Œæ•´åœæ­¢(å»ºè®®ä½¿ç”¨)ï¼š cd /usr/local/nginx/sbin ./nginx -s quitæ­¤æ–¹å¼åœæ­¢æ­¥éª¤æ˜¯å¾…nginxè¿›ç¨‹å¤„ç†ä»»åŠ¡å®Œæ¯•è¿›è¡Œåœæ­¢ã€‚ 3.3 é‡å¯nginxæ–¹å¼1 : å…ˆåœæ­¢å†å¯åŠ¨ï¼ˆå»ºè®®ä½¿ç”¨ï¼‰å¯¹nginxè¿›è¡Œé‡å¯ç›¸å½“äºå…ˆåœæ­¢nginxå†å¯åŠ¨nginxï¼Œå³å…ˆæ‰§è¡Œåœæ­¢å‘½ä»¤å†æ‰§è¡Œå¯åŠ¨å‘½ä»¤ã€‚ ./nginx -s quit ./nginxæ–¹å¼2 : é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶å½“nginxçš„é…ç½®æ–‡ä»¶nginx.confä¿®æ”¹åï¼Œè¦æƒ³è®©é…ç½®ç”Ÿæ•ˆéœ€è¦é‡å¯nginxï¼Œä½¿ç”¨-s reloadä¸ç”¨å…ˆåœæ­¢nginxå†å¯åŠ¨nginxå³å¯å°†é…ç½®ä¿¡æ¯åœ¨nginxä¸­ç”Ÿæ•ˆ ./nginx -s reloadNginxæ— æ³•ç«™å¤–è®¿é—®ï¼Ÿ è¿™æ˜¯ä¸€ä¸ªå¾ˆå°´å°¬çš„åœºé¢,ä¼ æ™ºçš„æ•™ç¨‹é‡Œé¢æ²¡æœ‰æåˆ°è¿™ä¸€éƒ¨åˆ†å†…å®¹.æ­¤éƒ¨åˆ†å†…å®¹æ¥è‡ªäº’è”ç½‘å’Œæˆ‘è‡ªå·±çš„å®è·µ. åˆšå®‰è£…å¥½nginxä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯æ— æ³•ç«™å¤–è®¿é—®ï¼Œæœ¬æœºwgetã€telnetéƒ½æ­£å¸¸ã€‚è€ŒæœåŠ¡å™¨ä¹‹å¤–ï¼Œä¸ç®¡æ˜¯å±€åŸŸç½‘çš„å…¶å®ƒä¸»æœºè¿˜æ˜¯äº’è”ç½‘çš„ä¸»æœºéƒ½æ— æ³•è®¿é—®ç«™ç‚¹ã€‚å¦‚æœç”¨telnetçš„è¯ï¼Œæç¤ºï¼šæ­£åœ¨è¿æ¥åˆ°192.168.0.xxxâ€¦ä¸èƒ½æ‰“å¼€åˆ°ä¸»æœºçš„è¿æ¥ï¼Œ åœ¨ç«¯å£ 80: è¿æ¥å¤±è´¥CentOSé˜²ç«å¢™åœ¨è™šæ‹Ÿæœºçš„CENTOSè£…å¥½APACHEä¸èƒ½ç”¨,éƒé—·,è§£å†³æ–¹æ³•å¦‚ä¸‹ /sbin/iptables -I INPUT -p tcp --dport 80 -j ACCEPT /sbin/iptables -I INPUT -p tcp --dport 22 -j ACCEPT å¦‚æœè¿˜æ— æ³•è®¿é—®ï¼Œåˆ™éœ€é…ç½®ä¸€ä¸‹Linuxé˜²ç«å¢™: iptables -I INPUT 5 -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPTç„¶åä¿å­˜ï¼š /etc/rc.d/init.d/iptables save centos 5.3ï¼Œ5.4ä»¥ä¸Šçš„ç‰ˆæœ¬éœ€è¦ç”¨ service iptables save æ¥å®ç°ä¿å­˜åˆ°é…ç½®æ–‡ä»¶ã€‚ è¿™æ ·é‡å¯è®¡ç®—æœºå,CentOSé˜²ç«å¢™é»˜è®¤å·²ç»å¼€æ”¾äº†80å’Œ22ç«¯å£ã€‚è¿™é‡Œåº”è¯¥ä¹Ÿå¯ä»¥ä¸é‡å¯è®¡ç®—æœºï¼š /etc/init.d/iptables restart CentOSé˜²ç«å¢™çš„å…³é—­ï¼Œå…³é—­å…¶æœåŠ¡å³å¯ï¼š æŸ¥çœ‹CentOSé˜²ç«å¢™ä¿¡æ¯ï¼š/etc/init.d/iptables status å…³é—­CentOSé˜²ç«å¢™æœåŠ¡ï¼š/etc/init.d/iptables stop æ°¸ä¹…å…³é—­ï¼Ÿä¸çŸ¥é“æ€ä¹ˆä¸ªæ°¸ä¹…æ³•ï¼š chkconfig â€“level 35 iptables offã€‚ å†æ¬¡è®¿é—®å³å¯ä½¿ç”¨ 4.å¼€æœºè‡ªå¯åŠ¨nginx4.1 ç¼–å†™shellè„šæœ¬è¿™é‡Œä½¿ç”¨çš„æ˜¯ç¼–å†™shellè„šæœ¬çš„æ–¹å¼æ¥å¤„ç† vi /etc/init.d/nginxè¾“å…¥ä¸‹é¢çš„ä»£ç  #!/bin/bash # nginx Startup script for the Nginx HTTP Server # it is v.0.0.2 version. # chkconfig: - 85 15 # description: Nginx is a high-performance web and proxy server. # It has a lot of features, but it&apos;s not for everyone. # processname: nginx # pidfile: /var/run/nginx.pid # config: /usr/local/nginx/conf/nginx.conf nginxd=/usr/local/nginx/sbin/nginx nginx_config=/usr/local/nginx/conf/nginx.conf nginx_pid=/var/run/nginx.pid RETVAL=0 prog=&quot;nginx&quot; # Source function library. . /etc/rc.d/init.d/functions # Source networking configuration. . /etc/sysconfig/network # Check that networking is up. [ ${NETWORKING} = &quot;no&quot; ] &amp;&amp; exit 0 [ -x $nginxd ] || exit 0 # Start nginx daemons functions. start() { if [ -e $nginx_pid ];then echo &quot;nginx already running....&quot; exit 1 fi echo -n $&quot;Starting $prog: &quot; daemon $nginxd -c ${nginx_config} RETVAL=$? echo [ $RETVAL = 0 ] &amp;&amp; touch /var/lock/subsys/nginx return $RETVAL } # Stop nginx daemons functions. stop() { echo -n $&quot;Stopping $prog: &quot; killproc $nginxd RETVAL=$? echo [ $RETVAL = 0 ] &amp;&amp; rm -f /var/lock/subsys/nginx /var/run/nginx.pid } # reload nginx service functions. reload() { echo -n $&quot;Reloading $prog: &quot; #kill -HUP `cat ${nginx_pid}` killproc $nginxd -HUP RETVAL=$? echo } # See how we were called. case &quot;$1&quot; in start) start ;; stop) stop ;; reload) reload ;; restart) stop start ;; status) status $prog RETVAL=$? ;; *) echo $&quot;Usage: $prog {start|stop|restart|reload|status|help}&quot; exit 1 esac exit $RETVALç„¶å :wq ä¿å­˜å¹¶é€€å‡º(åˆ«å‘Šè¯‰æˆ‘ä½ ä¸ä¼šè¿™ä¸ª) 4.2 è®¾ç½®æ–‡ä»¶çš„è®¿é—®æƒé™chmod a+x /etc/init.d/nginx (a+x ==&gt; all user can execute æ‰€æœ‰ç”¨æˆ·å¯æ‰§è¡Œ)è¿™æ ·åœ¨æ§åˆ¶å°å°±å¾ˆå®¹æ˜“çš„æ“ä½œnginxäº†ï¼šæŸ¥çœ‹Nginxå½“å‰çŠ¶æ€ã€å¯åŠ¨Nginxã€åœæ­¢Nginxã€é‡å¯Nginxâ€¦ å¦‚æœä¿®æ”¹äº†nginxçš„é…ç½®æ–‡ä»¶nginx.confï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤é‡æ–°åŠ è½½æ–°çš„é…ç½®æ–‡ä»¶å¹¶è¿è¡Œï¼Œå¯ä»¥å°†æ­¤å‘½ä»¤åŠ å…¥åˆ°rc.localæ–‡ä»¶ä¸­ï¼Œè¿™æ ·å¼€æœºçš„æ—¶å€™nginxå°±é»˜è®¤å¯åŠ¨äº† 4.3 åŠ å…¥åˆ°rc.localæ–‡ä»¶ä¸­vi /etc/rc.localåŠ å…¥ä¸€è¡Œ /etc/init.d/nginx start ä¿å­˜å¹¶é€€å‡ºï¼Œä¸‹æ¬¡é‡å¯ä¼šç”Ÿæ•ˆã€‚ #!/bin/sh # # This script will be executed *after* all the other init scripts. # You can put your own initialization stuff in here if you don&apos;t # want to do the full Sys V style init stuff. touch /var/lock/subsys/local # nginx auto start /etc/init.d/nginx startNginxåº”ç”¨-åå‘ä»£ç†(Reverse Proxy)","link":"/2016/11/02/JavaWeb%E5%9F%BA%E7%A1%80/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E-Nginx%E7%AC%94%E8%AE%B0/"},{"title":"æ·˜æ·˜å•†åŸ-æ­å»ºFTPæœåŠ¡å™¨","text":"1.å‰æœŸå‡†å¤‡ å› ä¸ºç©·,æ‰€ä»¥ä½¿ç”¨çš„æ˜¯VMwareè™šæ‹Ÿæœºæ¥æ­å»º å®‰è£…CentOSè™šæ‹Ÿæœº(å¦‚æœä½ æœ‰æœåŠ¡å™¨æ›´å¥½) å‡†å¤‡IPåœ°å€(è™šæ‹Ÿæœºå†…ç½‘ : 192.168.2.100),å¹¶é…ç½®å¥½ å‡†å¤‡å®¢æˆ·ç«¯è¿æ¥è½¯ä»¶(FileZilla/Xftp/EditPlus) 2.å¼€å§‹å®‰è£…2.1å®‰è£…vsftpdç»„ä»¶[root@localhost ~]# yum -y install vsftpdå®‰è£…å®Œåï¼Œæœ‰/etc/vsftpd/vsftpd.conf æ–‡ä»¶ï¼Œæ˜¯vsftpçš„é…ç½®æ–‡ä»¶ã€‚ 2.2æ·»åŠ ä¸€ä¸ªftpç”¨æˆ·å¹¶è®¾ç½®å¯†ç [root@localhost ~]# useradd ftpuseræ­¤ç”¨æˆ·å°±æ˜¯ç”¨æ¥ç™»å½•ftpæœåŠ¡å™¨ç”¨çš„ã€‚ç™»å½•åé»˜è®¤çš„è·¯å¾„ä¸º /home/ftpuser [root@localhost ~]# passwd ftpuserè¾“å…¥ä¸¤æ¬¡å¯†ç åä¿®æ”¹å¯†ç ã€‚ å¯†ç :123 2.3é˜²ç«å¢™å¼€å¯21ç«¯å£å› ä¸ºftpé»˜è®¤çš„ç«¯å£ä¸º21ï¼Œè€Œcentosé»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œæ‰€ä»¥è¦ä¿®æ”¹iptablesæ–‡ä»¶ [root@localhost ~]# vim /etc/sysconfig/iptablesåœ¨è¡Œä¸Šé¢æœ‰22 -j ACCEPT ä¸‹é¢å¦èµ·ä¸€è¡Œè¾“å…¥è·Ÿé‚£è¡Œå·®ä¸å¤šçš„ï¼Œåªæ˜¯æŠŠ22æ¢æˆ21ï¼Œç„¶åï¼šwqä¿å­˜ã€‚ ä¿®æ”¹åçš„å†…å®¹å¦‚ä¸‹: # Firewall configuration written by system-config-firewall # Manual customization of this file is not recommended. *filter :INPUT ACCEPT [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [0:0] -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT -A INPUT -p icmp -j ACCEPT -A INPUT -i lo -j ACCEPT -A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT -A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT -A INPUT -j REJECT --reject-with icmp-host-prohibited -A FORWARD -j REJECT --reject-with icmp-host-prohibited COMMITè¿˜è¦è¿è¡Œä¸‹,é‡å¯iptablesé˜²ç«å¢™ [root@localhost ~]# service iptables restart2.4ä¿®æ”¹selinuxå¤–ç½‘æ˜¯å¯ä»¥è®¿é—®ä¸Šå»äº†ï¼Œå¯æ˜¯å‘ç°æ²¡æ³•è¿”å›ç›®å½•ï¼ˆä½¿ç”¨ftpçš„ä¸»åŠ¨æ¨¡å¼ï¼Œè¢«åŠ¨æ¨¡å¼è¿˜æ˜¯æ— æ³•è®¿é—®ï¼‰ï¼Œä¹Ÿä¸Šä¼ ä¸äº†ï¼Œå› ä¸ºselinuxä½œæ€ªäº†ã€‚ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹çŠ¶æ€ï¼š [root@localhost ~]# getsebool -a | grep ftp allow_ftpd_anon_write --&gt; off allow_ftpd_full_access --&gt; off allow_ftpd_use_cifs --&gt; off allow_ftpd_use_nfs --&gt; off ftp_home_dir --&gt; off ftpd_connect_db --&gt; off ftpd_use_passive_mode --&gt; off httpd_enable_ftp_server --&gt; off tftp_anon_write --&gt; offæ‰§è¡Œä¸Šé¢å‘½ä»¤ï¼Œå†è¿”å›çš„ç»“æœçœ‹åˆ°allow_ftpd_full_accesså’Œftp_home_dirä¸¤è¡Œéƒ½æ˜¯offï¼Œä»£è¡¨ï¼Œæ²¡æœ‰å¼€å¯å¤–ç½‘çš„è®¿é—® [root@localhost ~]# setsebool -P allow_ftpd_full_access on [root@localhost ~]# setsebool -P ftp_home_dir onè¿™æ ·åº”è¯¥æ²¡é—®é¢˜äº†ï¼ˆå¦‚æœï¼Œè¿˜æ˜¯ä¸è¡Œï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯ç”¨äº†ftpå®¢æˆ·ç«¯å·¥å…·ç”¨äº†passiveæ¨¡å¼è®¿é—®äº†ï¼Œå¦‚æç¤ºEntering Passive modeï¼Œå°±ä»£è¡¨æ˜¯passiveæ¨¡å¼ï¼Œé»˜è®¤æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºftp passiveæ¨¡å¼è¢«iptablesæŒ¡ä½äº†ï¼Œä¸‹é¢ä¼šè®²æ€ä¹ˆå¼€å¯ï¼Œå¦‚æœæ‡’å¾—å¼€çš„è¯ï¼Œå°±çœ‹çœ‹ä½ å®¢æˆ·ç«¯ftpæ˜¯å¦æœ‰portæ¨¡å¼çš„é€‰é¡¹ï¼Œæˆ–è€…æŠŠpassiveæ¨¡å¼çš„é€‰é¡¹å»æ‰ã€‚å¦‚æœå®¢æˆ·ç«¯è¿˜æ˜¯ä¸è¡Œï¼Œçœ‹çœ‹å®¢æˆ·ç«¯ä¸Šçš„ä¸»æœºçš„ç”µè„‘æ˜¯å¦å¼€äº†é˜²ç«å¢™ï¼Œå…³å§ï¼‰ 2.5å…³é—­åŒ¿åè®¿é—®[root@localhost ~]# vim /etc/vsftpd/vsftpd.confå°†anonymous_enable=YESæ”¹ä¸ºanonymous_enable=NO é‡å¯ftpæœåŠ¡ [root@localhost ~]# service vsftpd restart2.6å¼€å¯è¢«åŠ¨æ¨¡å¼é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œä½†æ˜¯è¦æŒ‡å®šä¸€ä¸ªç«¯å£èŒƒå›´ï¼Œæ‰“å¼€vsftpd.confæ–‡ä»¶ï¼Œåœ¨åé¢åŠ ä¸Š pasv_min_port=30000 pasv_max_port=30999è¡¨ç¤ºç«¯å£èŒƒå›´ä¸º30000~30999ï¼Œè¿™ä¸ªå¯ä»¥éšæ„æ”¹ã€‚æ”¹å®Œé‡å¯ä¸€ä¸‹vsftpdç”±äºæŒ‡å®šè¿™æ®µç«¯å£èŒƒå›´ï¼Œiptablesä¹Ÿè¦ç›¸åº”çš„å¼€å¯è¿™ä¸ªèŒƒå›´ï¼Œæ‰€ä»¥åƒä¸Šé¢é‚£æ ·æ‰“å¼€iptablesæ–‡ä»¶ã€‚ä¹Ÿæ˜¯åœ¨21ä¸Šä¸‹é¢å¦èµ·ä¸€è¡Œï¼Œæ›´é‚£è¡Œå·®ä¸å¤šï¼Œåªæ˜¯æŠŠ21 æ”¹ä¸º30000:30999,ç„¶å:wqä¿å­˜ ä¿®æ”¹åçš„å†…å®¹å¦‚ä¸‹: # Generated by iptables-save v1.4.7 on Sat Sep 3 13:04:11 2016 *filter :INPUT ACCEPT [0:0] :FORWARD ACCEPT [0:0] :OUTPUT ACCEPT [9:1116] -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT -A INPUT -p tcp -m tcp --dport 21 -j ACCEPT -A INPUT -p tcp -m tcp --dport 30000:30999 -j ACCEPT -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT -A INPUT -p icmp -j ACCEPT -A INPUT -i lo -j ACCEPT -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT -A INPUT -j REJECT --reject-with icmp-host-prohibited -A FORWARD -j REJECT --reject-with icmp-host-prohibited COMMIT # Completed on Sat Sep 3 13:04:11 2016é‡å¯iptablesé˜²ç«å¢™ [root@localhost ~]# service iptables restart2.7è®¾ç½®å¼€æœºå¯åŠ¨vsftpd ftpæœåŠ¡[root@localhost ~]# chkconfig vsftpd on3.å®¢æˆ·ç«¯è¿æ¥å·¥å…·ä»‹ç»3.1FileZillaå“ˆå“ˆ è¿™ä¸ªæ²¡ç”¨è¿‡ è™½ç„¶è§†é¢‘é‡Œé¢è®²çš„æ˜¯è¿™ä¸ªå·¥å…· 3.2Xftpä¸€å›¾èƒœåƒè¨€ 3.3EditPlusäº”å›¾èƒœåƒè¨€ æ€»ç»“æˆ‘ç«Ÿç„¶ä¸çŸ¥é“EditPluså±…ç„¶èƒ½è¿æ¥FTPæœåŠ¡å™¨,è¿™æ ·çš„è¯ç”¨è¿™ä¸ªä¸œè¥¿æ¥ä¿®æ”¹æœåŠ¡å™¨é…ç½®å°±æ–¹ä¾¿å¤šäº†,ä¸ç”¨å†ä¸€ç‚¹ä¸€ç‚¹vimäº†(åŸè°…æˆ‘åªä¼švimç®€å•æ“ä½œ). è¯´æ˜è¿™ç¯‡æ–‡ç« æ•´ç†è‡ªé»‘é©¬JavaEEçš„è¯¾ç¨‹ç¬”è®°ä¸­,å¤–åŠ äº†ç‚¹è‡ªå·±çš„å®è·µçš„ä¸œè¥¿åŠ æ²¹å­¦,é—ªå…‰ä¹‹å‰æ€»æ˜¯è¦ç»å†é»‘æš—.^_^","link":"/2016/11/02/JavaWeb%E5%9F%BA%E7%A1%80/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E-%E6%90%AD%E5%BB%BAFTP%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"title":"è°·æ­Œæ¨å‡º12æ¬¾æ–°å®˜æ–¹ä¸»é¢˜ï¼Œèµ¶å¿«ç»™ä½ çš„Chromeæ¢æ¢æ ·å­ï¼","text":"å‰è¨€æ–°å¹´ä¼Šå§‹ï¼Œå¼€å·¥å¤§å‰ï¼æ–°çš„ä¸€å¹´ï¼Œå„ä½å¤§ä½¬å‡†å¤‡å¥½ç èµ·æ¥äº†å—ï¼ä¿—è¯è¯´å¾—å¥½ï¼Œå·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œä»Šå¤©ä»‹ç»ä¸‹è°·æ­Œå®˜æ–¹å‡ºå“çš„æµè§ˆå™¨ä¸»é¢˜ï¼Œè®©æˆ‘ä»¬çš„ Chrome æµè§ˆå™¨æ›´åŠ èµå¿ƒæ‚¦ç›®ï¼ éšç€ macOS Mojave çš„å‘å¸ƒï¼Œé»‘æš—æ¨¡å¼ä¸å†ä»…æ˜¯æ‰‹æœºä¸“å±ï¼ŒPC ç«¯è¿æ¥äº†é»‘æš—æ¨¡å¼ä¸»é¢˜ã€‚å°ç¼–æœ¬äººå°±åœ¨ç¬¬ä¸€æ—¶é—´æ›´æ–°ç³»ç»Ÿï¼Œé»‘æš—æ¨¡å¼ç»å¯¹çš„ç§‘æŠ€æ„Ÿåè¶³ï¼![](https://raw.githubusercontent.com/lujiahao0708/PicRepo/master/2019/20190213%E8%B0%B7%E6%AD%8C%E6%8E%A8%E5%87%BA12%E6%AC%BE%E6%96%B0%E5%AE%98%E6%96%B9%E4%B8%BB%E9%A2%98%EF%BC%8C%E7%BB%99%E4%BD%A0%E7%9A%84Chrome%E6%8D%A2%E6%8D%A2%E6%A0%B7%E5%AD%90%EF%BC%81/macOS Mojave.png) Chrome æ–°ä¸»é¢˜ä¸ºäº†æ»¡è¶³ç”¨æˆ·å¯¹é»‘æš—æ¨¡å¼çš„éœ€æ±‚ï¼ŒGoogle Chrome å›¢é˜Ÿåœ¨æ–°å¹´æœŸé—´ä¸ºå¤§ä¼—æä¾›äº†å…¨æ–°çš„ä¸»é¢˜æ¨¡å¼ã€‚è¿™å¥— Chrome è°·æ­Œæµè§ˆå™¨å®˜æ–¹æ–°ä¸»é¢˜å…±åŒ…å« 12 æ¬¾ï¼Œå…¶ä¸­å¤‡å—æ¬¢è¿çš„é»‘æš—æ¨¡å¼ä¸»é¢˜(Just Blackï¼‰ï¼Œæå¤§çš„æ»¡è¶³äº†å€¾å‘äºå¤œé—´å·¥ä½œçš„ç”¨æˆ·ç¾¤ä½“ã€‚![](https://raw.githubusercontent.com/lujiahao0708/PicRepo/master/2019/20190213%E8%B0%B7%E6%AD%8C%E6%8E%A8%E5%87%BA12%E6%AC%BE%E6%96%B0%E5%AE%98%E6%96%B9%E4%B8%BB%E9%A2%98%EF%BC%8C%E7%BB%99%E4%BD%A0%E7%9A%84Chrome%E6%8D%A2%E6%8D%A2%E6%A0%B7%E5%AD%90%EF%BC%81/Just Black.png) é™¤äº†å¤‡å—æ¬¢è¿çš„é»‘æš—æ¨¡å¼å¤–ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—ä¸»é¢˜å¯é€‰æ‹©ï¼ŒåŒ…æ‹¬ Slateã€Oceanicã€Ultra Violetã€Classic Blueã€Bananaã€Blackï¼†Whiteã€Honeysuckleã€Roseã€Serenityã€Sea Foamã€Marsalaã€é«˜å¯¹æ¯”è‰²å½©ã€ä»¥åŠ Pretty in Pink ç­‰ã€‚å¤§å®¶å¯ä»¥ä¾æ®ä¸ªäººå–œå¥½é€‰æ‹©è‡ªå·±ä¸­æ„çš„ä¸»é¢˜ã€‚ æˆªæ­¢å°ç¼–å‘ç¨¿æ˜¯ï¼Œæœ¬æ¬¡æ–°ä¸»é¢˜ä¸­å¥½è¯„åº¦è¾ƒé«˜çš„çš„å‡ æ¬¾å¦‚ä¸‹ï¼š![](https://raw.githubusercontent.com/lujiahao0708/PicRepo/master/2019/20190213%E8%B0%B7%E6%AD%8C%E6%8E%A8%E5%87%BA12%E6%AC%BE%E6%96%B0%E5%AE%98%E6%96%B9%E4%B8%BB%E9%A2%98%EF%BC%8C%E7%BB%99%E4%BD%A0%E7%9A%84Chrome%E6%8D%A2%E6%8D%A2%E6%A0%B7%E5%AD%90%EF%BC%81/Ultra Violet.png)![](https://raw.githubusercontent.com/lujiahao0708/PicRepo/master/2019/20190213%E8%B0%B7%E6%AD%8C%E6%8E%A8%E5%87%BA12%E6%AC%BE%E6%96%B0%E5%AE%98%E6%96%B9%E4%B8%BB%E9%A2%98%EF%BC%8C%E7%BB%99%E4%BD%A0%E7%9A%84Chrome%E6%8D%A2%E6%8D%A2%E6%A0%B7%E5%AD%90%EF%BC%81/Black &amp; White.png)å°ç¼–ä¸ªäººé€‰æ‹©äº† Slate ä¸»é¢˜ã€‚ï¼ˆæˆ‘æ„Ÿè§‰ Just Black ä¸»é¢˜å¤ªé»‘äº†ğŸ˜ï¼Œçº¯ä¸ªäººè§‚ç‚¹ï¼‰ æ¢å¤é»˜è®¤ä¸»é¢˜ ä¸»é¢˜åˆšåˆšå®‰è£…åï¼Œé¡¶éƒ¨ä¼šæœ‰ä¸€ä¸ªæ’¤é”€æŒ‰é’®ï¼Œå¦‚æœæ„Ÿè§‰å¹¶ä¸æ»¡æ„å½“å‰çš„ä¸»é¢˜ï¼Œå¯ä»¥æ’¤é”€æ¢å¤é»˜è®¤ä¸»é¢˜ã€‚ å¦‚æœç”¨æˆ·åœ¨ä½¿ç”¨ä»»ä½•ä¸»é¢˜ä¸€æ®µæ—¶é—´åï¼Œè‹¥è¦æ¢å¤æˆé»˜è®¤ä¸»é¢˜ï¼Œå¯ä»¥å•å‡»èœå•&gt;è®¾ç½®&gt;å¤–è§‚ï¼Œç„¶åå•å‡»â€œ é‡ç½®ä¸ºé»˜è®¤å€¼ â€ï¼Œå³å¯æ¢å¤ã€‚ è·å¾—ä¸»é¢˜æœ‰å…´è¶£æœ‹å‹å¯ä»¥è®¿é—® Chrome ç½‘ä¸Šåº”ç”¨å•†åº—ï¼Œæœç´¢ä¸»é¢˜èƒŒæ™¯ï¼Œè¿›å…¥ä¸»é¢˜é¡µé¢æ¥æŸ¥çœ‹åŠè·å¾—ä¸»é¢˜ã€‚ Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜ å„ä½å¤§ä½¬ç‚¹ç‚¹å¹¿å‘Šï¼Œä¸‡åˆ†æ„Ÿè°¢ï¼ï¼ï¼","link":"/2019/02/13/JavaWeb%E5%9F%BA%E7%A1%80/%E8%B0%B7%E6%AD%8C%E6%8E%A8%E5%87%BA12%E6%AC%BE%E6%96%B0%E5%AE%98%E6%96%B9%E4%B8%BB%E9%A2%98%EF%BC%8C%E7%BB%99%E4%BD%A0%E7%9A%84Chrome%E6%8D%A2%E6%8D%A2%E6%A0%B7%E5%AD%90%EF%BC%81/"},{"title":"è§£å†³Macä¸‹VSCodeæ‰“å¼€zshä¹±ç ","text":"1.ä¹±ç é—®é¢˜iTerm2ç»ˆç«¯ä½¿ç”¨Zshï¼Œå¹¶ä¸”é…ç½®Zshä¸»é¢˜ï¼Œè¯¥ä¸»é¢˜ä¸»é¢˜éœ€è¦å®‰è£…å­—ä½“æ¥æ”¯æŒç®­å¤´æ•ˆæœï¼Œåœ¨iTerm2ä¸­è®¾ç½®è¿™ä¸ªå­—ä½“ï¼Œä½†æ˜¯VSCodeé‡Œè¿™ä¸ªç®­å¤´è¿˜æ˜¯æ˜¾ç¤ºä¹±ç ã€‚ iTerm2å±•ç¤ºå¦‚ä¸‹: VSCodeå±•ç¤ºå¦‚ä¸‹: 2.è§£å†³æ–¹æ¡ˆ2.1 å­—ä½“åœ¨å­—ä½“å†ŒæŸ¥æ‰¾æ˜¯å¦å·²ç»å®‰è£…Meslo LG M for Powerlineå­—ä½“ï¼Œå¦‚æœæœªå®‰è£…å°±å®‰è£…ä¸€ä¸‹ã€‚ 2.2 VSCodeä¸­é…ç½®ä½¿ç”¨âŒ˜,æ‰“å¼€settingsç•Œé¢,æœç´¢terminal,åœ¨Font Familyä¸­æ·»åŠ å­—ä½“Meslo LG M for Powerline ä¹Ÿå¯ä»¥åœ¨VSCodeçš„settings.jsonæ–‡ä»¶ï¼ŒåŠ å…¥ : â€œterminal.integrated.fontFamilyâ€: â€œMeslo LG M for Powerlineâ€, 3.æ•ˆæœå±•ç¤º æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/07/21/Mac%E7%9B%B8%E5%85%B3/%E8%A7%A3%E5%86%B3Mac%E4%B8%8BVSCode%E6%89%93%E5%BC%80zsh%E4%B9%B1%E7%A0%81/"},{"title":"Macä½¿ç”¨sshå…¬é’¥å…å¯†ç™»å½•æœåŠ¡å™¨","text":"æ¯æ¬¡ç™»é™†æœåŠ¡å™¨éƒ½è¦è¾“å…¥å¯†ç ,é‡å¤æ— ç”¨çš„æ“ä½œè®©äººå¿ƒç”ŸåŒçƒ¦ã€‚â€œæ‡’äººæ˜¯æ¨åŠ¨ç¤¾ä¼šè¿›æ­¥çš„åŠ¨åŠ›â€,æˆ‘çš„å®—æ—¨å°±æ˜¯èƒ½è‡ªåŠ¨çš„å°±ä¸è¦æ‰‹åŠ¨ã€‚ä¸‹é¢å°±åƒå¤§å®¶ä»‹ç»æˆ‘æ˜¯å¦‚ä½•æ‰“é€ æ— å¯†ç ç™»å½•æœåŠ¡å™¨: 1. ç”Ÿæˆå…¬é’¥å’Œå¯†é’¥ç›¸ä¿¡ä½¿ç”¨è¿‡gitçš„æœ‹å‹å¯¹è¿™ä¸€éƒ¨åˆ†åº”è¯¥ä¸ä¼šé™Œç”Ÿ,gitçš„å…¬ç§é’¥é…ç½®ä¹Ÿæ˜¯è¿™æ ·åœ¨æœ¬åœ°ç”Ÿæˆçš„,è¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚ 2. ç¼–è¾‘sshé…ç½®æ–‡ä»¶1234567891011121314vim ~/.ssh/configå¢åŠ ï¼š#Tencent ServerHost ts HostName 111.231.199.76 User root PreferredAuthentications publickey IdentityFile ~/.ssh/id_rsa_tencent_server 1. Host ts #åˆ«åï¼ŒåŸŸåç¼©å†™2. HostName 111.231.199.76 #å®Œæ•´çš„åŸŸåæˆ–ipåœ°å€3. User root #ç™»å½•è¯¥åŸŸåä½¿ç”¨çš„è´¦å·å4. PreferredAuthentications publickey #æœ‰äº›æƒ…å†µæˆ–è®¸éœ€è¦åŠ å…¥æ­¤å¥ï¼Œä¼˜å…ˆéªŒè¯ç±»å‹ssh5. IdentityFile ~/.ssh/id_rsa_tencent_server #æœ¬åœ°ç§é’¥æ–‡ä»¶çš„è·¯å¾„ è¯¦ç»†é…ç½®è§ä¸‹å›¾: æˆ‘çš„ç”µè„‘é‡Œé¢é…ç½®äº†å…¬å¸çš„gitlabå’Œgithub,å†åŠ ä¸ŠæœåŠ¡å™¨çš„å°±æœ‰ä¸‰ç»„é…ç½®äº†ã€‚ 3. æ”¾ç½®å…¬é’¥åˆ°æœåŠ¡å™¨ç›®å½•ä¸­1scp ~/.ssh/id_rsa_tencent_server.pub ts:~/.ssh/ 4. æœåŠ¡å™¨é…ç½®å…¬é’¥1mv id_rsa.pub authorized_keys å¦‚æœæœåŠ¡å™¨æœ‰authorized_keysè¿™ä¸ªæ–‡ä»¶å°±ç›´æ¥è¦†ç›–ã€‚ 5. æœ¬åœ°å’ŒæœåŠ¡å™¨æ–‡ä»¶æƒé™123456ç°åœ¨ä¸ºæœ¬åœ°macçš„ç§é’¥è®¾ç½®æƒé™ï¼šchmod 700 ~/.sshchmod 600 ~/.ssh/id_rsa_tencent_serverè®¾ç½®æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æƒé™ï¼šchmod 700 ~/.sshchmod 600 ~/.ssh/authorized_keys 6. æœåŠ¡å™¨ç¦ç”¨å¯†ç ç™»å½•(å¯é€‰)12345vi /etc/ssh/sshd_config # å°†PasswordAuthenticationè®¾ç½®æˆnoï¼Œ# ç„¶åé‡å¯service sshd restartå¦‚æœä½ éœ€è¦ç”¨å¯†ç ç™»å½•ï¼Œè¿™ä¸€æ­¥ä¹Ÿå¯ä»¥ä¸è®¾ç½®ï¼ˆssh root@111.231.199.76ï¼‰ 7. ç™»å½•æœåŠ¡å™¨1ssh ts 8. åŠ¨å›¾æ¼”ç¤ºä¸‹é¢çš„åŠ¨å›¾æ¼”ç¤ºä¸¤ç§ç™»å½•æœåŠ¡å™¨çš„æ–¹æ³•: ssh ç”¨æˆ·@ip ssh è‡ªå®šä¹‰åç§° ç¬¬ä¸€ç§æ–¹å¼éœ€è¦æ¯æ¬¡æ‰‹åŠ¨è¾“å…¥å¯†ç ,ä¸€æ—¦è¾“å…¥é”™è¯¯å°±å¾—é‡æ–°è¾“å…¥,éå¸¸ä¸æ–¹ä¾¿ã€‚ç„¶è€Œç¬¬äºŒç§æ–¹å¼æ— éœ€æ¯æ¬¡è¾“å…¥å¯†ç ,å‡å°‘è¯¯è¾“å…¥çš„é—®é¢˜ã€‚é€šè¿‡å¯¹æ¯”ä¸éš¾å‘ç°ç¬¬äºŒç§æ–¹å¼æ–¹ä¾¿å¿«æ·,ä¸€åŠ³æ°¸é€¸,éå¸¸æ¨èå¤§å®¶åŠ¨æ‰‹æ“ä½œé…ç½®ã€‚ 8. å‚è€ƒæ•™ç¨‹ https://bitzhi.com/2015/07/login-in-linux-servers-with-sshkey-on-osx/ https://my.oschina.net/kmwzjs/blog/732601 http://cssor.com/mac-ssh-auto-login-server.html æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/05/28/Mac%E7%9B%B8%E5%85%B3/Mac%E4%BD%BF%E7%94%A8ssh%E5%85%AC%E9%92%A5%E6%97%A0%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"title":"é˜¿é‡Œå¼€æºé¡¹ç›®ä¸Šæ–°ï¼ŒFlutter Go è¯·æŸ¥æ”¶ï¼","text":"å‰è¨€æ–°å¹´ä¼Šå§‹ï¼Œé˜¿é‡Œå¼€æºé¡¹ç›®ä¸Šæ–°äº†ï¼æ­¤æ¬¡æ˜¯é˜¿é‡Œæ‹å–å‰ç«¯å›¢é˜Ÿå¸¦æ¥çš„ Fluttr Go ï¼Œé’ˆå¯¹äºæ—¶ä¸‹å¾ˆç«çš„è·¨å¹³å°ç§»åŠ¨è§£å†³æ–¹æ¡ˆæ¨å‡ºçš„å®ä¾‹APPé¡¹ç›®ï¼Œå¯¹äºFlutteråˆå­¦è€…ï¼Œå­¦ä¹ æŒæ¡æ­¤é¡¹ç›®æ˜¯æå…¶æœ‰ç›Šçš„ã€‚ Flutter æ˜¯ä»€ä¹ˆ?2018å¹´6æœˆ21æ—¥Googleå‘å¸ƒFlutteré¦–ä¸ªreleaseé¢„è§ˆç‰ˆ,ä½œä¸ºGoogle å¤§åŠ›æ¨å‡ºçš„ä¸€ç§å…¨æ–°çš„å“åº”å¼ï¼Œè·¨å¹³å°ï¼Œé«˜æ€§èƒ½çš„ç§»åŠ¨å¼€å‘æ¡†æ¶ã€‚Flutteræ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç§»åŠ¨UIæ¡†æ¶ï¼Œæ—¨åœ¨å¸®åŠ©å¼€å‘è€…ä½¿ç”¨ä¸€å¥—ä»£ç å¼€å‘é«˜æ€§èƒ½ã€é«˜ä¿çœŸçš„Androidå’ŒiOSåº”ç”¨ã€‚ flutterä¼˜ç‚¹ä¸»è¦åŒ…æ‹¬ï¼š å¼€æºã€è·¨å¹³å° Hot Reloadã€å“åº”å¼æ¡†æ¶ã€åŠå…¶ä¸°å¯Œçš„æ§ä»¶ä»¥åŠå¼€å‘å·¥å…· çµæ´»çš„ç•Œé¢è®¾è®¡ä»¥åŠæ§ä»¶ç»„åˆ å€ŸåŠ©å¯ä»¥ç§»æ¤çš„GPUåŠ é€Ÿçš„æ¸²æŸ“å¼•æ“ä»¥åŠé«˜æ€§èƒ½ARMä»£ç è¿è¡Œæ—¶å·²è¾¾åˆ°é«˜è´¨é‡çš„ç”¨æˆ·ä½“éªŒ Flutter Go çš„ç”±æ¥ å¸®åŠ©å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹ Flutter Flutterå­¦ä¹ èµ„æ–™å¤ªå°‘ï¼Œå¯¹äºè‹±æ–‡ä¸å¥½çš„åŒå­¦ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå›°éš¾ å®˜ç½‘æ–‡æ¡£ç¤ºä¾‹ä¸å¤Ÿå¥å…¨ï¼Œä¸å¤Ÿç›´è§‚ å„ä¸ª widget çš„ç”¨æ³•å„å¼‚ï¼Œå±æ€§çº·ç¹ï¼Œè¦è¿è¡Œä¸€ä¸ª widget çš„ demo å¾€å¾€è¦åˆ°å¤„ç¿»é˜…å„ç§èµ„æ–™ Flutter Go çš„ä¼˜åŠ¿ è¯¦è§£å¸¸ç”¨widgetå¤šè¾¾ 140+ ä¸ª é…å¥— Demo è¯¦è§£ widget å¸¸è§„ç”¨æ³• é›†ä¸­æ•´åˆ widget æ¡ˆä¾‹ï¼Œä¸€ä¸ª APP æå®šæ‰€æœ‰å¸¸ç”¨ widget çš„ç”¨æ³• æŒç»­è¿­ä»£ â€˜è¿½æ–°â€™ å®˜æ–¹ç‰ˆæœ¬ app é¢„è§ˆ åè®°è·¨å¹³å°æŠ€æœ¯è“æµ·å·²ç»å‡ºç°ï¼Œæœªæ¥è·¨å¹³å°å¼€å‘ç”šè‡³å¤šç«¯ç»Ÿä¸€çš„å¼€å‘æ¨¡å¼ä¸è¯­è¨€åŠ¿å¿…æˆä¸ºä¸»æµã€‚è€Œæˆ‘ä»¬å¤§å®¶ä¸€èˆ¬éƒ½æ˜¯åªæ‹¥æœ‰ä¸€ä¸ªæŠ€æœ¯æ ˆï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬åŠªåŠ›æ‰©å±•çŸ¥è¯†å®½åº¦å¹¿åº¦çš„åŒæ—¶ï¼Œä¹Ÿè¦å¤šæ¶‰çŒæ—¶ä¸‹æ–°å…´æŠ€æœ¯ï¼Œç´§è¿½æŠ€æœ¯çš„æ—¶ä»£å¤§æ½®ï¼ Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜ å„ä½å¤§ä½¬ç‚¹ç‚¹å¹¿å‘Šï¼Œä¸‡åˆ†æ„Ÿè°¢ï¼ï¼ï¼","link":"/2019/02/14/JavaWeb%E5%9F%BA%E7%A1%80/%E9%98%BF%E9%87%8C%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E4%B8%8A%E6%96%B0%EF%BC%8CFlutter-Go-%E8%AF%B7%E6%9F%A5%E6%94%B6%EF%BC%81/"},{"title":"Rediså®‰è£…&amp;æ­å»ºæœ¬åœ°ç¯å¢ƒ&amp;å¤‡ä»½æ¢å¤","text":"æ­å»ºæµç¨‹è®°å½•,æ–¹ä¾¿æ—¥åæŸ¥çœ‹ã€‚ Windowsä¸‹å®‰è£…å¹¶è®¾ç½®Redis Redisæœ¬åœ°ç¯å¢ƒæ­å»ºWindows ä¸‹ç¯å¢ƒæ­å»º1. è®¾ç½®hosts(è¿™ä¸ªæ²¡å•¥ç”¨,å¯ä»¥ä¸ç”¨è®¾ç½®)set duapphosts=127.0.0.1 sqld.duapp.com set redisduapphosts=127.0.0.1 redis.duapp.com echo %duapphosts% &gt;&gt; C:\\Windows\\System32\\drivers\\etc\\hosts echo %redisduapphosts% &gt;&gt; C:\\Windows\\System32\\drivers\\etc\\hosts2. ä¸‹è½½Redis-Windowsç‰ˆæœ¬Rediså®˜ç½‘ä¸‹è½½é¡µé¢: http://redis.io/download Windowsä¸‹Redisé¡¹ç›®: https://github.com/MSOpenTech/redis åœ¨releasesé¡µé¢æ‰¾åˆ°å¹¶ä¸‹è½½æœ€æ–°çš„ZIPåŒ…: https://github.com/MSOpenTech/redis/releases 3. è§£å‹å®‰è£…åŠ å‹ä¸‹è½½åçš„æ–‡ä»¶ redis-2.8.17.zip åˆ° redis-2.8.17 ç›®å½•. ä¾‹å¦‚: D:\\DevlopPrograms\\redis-2.8.17. å¦‚æœéœ€è¦ç®€å•æµ‹è¯•ä¸€ä¸‹, é¼ æ ‡åŒå‡» redis-server.exeå³å¯,å¦‚æœæ²¡é”™, ç¨åä¼šå¼¹å‡ºå‘½ä»¤è¡Œçª—å£æ˜¾ç¤ºæ‰§è¡ŒçŠ¶æ€. å¦‚æœä¸æ˜¯ Administratorç”¨æˆ·,åˆ™å¯èƒ½éœ€è¦ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ. æˆ–è€…å‚è€ƒ Windows 7 å¯ç”¨è¶…çº§ç®¡ç†å‘˜administratorè´¦æˆ·çš„Nç§æ–¹æ³• ç®€å•æµ‹è¯•,åˆ™ä½¿ç”¨ redis-cli.exe å³å¯, æ‰“å¼€åä¼šè‡ªåŠ¨è¿æ¥ä¸Šæœ¬æœºæœåŠ¡å™¨. å¯ä»¥è¾“å…¥ info æŸ¥çœ‹æœåŠ¡å™¨ä¿¡æ¯. å¦‚æœè¦è¿›è¡ŒåŸºå‡†æµ‹è¯•,å¯ä»¥å¯åŠ¨æœåŠ¡å™¨å,åœ¨cmdä¸­è¿è¡Œ redis-benchmark.exe ç¨‹åº. 4. å¯åŠ¨ä¸æ³¨å†ŒæœåŠ¡å¦‚æœå‡†å¤‡é•¿æœŸä½¿ç”¨,åˆ™éœ€è¦æ³¨å†Œä¸ºç³»ç»ŸæœåŠ¡. è¿›å…¥CMD,åˆ‡æ¢ç›®å½•: D: cd D:\\DevlopPrograms\\redis-2.8.17æ³¨å†ŒæœåŠ¡,å¯ä»¥ä¿å­˜ä¸º service-install.bat æ–‡ä»¶: redis-server.exe --service-install redis.windows.conf --loglevel verbose redis-server --service-startå¸è½½æœåŠ¡, å¯ä»¥ä¿å­˜ä¸º uninstall-service.bat æ–‡ä»¶.: redis-server --service-stop redis-server --service-uninstallå¯ä»¥åœ¨æ³¨å†ŒæœåŠ¡æ—¶,é€šè¿‡ â€“service-name redisService1 å‚æ•°ç›´æ¥æŒ‡å®šæœåŠ¡å,é€‚åˆå®‰è£…å¤šä¸ªå®ä¾‹çš„æƒ…å†µ,å¸è½½ä¹Ÿæ˜¯åŒæ ·çš„é“ç†. å¯åŠ¨redisæœåŠ¡å™¨æ—¶ä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®šé…ç½®æ–‡ä»¶,å¯ä»¥ä¿å­˜ä¸º startup.bat æ–‡ä»¶: redis-server.exe redis.windows.confå½“ç„¶,æŒ‡å®šäº†é…ç½®æ–‡ä»¶ä»¥å,å¯èƒ½ä¼šç¢°åˆ°å¯åŠ¨å¤±è´¥çš„é—®é¢˜.æ­¤æ—¶,è¯·ä¿®æ”¹é…ç½®æ–‡ä»¶,æŒ‡å®š maxheap å‚æ•°. 5. ä¿®æ”¹é…ç½®æ–‡ä»¶ä¿®æ”¹é…ç½®æ–‡ä»¶redis.windows.conf,å¦‚æœæœ‰ä¸­æ–‡,è¯·å¦å­˜ä¸ºUTF-8ç¼–ç . # ä¿®æ”¹ç«¯å£å· # port 6379 port 80 # æŒ‡å®šè®¿é—®å¯†ç  # requirepass foobared requirepass 6EhSiGpsmSMRyZieglUImkTr-eoNRNBgRk397mVyu66MHYuZDsepCeZ8A-MHdLBQwQQVQiHBufZbPa # è®¾ç½®æœ€å¤§å †å†…å­˜é™åˆ¶,ä¸¤è€…è®¾ç½®ä¸€ä¸ªå³å¯ # maxheap &lt;bytes&gt; maxheap 512000000 # è®¾ç½®æœ€å¤§å†…å­˜é™åˆ¶, ä¸¤è€…è®¾ç½®ä¸€ä¸ªå³å¯ # maxmemory &lt;bytes&gt; # maxmemory 512000000æ­¤æ—¶,å¦‚æœç”¨å®¢æˆ·ç«¯æ¥è®¿é—®,ä½¿ç”¨å¦‚ä¸‹cmdå‘½ä»¤,å¯ä»¥ä¿å­˜ä¸º client.bat æ–‡ä»¶: redis-cli.exe -h redis.duapp.com -p 80 -a 6EhSiGpsmSMRyZieglUImkTr-eoNRNBgRk397mVyu66MHYuZDsepCeZ8A-MHdLBQwQQVQiHBufZbPa6. å…¶ä»–é™„åŠ ç®¡ç†å·¥å…·: RedisStudio: https://github.com/cinience/RedisStudio å½“ç„¶,ç›®å½•é‡Œé¢ä¹Ÿæœ‰ä¸€äº›wordæ–‡æ¡£, æœ‰å…´è¶£å¯ä»¥è¯»ä¸€è¯». æ›´å¤šä¿¡æ¯,è¯·å‚è€ƒ: renfufeiçš„ä¸“æ -Redis: http://blog.csdn.net/renfufei/article/category/2470713 Redis æ•°æ®å¤‡ä»½ä¸æ¢å¤ Redis SAVE å‘½ä»¤ç”¨äºåˆ›å»ºå½“å‰æ•°æ®åº“çš„å¤‡ä»½ã€‚ è¯­æ³•redis Save å‘½ä»¤åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š redis 127.0.0.1:6379&gt; SAVE å®ä¾‹redis 127.0.0.1:6379&gt; SAVE OKè¯¥å‘½ä»¤å°†åœ¨ redis å®‰è£…ç›®å½•ä¸­åˆ›å»ºdump.rdbæ–‡ä»¶ã€‚ æ¢å¤æ•°æ®å¦‚æœéœ€è¦æ¢å¤æ•°æ®ï¼Œåªéœ€å°†å¤‡ä»½æ–‡ä»¶ (dump.rdb) ç§»åŠ¨åˆ° redis å®‰è£…ç›®å½•å¹¶å¯åŠ¨æœåŠ¡å³å¯ã€‚","link":"/2020/04/11/Redis/Redis%E5%AE%89%E8%A3%85-%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/"},{"title":"01.Shiroç®€ä»‹","text":"Apache Shiroï¼ˆå‘éŸ³ä¸ºâ€œshee-rohâ€ï¼Œæ—¥è¯­â€œå ¡å’ï¼ˆCastleï¼‰â€çš„æ„æ€ï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§æ˜“ç”¨çš„ Java å®‰å…¨æ¡†æ¶ï¼Œæä¾›äº†è®¤è¯ã€æˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†åŠŸèƒ½ï¼Œå¯ä¸ºä»»ä½•åº”ç”¨æä¾›å®‰å…¨ä¿éšœ - ä»å‘½ä»¤è¡Œåº”ç”¨ã€ç§»åŠ¨åº”ç”¨åˆ°å¤§å‹ç½‘ç»œåŠä¼ä¸šåº”ç”¨ã€‚ 1. æƒé™ç®¡ç†æƒé™ç®¡ç†åŒ…æ‹¬ç”¨æˆ·èº«ä»½è®¤è¯å’Œæˆæƒä¸¤ä¸ªéƒ¨åˆ†,ç®€ç§°è®¤è¯æˆæƒ èº«ä»½è®¤è¯ : ä¸ºåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºåˆæ³•ç”¨æˆ·çš„è¿‡ç¨‹,æœ€å¸¸ç”¨çš„èº«ä»½è®¤è¯æ–¹å¼å°±æ˜¯ç³»ç»Ÿé€šè¿‡æ ¸å¯¹ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå£ä»¤,å°†å…¶ä¸ç³»ç»Ÿä¸­å­˜å‚¨çš„è¯¥ç”¨æˆ·ä¿¡æ¯ç›¸å¯¹æ¯”,ç»§è€Œæ¥åˆ¤æ–­ç”¨æˆ·èº«ä»½æ˜¯å¦æ­£ç¡® æˆæƒ : æ—¢è®¿é—®æƒé™,æ§åˆ¶ç”¨æˆ·è®¿é—®èµ„æºçš„æƒé™. ä¸»ä½“(subject)è¿›è¡Œèº«ä»½è®¤è¯åéœ€è¦åˆ†é…æƒé™æ–¹å¯è®¿é—®ç³»ç»Ÿçš„èµ„æº 2. Shiroæ ¸å¿ƒæ¦‚å¿µä¸‰ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µSubjectï¼ŒSecurityManagerå’ŒRealmsï¼Œå¦‚å›¾æ‰€ç¤ºï¼š Subject : ä¸»ä½“,ä»£è¡¨äº†å½“å‰â€ç”¨æˆ·â€,è¿™ä¸ªç”¨æˆ·ä¸ä¸€å®šæ˜¯ä¸€ä¸ªå…·ä½“çš„äºº,ä¸å½“å‰åº”ç”¨äº¤äº’çš„ä»»ä½•ä¸œè¥¿éƒ½æ˜¯Subject,å¦‚ç½‘ç»œçˆ¬è™«,æœºå™¨äººç­‰,å³ä¸ºä¸€ä¸ªæŠ½è±¡æ¦‚å¿µ. æ‰€æœ‰Subjectéƒ½ç»‘å®šåˆ°SecurityManager,ä¸Subjectçš„æ‰€æœ‰äº¤äº’éƒ½ä¼šå§”æ‰˜ç»™SecurityManager. å¯ä»¥æŠŠSubjectè®¤ä¸ºæ˜¯ä¸€ä¸ªé—¨é¢,SecurityManageræ‰æ˜¯å®é™…çš„æ‰§è¡Œè€… SecurityManager : å®‰å…¨ç®¡ç†å™¨,å³æ‰€æœ‰ä¸å®‰å…¨æœ‰å…³çš„æ“ä½œéƒ½ä¼šä¸SecurityManageräº¤äº’,ä¸”å®ƒç®¡ç†ç€æ‰€æœ‰Subject. å¯ä»¥çœ‹å‡ºå®ƒæ˜¯Shiroçš„æ ¸å¿ƒ,å®ƒè´Ÿè´£ä¸åè¾¹ä»‹ç»çš„å…¶ä»–ç»„ä»¶è¿›è¡Œäº¤äº’,å¦‚æœå­¦ä¹ è¿‡SpringMVC,ä½ å¯ä»¥æŠŠå®ƒçœ‹æˆDispatcherServletå‰ç«¯æ§åˆ¶å™¨ Realm : åŸŸ,Shiroä»Realmè·å–å®‰å…¨æ•°æ®(å¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™),å°±æ˜¯è¯´SecurityManagerè¦éªŒè¯ç”¨æˆ·èº«ä»½,é‚£ä¹ˆå®ƒéœ€è¦ä»Realmè·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒä»¥ç¡®å®šç”¨æˆ·èº«ä»½æ˜¯å¦åˆæ³•,ä¹Ÿéœ€è¦ä»Realmå¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰² / æƒé™è¿›è¡ŒéªŒè¯ç”¨æˆ·æ˜¯å¦èƒ½è¿›è¡Œæ“ä½œ. å¯ä»¥æŠŠRealmçœ‹æˆ DataSource,å³å®‰å…¨æ•°æ®æº ShiroåŸºæœ¬å·¥ä½œæµç¨‹ï¼š åº”ç”¨ä»£ç é€šè¿‡Subjectæ¥è¿›è¡Œè®¤è¯å’Œæˆæƒ,è€ŒSubjectåˆå°†æ‰€æœ‰çš„äº’äº¤éƒ½å§”æ‰˜ç»™äº†SecurityManager æˆ‘ä»¬éœ€è¦ç»™Shiroçš„SecurityManageræ³¨å…¥Realm,ä»è€Œè®©SecurityManagerèƒ½å¾—åˆ°åˆæ³•çš„ç”¨æˆ·åŠå…¶æƒé™è¿›è¡Œåˆ¤æ–­ Shiroä¸æä¾›ç»´æŠ¤ç”¨æˆ· / æƒé™ï¼Œè€Œæ˜¯é€šè¿‡Realmè®©å¼€å‘äººå‘˜è‡ªå·±æ³¨å…¥ã€‚é€šè¿‡ç»§æ‰¿AuthorizingRealmæŠ½è±¡ç±»ï¼Œå®ç°doGetAuthorizationInfoå’ŒdoGetAuthenticationInfoæ–¹æ³•ã€‚ 3. Shiroæ¶æ„ Authentication : èº«ä»½è®¤è¯ / ç™»å½•,éªŒè¯ç”¨æˆ·æ˜¯ä¸æ˜¯æ‹¥æœ‰ç›¸åº”çš„èº«ä»½ Authorization : æˆæƒ,å³æƒé™éªŒè¯,éªŒè¯æŸä¸ªå·²è®¤è¯çš„ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªæƒé™. å³åˆ¤æ–­ç”¨æˆ·æ˜¯å¦èƒ½åšäº‹æƒ…,å¸¸è§çš„å¦‚ : éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªè§’è‰²,æˆ–è€…ç»†ç²’åº¦çš„éªŒè¯æŸä¸ªç”¨æˆ·å¯¹æŸä¸ªèµ„æºæ˜¯å¦å…·æœ‰æŸä¸ªæƒé™ Session Manager : ä¼šè¯ç®¡ç†,å³ç”¨æˆ·ç™»å½•åå°±æ˜¯ä¸€æ¬¡ä¼šè¯,åœ¨æ²¡æœ‰é€€å‡ºä¹‹å‰,å®ƒçš„æ‰€æœ‰ä¿¡æ¯éƒ½åœ¨ä¼šè¯ä¸­. ä¼šè¯å¯ä»¥æ˜¯æ™®é€šJavaSEç¯å¢ƒçš„,ä¹Ÿå¯ä»¥æ˜¯å¦‚Webç¯å¢ƒçš„ Cryptography : åŠ å¯†,ä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§,å¦‚å¯†ç åŠ å¯†å­˜å‚¨åˆ°æ•°æ®åº“,è€Œä¸æ˜¯æ˜æ–‡å­˜å‚¨ Web Support : Webæ”¯æŒ,å¯ä»¥éå¸¸å®¹æ˜“çš„é›†æˆåˆ°Webç¯å¢ƒä¸­ Caching : ç¼“å­˜,æ¯”å¦‚ç”¨æˆ·ç™»å½•å,å…¶ç”¨æˆ·ä¿¡æ¯ã€æ‹¥æœ‰çš„è§’è‰² / æƒé™ä¸å¿…æ¯æ¬¡å»æŸ¥,è¿™æ ·å¯ä»¥æé«˜æ•ˆç‡ Concurrency : shiroæ”¯æŒå¤šçº¿ç¨‹åº”ç”¨çš„å¹¶å‘éªŒè¯,å³å¦‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å¼€å¯å¦ä¸€ä¸ªçº¿ç¨‹,èƒ½æŠŠæƒé™è‡ªåŠ¨ä¼ æ’­è¿‡å» Testing : æä¾›æµ‹è¯•æ”¯æŒ Run As : å…è®¸ä¸€ä¸ªç”¨æˆ·å‡è£…ä¸ºå¦ä¸€ä¸ªç”¨æˆ·(åœ¨ä»–ä»¬å…è®¸çš„æƒ…å†µä¸‹)çš„èº«ä»½è¿›è¡Œè®¿é—® Remember Me : è®°ä½æˆ‘,è¿™ä¸ªæ˜¯éå¸¸å¸¸è§çš„åŠŸèƒ½,å³ä¸€æ¬¡ç™»å½•å,ä¸‹æ¬¡ä¸ç”¨é‡å¤ç™»å½•äº† 4. Shiroæ¶æ„è¯¦è§£ Subject : ä¸»ä½“,å¯ä»¥çœ‹åˆ°ä¸»ä½“å¯ä»¥æ˜¯ä»»ä½•å¯ä»¥ä¸åº”ç”¨äº¤äº’çš„â€ç”¨æˆ·â€ SecurityManager : ç›¸å½“äºSpringMVCä¸­çš„DispatcherServletæˆ–Struts2ä¸­çš„FilterDispatcher; æ˜¯Shiroçš„å¿ƒè„. æ‰€æœ‰å…·ä½“çš„äº¤äº’éƒ½é€šè¿‡SecurityManagerè¿›è¡Œæ§åˆ¶,å®ƒç®¡ç†ç€æ‰€æœ‰Subjectã€ä¸”è´Ÿè´£è¿›è¡Œè®¤è¯å’Œæˆæƒã€åŠä¼šè¯ã€ç¼“å­˜çš„ç®¡ç† Authenticator : è®¤è¯å™¨,è´Ÿè´£ä¸»ä½“è®¤è¯çš„,è¿™æ˜¯ä¸€ä¸ªæ‰©å±•ç‚¹,å¦‚æœç”¨æˆ·è§‰å¾—Shiroé»˜è®¤çš„ä¸å¥½,å¯ä»¥è‡ªå®šä¹‰å®ç°. å…¶éœ€è¦è®¤è¯ç­–ç•¥(Authentication Strategy),å³ä»€ä¹ˆæƒ…å†µä¸‹ç®—ç”¨æˆ·è®¤è¯é€šè¿‡äº† Authrizer : æˆæƒå™¨,æˆ–è€…è®¿é—®æ§åˆ¶å™¨,ç”¨æ¥å†³å®šä¸»ä½“æ˜¯å¦æœ‰æƒé™è¿›è¡Œç›¸åº”çš„æ“ä½œ,å³æ§åˆ¶ç€ç”¨æˆ·èƒ½è®¿é—®åº”ç”¨ä¸­çš„å“ªäº›åŠŸèƒ½ Realm : å¯ä»¥æœ‰1ä¸ªæˆ–å¤šä¸ªRealm,å¯ä»¥è®¤ä¸ºæ˜¯å®‰å…¨å®ä½“æ•°æ®æº,å³ç”¨äºè·å–å®‰å…¨å®ä½“. å¯ä»¥æ˜¯JDBCå®ç°,ä¹Ÿå¯ä»¥æ˜¯LDAPå®ç°,æˆ–è€…å†…å­˜å®ç°ç­‰,ç”±ç”¨æˆ·æä¾›. æ³¨æ„ : Shiroä¸çŸ¥é“ä½ çš„ç”¨æˆ· / æƒé™å­˜å‚¨åœ¨å“ªåŠä»¥ä½•ç§æ ¼å¼å­˜å‚¨,æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬åœ¨åº”ç”¨ä¸­éƒ½éœ€è¦å®ç°è‡ªå·±çš„Realm SessionManager : å¦‚æœå†™è¿‡Servletå°±åº”è¯¥çŸ¥é“Sessionçš„æ¦‚å¿µ,Sessionéœ€è¦æœ‰äººå»ç®¡ç†å®ƒçš„ç”Ÿå‘½å‘¨æœŸ,è¿™ä¸ªç»„ä»¶å°±æ˜¯SessionManager,è€ŒShiroå¹¶ä¸ä»…ä»…å¯ä»¥ç”¨åœ¨Webç¯å¢ƒ,ä¹Ÿå¯ä»¥ç”¨åœ¨å¦‚æ™®é€šçš„JavaSEç¯å¢ƒã€EJBç­‰ç¯å¢ƒ. æ‰€ä»¥Shiroå°±æŠ½è±¡äº†ä¸€ä¸ªè‡ªå·±çš„Sessionæ¥ç®¡ç†ä¸»ä½“ä¸åº”ç”¨ä¹‹é—´äº¤äº’çš„æ•°æ®. è¿™æ ·çš„è¯,æ¯”å¦‚æˆ‘ä»¬åœ¨Webç¯å¢ƒç”¨,åˆšå¼€å§‹æ˜¯ä¸€å°WebæœåŠ¡å™¨,æ¥ç€åˆä¸Šäº†å°EJBæœåŠ¡å™¨,è¿™æ—¶æƒ³æŠŠä¸¤å°æœåŠ¡å™¨çš„ä¼šè¯æ•°æ®æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹,è¿™ä¸ªæ—¶å€™å°±å¯ä»¥å®ç°è‡ªå·±çš„åˆ†å¸ƒå¼ä¼šè¯(å¦‚æŠŠæ•°æ®æ”¾åˆ°MemcachedæœåŠ¡å™¨) SessionDAO : DAOå¤§å®¶éƒ½ç”¨è¿‡,æ•°æ®è®¿é—®å¯¹è±¡,ç”¨äºä¼šè¯çš„CRUD,æ¯”å¦‚æˆ‘ä»¬æƒ³æŠŠSessionä¿å­˜åˆ°æ•°æ®åº“,é‚£ä¹ˆå¯ä»¥å®ç°è‡ªå·±çš„ SessionDAO,é€šè¿‡å¦‚JDBCå†™åˆ°æ•°æ®åº“. æ¯”å¦‚æƒ³æŠŠSessionæ”¾åˆ°Memcachedä¸­,å¯ä»¥å®ç°è‡ªå·±çš„Memcached SessionDAO. å¦å¤–SessionDAOä¸­å¯ä»¥ä½¿ç”¨Cacheè¿›è¡Œç¼“å­˜,ä»¥æé«˜æ€§èƒ½ CacheManager : ç¼“å­˜æ§åˆ¶å™¨,æ¥ç®¡ç†å¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ç­‰çš„ç¼“å­˜çš„. å› ä¸ºè¿™äº›æ•°æ®åŸºæœ¬ä¸Šå¾ˆå°‘å»æ”¹å˜,æ”¾åˆ°ç¼“å­˜ä¸­åå¯ä»¥æé«˜è®¿é—®çš„æ€§èƒ½ Cryptography : å¯†ç æ¨¡å—,Shiroæé«˜äº†ä¸€äº›å¸¸è§çš„åŠ å¯†ç»„ä»¶ç”¨äºå¦‚å¯†ç åŠ å¯† / è§£å¯† å‚è€ƒèµ„æ–™ https://www.infoq.cn/article/apache-shiro/ http://shiro.apache.org/architecture.html https://mrbird.cc/tags/Shiro/ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/12/Shiro/01-Shiro%E7%AE%80%E4%BB%8B/"},{"title":"02.Shiroå…¥é—¨å®ä¾‹","text":"æœ¬ç¯‡ä¸ºShiroå…¥é—¨æ¡ˆä¾‹ï¼Œä½¿ç”¨Spring Booté›†æˆã€‚ 1. å¼•å…¥åæ ‡ä¾èµ–æœ‰ä¸¤ç§æ–¹å¼å¼•å…¥jaråŒ… SpringBoot starteræ–¹å¼ï¼ˆæ¨èï¼‰ shiro-spring 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt;&lt;/dependency&gt; æˆ–è€… 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt;&lt;/dependency&gt; 2. åˆ›å»ºiniæ–‡ä»¶Shiroæœ€åŸºç¡€çš„é…ç½®æ–¹å¼ï¼Œå­˜å‚¨ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼ˆå³ç”¨æˆ·åå’Œå¯†ç ï¼‰ 12[users]lujiahao=123 3. ä¸»ä½“ä»£ç ç¼–å†™è¿™é‡Œæˆ‘æœ‰ç‚¹å·æ‡’äº†ï¼Œç›´æ¥åœ¨Applicationçš„mainæ–¹æ³•å†™äº†ï¼Œä½ å¯ä»¥ä½¿ç”¨å•å…ƒæµ‹è¯•çš„å†™æ³•ï¼Œè¿™æ ·æ›´åŠ ä¸“ä¸šäº›ã€‚ 1234567891011121314151617181920212223242526272829303132@SpringBootApplicationpublic class ShiroIniApplication { public static void main(String[] args) { SpringApplication.run(ShiroIniApplication.class, args); // 1.åŠ è½½é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºSecurityMangerå·¥å‚ Factory&lt;SecurityManager&gt; factory = new IniSecurityManagerFactory(\"classpath:shiro.ini\"); // 2.è·å¾—SecurityManagerå®ä¾‹å¯¹è±¡ SecurityManager securityManager = factory.getInstance(); // 3.å°†SecurityMangerç»‘å®šåˆ°å½“å‰è¿è¡Œç¯å¢ƒä¸­ SecurityUtils.setSecurityManager(securityManager); // 4.åˆ›å»ºå½“å‰ç™»å½•ä¸»ä½“ Subject currentUser = SecurityUtils.getSubject(); // 5.ç»‘å®šä¸»ä½“ç™»å½•çš„èº«ä»½å‡­è¯ï¼ˆå³è´¦æˆ·å¯†ç ï¼‰ UsernamePasswordToken token = new UsernamePasswordToken(\"lujiahao\", \"123\"); // 6.ä¸»ä½“ç™»å½• try { currentUser.login(token); System.out.println(\"ç”¨æˆ·èº«ä»½éªŒè¯ï¼š\" + currentUser.isAuthenticated()); } catch (UnknownAccountException e) { System.out.println(\"è´¦æˆ·ä¿¡æ¯é”™è¯¯ï¼šæ— æ­¤è´¦æˆ·ä¿¡æ¯\"); } catch (IncorrectCredentialsException e) { System.out.println(\"å¯†ç é”™è¯¯ï¼\"); } catch (Exception e) { e.printStackTrace(); } // 7.æ³¨é”€ç™»å½• currentUser.logout(); System.out.println(\"ç”¨æˆ·èº«ä»½éªŒè¯ï¼š\" + currentUser.isAuthenticated()); }} 4. è¿è¡Œç»“æœæ­£å¸¸æ‰§è¡Œï¼š 12ç”¨æˆ·èº«ä»½éªŒè¯ï¼štrueç”¨æˆ·èº«ä»½éªŒè¯ï¼šfalse è´¦æˆ·ä¸å­˜åœ¨ï¼š 12è´¦æˆ·ä¿¡æ¯é”™è¯¯ï¼šæ— æ­¤è´¦æˆ·ä¿¡æ¯ç”¨æˆ·èº«ä»½éªŒè¯ï¼šfalse ä¿®æ”¹ä»£ç ä¸­çš„ç”¨æˆ·åï¼Œä¸iniæ–‡ä»¶ä¸­ä¸ä¸€è‡´å³å¯ å¯†ç é”™è¯¯ï¼š 12å¯†ç é”™è¯¯ï¼ç”¨æˆ·èº«ä»½éªŒè¯ï¼šfalse ä¿®æ”¹ä»£ç ä¸­çš„å¯†ç ï¼Œä¸iniæ–‡ä»¶ä¸­ä¸ä¸€è‡´å³å¯ å‚è€ƒèµ„æ–™ http://shiro.apache.org/10-minute-tutorial.html https://juejin.im/post/5cff0cfc5188250d28510681 https://mrbird.cc/tags/Shiro/ ä»£ç è·å–https://github.com/lujiahao0708/LearnSpring Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/13/Shiro/02-Shiro%E5%85%A5%E9%97%A8%E5%AE%9E%E4%BE%8B/"},{"title":"04-Shiroè§’è‰²åŠæƒé™","text":"æˆæƒï¼Œä¹Ÿå«è®¿é—®æ§åˆ¶ï¼Œå³åœ¨åº”ç”¨ä¸­æ§åˆ¶è°èƒ½è®¿é—®å“ªäº›èµ„æº(å¦‚è®¿é—®é¡µé¢/ç¼–è¾‘æ•°æ®/é¡µé¢æ“ä½œç­‰)ã€‚ 1. ç›¸å…³æ¦‚å¿µåœ¨æˆæƒä¸­éœ€äº†è§£çš„å‡ ä¸ªå…³é”®å¯¹è±¡ï¼šä¸»ä½“(Subject)ã€èµ„æº(Resource)ã€æƒé™(Permission)ã€è§’è‰²(Role)ï¼Œå…¶è§£æå¦‚ä¸‹æ‰€ç¤ºï¼š ä¸»ä½“ : å³è®¿é—®åº”ç”¨çš„ç”¨æˆ·ï¼Œåœ¨Shiroä¸­ä½¿ç”¨Subjectä»£è¡¨è¯¥ç”¨æˆ·ã€‚ç”¨æˆ·åªæœ‰æˆæƒåæ‰å…è®¸è®¿é—®ç›¸åº”çš„èµ„æºã€‚ èµ„æº : åœ¨åº”ç”¨ä¸­ç”¨æˆ·å¯ä»¥è®¿é—®çš„ä»»ä½•èµ„æºï¼Œæ¯”å¦‚è®¿é—®JSPé¡µé¢ã€æŸ¥çœ‹/ç¼–è¾‘æŸäº›æ•°æ®ã€è®¿é—®æŸä¸ªä¸šåŠ¡æ–¹æ³•ã€æ‰“å°æ–‡æœ¬ç­‰ç­‰ç”¨æˆ·éœ€è¦æˆæƒåæ–¹å¯è®¿é—®ã€‚ æƒé™ : å®‰å…¨ç­–ç•¥ä¸­çš„åŸå­æˆæƒå•ä½,å¯ç”¨æƒé™æ§åˆ¶ç”¨æˆ·åœ¨åº”ç”¨ä¸­æ˜¯å¦èƒ½è®¿é—®æŸä¸ªèµ„æº,å¦‚è®¿é—®ç”¨æˆ·åˆ—è¡¨é¡µé¢,æŸ¥çœ‹/æ–°å¢/ä¿®æ”¹/åˆ é™¤ç”¨æˆ·æ•°æ®(åŸºæœ¬ä¸ºCRUDå¼æƒé™æ§åˆ¶)ã€‚ è§’è‰² : è§’è‰²ä»£è¡¨äº†æ“ä½œé›†åˆ,å¯ä»¥ç†è§£ä¸ºæƒé™çš„é›†åˆ,ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šèµ‹äºˆç”¨æˆ·è§’è‰²è€Œä¸æ˜¯æƒé™,å³è¿™æ ·ç”¨æˆ·å¯ä»¥æ‹¥æœ‰ä¸€ç»„æƒé™,ä¸åŒçš„è§’è‰²æ‹¥æœ‰ä¸€ç»„ä¸åŒçš„æƒé™ã€‚ éšå¼è§’è‰² : å³ç›´æ¥é€šè¿‡è§’è‰²æ¥éªŒè¯ç”¨æˆ·æœ‰æ²¡æœ‰æ“ä½œæƒé™ï¼Œå³ç²’åº¦æ˜¯ä»¥è§’è‰²ä¸ºå•ä½è¿›è¡Œè®¿é—®æ§åˆ¶çš„ï¼Œç²’åº¦è¾ƒç²—ã€‚è‹¥è¿›è¡Œå˜æ›´å¯èƒ½éœ€è¦å¤šå¤„ä»£ç çš„ä¿®æ”¹ã€‚ æ˜¾ç¤ºè§’è‰² : åœ¨ç¨‹åºä¸­é€šè¿‡æƒé™æ§åˆ¶è°èƒ½è®¿é—®æŸä¸ªèµ„æºï¼Œè§’è‰²èšåˆä¸€ç»„æƒé™é›†åˆã€‚è¿™æ ·è‹¥éœ€è¦å“ªä¸ªè§’è‰²ä¸èƒ½è®¿é—®æŸä¸ªèµ„æºï¼Œåªéœ€è¦ä»è§’è‰²ä»£è¡¨çš„æƒé™é›†åˆä¸­ç§»é™¤æŒ‡å®šçš„è®¿é—®æƒé™å³å¯ï¼Œæ— é¡»ä¿®æ”¹å¤šå¤„ä»£ç ã€‚ 2. æˆæƒæ–¹å¼Shiroæœ‰ä¸‰ç§æˆæƒæ–¹å¼ï¼š 2.1 ç¼–ç¨‹æ–¹å¼123456Subject subject = SecurityUtils.getSubject();if(subject.hasRole(\"admin\")) { //æœ‰æƒé™} else { // æ— æƒé™} 2.2 æ³¨è§£æ–¹å¼1234@RequiresRoles(\"admin\")public void hello() { // æœ‰æƒé™} 2.3 jspæ ‡ç­¾å½¢å¼123&lt;shiro:hasRole name=\"admin\"&gt;// æœ‰æƒé™&lt;/shiro:hasRole&gt; 3. iniæ–¹å¼éªŒè¯è§’è‰²å’Œæƒé™3.1 shiro-roles.ini1234567891011[users]# ç”¨æˆ·lujiahaoçš„å¯†ç æ˜¯123ï¼Œæ‹¥æœ‰role1å’Œrole2ä¸¤ä¸ªè§’è‰²lujiahao=123,role1,role2zhangsan=321,role3[roles]# è§’è‰²role1å¯¹èµ„æºuseræ‹¥æœ‰createå’Œupdateæƒé™role1=user:create,user:update# è§’è‰²role2å¯¹èµ„æºuseræ‹¥æœ‰deleteæƒé™role2=user:deleterole3=user:update é…ç½®è§„åˆ™ï¼š ç”¨æˆ·å=å¯†ç ,è§’è‰²1,è§’è‰²2... è§’è‰²=æƒé™1,æƒé™2... æƒé™å­—ç¬¦ä¸²çš„è§„åˆ™ï¼šæ“ä½œ:èµ„æºå®ä¾‹æ ‡è¯†ç¬¦ å¯ä»¥ä½¿ç”¨*é€šé…ç¬¦ egï¼š ç”¨æˆ·åˆ›å»ºæƒé™ï¼šuser:create ç”¨æˆ·ä¿®æ”¹å®ä¾‹001çš„æƒé™ï¼šuser:update:0013.2 æµ‹è¯•ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748@Testpublic void testRole() { // ç”¨æˆ·ç™»å½•ï¼Œæˆæƒæ“ä½œçš„å‰ææ˜¯ç”¨æˆ·å·²ç»é€šè¿‡è®¤è¯ Subject subject = this.doLogin(\"shiro-roles.ini\", \"lujiahao\", \"123\"); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªè§’è‰² trueï¼šæ‹¥æœ‰ falseï¼šæ²¡æœ‰\"); System.out.println(subject.hasRole(\"role1\")); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰è§’è‰² trueï¼šå…¨éƒ¨æ‹¥æœ‰ falseï¼šä¸å…¨éƒ¨æ‹¥æœ‰\"); System.out.println(subject.hasAllRoles(Arrays.asList(\"role1\", \"role2\", \"role3\"))); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰è§’è‰²ï¼Œè¿”å›booleanç±»å‹æ•°ç»„ trueï¼šæ‹¥æœ‰ falseï¼šæ²¡æœ‰\"); System.out.println(Arrays.toString(subject.hasRoles(Arrays.asList(\"role1\", \"role2\", \"role3\")))); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªè§’è‰² æ‹¥æœ‰ï¼šæ— å¼‚å¸¸ æ²¡æœ‰ï¼šæŠ¥UnauthorizedExceptionå¼‚å¸¸\"); subject.checkRole(\"role1\"); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰è§’è‰² æ‹¥æœ‰ï¼šæ— å¼‚å¸¸ æ²¡æœ‰ï¼šæŠ¥UnauthorizedExceptionå¼‚å¸¸\"); subject.checkRoles(\"role1\", \"role2\"); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰è§’è‰² æ‹¥æœ‰ï¼šæ— å¼‚å¸¸ æ²¡æœ‰ï¼šæŠ¥UnauthorizedExceptionå¼‚å¸¸\"); subject.checkRoles(Arrays.asList(\"role1\", \"role2\"));}@Testpublic void testPermission() { // ç”¨æˆ·ç™»å½•ï¼Œæˆæƒæ“ä½œçš„å‰ææ˜¯ç”¨æˆ·å·²ç»é€šè¿‡è®¤è¯ Subject subject = this.doLogin(\"shiro-roles.ini\", \"lujiahao\", \"123\"); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªæƒé™ trueï¼šæ‹¥æœ‰ falseï¼šæ²¡æœ‰\"); System.out.println(subject.isPermitted(\"user:list\")); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰æƒé™ trueï¼šå…¨éƒ¨æ‹¥æœ‰ falseï¼šä¸å…¨éƒ¨æ‹¥æœ‰\"); System.out.println(subject.isPermittedAll(\"user:delete\", \"user:update\", \"user:create\")); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æƒé™ï¼Œè¿”å›booleanç±»å‹æ•°ç»„ trueï¼šæ‹¥æœ‰ falseï¼šæ²¡æœ‰\"); System.out.println(Arrays.toString(subject.isPermitted(\"user:list\", \"user:update\", \"user:create\"))); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªæƒé™ æ‹¥æœ‰ï¼šæ— å¼‚å¸¸ æ²¡æœ‰ï¼šæŠ¥UnauthorizedExceptionå¼‚å¸¸\"); subject.checkPermission(\"user:update\"); System.out.println(\"éªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰æƒé™ æ‹¥æœ‰ï¼šæ— å¼‚å¸¸ æ²¡æœ‰ï¼šæŠ¥UnauthorizedExceptionå¼‚å¸¸\"); subject.checkPermissions(\"user:delete\", \"user:update\", \"user:create\");} 4. è‡ªå®šä¹‰RealméªŒè¯è§’è‰²å’Œæƒé™4.1 shiro-permission-realm.ini1234# å£°æ˜ä¸€ä¸ªrealmmyRealm=com.lujiahao.PermissionRealm# æŒ‡å®šsecuritymanagerçš„realmså®ç°securityManager.realms=$myRealm 4.2 è‡ªå®šä¹‰Realm1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556/** * è‡ªå®šä¹‰realmå®ç° * * @author lujiahao * @date 2019/10/14 */public class PermissionRealm extends AuthorizingRealm { @Override public String getName() { return \"permissionRealm\"; } /** * ç”¨æˆ·æƒé™å’Œè§’è‰² */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) { // å½“å‰ç”¨æˆ·ç™»å½•ä¿¡æ¯ String username = (String) principalCollection.getPrimaryPrincipal(); // æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·è§’è‰²å’Œæƒé™ List&lt;String&gt; roles = new ArrayList&lt;&gt;(); List&lt;String&gt; permissions = new ArrayList&lt;&gt;(); roles.add(\"role1\"); permissions.add(\"user:read\"); // å¢åŠ æƒé™ SimpleAuthorizationInfo info = new SimpleAuthorizationInfo(); info.addRoles(roles); info.addStringPermissions(permissions); return info; } /** * ç”¨æˆ·è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // è·å–ç”¨æˆ·ä¿¡æ¯ String username = (String) token.getPrincipal(); // æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–ç”¨æˆ·åå’Œå¯†ç  String dbUsername = \"lujiahao\"; String dbPassword = \"123\"; // éªŒè¯ç”¨æˆ· if (!dbUsername.equals(username)) { return null; } // å‚æ•°åˆ—è¡¨ä¾æ¬¡æ˜¯ï¼š ç”¨æˆ·å å¯†ç  å½“å‰realmåå­— SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(username, dbPassword, getName()); return info; }} 4.3 æµ‹è¯•ä»£ç 12345678@Testpublic void testPermissionRealm() { // ç”¨æˆ·ç™»å½•ï¼Œæˆæƒæ“ä½œçš„å‰ææ˜¯ç”¨æˆ·å·²ç»é€šè¿‡è®¤è¯ Subject subject = this.doLogin(\"shiro-permission-realm.ini\", \"lujiahao\", \"123\"); System.out.println(subject.isPermitted(\"user:read\")); System.out.println(subject.hasRole(\"role1\"));} å‚è€ƒèµ„æ–™ http://shiro.apache.org/10-minute-tutorial.html https://mrbird.cc/tags/Shiro/ ä»£ç è·å–https://github.com/lujiahao0708/LearnSpring Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/15/Shiro/04-Shiro%E8%A7%92%E8%89%B2%E5%8F%8A%E6%9D%83%E9%99%90/"},{"title":"06-Shiroä¸Spring Bootç”¨æˆ·è®¤è¯","text":"Spring Bootä¸Shiroæ•´åˆæ¡ˆä¾‹ï¼Œç”¨æˆ·è®¤è¯éƒ¨åˆ†ã€‚ Spring Booté›†æˆShiroä¸»è¦é…ç½®ä¸¤ä¸ªç±»ï¼š ShiroConfigç±»åŠç»§æ‰¿AuthorizingRealmçš„Realmç±»ã€‚ ShiroConfigï¼šæ˜¯Shiroçš„é…ç½®ï¼Œç›¸å½“äºSpringä¸­çš„xmlé…ç½®ã€‚åŒ…æ‹¬ï¼šåŒ…æ‹¬è¿‡æ»¤å™¨(ShiroFilter)ã€å®‰å…¨äº‹åŠ¡ç®¡ç†å™¨(SecurityManager)ã€å¯†ç å‡­è¯åŒ¹é…å™¨(CredentialsMatcher)ã€ç¼“å†²ç®¡ç†å™¨(EhCacheManager)ã€AOPæ³¨è§£æ”¯æŒ(authorizationAttributeSourceAdvisor)ã€ç­‰ç­‰ UserRealmï¼šè‡ªå®šä¹‰çš„UserRealmç»§æ‰¿è‡ªAuthorizingRealmï¼Œé‡å†™doGetAuthorizationInfo(æˆæƒè®¤è¯)å’ŒdoGetAuthenticationInfo(ç™»é™†è®¤è¯)è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ 1. ä¾èµ–1234567891011121314151617181920212223242526272829303132333435&lt;dependencies&gt; &lt;!-- MyBatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- thymeleaf --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring-boot-web-starter&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.15&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 2. ShiroConfig123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657@Configurationpublic class ShiroConfig { /** * è¿‡æ»¤è§„åˆ™ */ @Bean public ShiroFilterFactoryBean shiroFilterFactoryBean(SecurityManager securityManager) { ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean(); // è®¾ç½®securityManager shiroFilterFactoryBean.setSecurityManager(securityManager); // ç™»å½•çš„url shiroFilterFactoryBean.setLoginUrl(\"/login\"); // ç™»å½•æˆåŠŸåè·³è½¬çš„url shiroFilterFactoryBean.setSuccessUrl(\"/index\"); // æœªæˆæƒurl shiroFilterFactoryBean.setUnauthorizedUrl(\"/403\"); // LinkedHashMapæ˜¯æœ‰åºçš„ï¼Œshiroä¼šæŒ‰ç…§é¡ºåºä¾æ¬¡åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸå°±ä¸éªŒè¯äº†ï¼Œå› æ­¤ä¸‹é¢çš„urlæ˜¯è¾ƒä¸ºå®½æ¾çš„ // ä¸Šé¢çš„urlæ˜¯æ¯”è¾ƒä¸¥æ ¼çš„ \"/**\"ä¸€å®šè¦æ”¾åœ¨æœ€å Map&lt;String, String&gt; filterChainDefinitionMap = new LinkedHashMap&lt;&gt;(); // å®šä¹‰filterChainï¼Œé™æ€èµ„æºä¸æ‹¦æˆª filterChainDefinitionMap.put(\"/css/**\", \"anon\"); filterChainDefinitionMap.put(\"/js/**\", \"anon\"); filterChainDefinitionMap.put(\"/fonts/**\", \"anon\"); filterChainDefinitionMap.put(\"/img/**\", \"anon\"); // é…ç½®é€€å‡ºè¿‡æ»¤å™¨ï¼Œå…¶ä¸­å…·ä½“çš„é€€å‡ºä»£ç Shiroå·²ç»æ›¿æˆ‘ä»¬å®ç°äº† filterChainDefinitionMap.put(\"/logout\", \"logout\"); // é™¤ä¸Šä»¥å¤–æ‰€æœ‰urléƒ½å¿…é¡»è®¤è¯é€šè¿‡æ‰å¯ä»¥è®¿é—®ï¼Œæœªé€šè¿‡è®¤è¯è‡ªåŠ¨è®¿é—®LoginUrl filterChainDefinitionMap.put(\"/**\", \"authc\"); shiroFilterFactoryBean.setFilterChainDefinitionMap(filterChainDefinitionMap); return shiroFilterFactoryBean; } /** * å®‰å…¨ç®¡ç†å™¨ * æ³¨ï¼šä½¿ç”¨shiro-spring-boot-starter 1.4æ—¶ï¼Œè¿”å›ç±»å‹æ˜¯SecurityManagerä¼šæŠ¥é”™ï¼Œç›´æ¥å¼•ç”¨shiro-springåˆ™ä¸æŠ¥é”™ */ @Bean public DefaultWebSecurityManager securityManager(){ DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(userRealm()); return securityManager; } /** * è‡ªå®šä¹‰realm */ @Bean public UserRealm userRealm(){ UserRealm userRealm = new UserRealm(); return userRealm; }} 3. è‡ªå®šä¹‰Realm12345678910111213141516171819202122232425262728293031323334353637383940@Slf4jpublic class UserRealm extends AuthorizingRealm { @Autowired private UserMapper userMapper; /** * è·å–ç”¨æˆ·è§’è‰²å’Œæƒé™ */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principal) { return null; } /** * ç™»å½•è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // è·å–ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç  String userName = (String) token.getPrincipal(); String password = new String((char[]) token.getCredentials()); log.info(\"ç”¨æˆ·:{} æ‰§è¡Œç™»å½•è®¤è¯æ“ä½œ\", userName); // é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ User user = userMapper.findByUserName(userName); if (user == null) { throw new UnknownAccountException(\"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼\"); } if (!password.equals(user.getPassword())) { throw new IncorrectCredentialsException(\"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼\"); } SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(user, password, getName()); return info; }} 4. Service/Mapper/SQL å‚è€ƒå·¥ç¨‹ä¸­çš„data.sql 5. htmlç™»å½•ç•Œé¢ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html xmlns:th=\"http://www.thymeleaf.org\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;ç™»å½•&lt;/title&gt; &lt;script src=\"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=\"login-page\"&gt; &lt;div class=\"form\"&gt; &lt;input type=\"text\" placeholder=\"ç”¨æˆ·å\" name=\"username\" required=\"required\"/&gt;&lt;br/&gt; &lt;input type=\"password\" placeholder=\"å¯†ç \" name=\"password\" required=\"required\"/&gt;&lt;br/&gt; &lt;button onclick=\"login()\"&gt;ç™»å½•&lt;/button&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;script th:inline=\"javascript\"&gt; function login() { var username = $(\"input[name='username']\").val(); var password = $(\"input[name='password']\").val(); $.ajax({ type: \"post\", url: \"/login\", data: {\"username\": username,\"password\": password}, dataType: \"json\", success: function (r) { if (r.code == 0) { location.href = '/index'; } else { alert(r.msg); } } }); }&lt;/script&gt;&lt;/html&gt; é¦–é¡µï¼š 123456789101112&lt;!DOCTYPE html&gt;&lt;html xmlns:th=\"http://www.thymeleaf.org\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;é¦–é¡µ&lt;/title&gt; &lt;script src=\"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;ä½ å¥½ï¼[[${user.username}]]&lt;/p&gt;&lt;a th:href=\"@{/logout}\"&gt;æ³¨é”€&lt;/a&gt;&lt;/body&gt;&lt;/html&gt; å‚è€ƒèµ„æ–™ http://shiro.apache.org/10-minute-tutorial.html https://mrbird.cc/tags/Shiro/ ä»£ç è·å–https://github.com/lujiahao0708/LearnSpring Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/17/Shiro/06-Shiro%E4%B8%8ESpring%20Boot%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81/"},{"title":"05-Shiroæ‹¦æˆªå™¨","text":"Shiroå†…ç½®äº†å¾ˆå¤šé»˜è®¤çš„æ‹¦æˆªå™¨ï¼Œæ¯”å¦‚èº«ä»½éªŒè¯ã€æˆæƒç­‰ç›¸å…³çš„ã€‚ æ‹¦æˆªå™¨åˆ—è¡¨ Filter Name Class Description anon org.apache.shiro.web.filter.authc.AnonymousFilter åŒ¿åæ‹¦æˆªå™¨ï¼Œå³ä¸éœ€è¦ç™»å½•å³å¯è®¿é—®ï¼›ä¸€èˆ¬ç”¨äºé™æ€èµ„æºè¿‡æ»¤ï¼›ç¤ºä¾‹/static/**=anon authc org.apache.shiro.web.filter.authc.FormAuthenticationFilter åŸºäºè¡¨å•çš„æ‹¦æˆªå™¨ï¼›å¦‚/**=authcï¼Œå¦‚æœæ²¡æœ‰ç™»å½•ä¼šè·³åˆ°ç›¸åº”çš„ç™»å½•é¡µé¢ç™»å½• authcBasic org.apache.shiro.web.filter.authc.BasicHttpAuthenticationFilter Basic HTTPèº«ä»½éªŒè¯æ‹¦æˆªå™¨ logout org.apache.shiro.web.filter.authc.LogoutFilter é€€å‡ºæ‹¦æˆªå™¨ï¼Œä¸»è¦å±æ€§ï¼šredirectUrlï¼šé€€å‡ºæˆåŠŸåé‡å®šå‘çš„åœ°å€ï¼ˆ/ï¼‰ï¼Œç¤ºä¾‹/logout=logout noSessionCreation org.apache.shiro.web.filter.session.NoSessionCreationFilter ä¸åˆ›å»ºä¼šè¯æ‹¦æˆªå™¨ï¼Œè°ƒç”¨subject.getSession(false)ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœsubject.getSession(true)å°†æŠ›å‡ºDisabledSessionExceptionå¼‚å¸¸ perms org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter æƒé™æˆæƒæ‹¦æˆªå™¨ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼›å±æ€§å’Œrolesä¸€æ ·ï¼›ç¤ºä¾‹/user/**=perms[â€œuser:createâ€] port org.apache.shiro.web.filter.authz.PortFilter ç«¯å£æ‹¦æˆªå™¨ï¼Œä¸»è¦å±æ€§port(80)ï¼šå¯ä»¥é€šè¿‡çš„ç«¯å£ï¼›ç¤ºä¾‹/test= port[80]ï¼Œå¦‚æœç”¨æˆ·è®¿é—®è¯¥é¡µé¢æ˜¯é80ï¼Œå°†è‡ªåŠ¨å°†è¯·æ±‚ç«¯å£æ”¹ä¸º80å¹¶é‡å®šå‘åˆ°è¯¥80ç«¯å£ï¼Œå…¶ä»–è·¯å¾„/å‚æ•°ç­‰éƒ½ä¸€æ · rest org.apache.shiro.web.filter.authz.HttpMethodPermissionFilter resté£æ ¼æ‹¦æˆªå™¨ï¼Œè‡ªåŠ¨æ ¹æ®è¯·æ±‚æ–¹æ³•æ„å»ºæƒé™å­—ç¬¦ä¸²ï¼›ç¤ºä¾‹/users=rest[user]ï¼Œä¼šè‡ªåŠ¨æ‹¼å‡ºuser:read,user:create,user:update,user:deleteæƒé™å­—ç¬¦ä¸²è¿›è¡Œæƒé™åŒ¹é…ï¼ˆæ‰€æœ‰éƒ½å¾—åŒ¹é…ï¼ŒisPermittedAllï¼‰ roles org.apache.shiro.web.filter.authz.RolesAuthorizationFilter è§’è‰²æˆæƒæ‹¦æˆªå™¨ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰è§’è‰²ï¼›ç¤ºä¾‹/admin/**=roles[admin] ssl org.apache.shiro.web.filter.authz.SslFilter SSLæ‹¦æˆªå™¨ï¼Œåªæœ‰è¯·æ±‚åè®®æ˜¯httpsæ‰èƒ½é€šè¿‡ï¼›å¦åˆ™è‡ªåŠ¨è·³è½¬ä¼šhttpsç«¯å£443ï¼›å…¶ä»–å’Œportæ‹¦æˆªå™¨ä¸€æ ·ï¼› user org.apache.shiro.web.filter.authc.UserFilter ç”¨æˆ·æ‹¦æˆªå™¨ï¼Œç”¨æˆ·å·²ç»èº«ä»½éªŒè¯/è®°ä½æˆ‘ç™»å½•çš„éƒ½å¯ï¼›ç¤ºä¾‹/**=user anon,authcBasic,auchc,useræ˜¯è®¤è¯è¿‡æ»¤å™¨. perms,roles,ssl,rest,portæ˜¯æˆæƒè¿‡æ»¤å™¨ å‚è€ƒèµ„æ–™ http://shiro.apache.org/10-minute-tutorial.html https://mrbird.cc/tags/Shiro/ ä»£ç è·å–https://github.com/lujiahao0708/LearnSpring Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/16/Shiro/05-Shiro%E6%8B%A6%E6%88%AA%E5%99%A8/"},{"title":"07-Shiroä¸Spring Bootç”¨æˆ·æˆæƒ.md","text":"Spring Bootä¸Shiroæ•´åˆæ¡ˆä¾‹ï¼Œç”¨æˆ·æˆæƒéƒ¨åˆ†ã€‚ Spring Booté›†æˆShiroä¸»è¦é…ç½®ä¸¤ä¸ªç±»ï¼š ShiroConfigç±»åŠç»§æ‰¿AuthorizingRealmçš„Realmç±»ã€‚ ShiroConfigï¼šæ˜¯Shiroçš„é…ç½®ï¼Œç›¸å½“äºSpringä¸­çš„xmlé…ç½®ã€‚åŒ…æ‹¬ï¼šåŒ…æ‹¬è¿‡æ»¤å™¨(ShiroFilter)ã€å®‰å…¨äº‹åŠ¡ç®¡ç†å™¨(SecurityManager)ã€å¯†ç å‡­è¯åŒ¹é…å™¨(CredentialsMatcher)ã€ç¼“å†²ç®¡ç†å™¨(EhCacheManager)ã€AOPæ³¨è§£æ”¯æŒ(authorizationAttributeSourceAdvisor)ã€ç­‰ç­‰ UserRealmï¼šè‡ªå®šä¹‰çš„UserRealmç»§æ‰¿è‡ªAuthorizingRealmï¼Œé‡å†™doGetAuthorizationInfo(æˆæƒè®¤è¯)å’ŒdoGetAuthenticationInfo(ç™»é™†è®¤è¯)è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ 1. ä¾èµ–1234567891011121314151617181920212223242526272829303132333435&lt;dependencies&gt; &lt;!-- MyBatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- thymeleaf --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring-boot-web-starter&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.15&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 2. ShiroConfig123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657@Configurationpublic class ShiroConfig { /** * è¿‡æ»¤è§„åˆ™ */ @Bean public ShiroFilterFactoryBean shiroFilterFactoryBean(SecurityManager securityManager) { ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean(); // è®¾ç½®securityManager shiroFilterFactoryBean.setSecurityManager(securityManager); // ç™»å½•çš„url shiroFilterFactoryBean.setLoginUrl(\"/login\"); // ç™»å½•æˆåŠŸåè·³è½¬çš„url shiroFilterFactoryBean.setSuccessUrl(\"/index\"); // æœªæˆæƒurl shiroFilterFactoryBean.setUnauthorizedUrl(\"/403\"); // LinkedHashMapæ˜¯æœ‰åºçš„ï¼Œshiroä¼šæŒ‰ç…§é¡ºåºä¾æ¬¡åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸå°±ä¸éªŒè¯äº†ï¼Œå› æ­¤ä¸‹é¢çš„urlæ˜¯è¾ƒä¸ºå®½æ¾çš„ // ä¸Šé¢çš„urlæ˜¯æ¯”è¾ƒä¸¥æ ¼çš„ \"/**\"ä¸€å®šè¦æ”¾åœ¨æœ€å Map&lt;String, String&gt; filterChainDefinitionMap = new LinkedHashMap&lt;&gt;(); // å®šä¹‰filterChainï¼Œé™æ€èµ„æºä¸æ‹¦æˆª filterChainDefinitionMap.put(\"/css/**\", \"anon\"); filterChainDefinitionMap.put(\"/js/**\", \"anon\"); filterChainDefinitionMap.put(\"/fonts/**\", \"anon\"); filterChainDefinitionMap.put(\"/img/**\", \"anon\"); // é…ç½®é€€å‡ºè¿‡æ»¤å™¨ï¼Œå…¶ä¸­å…·ä½“çš„é€€å‡ºä»£ç Shiroå·²ç»æ›¿æˆ‘ä»¬å®ç°äº† filterChainDefinitionMap.put(\"/logout\", \"logout\"); // é™¤ä¸Šä»¥å¤–æ‰€æœ‰urléƒ½å¿…é¡»è®¤è¯é€šè¿‡æ‰å¯ä»¥è®¿é—®ï¼Œæœªé€šè¿‡è®¤è¯è‡ªåŠ¨è®¿é—®LoginUrl filterChainDefinitionMap.put(\"/**\", \"authc\"); shiroFilterFactoryBean.setFilterChainDefinitionMap(filterChainDefinitionMap); return shiroFilterFactoryBean; } /** * å®‰å…¨ç®¡ç†å™¨ * æ³¨ï¼šä½¿ç”¨shiro-spring-boot-starter 1.4æ—¶ï¼Œè¿”å›ç±»å‹æ˜¯SecurityManagerä¼šæŠ¥é”™ï¼Œç›´æ¥å¼•ç”¨shiro-springåˆ™ä¸æŠ¥é”™ */ @Bean public DefaultWebSecurityManager securityManager(){ DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(userRealm()); return securityManager; } /** * è‡ªå®šä¹‰realm */ @Bean public UserRealm userRealm(){ UserRealm userRealm = new UserRealm(); return userRealm; }} 3. è‡ªå®šä¹‰Realm12345678910111213141516171819202122232425262728293031323334353637383940@Slf4jpublic class UserRealm extends AuthorizingRealm { @Autowired private UserMapper userMapper; /** * è·å–ç”¨æˆ·è§’è‰²å’Œæƒé™ */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principal) { return null; } /** * ç™»å½•è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // è·å–ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç  String userName = (String) token.getPrincipal(); String password = new String((char[]) token.getCredentials()); log.info(\"ç”¨æˆ·:{} æ‰§è¡Œç™»å½•è®¤è¯æ“ä½œ\", userName); // é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ User user = userMapper.findByUserName(userName); if (user == null) { throw new UnknownAccountException(\"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼\"); } if (!password.equals(user.getPassword())) { throw new IncorrectCredentialsException(\"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼\"); } SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(user, password, getName()); return info; }} 4. Service/Mapper/SQL å‚è€ƒå·¥ç¨‹ä¸­çš„data.sql 5. htmlç™»å½•ç•Œé¢ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html xmlns:th=\"http://www.thymeleaf.org\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;ç™»å½•&lt;/title&gt; &lt;script src=\"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=\"login-page\"&gt; &lt;div class=\"form\"&gt; &lt;input type=\"text\" placeholder=\"ç”¨æˆ·å\" name=\"username\" required=\"required\"/&gt;&lt;br/&gt; &lt;input type=\"password\" placeholder=\"å¯†ç \" name=\"password\" required=\"required\"/&gt;&lt;br/&gt; &lt;button onclick=\"login()\"&gt;ç™»å½•&lt;/button&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;script th:inline=\"javascript\"&gt; function login() { var username = $(\"input[name='username']\").val(); var password = $(\"input[name='password']\").val(); $.ajax({ type: \"post\", url: \"/login\", data: {\"username\": username,\"password\": password}, dataType: \"json\", success: function (r) { if (r.code == 0) { location.href = '/index'; } else { alert(r.msg); } } }); }&lt;/script&gt;&lt;/html&gt; é¦–é¡µï¼š 123456789101112&lt;!DOCTYPE html&gt;&lt;html xmlns:th=\"http://www.thymeleaf.org\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;é¦–é¡µ&lt;/title&gt; &lt;script src=\"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js\"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;ä½ å¥½ï¼[[${user.username}]]&lt;/p&gt;&lt;a th:href=\"@{/logout}\"&gt;æ³¨é”€&lt;/a&gt;&lt;/body&gt;&lt;/html&gt; å‚è€ƒèµ„æ–™ http://shiro.apache.org/10-minute-tutorial.html https://mrbird.cc/tags/Shiro/ ä»£ç è·å–https://github.com/lujiahao0708/LearnSpring Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/18/Shiro/07-Shiro%E4%B8%8ESpring%20Boot%E7%94%A8%E6%88%B7%E6%8E%88%E6%9D%83/"},{"title":"ã€ŠElasticsearchæŠ€æœ¯è§£æä¸å®æˆ˜ã€‹Chapter 1.2 Elasticsearchå®‰è£…","text":"1. ä¸‹è½½å®‰è£…1.1 ä¸‹è½½12https://www.elastic.co/downloads/elasticsearchä¸‹è½½ https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.7.0.tar.gz 1.2 è§£å‹1tar -zxvf elasticsearch-6.7.0.tar.gz 1.3 è¿è¡Œ12cd elasticsearch-6.7.0bin/elasticsearch 1.4 æ£€éªŒ1234567891011121314curl http://localhost:9200 æˆ–è€…æµè§ˆå™¨è®¿é—®{ \"name\": \"q9sdES9\", \"cluster_name\": \"docker-cluster\", \"cluster_uuid\": \"6klEi4d0Q6y0LC3YNYVXTQ\", \"version\": { \"number\": \"5.5.0\", \"build_hash\": \"260387d\", \"build_date\": \"2017-06-30T23:16:05.735Z\", \"build_snapshot\": false, \"lucene_version\": \"6.6.0\" }, \"tagline\": \"You Know, for Search\"} 2. Dockeréƒ¨ç½² å®˜æ–¹æ–‡æ¡£ : https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html 2.1 æ‹‰å–é•œåƒ1docker pull docker.elastic.co/elasticsearch/elasticsearch:5.5.1 2.2 å¯åŠ¨å®¹å™¨1docker run -p 9200:9200 9300:9300 -e \"http.host=0.0.0.0\" -e â€œtransport.host=0.0.0.0\" --name elasticsearch_5.5.0 -d docker.elastic.co/elasticsearch/elasticsearch:5.5.0 2.3 ä¿®æ”¹é…ç½®12345è¿›å…¥åˆ°å®¹å™¨ä¸­ : docker exec -it elasticsearch_5.5.0 /bin/bashä¿®æ”¹jvmé…ç½® : vi /config/jvm.options -Xms2g â€”&gt; -Xms512m -Xmx2g â€”&gt; -Xmx512m ä¿®æ”¹å°ä¸€äº›,æœåŠ¡å™¨å†…å­˜æœ‰é™ğŸ˜‚ 2.4 é‡å¯å®¹å™¨,æŸ¥çœ‹æ˜¯å¦æˆåŠŸ123456789101112131415http://æœåŠ¡å™¨ip:9200{ \"name\": \"q9sdES9\", \"cluster_name\": \"docker-cluster\", \"cluster_uuid\": \"6klEi4d0Q6y0LC3YNYVXTQ\", \"version\": { \"number\": \"5.5.0\", \"build_hash\": \"260387d\", \"build_date\": \"2017-06-30T23:16:05.735Z\", \"build_snapshot\": false, \"lucene_version\": \"6.6.0\" }, \"tagline\": \"You Know, for Search\"}æ­¤å¤„é›†ç¾¤çš„åç§°ä¸º docker-cluster, å¯ä»¥è‡ªè¡Œä¿®æ”¹ : vi /config/elasticsearch.yml Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜åç»­ç¬”è®°æ¬¢è¿å…³æ³¨è·å–ç¬¬ä¸€æ—¶é—´æ›´æ–°ï¼","link":"/2019/04/14/%E3%80%8AElasticsearch%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Chapter%201.2%20Elasticsearch%E5%AE%89%E8%A3%85/"},{"title":"ã€ŠElasticsearchæŠ€æœ¯è§£æä¸å®æˆ˜ã€‹Chapter 1.3 Elasticsearchå¢åˆ æ”¹æŸ¥","text":"1. æ–°å¢æ–‡æ¡£ï¼Œå»ºç«‹ç´¢å¼•è¯­æ³•æ ¼å¼: PUT /index/type/id { &quot;jsonæ•°æ®&quot; }è¾“å…¥: PUT /person/chinese/1 { &quot;id&quot;:12345, &quot;name&quot;:&quot;lujiahao&quot;, &quot;age&quot;:18 }è¾“å‡º: { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 1, &quot;result&quot;: &quot;created&quot;, &quot;_shards&quot;: { &quot;total&quot;: 2, &quot;successful&quot;: 1, &quot;failed&quot;: 0 }, &quot;created&quot;: true } esä¼šè‡ªåŠ¨å»ºç«‹indexå’Œtypeï¼Œä¸éœ€è¦æå‰åˆ›å»ºï¼Œè€Œä¸”esé»˜è®¤ä¼šå¯¹documentæ¯ä¸ªfieldéƒ½å»ºç«‹å€’æ’ç´¢å¼•ï¼Œè®©å…¶å¯ä»¥è¢«æœç´¢ã€‚ 2. æ£€ç´¢æ–‡æ¡£æ ¼å¼: GET /index/type/idè¾“å…¥: GET /person/chinese/1è¾“å‡º: { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 1, &quot;found&quot;: true, &quot;_source&quot;: { &quot;id&quot;: 12345, &quot;name&quot;: &quot;lujiahao&quot;, &quot;age&quot;: 18 } }3. æ›´æ–°æ–‡æ¡£3.1 æ›¿æ¢æ–¹å¼æ ¼å¼: PUT /index/type/id { &quot;jsonæ•°æ®&quot; }è¾“å…¥: PUT /person/chinese/1 { &quot;name&quot;:&quot;lujiahao123&quot; }è¾“å‡º: { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 2, &quot;result&quot;: &quot;updated&quot;, &quot;_shards&quot;: { &quot;total&quot;: 2, &quot;successful&quot;: 1, &quot;failed&quot;: 0 }, &quot;created&quot;: false }æŸ¥è¯¢: { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 2, &quot;found&quot;: true, &quot;_source&quot;: { &quot;name&quot;: &quot;lujiahao123&quot; } } æ›¿æ¢æ–¹å¼æ›´æ–°æ–‡æ¡£æ—¶ï¼Œå¿…é¡»å¸¦ä¸Šæ‰€æœ‰çš„fieldï¼Œæ‰èƒ½å»è¿›è¡Œä¿¡æ¯çš„ä¿®æ”¹ï¼›å¦‚æœç¼ºå°‘fieldå°±ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ®ã€‚å…¶åŸç†æ—¶æ›¿æ¢ï¼Œå› æ­¤éœ€è¦å…¨éƒ¨å­—æ®µã€‚ä¸æ¨èæ­¤ç§æ–¹å¼æ›´æ–°æ–‡æ¡£ã€‚ 3.1 æ›´æ–°æ–¹å¼æ ¼å¼: POST /index/type/id/_update { &quot;doc&quot;:{ &quot;jsonæ•°æ®&quot; } }è¾“å…¥: POST /person/chinese/1/_update { &quot;doc&quot;:{ &quot;name&quot;:&quot;lujiahao10010&quot; } }è¾“å‡º: { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 4, &quot;result&quot;: &quot;updated&quot;, &quot;_shards&quot;: { &quot;total&quot;: 2, &quot;successful&quot;: 1, &quot;failed&quot;: 0 }, &quot;created&quot;: false }å†æ¬¡æŸ¥è¯¢ï¼š { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 6, &quot;found&quot;: true, &quot;_source&quot;: { &quot;id&quot;: 12345, &quot;name&quot;: &quot;lujiahao10010&quot;, &quot;age&quot;: 18 } }4. åˆ é™¤æ–‡æ¡£æ ¼å¼: DELETE /index/type/id/_update { &quot;doc&quot;:{ &quot;jsonæ•°æ®&quot; } }è¾“å…¥: DELETE /person/chinese/1è¾“å‡º: { &quot;found&quot;: true, &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;_version&quot;: 7, &quot;result&quot;: &quot;deleted&quot;, &quot;_shards&quot;: { &quot;total&quot;: 2, &quot;successful&quot;: 1, &quot;failed&quot;: 0 } }å†æ¬¡æŸ¥è¯¢: { &quot;_index&quot;: &quot;person&quot;, &quot;_type&quot;: &quot;chinese&quot;, &quot;_id&quot;: &quot;1&quot;, &quot;found&quot;: false }5. å°ç»“æœ¬æ–‡æ‰€æœ‰æ“ä½œéƒ½æ˜¯åœ¨kibanaçš„Dev toolsä¸­è¿›è¡Œçš„ï¼Œç›¸è¾ƒäºElasticsearch-Headeæ’ä»¶ï¼Œkibanaä¸­æ›´åŠ æ–¹ä¾¿ä¸ç¾è§‚ï¼ˆä¸ªäººè§‚ç‚¹ï¼‰ï¼Œæ¨èå¤§å®¶ä½¿ç”¨ã€‚ Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜åç»­ç¬”è®°æ¬¢è¿å…³æ³¨è·å–ç¬¬ä¸€æ—¶é—´æ›´æ–°ï¼","link":"/2019/04/15/%E3%80%8AElasticsearch%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Chapter%201.3%20Elasticsearch%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"},{"title":"ã€ŠElasticsearchæŠ€æœ¯è§£æä¸å®æˆ˜ã€‹Chapter 2.1 Elasticsearchç´¢å¼•å¢åˆ æ”¹æŸ¥","text":"1. åˆ›å»ºç´¢å¼•123456PUT /lujiahao123{ &quot;acknowledged&quot;: true, &quot;shards_acknowledged&quot;: true}ç´¢å¼•é»˜è®¤çš„ä¸»åˆ†ç‰‡æ•°é‡æ˜¯5ï¼Œæ¯ä¸ªä¸»åˆ†ç‰‡çš„å‰¯æœ¬æ•°é‡æ˜¯1ã€‚ åˆ›å»ºè‡ªå®šä¹‰å­—æ®µç±»å‹çš„ç´¢å¼•ï¼š 1234567891011121314151617181920212223PUT /order{ &quot;settings&quot;: { &quot;number_of_shards&quot;: 3, &quot;number_of_replicas&quot;: 2 }, &quot;mappings&quot;: { &quot;carpoolType&quot;:{ &quot;properties&quot;: { &quot;orderNo&quot;:{ &quot;type&quot;: &quot;string&quot;, &quot;index&quot;: &quot;not_analyzed&quot; } } } }}#! Deprecation: The [string] field is deprecated, please use [text] or [keyword] instead on [orderNo]{ &quot;acknowledged&quot;: true, &quot;shards_acknowledged&quot;: true}ES5.0ç‰ˆæœ¬ä¸­stringç±»å‹è¢«æ‹†åˆ†ä¸ºtextå’Œkeywordç±»å‹: https://www.elastic.co/blog/strings-are-dead-long-live-strings 2. ä¿®æ”¹ç´¢å¼•1234PUT /order/_settings{ &quot;number_of_replicas&quot;: 2} æ›´æ–°åˆ†è¯å™¨ 1234567891011121314POST /order/_closePUT /order/_settings{ &quot;analysis&quot;: { &quot;analyzer&quot;: { &quot;content&quot;:{ &quot;type&quot;:&quot;customer&quot;, &quot;tokenizer&quot;:&quot;whitespace&quot; } } }}POST /order/_openæ·»åŠ åˆ†æå™¨ä¹‹å‰å¿…é¡»å…ˆå…³é—­ç´¢å¼•ï¼Œæ·»åŠ ä¹‹åå†æ‰“å¼€ç´¢å¼•ã€‚ å°è¯•ä¿®æ”¹ç´¢å¼•ä¸»åˆ†ç‰‡æ•°ï¼š 1234PUT /order/_settings{ &quot;number_of_shards&quot;: 2} é”™è¯¯æç¤ºï¼š 123456789101112131415{ &quot;error&quot;: { &quot;root_cause&quot;: [ { &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;Can't update non dynamic settings [[index.number_of_shards]] for open indices [[order/2cOJ6Ga7THCyW10idoPPig]]&quot; } ], &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;Can't update non dynamic settings [[index.number_of_shards]] for open indices [[order/2cOJ6Ga7THCyW10idoPPig]]&quot; }, &quot;status&quot;: 400}ä¸»åˆ†ç‰‡æ˜¯æ— æ³•ä¿®æ”¹çš„ï¼Œä¸»åˆ†ç‰‡ä¸ªæ•°ä¸€æ—¦å»ºç«‹å°±æ— æ³•ä¿®æ”¹ï¼Œä½†æ˜¯çœ‹é”™è¯¯åŸå› é‡Œé¢è¯´å› ä¸ºè¿™ä¸ªæ˜¯opençš„ç´¢å¼•ï¼Œé‚£æ˜¯ä¸æ˜¯å…³é—­çš„ç´¢å¼•å°±å¯ä»¥ä¿®æ”¹ä¸»åˆ†ç‰‡ä¸ªæ•°äº†å‘¢ï¼Ÿè¿™ä¸ªæˆ‘ä»¬åé¢å†è§£ç­”ã€‚ 3. åˆ é™¤ç´¢å¼•123åˆ é™¤å•ä¸ªç´¢å¼•ï¼šDELETE /orderåˆ é™¤ç´¢å¼•éœ€è¦æŒ‡å®šç´¢å¼•åç§°ï¼Œåˆ«åæˆ–è€…é€šé…ç¬¦ 123åˆ é™¤å¤šä¸ªç´¢å¼•ï¼šDELETE order,order1,order2DELETE order* 123åˆ é™¤å…¨éƒ¨ç´¢å¼•ï¼šDELETE _allDELETE * ä½¿ç”¨_all å’Œé€šé…ç¬¦åˆ é™¤å…¨éƒ¨ç´¢å¼•ä¸ºäº†é˜²æ­¢è¯¯åˆ é™¤ï¼Œè®¾ç½®config/elasticsearch.ymlå±æ€§action.destructive_requires_name=trueï¼Œä»¥ç¦ç”¨é€šé…ç¬¦æˆ–_allåˆ é™¤ç´¢å¼•ã€‚ 4. æŸ¥è¯¢ç´¢å¼•123456789101112131415161718192021222324252627GET /order{ &quot;order&quot;: { &quot;aliases&quot;: {}, &quot;mappings&quot;: { &quot;carpoolType&quot;: { &quot;properties&quot;: { &quot;orderNo&quot;: { &quot;type&quot;: &quot;keyword&quot; } } } }, &quot;settings&quot;: { &quot;index&quot;: { &quot;creation_date&quot;: &quot;1555054886098&quot;, &quot;number_of_shards&quot;: &quot;3&quot;, &quot;number_of_replicas&quot;: &quot;2&quot;, &quot;uuid&quot;: &quot;uSh9K26CS_q1uZKaos7NRQ&quot;, &quot;version&quot;: { &quot;created&quot;: &quot;5050099&quot; }, &quot;provided_name&quot;: &quot;order&quot; } } }} è‡ªå®šä¹‰è¿”å›ç»“æœçš„å±æ€§ï¼š 123456789101112131415161718GET /order/_settings,_aliases{ &quot;order&quot;: { &quot;settings&quot;: { &quot;index&quot;: { &quot;creation_date&quot;: &quot;1555054886098&quot;, &quot;number_of_shards&quot;: &quot;3&quot;, &quot;number_of_replicas&quot;: &quot;2&quot;, &quot;uuid&quot;: &quot;uSh9K26CS_q1uZKaos7NRQ&quot;, &quot;version&quot;: { &quot;created&quot;: &quot;5050099&quot; }, &quot;provided_name&quot;: &quot;order&quot; } }, &quot;aliases&quot;: {} }} 5. æ‰“å¼€/å…³é—­ç´¢å¼•ç´¢å¼•å…³é—­åªèƒ½æ˜¾ç¤ºç´¢å¼•å…ƒæ•°æ®ä¿¡æ¯ï¼Œä¸èƒ½å¤Ÿè¿›è¡Œè¯»å†™ã€‚ 12345POST /order/_closePOST /order/_openhealth status index uuid pri rep docs.count docs.deleted store.size pri.store.sizeyellow open .kibana 8n5wnGEjRJ-aVa54l_jTjA 1 1 1 0 3.1kb 3.1kbyellow open order uSh9K26CS_q1uZKaos7NRQ 3 2 0 0 486b 486b å¯ä»¥åŒæ—¶æ‰“å¼€æˆ–å…³é—­å¤šä¸ªç´¢å¼•ã€‚å¦‚æœæŒ‡å‘ä¸å­˜åœ¨çš„ç´¢å¼•ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå¯é€šè¿‡é…ç½®ignore_unavailable=true å…³é—­å¼‚å¸¸æç¤ºã€‚ç¦æ­¢ä½¿ç”¨å…³é—­ç´¢å¼•åŠŸèƒ½ï¼Œé…ç½®settingscluster.indices.close.enableä¸ºfalseï¼Œé»˜è®¤å€¼æ˜¯tureã€‚ 6. å…³é—­ç´¢å¼•åå°è¯•ä¿®æ”¹ä¸»åˆ†ç‰‡ä¸ªæ•°1234567891011121314151617PUT /order/_settings{ &quot;number_of_shards&quot;: 2}{ &quot;error&quot;: { &quot;root_cause&quot;: [ { &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;final order setting [index.number_of_shards], not updateable&quot; } ], &quot;type&quot;: &quot;illegal_argument_exception&quot;, &quot;reason&quot;: &quot;final order setting [index.number_of_shards], not updateable&quot; }, &quot;status&quot;: 400} è§£ç­”äº†ä¹‹å‰çš„é—®é¢˜ï¼Œç´¢å¼•ä¸€æ—¦å»ºç«‹ï¼Œä¸»åˆ†ç‰‡æ•°é‡ä¸å¯æ”¹å˜ã€‚ Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜åç»­ç¬”è®°æ¬¢è¿å…³æ³¨è·å–ç¬¬ä¸€æ—¶é—´æ›´æ–°ï¼","link":"/2019/04/17/%E3%80%8AElasticsearch%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Chapter%202.1%20Elasticsearch%E7%B4%A2%E5%BC%95%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"},{"title":"ã€ŠElasticsearchæŠ€æœ¯è§£æä¸å®æˆ˜ã€‹Chapter 1.4 Spring Bootæ•´åˆElasticsearch","text":"1. spring-boot-starter-data-elasticsearch1.1 pom.xmlå’Œapplication.yml123456789101112&lt;!-- Spring Boot Elasticsearch ä¾èµ– --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;&lt;/dependency&gt;spring: data: elasticsearch: repositories: enabled: true cluster-name: docker-cluster cluster-nodes: lujiahao.ml:9300 1.2 åˆ›å»ºRepository1234@Repositorypublic interface PersonEsRepository extends ElasticsearchRepository&lt;Person,Long&gt; { List&lt;Person&gt; findPersonByName(String name);} 1.3 æ–‡æ¡£å®ä½“ç±»12345678910@Data@Document(indexName = \"person\", type = \"chinese\")public class Person implements Serializable{ private static final long serialVersionUID = -6804453833406105286L; @Id private Long id; private String name; private Integer age; private String address;} 1.4 å¢åˆ æ”¹æŸ¥1234567891011121314151617181920212223242526272829@Servicepublic class EsStarterService { @Autowired private PersonEsRepository repository; /** * å¢ */ public Person save(Person person) { return repository.save(person); } /** * åˆ  */ public void delete(Person person) { repository.delete(person); } /** * æ”¹ */ public Person update(Person person) { return repository.save(person); } /** * æŸ¥ */ public Iterable&lt;Person&gt; findAll() { return repository.findAll(); }} 1.5 å•å…ƒæµ‹è¯•1234567891011121314151617181920212223242526272829303132@RunWith(SpringRunner.class)@SpringBootTestpublic class EsStarterServiceTest { @Autowired private EsStarterService esStarterService; @Test public void save() { Person person = new Person(); person.setId(new Random().nextLong()); person.setName(\"lujiahao\"); esStarterService.save(person); } @Test public void delete() { Person person = new Person(); person.setId(-5264182431891613084L); person.setName(\"lujiahao123456\"); esStarterService.delete(person); } @Test public void update() { Person person = new Person(); person.setId(542136934419565287L); person.setName(\"lujiahao123456\"); esStarterService.update(person); } @Test public void findAll() { Iterable&lt;Person&gt; all = esStarterService.findAll(); all.forEach(System.out::println); }} 2. ElasticsearchTemplate2.1 pom.xmlå’Œapplication.ym123456789101112&lt;!--elasticsearch--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.data&lt;/groupId&gt; &lt;artifactId&gt;spring-data-elasticsearch&lt;/artifactId&gt;&lt;/dependency&gt;spring: data: elasticsearch: repositories: enabled: true cluster-name: docker-cluster cluster-nodes: lujiahao.ml:9300 2.2 æ–‡æ¡£å®ä½“ç±»åŒä¸Š 2.3 å¢åˆ æ”¹æŸ¥123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172@Servicepublic class ElasticsearchTemplateService { @Autowired public ElasticsearchTemplate elasticsearchTemplate; private static final String INDEX_NAME = \"person\"; private static final String TYPE_NAME = \"chinese\"; /** * å¢ */ public String save(Person person) { IndexQuery indexQuery = new IndexQueryBuilder() .withIndexName(INDEX_NAME) .withType(TYPE_NAME) .withId(String.valueOf(person.getId())) .withObject(person) .build(); String index = elasticsearchTemplate.index(indexQuery); System.out.println(\"xxxxxxxxxxxx \" + index); return index; } /** * åˆ  */ public void deleteByName(String name) { DeleteQuery deleteQuery = new DeleteQuery(); deleteQuery.setQuery(QueryBuilders.matchQuery(\"name\", name)); deleteQuery.setIndex(INDEX_NAME); deleteQuery.setType(TYPE_NAME); elasticsearchTemplate.delete(deleteQuery); } /** * æ”¹ */ public UpdateResponse update(Person person) { try { UpdateRequest updateRequest = new UpdateRequest() .index(INDEX_NAME) .type(TYPE_NAME) .id(String.valueOf(person.getId())) .doc(XContentFactory.jsonBuilder() .startObject() .field(\"name\", person.getName()) .endObject()); UpdateQuery updateQuery = new UpdateQueryBuilder() .withIndexName(INDEX_NAME) .withType(TYPE_NAME) .withId(String.valueOf(person.getId())) .withClass(Person.class) .withUpdateRequest(updateRequest) .build(); UpdateResponse update = elasticsearchTemplate.update(updateQuery); return update; } catch (Exception e) { return null; } } /** * æŸ¥ */ public List&lt;Person&gt; getAll() { SearchQuery searchQuery = new NativeSearchQueryBuilder() .withQuery(QueryBuilders.matchAllQuery()) .build(); return elasticsearchTemplate.queryForList(searchQuery, Person.class); }} 2.4 å•å…ƒæµ‹è¯•12345678910111213141516171819202122232425262728293031@RunWith(SpringRunner.class)@SpringBootTestpublic class ElasticsearchTemplateServiceTest { @Autowired private ElasticsearchTemplateService elasticsearchTemplateService; @Test public void save() { Person person = new Person(); person.setId(new Random().nextLong()); person.setName(\"haha\"); String save = elasticsearchTemplateService.save(person); System.out.println(save); } @Test public void deleteByName() { elasticsearchTemplateService.deleteByName(\"lujiahao\"); } @Test public void update() { Person person = new Person(); person.setId(-5264182431891613084L); person.setName(\"hahaaaaaaaaa\"); UpdateResponse update = elasticsearchTemplateService.update(person); System.out.println(update); } @Test public void getAll() { List&lt;Person&gt; all = elasticsearchTemplateService.getAll(); System.out.println(all); }} 3. ä»£ç ç¤ºä¾‹1https://github.com/lujiahao0708/LearnSeries/tree/master/LearnElasticSerach Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜åç»­ç¬”è®°æ¬¢è¿å…³æ³¨è·å–ç¬¬ä¸€æ—¶é—´æ›´æ–°ï¼","link":"/2019/04/16/%E3%80%8AElasticsearch%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Chapter%201.4%20Spring%20Boot%E6%95%B4%E5%90%88Elasticsearch/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 1ï¼šä¸ºä»€ä¹ˆè¦å…³å¿ƒJava 8","text":"è‡ª1998å¹´ JDK 1.0(Java 1.0) å‘å¸ƒä»¥æ¥ï¼ŒJava å·²ç»å—åˆ°äº†å­¦ç”Ÿã€é¡¹ç›®ç»ç†å’Œç¨‹åºå‘˜ç­‰ä¸€å¤§æ‰¹æ´»è·ƒç”¨æˆ·çš„æ¬¢è¿ã€‚è¿™ä¸€è¯­è¨€æå¯Œæ´»åŠ›ï¼Œä¸æ–­è¢«ç”¨åœ¨å¤§å¤§å°å°çš„é¡¹ç›®é‡Œã€‚ä» Java 1.1(1997å¹´) ä¸€ç›´åˆ° Java 7(2011å¹´)ï¼ŒJava é€šè¿‡å¢åŠ æ–°åŠŸèƒ½ï¼Œä¸æ–­å¾—åˆ°è‰¯å¥½çš„å‡çº§ã€‚Java 8 åˆ™æ˜¯åœ¨2014å¹´3æœˆå‘å¸ƒçš„ã€‚Java 8 æ‰€åšçš„æ”¹å˜ï¼Œåœ¨è®¸å¤šæ–¹é¢æ¯” Java å†å²ä¸Šä»»ä½•ä¸€æ¬¡æ”¹å˜éƒ½æ·±è¿œï¼Œè€Œä¸”æå¤§çš„æé«˜äº† Java ä»£ç çš„ç®€æ´æ€§ã€‚ 1. lambda è¡¨è¾¾å¼æœ¬æ–‡é€šè¿‡ç­›é€‰è‹¹æœçš„éœ€æ±‚å¼•å…¥ Java 8 ï¼Œå¯¹ inventory ä¸­çš„è‹¹æœæŒ‰ç…§é‡é‡è¿›è¡Œæ’åºã€‚Java 8 ä¹‹å‰çš„ç‰ˆæœ¬ï¼š 12345Collections.sort(inventory, new Comparator&lt;Apple&gt;() { public int compare(Apple a1, Apple a2){ return a1.getWeight().compareTo(a2.getWeight()); }}); Java 8 ç‰ˆæœ¬ï¼š 1inventory.sort(comparing(Apple::getWeight)); é€šè¿‡å¯¹æ¯”æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œä½¿ç”¨ Java 8 å¯ä»¥ç¼–å†™æ›´ä¸ºç®€æ´çš„ä»£ç ï¼Œè€Œä¸”ä»£ç è¯»èµ·æ¥æ›´æ¥è¿‘é—®é¢˜çš„æè¿°ã€‚ 2. æ–¹æ³•å¼•ç”¨åœ¨ Java 8 ä¹‹å‰ç±»ï¼ˆClassï¼‰æ˜¯Javaä¸­çš„ä¸€ç­‰å…¬æ°‘ï¼ŒJava8ä¸­å°†æ–¹æ³•å’Œlambdaå¢åŠ ä¸ºä¸€ç­‰å…¬æ°‘ã€‚æ–¹æ³•å’Œlambdaä½œä¸ºä¸€ç­‰å…¬æ°‘ï¼Œæ˜¯Java8ä¸­æ–¹æ³•å¼•ç”¨çš„åŸºç¡€ã€‚é™¤äº†å…è®¸(å‘½å)å‡½æ•°æˆä¸ºä¸€ç­‰å€¼å¤–ï¼ŒJava 8è¿˜ä½“ç°äº†æ›´å¹¿ä¹‰çš„å°†å‡½æ•°ä½œä¸ºå€¼çš„æ€æƒ³ï¼ŒåŒ…æ‹¬ Lambda1(æˆ–åŒ¿åå‡½æ•°)ã€‚ ç­›é€‰ä¸€ä¸ªç›®å½•ä¸­çš„æ‰€æœ‰éšè—æ–‡ä»¶ï¼ŒJava 8 ä¹‹å‰ç‰ˆæœ¬ï¼š 12345File[] hiddenFiles = new File(â€œ.â€).listFiles(new FileFilter() { public boolean accept (File file) { return file.isHidden(); }} Java 8 ç‰ˆæœ¬ï¼š 1File[] hiddenFiles = new File(\".\").listFiles(File::isHidden); 3. æµåœ¨Java8ä¹‹å‰ï¼Œéå†å¤„ç†é›†åˆå…ƒç´ ï¼Œä½ å¾—ç”¨for-eachå¾ªç¯ä¸€ä¸ªä¸ªå»è¿­ä»£å…ƒç´ ï¼Œç„¶åå†å¤„ç†å…ƒç´ ã€‚æˆ‘ä»¬æŠŠè¿™ç§æ•°æ®è¿­ä»£çš„æ–¹æ³•ç§°ä¸ºå¤–éƒ¨è¿­ä»£ã€‚ç›¸åï¼Œæœ‰äº†Stream APIï¼Œä½ æ ¹æœ¬ç”¨ä¸ç€æ“å¿ƒå¾ªç¯çš„äº‹æƒ…ã€‚æ•°æ®å¤„ç†å®Œå…¨æ˜¯åœ¨åº“å†…éƒ¨è¿›è¡Œçš„ã€‚æˆ‘ä»¬æŠŠè¿™ç§æ€æƒ³å«ä½œå†…éƒ¨è¿­ä»£ã€‚ Java 8 ä¸­å¯¹äºå¤§æ•°æ®é‡çš„é›†åˆï¼Œç”¨Stream API(java.util.stream)è§£å†³äº†ï¼šé›†åˆå¤„ç†æ—¶çš„å¥—è·¯å’Œæ™¦æ¶©ï¼Œä»¥åŠéš¾ä»¥åˆ©ç”¨å¤šæ ¸è¿™ä¸¤ä¸ªé—®é¢˜ã€‚ å¦‚ä¸‹å±•ç¤º Java 8 ä¸­ä½¿ç”¨ Stream API å¹¶è¡Œå¤„ç†æ•°æ®ï¼š 12import static java.util.stream.Collectors.toList;List&lt;Apple&gt; heavyApples = inventory.parallelStream().filter((Apple a) -&gt; a.getWeight() &gt; 150) .collect(toList()); 4. é»˜è®¤æ–¹æ³•Java 8ä¸­åŠ å…¥é»˜è®¤æ–¹æ³•ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒåº“è®¾è®¡å¸ˆï¼Œè®©ä»–ä»¬èƒ½å¤Ÿå†™å‡ºæ›´å®¹æ˜“æ”¹è¿›çš„æ¥å£ã€‚åŒæ—¶ï¼Œæ™®é€šå¼€å‘è€…ä¹Ÿå¯ä»¥åœ¨æ¥å£ä¸­ä½¿ç”¨é»˜è®¤æ–¹æ³•ï¼Œåœ¨å®ç°ç±»æ²¡æœ‰å®ç°æ–¹æ³•æ—¶æä¾›æ–¹æ³•å†…å®¹ï¼Œè¿›ä¸€æ­¥æ–¹ä¾¿å¼€å‘ã€‚ 12List&lt;Apple&gt; heavyApples1 = inventory.stream().filter((Apple a) -&gt; a.getWeight() &gt; 150).collect(toList());List&lt;Apple&gt; heavyApples2 = inventory.parallelStream().filter((Apple a) -&gt; a.getWeight() &gt; 150).collect(toList()); åœ¨Java 8ä¹‹å‰ï¼ŒListå¹¶æ²¡æœ‰streamæˆ–parallelStreamæ–¹æ³•ï¼Œå®ƒå®ç° çš„Collectionæ¥å£ä¹Ÿæ²¡æœ‰ã€‚Java 8 ç»™æ¥å£è®¾è®¡è€…æä¾›äº†ä¸€ä¸ªæ‰©å……æ¥å£çš„æ–¹å¼ï¼Œè€Œä¸ä¼šç ´åç°æœ‰çš„ä»£ç ã€‚Java 8åœ¨æ¥å£å£°æ˜ ä¸­ä½¿ç”¨æ–°çš„defaultå…³é”®å­—æ¥è¡¨ç¤ºè¿™ä¸€ç‚¹ã€‚è¿™æ ·å°±å®ç°äº†æ”¹å˜å·²å‘å¸ƒçš„æ¥å£è€Œä¸ç ´åå·²æœ‰çš„å®ç°ã€‚ æ€»ç»“æœ¬ç« ä¸»è¦æ€»ç»“Java 8 çš„ä¸»è¦å˜åŒ–(Lambdaè¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ã€æµå’Œé»˜è®¤æ–¹æ³•)ï¼Œä¸ºåé¢æ›´è¿›ä¸€æ­¥å­¦ä¹ æ‰“ä¸‹åšå®åŸºç¡€ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/02/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%201%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%85%B3%E5%BF%83Java-8/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 4ï¼šå¼•å…¥æµ","text":"1. æµç®€ä»‹æµæ˜¯Java APIçš„æ–°æˆå‘˜ï¼Œå®ƒå…è®¸ä½ ä»¥å£°æ˜æ€§æ–¹å¼å¤„ç†æ•°æ®é›†åˆ(é€šè¿‡æŸ¥è¯¢è¯­å¥æ¥è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ä¸´æ—¶ç¼–å†™ä¸€ä¸ªå®ç°)ã€‚å°±ç°åœ¨æ¥è¯´ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬çœ‹æˆéå†æ•°æ®é›†çš„é«˜çº§è¿­ä»£å™¨ã€‚æ­¤å¤–ï¼Œæµè¿˜å¯ä»¥é€æ˜åœ°å¹¶è¡Œå¤„ç†ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹è¿”å›ä½çƒ­é‡(&lt;400)çš„èœè‚´åç§°ï¼š 12345678910111213141516171819202122232425262728Java7ç‰ˆæœ¬ï¼šList&lt;Dish&gt; lowCaloricDishes = new ArrayList&lt;&gt;();// ç”¨ç´¯åŠ å™¨ç­›é€‰å…ƒç´ for(Dish d: menu){ if(d.getCalories() &lt; 400){ lowCaloricDishes.add(d); }}// ç”¨åŒ¿åç±»å¯¹èœè‚´æ’åºCollections.sort(lowCaloricDishes, new Comparator&lt;Dish&gt;() { public int compare(Dish d1, Dish d2){ return Integer.compare(d1.getCalories(), d2.getCalories()); }});// å¤„ç†æ’åºåçš„èœååˆ—è¡¨List&lt;String&gt; lowCaloricDishesName = new ArrayList&lt;&gt;();for(Dish d: lowCaloricDishes){ lowCaloricDishesName.add(d.getName());}Java8ç‰ˆæœ¬ï¼šimport static java.util.Comparator.comparing;import static java.util.stream.Collectors.toList;List&lt;String&gt; lowCaloricDishesName = menu.stream() .filter(d -&gt; d.getCalories() &lt; 400) // é€‰å‡º400å¡è·¯é‡Œä»¥ä¸‹çš„èœè‚´ .sorted(comparing(Dish::getCalories)) // æŒ‰ç…§å¡è·¯é‡Œæ’åº .map(Dish::getName) // æå–èœè‚´åç§° .collect(toList()); // å°†æ‰€æœ‰çš„åç§°ä¿å­˜åœ¨Listä¸­åˆ©ç”¨å¤šæ ¸æ¶æ„å¹¶è¡Œæ‰§è¡Œï¼Œåªéœ€è¦æŠŠstream()æ¢æˆparallelStream() Java 8ä¸­çš„Stream APIç‰¹æ€§ï¼š å£°æ˜æ€§â€”â€”æ›´ç®€æ´ï¼Œæ›´æ˜“è¯» å¯å¤åˆâ€”â€”æ›´çµæ´» å¯å¹¶è¡Œâ€”â€”æ€§èƒ½æ›´å¥½ æµå®šä¹‰ï¼š å…ƒç´ åºåˆ—â€”â€”å°±åƒé›†åˆä¸€æ ·ï¼Œæµä¹Ÿæä¾›äº†ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®¿é—®ç‰¹å®šå…ƒç´ ç±»å‹çš„ä¸€ç»„æœ‰åº å€¼ã€‚ æºâ€”â€”æµä¼šä½¿ç”¨ä¸€ä¸ªæä¾›æ•°æ®çš„æºï¼Œå¦‚é›†åˆã€æ•°ç»„æˆ–è¾“å…¥/è¾“å‡ºèµ„æºã€‚ è¯·æ³¨æ„ï¼Œä»æœ‰åºé›† åˆç”Ÿæˆæµæ—¶ä¼šä¿ç•™åŸæœ‰çš„é¡ºåºã€‚ç”±åˆ—è¡¨ç”Ÿæˆçš„æµï¼Œå…¶å…ƒç´ é¡ºåºä¸åˆ—è¡¨ä¸€è‡´ã€‚ æ•°æ®å¤„ç†æ“ä½œâ€”â€”æµçš„æ•°æ®å¤„ç†åŠŸèƒ½æ”¯æŒç±»ä¼¼äºæ•°æ®åº“çš„æ“ä½œï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­çš„å¸¸ç”¨æ“ä½œï¼Œå¦‚filterã€mapã€reduceã€findã€matchã€sortç­‰ã€‚æµæ“ä½œå¯ä»¥é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯å¹¶è¡Œæ‰§è¡Œã€‚ æµæ°´çº¿â€”â€”å¾ˆå¤šæµæ“ä½œæœ¬èº«ä¼šè¿”å›ä¸€ä¸ªæµï¼Œè¿™æ ·å¤šä¸ªæ“ä½œå°±å¯ä»¥é“¾æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¤§çš„æµæ°´çº¿ã€‚è¿™è®©æˆ‘ä»¬ä¸‹ä¸€ç« ä¸­çš„ä¸€äº›ä¼˜åŒ–æˆä¸ºå¯èƒ½ï¼Œå¦‚å»¶è¿Ÿå’ŒçŸ­è·¯ã€‚æµæ°´çº¿çš„æ“ä½œå¯ä»¥çœ‹ä½œå¯¹æ•°æ®æºè¿›è¡Œæ•°æ®åº“å¼æŸ¥è¯¢ã€‚ å†…éƒ¨è¿­ä»£â€”â€”ä¸ä½¿ç”¨è¿­ä»£å™¨æ˜¾å¼è¿­ä»£çš„é›†åˆä¸åŒï¼Œæµçš„è¿­ä»£æ“ä½œæ˜¯åœ¨èƒŒåè¿›è¡Œçš„ã€‚ 2. æµä¸é›†åˆé›†åˆä¸æµä¹‹é—´çš„å·®å¼‚å°±åœ¨äºä»€ä¹ˆæ—¶å€™è¿›è¡Œè®¡ç®—ã€‚é›†åˆæ˜¯ä¸€ä¸ªå†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«æ•°æ®ç»“æ„ä¸­ç›®å‰æ‰€æœ‰çš„å€¼â€”â€”é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¾—å…ˆç®—å‡ºæ¥æ‰èƒ½æ·»åŠ åˆ°é›†åˆä¸­ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæµåˆ™æ˜¯åœ¨æ¦‚å¿µä¸Šå›ºå®šçš„æ•°æ®ç»“æ„(ä½ ä¸èƒ½æ·»åŠ æˆ–åˆ é™¤å…ƒç´ )ï¼Œå…¶å…ƒç´ åˆ™æ˜¯æŒ‰éœ€è®¡ç®—çš„ã€‚é›†åˆå’Œæµçš„å¦ä¸€ä¸ªå…³é”®åŒºåˆ«åœ¨äºå®ƒä»¬éå†æ•°æ®çš„æ–¹å¼ã€‚ 2.1 åªèƒ½éå†ä¸€æ¬¡å’Œè¿­ä»£å™¨ç±»ä¼¼ï¼Œæµåªèƒ½éå†ä¸€æ¬¡ã€‚éå†å®Œä¹‹åï¼Œæˆ‘ä»¬å°±è¯´è¿™ä¸ªæµå·²ç»è¢«æ¶ˆè´¹æ‰äº†ã€‚ä»¥ä¸‹ä»£ç ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè¯´æµå·²è¢«æ¶ˆè´¹æ‰äº†ï¼š 123456789List&lt;String&gt; title = Arrays.asList(â€œJava8â€,â€Inâ€, â€œActionâ€);Stream&lt;String&gt; s = title.stream();s.forEach(System.out::println);s.forEach(System.out::println);Exception in thread \"main\" java.lang.IllegalStateException: stream has already been operated upon or closed at java.util.stream.AbstractPipeline.sourceStageSpliterator(AbstractPipeline.java:279) at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:580) at com.lujiahao.learnjava8.chapter4.StreamAndCollection.main(StreamAndCollection.java:16) 2.2 å¤–éƒ¨è¿­ä»£ä¸å†…éƒ¨è¿­ä»£ä½¿ç”¨Collectionæ¥å£éœ€è¦ç”¨æˆ·å»åšè¿­ä»£(æ¯”å¦‚ç”¨for-each)ï¼Œè¿™ç§°ä¸ºå¤–éƒ¨è¿­ä»£ã€‚ç›¸å,Streamsåº“ä½¿ç”¨å†…éƒ¨è¿­ä»£ 123456789101112131415161718é›†åˆ:ç”¨for-eachå¾ªç¯å¤–éƒ¨è¿­ä»£List&lt;String&gt; names = new ArrayList&lt;&gt;();for(Dish d: menu){ names.add(d.getName());}é›†åˆ:ç”¨èƒŒåçš„è¿­ä»£å™¨åšå¤–éƒ¨è¿­ä»£List&lt;String&gt; names = new ArrayList&lt;&gt;();Iterator&lt;String&gt; iterator = menu.iterator();while(iterator.hasNext()) { Dish d = iterator.next(); names.add(d.getName());}æµ:å†…éƒ¨è¿­ä»£List&lt;String&gt; names = menu.stream() .map(Dish::getName) .collect(toList()); 3. æµæ“ä½œjava.util.stream.Streamä¸­çš„Streamæ¥å£å®šä¹‰äº†è®¸å¤šæ“ä½œã€‚å®ƒä»¬å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ã€‚å¯ä»¥è¿æ¥èµ·æ¥çš„æµæ“ä½œç§°ä¸ºä¸­é—´æ“ä½œï¼Œå…³é—­æµçš„æ“ä½œç§°ä¸ºç»ˆç«¯æ“ä½œã€‚ä¸­é—´æ“ä½œï¼šé™¤éæµæ°´çº¿ä¸Šè§¦å‘ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå¦åˆ™ä¸­é—´æ“ä½œä¸ä¼šæ‰§è¡Œä»»ä½•å¤„ç†ã€‚ç»ˆç«¯æ“ä½œï¼šä¼šä»æµçš„æµæ°´çº¿ç”Ÿæˆç»“æœã€‚å…¶ç»“æœæ˜¯ä»»ä½•ä¸æ˜¯æµçš„å€¼ã€‚ æµçš„ä½¿ç”¨ä¸€èˆ¬åŒ…æ‹¬ä¸‰ä»¶äº‹: ä¸€ä¸ªæ•°æ®æº(å¦‚é›†åˆ)æ¥æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢; ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆä¸€æ¡æµçš„æµæ°´çº¿; ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶èƒ½ç”Ÿæˆç»“æœã€‚ æµçš„æµæ°´çº¿èƒŒåçš„ç†å¿µç±»ä¼¼äºæ„å»ºå™¨æ¨¡å¼ã€‚ å¸¸è§æµæ“ä½œï¼š 4. å°ç»“ä»¥ä¸‹æ˜¯ä½ åº”ä»æœ¬ç« ä¸­å­¦åˆ°çš„ä¸€äº›å…³é”®æ¦‚å¿µã€‚ æµæ˜¯â€œä»æ”¯æŒæ•°æ®å¤„ç†æ“ä½œçš„æºç”Ÿæˆçš„ä¸€ç³»åˆ—å…ƒç´ â€ã€‚ æµåˆ©ç”¨å†…éƒ¨è¿­ä»£:è¿­ä»£é€šè¿‡filterã€mapã€sortedç­‰æ“ä½œè¢«æŠ½è±¡æ‰äº†ã€‚ æµæ“ä½œæœ‰ä¸¤ç±»:ä¸­é—´æ“ä½œå’Œç»ˆç«¯æ“ä½œã€‚ filterå’Œmapç­‰ä¸­é—´æ“ä½œä¼šè¿”å›ä¸€ä¸ªæµï¼Œå¹¶å¯ä»¥é“¾æ¥åœ¨ä¸€èµ·ã€‚å¯ä»¥ç”¨å®ƒä»¬æ¥è®¾ç½®ä¸€æ¡æµæ°´çº¿ï¼Œä½†å¹¶ä¸ä¼šç”Ÿæˆä»»ä½•ç»“æœ forEachå’Œcountç­‰ç»ˆç«¯æ“ä½œä¼šè¿”å›ä¸€ä¸ªéæµçš„å€¼ï¼Œå¹¶å¤„ç†æµæ°´çº¿ä»¥è¿”å›ç»“æœã€‚ æµä¸­çš„å…ƒç´ æ˜¯æŒ‰éœ€è®¡ç®—çš„ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/08/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%204%EF%BC%9A%E5%BC%95%E5%85%A5%E6%B5%81/"},{"title":"ç¬¬ä¸€ç«  å¿«é€Ÿè®¤è¯†çº¿ç¨‹","text":"å¯¹äºè®¡ç®—æœºè€Œè¨€æ¯ä¸ªä»»åŠ¡å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹,åœ¨æ¯ä¸ªè¿›ç¨‹å†…éƒ¨è‡³å°‘è¦æœ‰ä¸€ä¸ªçº¿ç¨‹,å› æ­¤æœ‰æ—¶çº¿ç¨‹ä¹Ÿç§°ä¸ºè½»é‡çº§è¿›ç¨‹.çº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„ä¸€ä¸ªè·¯å¾„,æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å±€éƒ¨å˜é‡è¡¨,ç¨‹åºè®¡æ•°å™¨ä»¥åŠå„è‡ªçš„ç”Ÿå‘½å‘¨æœŸ. 1.åˆ›å»ºçº¿ç¨‹1.1 æ¼”ç¤ºå¹¶è¡Œè¿è¡Œ1234567891011121314151617181920212223242526272829303132333435363738public class TryConcurrencyThread { public static void main(String[] args) { // é€šè¿‡åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼åˆ›å»ºçº¿ç¨‹,å¹¶é‡å†™å…¶ä¸­çš„runæ–¹æ³• new Thread() { @Override public void run() { enjoyMusic(); } }.start(); browseNews(); } private static void browseNews() { for (; ; ) { System.out.println(\"Uh-huh, the good news.\"); sleep(1); } } private static void enjoyMusic() { for (; ; ) { System.out.println(\"Uh-huh, the nice music.\"); sleep(1); } } /** * æ¨¡æ‹Ÿç­‰å¾…å¹¶å¿½ç•¥å¼‚å¸¸ */ private static void sleep(int seconds) { try { TimeUnit.SECONDS.sleep(seconds); } catch (Exception e) { e.printStackTrace(); } }} è¾“å‡ºç»“æœ: 1234Uh-huh, the good news.Uh-huh, the nice music.Uh-huh, the good news.Uh-huh, the nice music. ä¸Šé¢åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨ Java 8 Lambdaä¼˜åŒ– new Thread(TryConcurrencyThreadLambda::enjoyMusic).start(); 1.2 ä½¿ç”¨Jconsoleè§‚å¯Ÿçº¿ç¨‹Jconsoleæ˜¯JDKè‡ªèº«æä¾›çš„ç›‘æµ‹å·¥å…·.å¯ä»¥åœ¨æ§åˆ¶å°å¯åŠ¨jconsole å›¾ä¸­Thread-0å°±æ˜¯æˆ‘ä»¬åˆ›å»ºçš„æ–°çº¿ç¨‹. 2.çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ: NEW RUNNABLE RUNNING BLOCKED TERMINATED 2.1 çº¿ç¨‹NEWçŠ¶æ€å½“æˆ‘ä»¬ç”¨å…³é”®å­— new åˆ›å»ºä¸€ä¸ª Thread å¯¹è±¡æ—¶,æ­¤æ—¶å®ƒå¹¶ä¸å¤„äºæ‰§è¡ŒçŠ¶æ€,å› ä¸ºæ²¡æœ‰è°ƒç”¨ start æ–¹æ³•å¯åŠ¨è¯¥çº¿ç¨‹,é‚£ä¹ˆçº¿ç¨‹çš„çŠ¶æ€ä¸º NEW çŠ¶æ€,å‡†ç¡®çš„è¯´,å®ƒåªæ˜¯ Thread å¯¹è±¡çš„çŠ¶æ€,å› ä¸ºåœ¨æ²¡æœ‰ start ä¹‹å‰,è¯¥çº¿ç¨‹æ ¹æœ¬ä¸å­˜åœ¨,ä¸ä½ ç”¨å…³é”®å­— new åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Java å¯¹è±¡æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«. NEW çŠ¶æ€é€šè¿‡ start æ–¹æ³•è¿›å…¥ RUNNABLE çŠ¶æ€. 2.2 çº¿ç¨‹RUNNABLEçŠ¶æ€çº¿ç¨‹å¯¹è±¡è¿›å…¥ RUNNABLE çŠ¶æ€å¿…é¡»è°ƒç”¨ start æ–¹æ³•,é‚£ä¹ˆæ­¤æ—¶æ‰æ˜¯çœŸæ­£çš„åœ¨ JVM è¿›ç¨‹ä¸­åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹,çº¿ç¨‹å¯åŠ¨åæ˜¯ä¸ä¼šç«‹å³æ‰§è¡Œçš„,éœ€è¦å¬ä»¤äº CPU çš„è°ƒåº¦,æ­¤æ—¶ç§°æ­¤çŠ¶æ€ä¸ºå¯æ‰§è¡ŒçŠ¶æ€(RUNNABLE),å³çº¿ç¨‹å…·å¤‡æ‰§è¡Œèµ„æ ¼,ä½†æ˜¯å¹¶æ²¡æœ‰çœŸæ­£æ‰§è¡Œ,åœ¨ç­‰å¾… CPU è°ƒåº¦. ç”±äºå­˜åœ¨ running çŠ¶æ€,æ‰€ä»¥ä¸ä¼šç›´æ¥è¿›å…¥ BLOCKED çŠ¶æ€å’Œ TERMINATED çŠ¶æ€,å³ä½¿æ˜¯åœ¨çº¿ç¨‹çš„æ‰§è¡Œé€»è¾‘ä¸­è°ƒç”¨ wait sleep æˆ–è€…å…¶ä»– block çš„IO æ“ä½œç­‰,ä¹Ÿä¸è®¸å…ˆè·å¾— CPU çš„è°ƒåº¦æ‰§è¡Œæƒæ‰å¯ä»¥,ä¸¥æ ¼æ¥è®², RUNNABLE çš„çº¿ç¨‹åªèƒ½æ„å¤–ç»ˆæ­¢æˆ–è€…è¿›å…¥ RUNNING çŠ¶æ€. 2.3 çº¿ç¨‹RUNNINGçŠ¶æ€ä¸€æ—¦ CPU é€šè¿‡è½®è¯¢æˆ–è€…å…¶ä»–æ–¹å¼ä»ä»»åŠ¡å¯æ‰§è¡Œé˜Ÿåˆ—ä¸­é€‰ä¸­äº†çº¿ç¨‹,é‚£ä¹ˆæ­¤æ—¶å®ƒæ‰èƒ½çœŸæ­£çš„æ‰§è¡Œè‡ªå·±çš„é€»è¾‘ä»£ç ,éœ€è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ä¸€ä¸ªæ­£åœ¨ RUNNING çŠ¶æ€çš„çº¿ç¨‹äº‹å®ä¸Šä¹Ÿæ˜¯ RUNNABLE çš„,åä¹‹åˆ™ä¸æˆç«‹. æ­¤çŠ¶æ€ä¸‹çº¿ç¨‹çš„çŠ¶æ€å¯ä»¥å‘ç”Ÿå¦‚ä¸‹è½¬æ¢: ç›´æ¥è¿›å…¥ TERMINATED çŠ¶æ€,æ¯”å¦‚è°ƒç”¨ JDK å·²ç»ä¸æ¨èçš„ stop æ–¹æ³•æˆ–è€…åˆ¤æ–­æŸä¸ªé€»è¾‘æ ‡è¯† è¿›å…¥ BLOCKED çŠ¶æ€,æ¯”å¦‚è°ƒç”¨ sleep æˆ–è€…wait æ–¹æ³•è€ŒåŠ å…¥ waitSetä¸­ è¿›è¡ŒæŸä¸ªé˜»å¡ IO æ“ä½œ,æ¯”å¦‚å› ç½‘ç»œçš„è¯»å†™è€Œè¿›å…¥ BLOCKED çŠ¶æ€ è·å–æŸä¸ªé”èµ„æº,ä»è€ŒåŠ å…¥åˆ°è¯¥é”çš„é˜»å¡é˜Ÿåˆ—ä¸­è€Œè¿›å…¥ BLOCKED çŠ¶æ€ ç”±äº CPU çš„è°ƒåº¦å™¨è½®è¯¢ä½¿è¯¥çº¿ç¨‹æ”¾å¼ƒæ‰§è¡Œ,è¿›å…¥ RUNNABLE çŠ¶æ€ çº¿ç¨‹ä¸»åŠ¨è°ƒç”¨ yield æ–¹æ³•,æ”¾å¼ƒ CPU æ‰§è¡Œæƒ,è¿›å…¥ RUNNABLE çŠ¶æ€ 2.4 çº¿ç¨‹BLOCKEDçŠ¶æ€ä»ä¸ŠèŠ‚å³å¯è·å¾—çº¿ç¨‹è¿›å…¥ BLOCKED çŠ¶æ€çš„åŸå› ,æ¥ä¸‹æ¥ä»‹ç»çº¿ç¨‹åœ¨ BLOCKED çŠ¶æ€ä¸­å¯ä»¥åˆ‡æ¢è‡³å¦‚ä¸‹å‡ ä¸ªçŠ¶æ€: ç›´æ¥è¿›å…¥ TERMINATED çŠ¶æ€,æ¯”å¦‚è°ƒç”¨ JDK å·²ç»ä¸æ¨èçš„ stop æ–¹æ³•æˆ–è€…æ„å¤–æ­»äº¡(JVM Crash) çº¿ç¨‹é˜»å¡æ“ä½œç»“æŸ,æ¯”å¦‚è¯»å–äº†æƒ³è¦çš„æ•°æ®å­—èŠ‚è¿›å…¥åˆ° RUNNABLE çŠ¶æ€ çº¿ç¨‹å®Œæˆäº†æŒ‡å®šæ—¶é—´çš„ä¼‘çœ ,è¿›å…¥åˆ° RUNNABLE çŠ¶æ€ Wait ä¸­çš„çº¿ç¨‹è¢«å…¶ä»–çº¿ç¨‹ notify/notifyall å”¤é†’,è¿›å…¥åˆ°RUNNABLE çŠ¶æ€ çº¿ç¨‹è·å–åˆ°äº†æŸä¸ªé”èµ„æº,è¿›å…¥åˆ° RUNNABLE çŠ¶æ€ çº¿ç¨‹åœ¨é˜»å¡è¿‡ç¨‹ä¸­è¢«æ‰“æ–­,æ¯”å¦‚å…¶ä»–çº¿ç¨‹è°ƒç”¨äº† interrupt æ–¹æ³•,è¿›å…¥ RUNNABLE çŠ¶æ€ 2.5 çº¿ç¨‹TERMINATEDçŠ¶æ€TERMINATED æ˜¯ä¸€ä¸ªçº¿ç¨‹çš„æœ€ç»ˆé€”çŠ¶æ€,åœ¨è¯¥çŠ¶æ€ä¸­çº¿ç¨‹å°†ä¸ä¼šåˆ‡æ¢åˆ°å…¶ä»–ä»»ä½•çŠ¶æ€,çº¿ç¨‹è¿›å…¥ TERMINATED çŠ¶æ€,æ„å‘³ç€çº¿ç¨‹çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸç»“æŸäº†,ä¸‹åˆ—æƒ…å†µå°†ä¼šä½¿çº¿ç¨‹è¿›å…¥åˆ° TERMINATED çŠ¶æ€: çº¿ç¨‹è¿è¡Œæ­£å¸¸ç»“æŸ,ç»“æŸç”Ÿå‘½å‘¨æœŸ çº¿ç¨‹è¿è¡Œå‡ºé”™æ„å¤–ç»“æŸ JVM Crash,å¯¼è‡´æ‰€æœ‰çš„çº¿ç¨‹éƒ½ç»“æŸ 3.çº¿ç¨‹startæ–¹æ³•å‰–æå’Œæ¨¡æ¿è®¾è®¡æ¨¡å¼åº”ç”¨3.1 startæ–¹æ³•æºç è§£æå¦‚æœç›´æ¥è°ƒç”¨çº¿ç¨‹çš„runæ–¹æ³•,çº¿ç¨‹æ˜¯ä¸ä¼šå¯åŠ¨çš„,è¿™ç›¸å½“äºè°ƒç”¨äº†ä¸€ä¸ªç±»çš„å±æ€§æ–¹æ³•.åªæœ‰è°ƒç”¨startæ–¹æ³•æ‰ä¼šå¯åŠ¨çº¿ç¨‹,æ¥ä¸‹æ¥æˆ‘ä»¬å‰–æstartæ–¹æ³•åŸç†: 12345678910111213141516171819public synchronized void start() { if (threadStatus != 0) throw new IllegalThreadStateException(); group.add(this); boolean started = false; try { start0(); started = true; } finally { try { if (!started) { group.threadStartFailed(this); } } catch (Throwable ignore) { } }} startæ–¹æ³•æºç å¾ˆç®€å•,æ ¸å¿ƒæ–¹æ³•æ˜¯start0çš„æœ¬åœ°æ–¹æ³•.start æ–¹æ³•ä¸­ä¼šè°ƒç”¨ start0æ–¹æ³•,è€Œstart0æ–¹æ³•ä¼šè°ƒç”¨çº¿ç¨‹çš„ runæ–¹æ³•,è¿™ä¸€ç‚¹åœ¨æºç ä¸­æœ‰æ³¨é‡Š: 1Causes this thread to begin execution; the Java Virtual Machine calls the run method of this thread. æ€»ç»“ä¸‹æºç ä¸­è·å¾—çš„çŸ¥è¯†ç‚¹: Thread è¢«æ„é€ åçš„ NEWçŠ¶æ€,äº‹å®ä¸Š threadStatus è¿™ä¸ªå†…éƒ¨å±æ€§æ˜¯0 ä¸èƒ½ä¸¤æ¬¡å¯åŠ¨ Thread,å¦åˆ™å°±ä¼šå‡ºç° IllegalThreadStateException çº¿ç¨‹å¯åŠ¨åä¼šè¢«åŠ å…¥åˆ°ä¸€ä¸ª ThreadGroup ä¸­ çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸç»“æŸ,å³ TERMINATED çŠ¶æ€,å†æ¬¡è°ƒç”¨ start æ–¹æ³•æ˜¯ä¸å…è®¸çš„,å³ TERMINATED çŠ¶æ€æ— æ³•å›åˆ° RUNNABLE/RUNNING çŠ¶æ€ 4.Runnableæ¥å£å‚è€ƒèµ„æ–™ ã€ŠJAVAä¸æ¨¡å¼ã€‹ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼ Javaè®¾è®¡æ¨¡å¼ï¼šç­–ç•¥æ¨¡å¼ ä»£ç è·å–https://github.com/lujiahao0708/LearnJavaConcurrent Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/11/20/%E3%80%8AJava%20%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E8%AF%A6%E8%A7%A3-%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/chapter1:%E5%BF%AB%E9%80%9F%E8%AE%A4%E8%AF%86%E7%BA%BF%E7%A8%8B/"},{"title":"ã€Šå¤§è¯æ•°æ®ç»“æ„ã€‹ç¬¬ä¸‰ç«  çº¿æ€§è¡¨(ä¸€) é¡ºåºè¡¨","text":"1.çº¿æ€§è¡¨å®šä¹‰é›¶ä¸ªæˆ–å¤šä¸ªæ•°æ®å…ƒç´ çš„æœ‰é™åºåˆ— 2.çº¿æ€§è¡¨é€»è¾‘ç‰¹æ€§ é™¤ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå…ƒç´ å¤–,æ¯ä¸ªå…ƒç´ åªæœ‰ä¸€ä¸ªå‰é©±å’Œä¸€ä¸ªåç»§ ç¬¬ä¸€ä¸ªå…ƒç´ æ²¡æœ‰å‰é©±å…ƒç´  æœ€åä¸€ä¸ªå…ƒç´ æ²¡æœ‰åç»§å…ƒç´  3.çº¿æ€§è¡¨æŠ½è±¡æ•°æ®ç±»å‹ 4.çº¿æ€§è¡¨å­˜å‚¨ç»“æ„ é¡ºåºå­˜å‚¨ é“¾å¼å­˜å‚¨ æœ¬æ–‡å…ˆæ€»ç»“é¡ºåºå­˜å‚¨åŠå…¶ä»£ç å®ç°,é“¾å¼å­˜å‚¨æ”¾åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ã€‚ 5.é¡ºåºå­˜å‚¨ ç”¨ä¸€æ®µåœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒä¸€æ¬¡å­˜å‚¨çº¿æ€§è¡¨çš„æ•°æ®å…ƒç´  5.1 æ’å…¥æ•°æ® 5.2 åˆ é™¤æ•°æ® 6.ä»£ç å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140public class SequenceList&lt;T&gt; { // é»˜è®¤é•¿åº¦ private final int DEFAULT_SIZE = 16; // ä¿å­˜æ•°ç»„çš„é•¿åº¦ private int capacity; // æ•°ç»„,ä¿å­˜é¡ºåºçº¿æ€§è¡¨ private Object[] elementData; // é¡ºåºçº¿æ€§è¡¨ä¸­å½“å‰å…ƒç´ ä¸ªæ•° private int size = 0; // é»˜è®¤é•¿åº¦åˆ›å»ºç©ºçº¿æ€§è¡¨ public SequenceList() { capacity = DEFAULT_SIZE; elementData = new Object[capacity]; } // ä»¥ä¸€ä¸ªåˆå§‹åŒ–å…ƒç´ åˆ›å»ºé¡ºåºçº¿æ€§è¡¨ public SequenceList(T element) { this(); elementData[0] = element; size++; } // ä»¥æŒ‡å®šé•¿åº¦åˆ›å»ºé¡ºåºçº¿æ€§è¡¨ public SequenceList(T element, int initSize) { capacity = 1; // æŠŠcapacityè®¾ç½®ä¸ºå¤§äºinitSizeçš„æœ€å°çš„2çš„næ¬¡æ–¹ while (capacity &lt; initSize) { capacity &lt;&lt;= 1; } elementData = new Object[capacity]; elementData[0] = element; size++; } // è·å–çº¿æ€§è¡¨çš„å¤§å° public int length() { return size; } // è·å–ç´¢å¼•içš„å…ƒç´  public T get(int i) { if (i &lt; 0 || i &gt; size - 1) { throw new IndexOutOfBoundsException(\"ç´¢å¼•è¶…å‡ºçº¿æ€§è¡¨èŒƒå›´\"); } return (T) elementData[i]; } // æ ¹æ®å…ƒç´ æŸ¥æ‰¾åœ¨çº¿æ€§è¡¨ä¸­çš„ä½ç½® public int indexOf(T element) { for (int i = 0; i &lt; size; i++) { if (elementData[i].equals(element)) { return i; } } return -1; } // å‘é¡ºåºè¡¨ä¸­æŒ‡å®šä½ç½®æ’å…¥å…ƒç´  public void insert(T element, int index) { if (index &lt; 0 || index &gt; size) { throw new IndexOutOfBoundsException(\"ç´¢å¼•è¶…å‡ºçº¿æ€§è¡¨èŒƒå›´\"); } ensureCapacity(size + 1); // å°†æŒ‡å®šç´¢å¼•å¤„ä¹‹åçš„æ‰€æœ‰å…ƒç´ åç§» System.arraycopy(elementData, index, elementData, index + 1, size - index); elementData[index] = element; size++; } private void ensureCapacity(int minCapacity) { // å¦‚æœæ•°ç»„çš„åŸæœ‰é•¿åº¦å°äºç›®å‰æ‰€éœ€çš„é•¿åº¦ if (minCapacity &gt; capacity) { // ä¸æ–­çš„å°†capacity*2,çŸ¥é“capacityå¤§äºminCapacity while (capacity &lt; minCapacity) { capacity &lt;&lt;= 1; } elementData = Arrays.copyOf(elementData, capacity); } } // åœ¨çº¿æ€§è¡¨çš„æœ«ç«¯å¢åŠ ä¸€ä¸ªå…ƒç´  public void add(T element) { insert(element, size); } // åˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´  public T delete(int index) { if (index &lt; 0 || index &gt; size - 1) { throw new IndexOutOfBoundsException(\"ç´¢å¼•è¶…è¿‡çº¿æ€§è¡¨èŒƒå›´\"); } T oldValue = (T) elementData[index]; int numMoved = size - index - 1; if (numMoved &gt; 0) { System.arraycopy(elementData, index + 1, elementData, index, numMoved); } elementData[--size] = null; return oldValue; } // åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´  public T remove() { return delete(size - 1); } // åˆ¤æ–­çº¿æ€§è¡¨æ˜¯å¦ä¸ºç©º public boolean isEmpty() { return size == 0; } // æ¸…ç©ºçº¿æ€§è¡¨ public void clear() { Arrays.fill(elementData, null); size = 0; } public String toString(){ if(size == 0){ return \"[]\"; } else{ StringBuilder sb = new StringBuilder(\"[\"); for(int i=0;i&lt;size;i++){ sb.append(elementData[i].toString() + \", \"); } int len = sb.length(); return sb.delete(len-2, len).append(\"]\").toString(); } }} 1234567891011121314151617public class SequenceTest { public static void main(String[] args) { SequenceList&lt;String&gt; sequenceList = new SequenceList&lt;&gt;(); sequenceList.add(\"hello\"); sequenceList.add(\"lu\"); sequenceList.add(\"jia\"); sequenceList.add(\"hao\"); System.out.println(sequenceList.toString()); System.out.println(\"é•¿åº¦:\" + sequenceList.length()); System.out.println(\"è·å–ç¬¬ä¸€ä¸ªå…ƒç´ :\" + sequenceList.get(0)); System.out.println(\"æŸ¥çœ‹luçš„ç´¢å¼•:\" + sequenceList.indexOf(\"lu\")); sequenceList.insert(\"lifan\", 4); System.out.println(\"æ–°çš„é¡ºåºè¡¨:\" + sequenceList.toString()); }} ä»£ç è¯¦è§: GitHub æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/07/15/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E7%AC%AC%E4%B8%89%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E8%A1%A8(%E4%B8%80)%20%E9%A1%BA%E5%BA%8F%E8%A1%A8/"},{"title":"ã€Šå¤§è¯æ•°æ®ç»“æ„ã€‹ç¬¬ä¸€ç«  ç»ªè®º","text":"åˆå¼€æ–°å‘ğŸ˜‚,è¿™æ¬¡æ˜¯ä»æœ€åŸºç¡€çš„çŸ¥è¯†èµ·,è¿™éƒ½æ˜¯ä¸Šå­¦æ—¶å€™æ¬ ä¸‹çš„å€ºå•Š!å¥½å¥½æŠŠåŸºç¡€æ‰“æ‰å®ä¸€äº›,è®©è‡ªå·±æ›´åŠ æœ‰å®åŠ›,åŠ æ²¹! 1.åŸºæœ¬æ¦‚å¿µ1.1 æ•°æ® æè¿°å®¢è§‚äº‹ç‰©çš„ç¬¦å·,æ˜¯è®¡ç®—æœºä¸­å¯ä»¥æ“ä½œçš„å¯¹è±¡,èƒ½è¢«è®¡ç®—æœºè¯†åˆ«,å¹¶è¾“å…¥ç»™è®¡ç®—æœºå¤„ç†çš„ç¬¦å·é›†åˆ. æ•°æ®ä¸ä»…ä»…åŒ…æ‹¬æ•´å‹ã€å®å‹ç­‰æ•°å€¼ç±»å‹,è¿˜åŒ…æ‹¬å­—ç¬¦åŠå£°éŸ³ã€å›¾åƒã€è§†é¢‘ç­‰éæ•°å€¼ç±»å‹ã€‚ 1.2 æ•°æ®å…ƒç´  ç»„æˆæ•°æ®çš„ã€æœ‰ä¸€å®šæ„ä¹‰çš„åŸºæœ¬å•ä½,åœ¨è®¡ç®—æœºä¸­é€šå¸¸ä½œä¸ºæ•´ä½“ä¸»åŠ›ã€‚ä¹Ÿè¢«æˆä¸ºè®°å½•ã€‚ 1.3 æ•°æ®é¡¹ ä¸€ä¸ªæ•°æ®å…ƒç´ å¯ä»¥ç”±è‹¥å¹²ä¸ªæ•°æ®é¡¹ç»„æˆ æ•°æ®é¡¹æ˜¯æ•°æ®ä¸å¯åˆ†å‰²çš„æœ€å°å•ä½ 1.4 æ•°æ®å¯¹è±¡ æ€§è´¨ç›¸åŒçš„æ•°æ®å…ƒç´ çš„é›†åˆ,æ˜¯æ•°æ®çš„å­é›† 1.5 æ•°æ®ç»“æ„ æ˜¯ç›¸äº’ä¹‹é—´å­˜åœ¨ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»çš„æ•°æ®å…ƒç´ çš„é›†åˆ ç»´åŸºç™¾ç§‘å®šä¹‰ 2.ç»“æ„åˆ†ç±»2.1 é€»è¾‘ç»“æ„2.1.1 é›†åˆç»“æ„æ•°æ®å…ƒç´ é™¤äº†åŒå±äºä¸€ä¸ªé›†åˆå¤–,æ— ä»»ä½•å…³ç³»,ç±»ä¼¼æ•°å­¦ä¸­çš„é›†åˆ 2.1.2 çº¿æ€§ç»“æ„æ•°æ®å…ƒç´ æ˜¯ä¸€å¯¹ä¸€ 2.1.3 æ ‘å½¢ç»“æ„æ•°æ®å…ƒç´ æ˜¯ä¸€å¯¹å¤š,å±‚æ¬¡å…³ç³» 2.1.4 å›¾å½¢ç»“æ„æ•°æ®å…ƒç´ æ˜¯å¤šå¯¹å¤š 2.2 ç‰©ç†ç»“æ„2.2.1 é¡ºåºå­˜å‚¨ç»“æ„æ˜¯æŠŠæ•°æ®å…ƒç´ å­˜æ”¾åœ¨åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒé‡Œ,å…¶æ•°æ®é—´çš„é€»è¾‘å…³ç³»å’Œç‰©ç†å…³ç³»æ˜¯ä¸€è‡´çš„ 2.2.2 é“¾å¼å­˜å‚¨ç»“æ„æ˜¯æŠŠæ•°æ®å…ƒç´ å­˜æ”¾åœ¨ä»»åŠ¡çš„å­˜å‚¨å•å…ƒé‡Œ,è¿™ç»„å­˜å‚¨å•å…ƒå¯ä»¥æ˜¯è¿ç»­çš„,ä¹Ÿå¯ä»¥æ˜¯ä¸è¿ç»­çš„ 3.æŠ½è±¡æ•°æ®ç±»å‹ ä¸€ä¸ªæ•°å­¦æ¨¡å‹åŠå®šä¹‰åœ¨è¯¥æ¨¡å‹ä¸Šçš„ä¸€ç»„æ“ä½œ,ä½“ç°äº†ç¨‹åºè®¾è®¡ä¸­é—®é¢˜åˆ†è§£/æŠ½è±¡å’Œä¿¡æ¯éšè—çš„ç‰¹æ€§. 4.å°ç»“æœ¬ç« ç®€å•ä»‹ç»äº†æ•°æ®ç»“æ„çš„ç›¸å…³æ¦‚å¿µå’Œæ•´ä½“åˆ†ç±»,ä½¿å¾—æˆ‘å¯¹æ•°æ®ç»“æ„æœ‰äº†å¤§ä½“çš„è®¤çŸ¥,ä¸ºåç»­å†…å®¹æ‰“ä¸‹åŸºç¡€ã€‚ æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/07/13/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E7%AC%AC%E4%B8%80%E7%AB%A0%20%E7%BB%AA%E8%AE%BA/"},{"title":"ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹å‰æœŸå‡†å¤‡","text":"ä¸ºä»€ä¹ˆè¦å­¦ä¹  JVMå¯¹äº Java å¼€å‘æ¥è¯´ JVM æ˜¯ä¸€ä¸ªåï¼Œé¢è¯•å¤§å‚å¿…é—®å†…å®¹ï¼Œæ˜¯ä¸€å—ç¡¬éª¨å¤´ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Java å¼€å‘çš„å¿…å¤‡æŠ€èƒ½ã€‚ å­¦ä¹  JVM çš„ç›®çš„ï¼š äº†è§£ JVMè¿è¡ŒåŸç†ï¼Œä¸åšâ€CRUD Boyâ€ ä¸ªäººæŠ€èƒ½æå‡( å‘¸â—ï¸è¯´å®è¯â—ï¸ ä¸ºäº†è£…BğŸ˜) é¢è¯•ä¸æ€‚ å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ IDEA Xmind ZEN Google çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ ä»£ç è¿˜æ˜¯è¦æ•²çš„ï¼Œè®°å½•è‡ªå·±çš„æˆé•¿å†ç¨‹ï¼Œä½ ä¼šæ„Ÿè°¢å½“æ—¶é‚£ä¹ˆåŠªåŠ›çš„è‡ªå·±ã€‚ è‰¿è‰¿ åœ¨æ˜Ÿçƒé‡Œé¢è¯´è¦å½¢æˆè‡ªå·±çš„â€œç‚¹ -&gt; çº¿ -&gt; é¢â€ï¼Œè¿™å…¶å®è¯´çš„å°±æ˜¯çŸ¥è¯†ä½“ç³»ï¼Œè€Œæ€ç»´å¯¼å›¾å°±æ˜¯ç”ŸæˆçŸ¥è¯†ä½“ç³»çš„ç¥å…µåˆ©å™¨ã€‚ å·¨äººçš„è‚©è†€ å…³äºJvmçŸ¥è¯†çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº† Javaã€è™šæ‹Ÿæœºã€‘ä¹¦å•æ•´ç† å­¦ä¹ JVMæ˜¯å¦‚ä½•ä»å…¥é—¨åˆ°æ”¾å¼ƒçš„ï¼Ÿ åœ¨çº¿ Java ç¼–è¯‘ç½‘ç«™æœ€ååœ¨æ¨èå‡ ä¸ªåœ¨çº¿ Java ç¼–è¯‘ç½‘ç«™ï¼Œä¸æƒ³ç”¨é‡é‡çš„ IDE çš„æ—¶å€™å¯ä»¥è¯•è¯•çœ‹ğŸ˜‰ https://www.tutorialspoint.com/compile_java8_online.php https://www.jdoodle.com/online-java-compiler http://www.beta.browxy.com/ https://www.compilejava.net/ æ¬¢è¿å¤§å®¶å…³æ³¨ : LFå·¥ä½œå®¤ ç®€ä¹¦ : https://www.jianshu.com/u/e61935d18b09 æ˜é‡‘ : https://juejin.im/user/59239002570c350069c5f0bb å¾®ä¿¡å…¬ä¼—å· :å¤´æ¡å· :","link":"/2019/01/10/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/JVM-0-%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87/"},{"title":"ã€Šå¤§è¯æ•°æ®ç»“æ„ã€‹ç¬¬äºŒç«  ç®—æ³•","text":"1.å®šä¹‰ç®—æ³•æ˜¯è§£å†³ç‰¹å®šé—®é¢˜æ±‚è§£æ­¥éª¤çš„æè¿°,åœ¨è®¡ç®—æœºä¸­è¡¨ç°ä¸ºæŒ‡ä»¤çš„æœ‰é™åºåˆ—,å¹¶ä¸”æ¯æ¡æŒ‡ä»¤è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œã€‚ 2.ç®—æ³•ç‰¹æ€§ è¾“å…¥è¾“å‡º : ç®—æ³•å…·æœ‰é›¶ä¸ªæˆ–å¤šä¸ªè¾“å…¥,ç®—æ³•è‡³å°‘æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºã€‚ æœ‰ç©·æ€§ : ç®—æ³•åœ¨æ‰§è¡Œæœ‰é™çš„æ­¥éª¤ä¹‹å,è‡ªåŠ¨ç»“æŸè€Œä¸ä¼šå‡ºç°æ— é™å¾ªç¯,å¹¶ä¸”æ¯ä¸€ä¸ªæ­¥éª¤åœ¨å¯ä»¥æ¥å—çš„æ—¶é—´å†…å®Œæˆã€‚ ç¡®å®šæ€§ : ç®—æ³•çš„æ¯ä¸€æ­¥éª¤éƒ½å…·æœ‰ç¡®å®šçš„å«ä¹‰,ä¸ä¼šå‡ºç°äºŒä¹‰æ€§ã€‚ å¯è¡Œæ€§ : ç®—æ³•çš„æ¯ä¸€æ­¥éƒ½å¿…é¡»æ˜¯å¯è¡Œçš„,å³æ¯ä¸€æ­¥éƒ½èƒ½å¤Ÿé€šè¿‡æ‰§è¡Œæœ‰é™æ¬¡æ•°å®Œæˆã€‚ 3.ç®—æ³•è®¾è®¡è¦æ±‚ æ­£ç¡®æ€§ : æŒ‡ç®—æ³•è‡³å°‘åº”è¯¥å…·æœ‰è¾“å…¥ã€è¾“å‡ºå’ŒåŠ å·¥å¤„ç†æ— æ­§ä¹‰æ€§ã€èƒ½æ­£ç¡®åæ˜ é—®é¢˜çš„éœ€æ±‚ã€èƒ½å¤Ÿå¾—åˆ°é—®é¢˜çš„æ­£ç¡®ç­”æ¡ˆã€‚ å¯è¯»æ€§ : ç®—æ³•è®¾è®¡çš„å¦ä¸€ä¸ªç›®çš„å°±æ˜¯ä¸ºäº†ä¾¿äºé˜…è¯»ã€ç†è§£å’Œäº¤æµã€‚ å¥å£®æ€§ : å½“è¾“å…¥æ•°æ®ä¸åˆæ³•æ—¶,ç®—æ³•ä¹Ÿèƒ½åšå‡ºç›¸å…³å¤„ç†,è€Œä¸æ˜¯äº§ç”Ÿå¼‚å¸¸æˆ–è«åå…¶å¦™çš„ç»“æœã€‚ æ—¶é—´æ•ˆç‡é«˜å’Œå­˜å‚¨é‡ä½ : å¥½çš„ç®—æ³•è¿˜åº”è¯¥å…·å¤‡æ—¶é—´æ•ˆç‡é«˜å’Œå­˜å‚¨é‡ä½çš„ç‰¹ç‚¹ã€‚ 4.åº¦é‡æ–¹æ³• äº‹åç»Ÿè®¡ äº‹å‰åˆ†æé¢„ä¼° 5.ç®—æ³•æ—¶é—´å¤æ‚åº¦5.1 å®šä¹‰åœ¨è¿›è¡Œç®—æ³•åˆ†ææ—¶,è¯­å¥æ€»çš„æ‰§è¡Œæ¬¡æ•°T(n)æ˜¯å…³äºé—®é¢˜è§„æ¨¡nçš„å‡½æ•°,è¿›è€Œåˆ†æT(n)éšnçš„å˜åŒ–æƒ…å†µå¹¶ç¡®å®šT(n)çš„æ•°é‡çº§.ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦,ä¹Ÿå°±æ˜¯ç®—æ³•çš„æ—¶é—´é‡åº¦,è®°ä½œ:T(n)=O(f(n)).å®ƒè¡¨ç¤ºéšç€é—®é¢˜è§„æ¨¡nçš„å¢å¤§,ç®—æ³•æ‰§è¡Œæ—¶é—´çš„å¢é•¿ç‡å’Œf(n)çš„å¢é•¿ç‡ç›¸åŒ,ç§°ä½œç®—æ³•çš„æ¸è¿‘æ—¶é—´å¤æ‚åº¦,ç®€ç§°ä¸ºæ—¶é—´å¤æ‚åº¦.å…¶ä¸­f(n)æ˜¯é—®é¢˜è§„æ¨¡nçš„æŸä¸ªå‡½æ•° è¿™æ ·ç”¨å¤§å†™O()æ¥ä½“ç°ç®—æ³•æ—¶é—´å¤æ‚åº¦çš„è®°æ³•,ç§°ä¹‹ä¸ºå¤§Oè®°æ³•ã€‚ 5.2 æ¨åˆ°å¤§Oé˜¶æ–¹æ³• ç”¨å¸¸æ•°1å–ä»£è¿è¡Œæ—¶é—´ä¸­çš„æ‰€æœ‰åŠ æ³•å¸¸æ•° åœ¨ä¿®æ”¹åçš„è¿è¡Œæ¬¡æ•°å‡½æ•°ä¸­,åªä¿ç•™æœ€é«˜é˜¶é¡¹ å¦‚æœæœ€é«˜é˜¶é¡¹å­˜åœ¨ä¸”ä¸æ˜¯1,åˆ™å»é™¤ä¸è¿™ä¸ªé¡¹ç›¸ä¹˜çš„å¸¸æ•° 5.3 å¸¸è§æ—¶é—´å¤æ‚åº¦å³æ’åº O(1) : å¸¸æ•°é˜¶ O(logn) : å¯¹æ•°é˜¶ O(n) : çº¿æ€§é˜¶ O(nlogn) : nlogné˜¶ O(nÂ²) : å¹³æ–¹é˜¶ O(nÂ³) : ç«‹æ–¹é˜¶ O(2â¿) : æŒ‡æ•°é˜¶ O(n!) : é˜¶ä¹˜é˜¶ O(nâ¿) ä»å°åˆ°å¤§çš„æ’åº : O(1)&lt;O(logn)&lt;O(n)&lt;O(nlogn)&lt;O(nÂ²)&lt;O(nÂ³)&lt;O(2â¿)&lt;O(n!)&lt;O(nâ¿) 5.4 æœ€åæƒ…å†µä¸å¹³å‡æƒ…å†µæœ€åæƒ…å†µ å®šä¹‰ä¸€ç±»è¾“å…¥ï¼Œåœ¨è¿™ç±»è¾“å…¥ä¸‹ï¼Œç®—æ³•è¡¨ç°å‡ºäº†æœ€åçš„è¿è¡Œæ€§èƒ½ã€‚è¿™ç±»è¾“å…¥çš„å…±åŒæ€§è´¨é˜»æ­¢äº†ç®—æ³•é«˜æ•ˆåœ°è¿è¡Œï¼Œè€Œä¸åªæ˜¯é’ˆå¯¹ç‰¹å®šçš„è¾“å…¥ã€‚ è®¡ç®—æœ€åæƒ…å†µçš„æ—¶é—´å¤æ‚åº¦ ä¸€ç§ä¿è¯ï¼Œä¿è¯è¿è¡Œæ—¶é—´ä¸ä¼šæ›´åäº†ã€‚ æ˜¯æœ€é‡è¦çš„éœ€æ±‚ï¼Œé€šå¸¸æåˆ°çš„è¿è¡Œæ—¶é—´éƒ½æ˜¯æœ€åæƒ…å†µçš„è¿è¡Œæ—¶é—´ã€‚ å¯¹å®æ—¶æ€§è¦æ±‚éå¸¸é«˜çš„æƒ…å†µï¼Œå¿…é¡»åˆ†ææœ€åæƒ…å†µã€‚ å¹³å‡æƒ…å†µ å¹³å‡æƒ…å†µæ˜¯è¡¨ç¤ºç®—æ³•åœ¨éšæœºç»™å®šçš„æ•°æ®ä¸ŠæœŸæœ›çš„æ‰§è¡Œæƒ…å†µã€‚é€šä¿—åœ°è¯´ï¼Œä¸€äº›è¾“å…¥å¯èƒ½ä¼šåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹è€—è´¹ç¨‹åºå¤§é‡çš„æ—¶é—´ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†çš„è¾“å…¥å¹¶ä¸ä¼šè¿™æ ·ã€‚è¿™ä¸ªè¡¡é‡æ ‡å‡†æè¿°äº†ç”¨æˆ·å¯¹ç®—æ³•æ€§èƒ½çš„æœŸæœ›ã€‚ è®¡ç®—æ‰€æœ‰æƒ…å†µçš„å¹³å‡å€¼ æœŸæœ›çš„è¿è¡Œæ—¶é—´ï¼Œæ˜¯æ‰€æœ‰æƒ…å†µä¸­æœ€æœ‰æ„ä¹‰çš„ã€‚ ç°å®ä¸­å¹³å‡è¿è¡Œæ—¶é—´å¾ˆéš¾é€šè¿‡åˆ†æå¾—åˆ°ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡è¿è¡Œä¸€å®šæ•°é‡çš„å®éªŒæ•°æ®åä¼°ç®—å‡ºæ¥çš„ã€‚ å¯¹å®æ—¶æ€§æ²¡æœ‰è¦æ±‚çš„æƒ…å†µï¼Œåˆ†æå¹³å‡æƒ…å†µå³å¯ã€‚ 5.5 ç©ºé—´å¤æ‚åº¦é€šè¿‡è®¡ç®—ç®—æ³•æ‰€éœ€çš„å­˜å‚¨ç©ºé—´å®ç°,ç®—æ³•ç©ºé—´å¤æ‚åº¦çš„è®¡ç®—å…¬å¼:S(n) = O(f(n)),å…¶ä¸­nä¸ºé—®é¢˜çš„è§„æ¨¡,f(n)ä¸ºè¯­å¥å…³äºnæ‰€å å­˜å‚¨ç©ºé—´çš„å‡½æ•°. æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/07/14/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E7%AC%AC%E4%BA%8C%E7%AB%A0%20%E7%AE%97%E6%B3%95/"},{"title":"GitHub Actions è‡ªåŠ¨éƒ¨ç½² Hexo","text":"Github Actions æ˜¯ GitHub å®˜æ–¹ CI å·¥å…·ï¼Œä¸ GitHub æ— ç¼é›†æˆã€‚ä¹‹å‰åšå®¢ä½¿ç”¨ TravisCI å®ç°çš„è‡ªåŠ¨éƒ¨ç½²ï¼Œç°åœ¨è½¬ç”¨ GitHub Actions éƒ¨ç½²ï¼Œæœ¬æ–‡è®°å½•éƒ¨ç½²æµç¨‹ã€‚ ç®€å•ä»‹ç»ä¸‹ GitHub Actions ä¸­çš„æœ¯è¯­ï¼š workflowï¼šè¡¨ç¤ºä¸€æ¬¡æŒç»­é›†æˆçš„è¿‡ç¨‹ jobï¼šæ„å»ºä»»åŠ¡ï¼Œä¸€ä¸ª workflow å¯ä»¥ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ª job ç»„æˆï¼Œå¯æ”¯æŒå¹¶å‘æ‰§è¡Œ job stepï¼šä¸€ä¸ª job ç”±ä¸€ä¸ªæˆ–å¤šä¸ª step ç»„æˆï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ actionï¼šæ¯ä¸ª step ç”±ä¸€ä¸ªæˆ–å¤šä¸ª action ç»„æˆï¼ŒæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œ æ¥ä¸‹æ¥ä»‹ç»ä¸‹æ“ä½œæ­¥éª¤ï¼š 1.åšå®¢å·¥ç¨‹GitHub åšå®¢åˆ›å»ºæ­¥éª¤éæœ¬æ–‡é‡ç‚¹ï¼Œè¯·è‡ªè¡Œæœç´¢ã€‚æ¨èä½¿ç”¨ master åˆ†æ”¯ä½œä¸ºæœ€ç»ˆéƒ¨ç½²åˆ†æ”¯ï¼Œæºç åˆ†æ”¯å¯ä»¥æ ¹æ®è‡ªå·±å–œå¥½åˆ›å»ºï¼Œæˆ‘è¿™é‡Œåˆ›å»ºçš„æ˜¯ hexoã€‚ 2.ç”Ÿæˆå…¬ç§é’¥æºç åˆ†æ”¯ä¸­é€šè¿‡ä¸‹é¢å‘½ä»¤ç”Ÿæˆå…¬é’¥å’Œç§é’¥ã€‚ 123~ cd github/lujiahao0708.github.io ~ git checkout hexo~ ssh-keygen -t rsa -b 4096 -C &quot;$(git config user.email)&quot; -f github-deploy-key -N &quot;&quot; ç›®å½•ä¸­ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š github-deploy-key.pub â€” å…¬é’¥æ–‡ä»¶ github-deploy-key â€” ç§é’¥æ–‡ä»¶ å…¬é’¥å’Œç§é’¥åˆ‡è®°è¦æ·»åŠ åˆ° .gitignore ä¸­ï¼ï¼ï¼ 3.GitHub æ·»åŠ å…¬é’¥åœ¨ GitHub ä¸­åšå®¢å·¥ç¨‹ä¸­æŒ‰ç…§ Settings-&gt;Deploye keys-&gt;Add deploy key æ‰¾åˆ°å¯¹åº”çš„é¡µé¢ï¼Œç„¶åè¿›è¡Œå…¬é’¥æ·»åŠ ã€‚è¯¥é¡µé¢ä¸­ Title è‡ªå®šä¹‰å³å¯ï¼ŒKey ä¸­æ·»åŠ  github-deploy-key.pub æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚ æ³¨æ„ï¼šåˆ‡è®°ä¸è¦å¤šå¤åˆ¶ç©ºæ ¼!!!åˆ‡è®°è¦å‹¾é€‰ Allow write accessï¼Œå¦åˆ™ä¼šå‡ºç°æ— æ³•éƒ¨ç½²çš„æƒ…å†µã€‚ 4.GitHub æ·»åŠ ç§é’¥åœ¨ GitHub ä¸­åšå®¢å·¥ç¨‹ä¸­æŒ‰ç…§ Settings-&gt;Secrets-&gt;Add a new secrets æ‰¾åˆ°å¯¹åº”çš„é¡µé¢ï¼Œç„¶åè¿›è¡Œç§é’¥æ·»åŠ ã€‚è¯¥é¡µé¢ä¸­ Name è‡ªå®šä¹‰å³å¯ï¼ŒValue ä¸­æ·»åŠ  github-deploy-key æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚ æ³¨æ„ï¼šåˆ‡è®°ä¸è¦å¤šå¤åˆ¶ç©ºæ ¼!!! 5.åˆ›å»ºç¼–è¯‘è„šæœ¬åœ¨åšå®¢æºç åˆ†æ”¯(æˆ‘è¿™é‡Œæ˜¯hexoåˆ†æ”¯)ä¸­åˆ›å»º .github/workflows/HexoCI.yml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334name: CIon: push: branches: - hexojobs: build: runs-on: ubuntu-latest steps: - name: Checkout source uses: actions/checkout@v1 with: ref: hexo - name: Use Node.js ${{ matrix.node_version }} uses: actions/setup-node@v1 with: version: ${{ matrix.node_version }} - name: Setup hexo env: ACTION_DEPLOY_KEY: ${{ secrets.HEXO_DEPLOY_PRI }} run: | mkdir -p ~/.ssh/ echo \"$ACTION_DEPLOY_KEY\" &gt; ~/.ssh/id_rsa chmod 600 ~/.ssh/id_rsa ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts git config --global user.email \"lujiahao0708@gmail.com\" git config --global user.name \"lujiahao0708\" npm install hexo-cli -g npm install - name: Hexo deploy run: | hexo clean hexo d 6.Hexo é…ç½®åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ä¿®æ”¹ _config.yml ï¼Œå¢åŠ éƒ¨ç½²ç›¸å…³å†…å®¹ï¼š 1234deploy: type: git repo: git@github.com:lujiahao0708/lujiahao0708.github.io.git branch: master è¿™é‡Œçš„repoè¦å¡«å†™sshçš„å½¢å¼ï¼Œä½¿ç”¨httpå½¢å¼å¯èƒ½ä¼šæœ‰é—®é¢˜ 7.éªŒè¯ç°åœ¨ Hexo å·²ç»å’Œ GitHub Actions å·²ç»é›†æˆäº†ï¼Œæ¥ä¸‹æ¥åœ¨åšå®¢æºç åˆ†æ”¯ä¸Šæ¨é€ä»£ç å³å¯è‡ªåŠ¨ç¼–è¯‘éƒ¨ç½²ã€‚å…·ä½“æ‰§è¡Œè¿‡ç¨‹å¯ä»¥åœ¨ Actions ä¸­æŸ¥çœ‹ï¼š æ¬¢è¿è®¿é—®æˆ‘çš„åšå®¢ï¼šhttps://lujiahao0708.github.io/ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2020/04/11/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/GitHub%20Actions%20%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2%20Hexo/"},{"title":"ã€Šå¤§è¯æ•°æ®ç»“æ„ã€‹ç¬¬ä¸‰ç«  çº¿æ€§è¡¨(äºŒ) å•é“¾è¡¨","text":"é“¾å¼å­˜å‚¨çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨ç»“æ„çš„ç‰¹ç‚¹æ˜¯ç”¨ä¸€ç»„ä»»æ„çš„å­˜å‚¨å•å…ƒå‡ºå¤„çº¿æ€§è¡¨çš„æ•°æ®å…ƒç´ ,è¿™ç»„å­˜å‚¨å•å…ƒå¯ä»¥æ˜¯è¿ç»­çš„,ä¹Ÿå¯ä»¥æ˜¯ä¸è¿ç»­çš„ã€‚ å•é“¾è¡¨ä¸‹å›¾æ˜¯æœ€ç®€å•çš„å•å‘é“¾è¡¨: ä»£ç è¯¦è§: GitHub æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/07/15/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8A%E5%A4%A7%E8%AF%9D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E3%80%8B%E7%AC%AC%E4%B8%89%E7%AB%A0%20%E7%BA%BF%E6%80%A7%E8%A1%A8(%E4%BA%8C)%20%E5%8D%95%E9%93%BE%E8%A1%A8/"},{"title":"è¿˜åœ¨ç”¨if elseï¼Ÿç­–ç•¥æ¨¡å¼äº†è§£ä¸€ä¸‹ï¼","text":"å°ç¼–åœ¨å…¬å¸è´Ÿè´£çš„å°±æ˜¯è®¢å•å–æ¶ˆä¸šåŠ¡ï¼Œè€ç³»ç»Ÿä¸­å„ç§ç±»å‹è®¢å•å–æ¶ˆéƒ½æ˜¯é€šè¿‡if else åˆ¤æ–­ä¸åŒçš„è®¢å•ç±»å‹è¿›è¡Œä¸åŒçš„é€»è¾‘ã€‚åœ¨ç»å†è€ç³»ç»Ÿçš„æŠ˜ç£¨å’Œäº§å“éœ€æ±‚çš„ä¸æ–­å˜æ›´ï¼Œå°ç¼–å†³å®šè¿›è¡Œä¸€æ¬¡å¤§çš„é‡æ„ï¼šæ¶ˆç­ if elseã€‚ æ¥ä¸‹æ¥å°±å‘å¤§å®¶ä»‹ç»ä¸‹æ˜¯å¦‚ä½•æ¶ˆç­ if elseã€‚ 1. if elseæ¨¡å¼1234567891011121314@Servicepublic class CancelOrderService { public void process(OrderDTO orderDTO) { int serviceType = orderDTO.getServiceType(); if (1 == serviceType) { System.out.println(\"å–æ¶ˆå³æ—¶è®¢å•\"); } else if (2 == serviceType) { System.out.println(\"å–æ¶ˆé¢„çº¦è®¢å•\"); } else if (3 == serviceType) { System.out.println(\"å–æ¶ˆæ‹¼è½¦è®¢å•\"); } }} è‹¥å¹²ä¸ªæœˆå†æ¥çœ‹å°±æ˜¯è¿™æ ·çš„æ„Ÿè§‰ 2. ç­–ç•¥æ¨¡å¼2.1 ç­–ç•¥æ¨¡å¼å®ç°çš„Service123456789101112@Servicepublic class CancelOrderStrategyService { @Autowired private StrategyContext context; public void process(OrderDTO orderDTO) { OrderTypeEnum orderTypeEnum = OrderTypeEnum.getByCode(orderDTO.getServiceType()); AbstractStrategy strategy = context.getStrategy(orderTypeEnum); strategy.process(orderDTO); }} ç®€æ´çš„æœ‰ç‚¹è¿‡åˆ†äº†æ˜¯ä¸æ˜¯!!! 2.2 å„ç§ç±»å‹ç­–ç•¥å®ç°åŠæŠ½è±¡ç­–ç•¥ç±»ä¸‹é¢é€‰å–äº†å³æ—¶è®¢å•å’Œé¢„çº¦è®¢å•çš„ç­–ç•¥. 12345678@Service@OrderTypeAnnotation(orderType = OrderTypeEnum.INSTANT)public class InstantOrderStrategy extends AbstractStrategy { @Override public void process(OrderDTO orderDTO) { System.out.println(\"å–æ¶ˆå³æ—¶è®¢å•\"); }} 12345678@Service@OrderTypeAnnotation(orderType = OrderTypeEnum.BOOKING)public class BookingOrderStrategy extends AbstractStrategy { @Override public void process(OrderDTO orderDTO) { System.out.println(\"å–æ¶ˆé¢„çº¦è®¢å•\"); }} 123public abstract class AbstractStrategy { abstract public void process(OrderDTO orderDTO);} 2.3 ç­–ç•¥ç±»å‹æ³¨è§£æ¯ä¸ªç­–ç•¥ä¸­å¢åŠ äº†æ³¨è§£OrderTypeAnnotation,ä»¥æ ‡æ³¨é€‚ç”¨äºä¸åŒç±»å‹çš„ç­–ç•¥å†…å®¹. 1234567@Target({ElementType.TYPE})@Retention(RetentionPolicy.RUNTIME)@Documented@Inheritedpublic @interface OrderTypeAnnotation { OrderTypeEnum orderType();} 2.4 ç­–ç•¥å¤„ç†å™¨ç±»StrategyProcessorå’Œç­–ç•¥ä¸Šä¸‹æ–‡StrategyContextå…¶ä¸­æœ€ä¸ºæ ¸å¿ƒçš„ä¸ºStrategyProcessor ç­–ç•¥å¤„ç†å™¨ç±»å’ŒStrategyContext ç­–ç•¥ä¸Šä¸‹æ–‡, 1234567891011121314151617@Componentpublic class StrategyProcessor implements BeanFactoryPostProcessor { private static final String STRATEGY_PACKAGE = \"com.lujiahao.strategy\"; @Override public void postProcessBeanFactory(ConfigurableListableBeanFactory configurableListableBeanFactory) throws BeansException { Map&lt;OrderTypeEnum, Class&gt; handlerMap = Maps.newHashMapWithExpectedSize(3); ClassScanner.scan(STRATEGY_PACKAGE, OrderTypeAnnotation.class).forEach(clazz -&gt; { OrderTypeEnum type = clazz.getAnnotation(OrderTypeAnnotation.class).orderType(); handlerMap.put(type, clazz); }); StrategyContext context = new StrategyContext(handlerMap); configurableListableBeanFactory.registerSingleton(StrategyContext.class.getName(), context); }} 123456789101112131415161718192021222324public class StrategyContext { private Map&lt;OrderTypeEnum, Class&gt; strategyMap; public StrategyContext(Map&lt;OrderTypeEnum, Class&gt; strategyMap) { this.strategyMap = strategyMap; } public AbstractStrategy getStrategy(OrderTypeEnum orderTypeEnum) { if (orderTypeEnum == null) { throw new IllegalArgumentException(\"not fond enum\"); } if (CollectionUtils.isEmpty(strategyMap)) { throw new IllegalArgumentException(\"strategy map is empty,please check you strategy package path\"); } Class clazz = strategyMap.get(orderTypeEnum); if (clazz == null) { throw new IllegalArgumentException(\"not fond strategy for type:\" + orderTypeEnum.getCode()); } return (AbstractStrategy) SpringBeanUtils.getBean(clazz); }} é¦–å…ˆä¼šæ‰«ææŒ‡å®šåŒ…ä¸­æ ‡æœ‰@OrderTypeAnnotationçš„ç±» å°†ç¬¦åˆç±»çš„å¯¹åº”çš„æšä¸¾å€¼ä½œä¸ºkeyï¼Œå¯¹åº”çš„ç±»ä½œä¸ºvalueï¼Œä¿å­˜åœ¨ç­–ç•¥Mapä¸­ åˆå§‹åŒ–StrategyContext,å¹¶æ³¨å†Œåˆ°springå®¹å™¨ä¸­,åŒæ—¶å°†ç­–ç•¥Mapä¼ å…¥å…¶ä¸­ æˆ‘ä»¬ä½¿ç”¨äº†æšä¸¾ä½œä¸ºMapä¸­çš„key,ç›¸ä¿¡å¤§å®¶å¾ˆå°‘æœ‰äººè¿™æ ·æ“ä½œè¿‡,ä¸è¿‡å¯ä»¥æ”¾å¿ƒæ“ä½œ.é€šè¿‡ä¸‹é¢ä¸¤ç¯‡æ–‡ç« è§£ç­”å¤§å®¶çš„ç–‘é—®. è‡ªå®šä¹‰æšä¸¾ç±» Enum æ˜¯å¦å¯ä»¥ä½œä¸º HashMap çš„key Java åœ¨ Map ä¸­ä½¿ç”¨å¤æ‚æ•°æ®ç±»å‹ä½œä¸º Key 3. æ€»ç»“ç­–ç•¥æ¨¡å¼æå¤§çš„å‡å°‘if elseç­‰æ¨¡æ¿ä»£ç ,åœ¨æå‡ä»£ç å¯è¯»æ€§çš„åŒæ—¶,ä¹Ÿå¤§å¤§å¢åŠ ä»£ç çš„çµæ´»æ€§,æ·»åŠ æ–°çš„ç­–ç•¥å³å¯ä»¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚.æœ¬äººåœ¨æˆ‘å¸ä¸šåŠ¡ä¸­å¯¹ç­–ç•¥æ¨¡å¼çš„åº”ç”¨å¾—åˆ°äº†å¾ˆå¥½çš„éªŒè¯,ä»æ­¤å†ä¹Ÿä¸ç”¨æ‹…å¿ƒäº§å“æ”¹éœ€æ±‚.ç”¨ç­–ç•¥æ¨¡å¼ä¸€æ—¶çˆ½,ä¸€ç›´ç”¨ä¸€ç›´çˆ½ğŸ˜! 4. ä»£ç å®Œæ•´ä»£ç  æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/01/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"},{"title":"ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬¬å…­ç«  ç±»æ–‡ä»¶ç»“æ„","text":"6.1 æ¦‚è¿°ä»£ç ç¼–è¯‘çš„ç»“æœä»æœ¬åœ°æœºå™¨ç è½¬å˜ä¸ºå­—èŠ‚ç ï¼Œæ˜¯å­˜å‚¨æ ¼å¼å‘å±•çš„ä¸€å°æ­¥ï¼Œå´æ˜¯ç¼–ç¨‹è¯­è¨€å‘å±•çš„ä¸€å¤§æ­¥ã€‚ 6.2 æ— å…³æ€§çš„åŸºçŸ³Javaè™šæ‹Ÿæœºæœ‰ä¸¤ä¸ªæ— å…³æ€§ï¼Œå³å¹³å°æ— å…³æ€§å’Œè¯­è¨€æ— å…³æ€§ã€‚å­—èŠ‚ç (ByteCode) æ˜¯æ„æˆå¹³å°æ— å…³æ€§çš„åŸºçŸ³ã€‚åœ¨ Java å‘å±•ä¹‹åˆï¼Œè®¾è®¡è€…å°±æ›¾ç»è€ƒè™‘è¿‡å¹¶å®ç°äº†è®©å…¶ä»–è¯­è¨€è¿è¡Œåœ¨ Java è™šæ‹Ÿæœºä¹‹ä¸Šçš„å¯èƒ½æ€§ï¼Œç”±æ­¤ Java è§„èŒƒæ‹†åˆ†æˆäº† Javaè¯­è¨€è§„èŒƒã€ŠThe Java Language Specificationã€‹åŠ Java è™šæ‹Ÿæœºè§„èŒƒã€ŠThe Java Virtual Machine Specificationã€‹ã€‚ In the future, we will consider bounded extensions to the Java virtual machine to provide better support for the other languages. è¯­è¨€æ— å…³æ€§æ˜¯æŒ‡è™šæ‹Ÿæœºå¹¶ä¸æ­¢æ‰§è¡Œ Javaç¨‹åºï¼Œä¹Ÿè€ƒè™‘è®©å…¶æ”¯æŒå…¶ä»–è¯­è¨€(Groovy/Scala/Kotlinç­‰)çš„è¿è¡Œã€‚ â€œä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚Javaçš„å¹³å°æ— å…³æ€§å³ä½“ç°åœ¨æ­¤å¤„ï¼Œå¯ä»¥åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œã€‚ 6.3 Class ç±»æ–‡ä»¶çš„ç»“æ„Class æ–‡ä»¶æ˜¯ä¸€ç»„ä»¥8ä½å­—èŠ‚ä¸ºåŸºç¡€å•ä½çš„äºŒè¿›åˆ¶æµã€‚Class æ–‡ä»¶é‡‡ç”¨ä¸€ç§ç±»ä¼¼äº C è¯­è¨€ç»“æ„ä½“çš„ä¼ªç»“æ„æ¥å­˜å‚¨æ•°æ® : æ— ç¬¦å·æ•° åŸºæœ¬çš„æ•°æ®ç±»å‹ u1 / u2 / u4 / u8 åˆ†åˆ«ä»£è¡¨1ä¸ªå­—èŠ‚ / 2ä¸ªå­—èŠ‚ / 4ä¸ªå­—èŠ‚ / 8ä¸ªå­—èŠ‚ å¯ä»¥ç”¨æ¥æè¿°æ•°å­— / ç´¢å¼•å¼•ç”¨ / æ•°é‡å€¼æˆ–è€…æŒ‰ç…§UTF-8ç¼–ç æ„æˆå­—ç¬¦ä¸²å€¼ è¡¨ å¤åˆæ•°æ®ç±»å‹ ç”±å¤šä¸ªæ— ç¬¦å·æ•°æˆ–è€…å…¶ä»–è¡¨ä½œä¸ºæ•°æ®é¡¹æ„æˆï¼Œä¹ æƒ¯ä»¥â€œ_infoâ€ç»“å°¾ ç”¨äºæè¿°æœ‰å±‚æ¬¡å…³ç³»çš„å¤åˆç»“æ„çš„æ•°æ®ï¼Œæ•´ä¸ª Class æ–‡ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å¼ è¡¨ 6.3.1 é­”æ•°ä¸ Class æ–‡ä»¶çš„ç‰ˆæœ¬æ¯ä¸ª Class æ–‡ä»¶çš„å¤´4ä¸ªå­—èŠ‚ç§°ä¸ºé­”æ•°(Magic Number)ã€‚å”¯ä¸€ä½œç”¨æ˜¯ç¡®å®šè¿™ä¸ªæ–‡ä»¶æ˜¯å¦ä¸ºä¸€ä¸ªèƒ½è¢«è™šæ‹Ÿæœºæ¥å—çš„ Class æ–‡ä»¶ã€‚ ç´§æ¥ç€é­”æ•°çš„4ä¸ªå­—èŠ‚æ˜¯ Class æ–‡ä»¶çš„ç‰ˆæœ¬å· : ç¬¬5å’Œç¬¬6ä¸ªå­—èŠ‚æ˜¯æ¬¡ç‰ˆæœ¬å·(Minor Version)ï¼Œç¬¬7å’Œç¬¬8ä¸ªå­—èŠ‚æ˜¯ä¸»ç‰ˆæœ¬å·(Major Version)ã€‚ å°†HelloWorld.javaç¼–è¯‘æˆ Class æ–‡ä»¶åï¼Œä½¿ç”¨ Synalyze It 16è¿›åˆ¶ç¼–è¾‘å·¥å…·æŸ¥çœ‹ ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ Class æ–‡ä»¶çš„ç‰ˆæœ¬å· 12345678910# javap -v HelloWorld.class Classfile /Users/lujiahao/HelloWorld.class Last modified 2019-1-12; size 430 bytes MD5 checksum f6fad4e65a952d7f01272063b971c2f8 Compiled from &quot;HelloWorld.java&quot;public class HelloWorld minor version: 0 major version: 52 flags: ACC_PUBLIC, ACC_SUPER... åŒæ—¶æŸ¥çœ‹æœ¬æœº JDK ç‰ˆæœ¬ : 1234# java -version java version &quot;1.8.0_161&quot;Java(TM) SE Runtime Environment (build 1.8.0_161-b12)Java HotSpot(TM) 64-Bit Server VM (build 25.161-b12, mixed mode) é€šè¿‡ä¸Šè¿°æ–¹å¼æˆ‘ä»¬å¯ä»¥çœ‹åˆ° Class æ–‡ä»¶çš„å‰9ä¸ªå­—èŠ‚çš„å«ä¹‰ã€‚ä¸‹é¢æ˜¯ Class æ–‡ä»¶çš„ç‰ˆæœ¬å·æ±‡æ€» : å‘å¸ƒç‰ˆæœ¬å· å†…éƒ¨ç‰ˆæœ¬å·ï¼ˆåå…­è¿›åˆ¶ï¼‰ å†…éƒ¨ç‰ˆæœ¬å·ï¼ˆåè¿›åˆ¶ï¼‰ 1.5 31 49 1.6 32 50 1.7 33 51 1.8 34 52 Tips 0xCAFEBABE çš„ç”±æ¥ Synalyze It 16è¿›åˆ¶ç¼–è¾‘å·¥å…· 6.3.2 å¸¸é‡æ± 6.3.3 è®¿é—®æ ‡å¿—6.3.4 ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ6.3.5 å­—æ®µè¡¨é›†åˆ6.3.6 æ–¹æ³•è¡¨é›†åˆ6.3.7 å±æ€§è¡¨é›†åˆ æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/01/12/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E7%AC%AC%E5%85%AD%E7%AB%A0%20%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"},{"title":"åˆ åº“å‹’ç´¢æ¯”ç‰¹å¸!è¿™ä¸ªå…­ä¸€è¿‡çš„æœ‰æ„æ€!","text":"æ²¡æœ‰åˆ åº“è·‘è·¯ï¼Œå´æœ‰åˆ åº“å‹’ç´¢æ¯”ç‰¹å¸ï¼å“ˆå“ˆå“ˆå“ˆğŸ˜„ä¸‹é¢ç»™å¤§å®¶è®²è¿°ä¸€ä¸‹ä»Šå¹´å…­ä¸€å„¿ç«¥èŠ‚å‘ç”Ÿäº†å•¥å’Œå’‹è§£å†³çš„ã€‚ 1. äº‹ä»¶å‘ç”Ÿä¹‹å‰åœ¨è…¾è®¯äº‘ä¹°äº†å°åŸºç¡€é…ç½®çš„æœåŠ¡å™¨ï¼Œå¹³æ—¶å°±éƒ¨ç½²ä¸€äº›ç»ƒæ‰‹é¡¹ç›®ï¼Œæœ‹å‹å¶å°”ä¹Ÿå€Ÿç”¨ä¸€ä¸‹éƒ¨ç½²å°é¡¹ç›®ã€‚æ˜¨å¤©æœ‹å‹çªç„¶å‘æ¶ˆæ¯è¯´æ•°æ®åº“æŸ¥ä¸å‡ºæ•°æ®ï¼Œè®©æˆ‘çœ‹çœ‹å’‹å›äº‹ã€‚æˆ‘æ‰“å¼€Navicatä¸€çœ‹ï¼ŒçœŸçš„æ˜¯ä¸€è„¸æ‡µé€¼â€¦ ä»€ä¹ˆæƒ…å†µè¿™æ˜¯ï¼Ÿå’‹å¤šäº†ä¸€ä¸ªæ•°æ®åº“ï¼Ÿå…¶ä»–æ•°æ®åº“æ€ä¹ˆæ•°æ®éƒ½æ²¡äº†ï¼Œéƒ½æ˜¯åŒä¸€å¼ è¡¨ï¼Ÿä¸€é€šæœç´¢æ“ä½œï¼Œæ‰çŸ¥é“åŸæ¥æ˜¯è¢«é»‘å®¢å‹’ç´¢ã€‚å¹¸äºè¿™ä¸ªæ•°æ®åº“æ˜¯æˆ‘å’Œæœ‹å‹ç”¨æ¥æµ‹è¯•çš„ï¼Œå¹³æ—¶éƒ½æ˜¯è‡ªå·±åšä¸€äº›æµ‹è¯•ç”¨ï¼Œæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„æ•°æ®ï¼Œè¿™ç§æƒ…å†µå°±ç›´æ¥åˆ é™¤é•œåƒé‡æ–°éƒ¨ç½²ä¸€ä¸ªå§ã€‚ 2. äº‹ä»¶å¤ç›˜è¿™ä¸ªMySQLå®ä¾‹æ˜¯ä½¿ç”¨Dockeréƒ¨ç½²çš„ï¼Œä»ç¬”è®°é‡Œé¢æ‰¾åˆ°å½“æ—¶å¯åŠ¨å‘½ä»¤: 123docker run -d -p 3306:3306 --name mysql_test01 \\-v /mydata/mysql_test01:/var/lib/mysql \\-e MYSQL_ROOT_PASSWORD=1234 mysql:5.7.6 çœ‹æˆ‘çš„ä½œæ­»æ“ä½œ: rootè´¦æˆ·å¼€å¯ å¼±å£ä»¤(å¯†ç 1234) ç«¯å£ç›´æ¥æš´éœ²(è€Œä¸”å®‰å…¨ç­–ç•¥3306ç«¯å£å¼€æ”¾å¤–ç½‘è®¿é—®) é€šè¿‡ä¸Šé¢ä¸€æ³¢çŒ›å¦‚è™çš„æ“ä½œï¼Œæˆ‘è¿™ä¸ªMySQLå®ä¾‹å°±æ˜¯è£¸å¥”çš„èŠ‚å¥ğŸ˜‚ã€‚ è€Œä¸”è…¾è®¯äº‘å¾ˆæ—©å°±æé†’æœ‰å¼‚åœ°ç™»å½•ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯æœ‹å‹é‚£è¾¹ç™»å½•çš„ï¼Œå°±æ²¡æ³¨æ„ã€‚ 3. é˜²èŒƒæ­¥éª¤ç»è¿‡ä¸€ç•ªæœç´¢è¯·æ•™å’Œå®è·µï¼Œæ€»ç»“äº†ä¸‹é¢å‡ ä¸ªé˜²èŒƒæ­¥éª¤ï¼Œä¾›å¤§å®¶å‚è€ƒ: 3.1 äº‘æœåŠ¡å™¨åå°è®¾ç½®äº‘æœåŠ¡å™¨å‚å®¶ä¸€èˆ¬éƒ½ä¼šæä¾›ä¸€äº›å®‰å…¨ç­–ç•¥ï¼Œå»ºè®®å¤§å®¶éƒ½æ‰“å¼€ç›¸å…³é…ç½®ã€‚ä¾‹å¦‚å¼‚åœ°ç™»å½•ç­‰ç­‰éƒ½æ˜¯å¯ä»¥æå‰é€šçŸ¥ç®¡ç†å‘˜ï¼Œææ—©åšå‡ºé£é™©é˜²èŒƒã€‚ 3.2 å¼€å¯MySQLæ—¥å¿—12345678910111213141516171819202122232425# vi /usr/local/mysql/etc/my.cnfæ·»åŠ å¦‚ä¸‹å†…å®¹:#é”™è¯¯æ—¥å¿—ï¼š -log-errlog-error=/usr/local/mysql-5.7.23-linux-glibc2.12-x86_64/log/error.log#æŸ¥è¯¢æ—¥å¿—ï¼š -loggeneral-log=ONgeneral-log-file=/usr/local/mysql-5.7.23-linux-glibc2.12-x86_64/log/general.log#æ…¢æŸ¥è¯¢æ—¥å¿—: -log-slow-queries# æ‰§è¡Œè¶…è¿‡1ç§’çš„sqlä¼šè¢«logä¸‹æ¥long_query_time=1# å¼€å¯æ…¢æŸ¥è¯¢slow_query_log=on# å°†æŸ¥è¯¢æ‰§è¡Œæ—¶é—´è¾ƒæ…¢çš„è¯­å¥è¿›è¡Œè®°å½•#log-slow-queries=/usr/local/mysql-5.7.23-linux-glibc2.12-x86_64/log/slow.logslow-query-log-file=/usr/local/mysql-5.7.23-linux-glibc2.12-x86_64/log/slow.log#äºŒè¿›åˆ¶æ—¥å¿—ï¼š -log-binserver_id=100log-bin=/usr/local/mysql-5.7.23-linux-glibc2.12-x86_64/log/bin.logé‡å¯mysqldæœåŠ¡ä½¿é…ç½®ç”Ÿæ•ˆ# /etc/init.d/mysqld restart 3.3 MySQLé…ç½®é‰´æƒMySQLå®‰è£…é»˜è®¤éœ€è¦è®¾ç½®å¯†ç ï¼Œå®‰è£…æ—¶å¦‚æœè®¾ç½®äº†å¼±å£ä»¤ï¼Œå¯é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼ä¿®æ”¹å¯†ç : UPDATE user SET password=PASSWORD(â€˜æ–°å¯†ç â€™) WHERE user=â€™rootâ€™; FLUSH PRIVILEGES; SET PASSWORD FOR root=PASSWORD(â€˜æ–°å¯†ç â€™); mysqladmin -u root -p æ—§å¯†ç  æ–°å¯†ç  ä¸€å®šè¦æ³¨æ„ä¸è¦ä½¿ç”¨å¼±å£ä»¤ï¼Œæ¨èæ•°å­—ã€å­—æ¯å’Œå­—ç¬¦æ··åˆä½¿ç”¨ã€‚ 3.4 é¿å…rootå’Œç«¯å£æš´éœ² ä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨rootè´¦æˆ·ï¼ŒåŒæ—¶æ³¨æ„æ§åˆ¶MySQLè¿è¡Œè´¦æˆ·æƒé™ï¼Œå°½é‡è®©å…¶æƒé™æœ€å° å†…ç½‘ç³»ç»Ÿå…³é—­å…¬ç½‘è®¿é—®ï¼Œé¿å…é»˜è®¤ç«¯å£ç›´æ¥æš´éœ² å¯åŠ¨å‚æ•°æˆ–é…ç½®æ–‡ä»¶ä¸­è®¾ç½®bind-addressï¼Œç»‘å®šå†…ç½‘IP 3.5 å¤‡ä»½ å¤‡ä»½è¡¨ç»“æ„å’Œæ•°æ® å¤‡ä»½è¡¨ç»“æ„å’Œæ•°æ® å¤‡ä»½è¡¨ç»“æ„å’Œæ•°æ® é‡è¦çš„äº‹æƒ…è¯´ä¸‰é!!! 4. æ€»ç»“æƒ³æƒ³è‡ªå·±èƒ½ç»å†è¿™ä¸€æ¬¡æ•°æ®åº“å‹’ç´¢è¿˜æŒºæœ‰æ„æ€çš„ã€‚è¿™ä¸€ç•ªæŠ˜è…¾ç¡®å®è®©æˆ‘æ„Ÿå—åˆ°ç½‘ç»œå®‰å…¨çš„é‡è¦æ€§ï¼ŒåŒæ—¶ä¹Ÿå¢å¼ºè‡ªå·±çš„å®‰å…¨æ„è¯†ã€‚æ— è®ºæ˜¯å¼€å‘å…¬å¸é¡¹ç›®è¿˜æ˜¯ä¸ªäººç»ƒæ‰‹é¡¹ç›®éƒ½è¦ä¸¥è°¨ä¸€äº›ï¼Œä¹ æƒ¯æ˜¯æ…¢æ…¢å…»æˆçš„ã€‚æ•¬ç•æ¯ä¸€è¡Œä»£ç ! æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/05/28/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A2%AB%E5%88%A0%E9%99%A4%E5%B9%B6%E8%A2%AB%E5%8B%92%E7%B4%A2%E6%AF%94%E7%89%B9%E5%B8%81!%E7%9C%9F%E6%98%AF%E5%85%AD%E4%B8%80%E5%84%BF%E7%AB%A5%E5%8A%AB%E5%95%8A!/"},{"title":"Volleyå­¦ä¹ ç¬¬äºŒç¯‡-ç¼“å­˜æµç¨‹","text":"å‰æ–‡æ¦‚è¦ ä¸Šç¯‡è¯´é“Volleyåˆå§‹åŒ–çš„æ—¶å€™éœ€è¦åˆ›å»ºä¸€ä¸ªRequestQueueæ¶ˆæ¯é˜Ÿåˆ—,ä¸‹é¢å°±æ¥çœ‹çœ‹è¿™ä¸ªRequestQueue. RequestQueue æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ç®¡ç†å™¨,é‡Œé¢ç»´æŠ¤äº†ä¸¤ä¸ªé˜Ÿåˆ—â€”CacheQueueå’ŒNetowrkQueue. Volleyç±»é‡Œé¢çš„newRequestQueueæ–¹æ³•ä¸­è°ƒç”¨äº†é˜Ÿåˆ—çš„start()æ–¹æ³•,å°±ä»è¿™ä¸ªæ–¹æ³•å…¥æ‰‹. public void start() { stop(); // Make sure any currently running dispatchers are stopped. // Create the cache dispatcher and start it. mCacheDispatcher = new CacheDispatcher(mCacheQueue, mNetworkQueue, mCache, mDelivery); mCacheDispatcher.start(); // è¿™é‡Œé»˜è®¤åˆ›å»º4ä¸ªçº¿ç¨‹ // Create network dispatchers (and corresponding threads) up to the pool size. for (int i = 0; i &lt; mDispatchers.length; i++) { NetworkDispatcher networkDispatcher = new NetworkDispatcher(mNetworkQueue, mNetwork, mCache, mDelivery); mDispatchers[i] = networkDispatcher; networkDispatcher.start(); } }è¿™é‡Œåˆ›å»ºäº†1ä¸ªCacheDispatcherå’Œ4ä¸ªNetworkDispatcher.CacheDispatcherå’Œ4ä¸ªNetworkDispatcheréƒ½æ˜¯ç»§æ‰¿äº†Threadçš„ä¸¤ä¸ªçº¿ç¨‹,ä¸€ä¸ªæ˜¯ç¼“å­˜çº¿ç¨‹,å¦ä¸€ä¸ªæ˜¯ç½‘ç»œçº¿ç¨‹. å…¶ä¸­DEFAULT_NETWORK_THREAD_POOL_SIZEä¸­å®šä¹‰äº†ç½‘ç»œçº¿ç¨‹çš„ä¸ªæ•°,å¯ä»¥æ ¹æ®ä¸åŒçš„cpuæ ¸æ•°æ¥è‡ªå®šä¹‰å¼€å¤šå°‘ä¸ªç½‘ç»œçº¿ç¨‹(çº¿ç¨‹æ•° = cpuæ ¸æ•° * 2 + 1). CacheDispatcherç¼“å­˜çº¿ç¨‹çš„æµç¨‹å®ƒç»§æ‰¿äº†Thread,æ‰€ä»¥åªéœ€è¦çœ‹å®ƒçš„run()æ–¹æ³•å°±å¥½äº†. while (true) { try { // Get a request from the cache triage queue, blocking until // at least one is available.ä»ç¼“å­˜é˜Ÿåˆ—ä¸­ä¸åœçš„å–å‡ºrequest,ç›´åˆ°é˜Ÿåˆ—ä¸­åªæœ‰ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™é˜»å¡ final Request request = mCacheQueue.take(); request.addMarker(&quot;cache-queue-take&quot;); // If the request has been canceled, don&apos;t bother dispatching it. if (request.isCanceled()) { request.finish(&quot;cache-discard-canceled&quot;); continue;// è¯·æ±‚å–æ¶ˆå°±ä¸è¯»ç¼“å­˜äº† } // Attempt to retrieve this item from cache. ä»ç¼“å­˜ä¸­è·å–ç¼“å­˜ä¿¡æ¯çš„å®ä½“ Cache.Entry entry = mCache.get(request.getCacheKey()); if (entry == null) { request.addMarker(&quot;cache-miss&quot;); // Cache miss; send off to the network dispatcher. mNetworkQueue.put(request);// ç¼“å­˜æœ¨æœ‰,å°†è¯·æ±‚æ·»åŠ åˆ°ç½‘ç»œè¯·æ±‚é˜Ÿåˆ— continue; } // If it is completely expired è¿‡æœŸ, just send it to the network. if (entry.isExpired()) { request.addMarker(&quot;cache-hit-expired&quot;); request.setCacheEntry(entry); mNetworkQueue.put(request);// ç¼“å­˜è¿‡æœŸ,æ·»åŠ åˆ°ç½‘ç»œè¯·æ±‚é˜Ÿåˆ— continue; } // We have a cache hit; parse its data for delivery back to the request. request.addMarker(&quot;cache-hit&quot;); // è§£æç½‘ç»œæ•°æ® è¿™ä¸ªæ˜¯ç”±è¯·æ±‚å¯¹è±¡requestæ¥è§£æçš„ // æ–‡æ¡£ä¸­è¯´é“:requestå¯¹è±¡è´Ÿè´£è¯·æ±‚å’Œè§£æç½‘ç»œè¯·æ±‚ Response&lt;?&gt; response = request.parseNetworkResponse( new NetworkResponse(entry.data, entry.responseHeaders)); request.addMarker(&quot;cache-hit-parsed&quot;); if (!entry.refreshNeeded()) {// ç¼“å­˜æ˜¯å¦éœ€è¦åˆ·æ–° // Completely unexpired cache hit. Just deliver the response. mDelivery.postResponse(request, response);// æ— éœ€åˆ·æ–°,ç›´æ¥åˆ†å‘ } else { // Soft-expired cache hit. We can deliver the cached response, // but we need to also send the request to the network for // refreshing. request.addMarker(&quot;cache-hit-refresh-needed&quot;); request.setCacheEntry(entry);// æ›´æ–°ç¼“å­˜ // Mark the response as intermediate.// ä¸­é—´ åª’ä»‹ response.intermediate = true; // Post the intermediate response back to the user and have // the delivery then forward the request along to the network. mDelivery.postResponse(request, response, new Runnable() { @Override public void run() { try { mNetworkQueue.put(request); } catch (InterruptedException e) { // Not much we can do about this. } } }); } } catch (InterruptedException e) { // We may have been interrupted because it was time to quit. if (mQuit) { return; } continue; } }ç¼“å­˜çš„ä¸»ä½“æµç¨‹å°±åœ¨è¿™ä¸ªæ­»å¾ªç¯é‡Œé¢,Volleyçš„dispatcherçš„åŸç†å’ŒHandleré‡Œé¢çš„looperçš„åŸç†éå¸¸ç›¸ä¼¼. è¯»å–ç¼“å­˜åˆ†å‘åˆ°ä¸»çº¿ç¨‹Response&lt;?&gt; response = request.parseNetworkResponse(new NetworkResponse(entry.data, entry.responseHeaders)); request.addMarker(&quot;cache-hit-parsed&quot;); if (!entry.refreshNeeded()) { // Completely unexpired cache hit. Just deliver the response. mDelivery.postResponse(request, response); } else { // Soft-expired cache hit. We can deliver the cached response, // but we need to also send the request to the network for // refreshing. request.addMarker(&quot;cache-hit-refresh-needed&quot;); request.setCacheEntry(entry); // Mark the response as intermediate.// ä¸­é—´ åª’ä»‹ response.intermediate = true; // Post the intermediate response back to the user and have // the delivery then forward the request along to the network. mDelivery.postResponse(request, response, new Runnable() { @Override public void run() { try { mNetworkQueue.put(request); } catch (InterruptedException e) { // Not much we can do about this. } } }); }è¯¦è§£request.parseNetworkResponse(new NetworkResponse(entry.data, entry.responseHeaders));`entry.dataæ˜¯ç¼“å­˜çš„åŸå§‹çš„byteæ•°ç»„,å°†byteæ•°ç»„å’Œå“åº”å¤´å°è£…æˆä¸€ä¸ªNetworkResponseå¯¹è±¡(Volleyé‡Œé¢çš„ç½‘ç»œå“åº”çš„ç»Ÿä¸€å¯¹è±¡).parseNetworkResponse()æ–¹æ³•å°†NetworkResponseå¯¹è±¡è§£ææˆResponseä¾›å„ç§æ³›å‹çš„è½¬æ¢. mDelivery.postResponse(request, response);mDeliveryå¯¹è±¡æ—¶åœ¨CacheDispatcherçš„æ„é€ æ–¹æ³•çš„æ—¶å€™èµ‹å€¼çš„,å¾€ä¸Šæ‰¾æ‰¾RequestQueueä¸­çš„start()æ–¹æ³•ä¸­mCacheDispatcher = new CacheDispatcher(mCacheQueue, mNetworkQueue, mCache, mDelivery); ç»§ç»­æ‰¾ public RequestQueue(Cache cache, Network network, int threadPoolSize,ResponseDelivery delivery) { mCache = cache; mNetwork = network; mDispatchers = new NetworkDispatcher[threadPoolSize]; mDelivery = delivery; }è¿˜æ‰¾ public RequestQueue(Cache cache, Network network, int threadPoolSize) { this(cache, network, threadPoolSize, new ExecutorDelivery(new Handler(Looper.getMainLooper()))); }çœ‹mDeliveryå°±æ˜¯new ExecutorDelivery(new Handler(Looper.getMainLooper())) ExecutorDeliveryä¸­æ„é€ æ–¹æ³•ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„ä¸€è¡Œ public ExecutorDelivery(final Handler handler) { // Make an Executor that just wraps the handler. mResponsePoster = new Executor() { @Override public void execute(Runnable command) { handler.post(command); } }; }handlerå°†runnableå¯¹è±¡postå‡ºå»,è€Œhandleræ˜¯é€šè¿‡Looper.getMainLooperåˆ›å»ºçš„,è¿™æ ·å°±æ˜¯é€šè¿‡æˆ‘ä»¬ç”¨ä¸»çº¿ç¨‹åˆ›å»ºçš„Handlerå°†å“åº”å‘é€åˆ°ä¸»çº¿ç¨‹ä¸­äº†. è‡³æ­¤,Volleyç¼“å­˜çš„è¯»å–/åˆ†å‘å°±å®Œæˆäº†. æ€»ç»“å®˜æ–¹å›¾è§£ä¸­çš„ç»¿è‰²çš„é‚£éƒ¨åˆ†â€”ç¼“å­˜çº¿ç¨‹çš„æµç¨‹å°±ç»“æŸäº†. åé¢æˆ‘ä¼šæ…¢æ…¢è‚¥è¥¿ç½‘ç»œçº¿ç¨‹ç›¸å…³çš„ä¸œè¥¿.","link":"/2016/05/23/Android/Volley%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%8C%E7%AF%87-%E7%BC%93%E5%AD%98%E6%B5%81%E7%A8%8B/"},{"title":"Dockeræ•™ç¨‹(å››)---Dockerfileå‘½ä»¤è¯¦è§£","text":"æ·±å…¥dockeré•œåƒæ‹‰å–é•œåƒæ–‡ä»¶åˆ°æœ¬åœ° docker pull centosæŸ¥çœ‹æœ¬åœ°é•œåƒï¼š docker images æŸ¥æ‰¾é•œåƒ docker search [é•œåƒåç§°]æ„å»ºé•œåƒ 1. ä½¿ç”¨docker commit å‘½ä»¤ ç”¨æˆ·å:lujiahao docker commit å®¹å™¨åç§°/ID lujiahao/centos-tomcat docker commit -m=&quot;describe&quot; --author=&quot;lujiahao&quot; å®¹å™¨åç§°/ID lujiahao/centos-tomcat:test docker inspect lujiahao/centos-tomcat:test 2. ä½¿ç”¨docker buildå‘½ä»¤å’ŒDockerfileæ–‡ä»¶(æ¨è) docker build -t=â€œç”¨æˆ·å/é•œåƒåç§°&quot; . docker build -t=&quot;crxy/centos&quot; . ç‚¹è¡¨ç¤ºä¼šåœ¨å½“å‰ç›®å½•ä¸­æ‰¾Dockerfileæ–‡ä»¶ å»ºè®®åˆ›å»ºé•œåƒçš„æ—¶å€™å•ç‹¬ä¸€ä¸ªç›®å½•,ç„¶ååœ¨å†™Dockerfile,è¿™ä¸ªç›®å½•å«æ„å»ºç›®å½•.å¦‚æœç›®å½•ä¸‹é¢æœ‰å…¶ä»–æ–‡ä»¶,ä¼šæŠŠç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å‘é€ç»™dockerçš„å®ˆæŠ¤è¿›ç¨‹æŸ¥çœ‹æ„å»ºçš„æ­¥éª¤å’Œå±‚çº§ docker history ç”¨æˆ·ID/é•œåƒåæ‰§è¡Œæµç¨‹ dockerfileä¸­çš„æŒ‡ä»¤ä¼šæŒ‰ç…§ä»ä¸Šåˆ°ä¸‹æ‰§è¡Œ dockeré¦–å…ˆä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨ æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œå¯¹å®¹å™¨è¿›è¡Œä¿®æ”¹ æ‰§è¡Œç±»ä¼¼docker commitçš„æ“ä½œï¼Œæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚ dockerå†åŸºäºåˆšæäº¤çš„é•œåƒè¿è¡Œä¸€ä¸ªæ–°å®¹å™¨ ç„¶åæ‰§è¡Œdockerfileä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œç›´åˆ°æ‰€æœ‰æŒ‡ä»¤éƒ½æ‰§è¡Œå®Œæ¯• DockerfileæŒ‡ä»¤è¯¦è§£ æ‰€æœ‰æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯ ä»¥#å¼€å¤´çš„éƒ½è®¤ä¸ºæ˜¯æ³¨é‡Š FROMç¬¬ä¸€æ¡æŒ‡ä»¤å¿…é¡»æ˜¯`FROM`(æŒ‡å®šä½¿ç”¨çš„åŸºç¡€é•œåƒ)MAINTAINERæŒ‡å®šé•œåƒçš„ä½œè€…ä¿¡æ¯RUNæŒ‡å®šé•œåƒè¢«æ„å»ºæ—¶è¦è¿è¡Œçš„å‘½ä»¤,é»˜è®¤ä¼šä½¿ç”¨/bin/bash -c æ‰§è¡ŒRUN åé¢æŒ‡å®šçš„å‘½ä»¤ ä¹Ÿå¯ä»¥ä½¿ç”¨RUN [&quot;mkdir&quot;,&quot;a.txt&quot;]EXPOSEå‘Šè¯‰dockerè¯¥å®¹å™¨éœ€è¦å¯¹å¤–å¼€æ”¾çš„ç«¯å£CMDæŒ‡å®šä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ docker run -i -t lujiahao/cenos-tomcat /bin/bash ç­‰äºåœ¨Dockerfileä¸­æ·»åŠ  CMD [&quot;/bin/ps&quot;] æ³¨æ„ï¼šä½¿ç”¨ docker run å‘½ä»¤å¯ä»¥è¦†ç›–CMDæŒ‡ä»¤ENTRYPOINTä¸CMDç±»ä¼¼ï¼Œä½†æ˜¯ENTRYPOINTæŒ‡å®šçš„å‘½ä»¤ä¸ä¼šè¢«docker runæŒ‡å®šçš„å‘½ä»¤è¦†ç›–ï¼Œ å®ƒä¼šæŠŠdocker runå‘½ä»¤è¡Œä¸­æŒ‡å®šçš„å‚æ•°ä¼ é€’ç»™ENTRYPOINTæŒ‡ä»¤ä¸­æŒ‡å®šçš„å‘½ä»¤å½“ä½œå‚æ•°ã€‚ ENTRYPOINT [&quot;/bin/ps&quot;] docker run -t -i lujiahao/centos -l ENTRYPOINT è¿˜å¯ä»¥å’ŒCMDç»„åˆä¸€å—æ¥ç”¨ï¼Œå¯ä»¥å®ç°ï¼Œå½“ç”¨æˆ·ä¸æŒ‡å®šå‚æ•°çš„æ—¶å€™ä½¿ç”¨é»˜è®¤çš„å‚æ•°æ‰§è¡Œï¼Œå¦‚æœç”¨æˆ·æŒ‡å®šçš„è¯å°±ä½¿ç”¨ç”¨æˆ·æä¾›çš„å‚æ•°. ENTRYPOINT [&quot;/bin/ps&quot;] CMD [&quot;-h&quot;] æ³¨æ„ï¼šå¦‚æœç¡®å®è¦è¦†ç›–é»˜è®¤çš„å‚æ•°çš„è¯ï¼Œå¯ä»¥åœ¨docker runä¸­æŒ‡å®š--entrypointè¿›è¡Œè¦†ç›–WORKDIRWORKDIR /etc RUN touch a.txt WORKDIR /usr/local RUN touch b.txt æ³¨æ„ï¼šå¯ä»¥åœ¨docker runå‘½ä»¤ä¸­ä½¿ç”¨-wè¦†ç›–å·¥ä½œç›®å½•ï¼Œä½†æ˜¯ä¸ä¼šå½±å“ä¹‹å‰åœ¨å·¥ä½œç›®å½•ä¸­æ‰§è¡Œçš„å‘½ä»¤ENVè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨è¿™è®¾ç½®çš„ç¯å¢ƒå˜é‡å¯ä»¥åœ¨åé¢çš„æŒ‡ä»¤ä¸­ä½¿ç”¨ï¼Œä½¿ç”¨$å¼•ç”¨ å¹¶ä¸”è¿™ä¸ªç¯å¢ƒå˜é‡ä¹Ÿä¼šè¢«æŒä¹…ä¿å­˜åˆ°ä»æˆ‘ä»¬çš„é•œåƒåˆ›å»ºçš„ä»»ä½•å®¹å™¨ä¸­ã€‚å¯ä»¥ä½¿ç”¨envå‘½ä»¤æŸ¥çœ‹ ä¹Ÿå¯ä»¥ä½¿ç”¨docker run å‘½ä»¤è¡Œçš„-eå‚æ•°æ¥ä¼ é€’ç¯å¢ƒå˜é‡ï¼Œè¿™äº›å˜é‡åªåœ¨è¿è¡Œæ—¶æœ‰æ•ˆ -e JAVA_HOME=/usr/localUSER(äº†è§£)å¯ä»¥æŒ‡å®šä»¥ä»€ä¹ˆç”¨æˆ·å»è¿è¡Œè¿™ä¸ªå®¹å™¨ USER ftpï¼ˆç”¨æˆ·ä¿¡æ¯ï¼šæŸ¥çœ‹/etc/groupï¼‰ è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–ç»„åˆæ–¹å¼ USER ç”¨æˆ·å/UID:ç»„/GIDï¼ˆç”¨æˆ·å/UIDå’Œç»„/GIDå¯ä»¥å•ç‹¬æŒ‡å®šæˆ–è€…ç»„åˆï¼‰ ä¸æŒ‡å®šçš„è¯é»˜è®¤å°±æ˜¯rootç”¨æˆ·ADDADDæŒ‡ä»¤ç”¨æ¥å°†æ„å»ºç›®å½•ä¸‹çš„æŒ‡å®šæ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­(æ³¨æ„åªèƒ½æ˜¯æ„å»ºç›®å½•ä¸‹é¢çš„æ–‡ä»¶) ADD a.txt /etc/a.txt ADD åœ¨æ·»åŠ å‹ç¼©æ–‡ä»¶çš„æ—¶å€™ä¼šæŠŠå‹ç¼©æ–‡ä»¶è‡ªåŠ¨è§£å‹ã€‚(gzip bzip2 xz),å¦‚æœç›®çš„ä½ç½®å·²ç»å­˜åœ¨äº†å’Œå‹ç¼©æ–‡ä»¶åŒåçš„æ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œé‚£ä¹ˆè¿™äº›æ–‡ä»¶å°†ä¼šè¢«è¦†ç›–ã€‚COPYCOPYå’ŒADDç±»ä¼¼ï¼Œä½†æ˜¯COPYå‘½ä»¤ä¸ä¼šå¯¹å‹ç¼©æ–‡ä»¶è¿›è¡Œè§£å‹ï¼Œåªè´Ÿè´£å¤åˆ¶ã€‚ å¦‚æœç›®çš„ä½ç½®ä¸å­˜åœ¨ï¼Œdockerä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰éœ€è¦çš„ç›®å½•ï¼Œå°±åƒä½¿ç”¨make -pä¸€æ · æ³¨æ„ï¼šä½¿ç”¨COPYå’ŒADDçš„å‘½ä»¤çš„æ—¶å€™ï¼Œå¤åˆ¶çš„æºæ–‡ä»¶å¿…é¡»åœ¨å½“å‰æ„å»ºç¯å¢ƒä¹‹å†…ï¼Œä¹Ÿå°±æ˜¯å’ŒDockerfileåŒä¸€ç›®å½•ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°ã€‚ONBUILDè¿™ä¸ªæŒ‡ä»¤èƒ½ä¸ºé•œåƒæ·»åŠ è§¦å‘å™¨ï¼Œå½“ä¸€ä¸ªé•œåƒè¢«ç”¨ä½œå…¶ä»–é•œåƒçš„åŸºç¡€é•œåƒæ—¶ï¼Œ è¯¥é•œåƒä¸­çš„è§¦å‘å™¨å°†ä¼šæ‰§è¡Œã€‚è¿™ä¸ªè§¦å‘å™¨æ‰€æŒ‡å®šçš„å‘½ä»¤ä¼šåœ¨FROMæŒ‡ä»¤ä¹‹åæ‰§è¡Œã€‚ ONBUILD ADD . /usr/local å…ˆåœ¨ä¸€ä¸ªé•œåƒä¸­æ·»åŠ è¿™ä¸ªè§¦å‘å™¨ï¼Œå†ä½¿ç”¨è¿™ä¸ªé•œåƒä½œä¸ºåŸºç¡€é•œåƒåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œ ä¼šå‘ç°åœ¨FROMæŒ‡ä»¤ä¹‹åå°±å¼€å§‹æ‰§è¡ŒåŸºç¡€é•œåƒä¸­è®¾ç½®çš„è§¦å‘å™¨ä¸­çš„æŒ‡ä»¤äº†ã€‚å¯åŠ¨ä¸€ä¸ªå®¹å™¨å¯ä»¥æŸ¥çœ‹æ•ˆæœã€‚ æ³¨æ„ï¼šè§¦å‘å™¨åªèƒ½è¢«ç»§æ‰¿ä¸€æ¬¡ã€‚ æœ‰ä¸€äº›å‘½ä»¤æ˜¯ä¸èƒ½åœ¨ONBUILDä¸­æŒ‡å®šçš„ã€‚åŒ…æ‹¬FROM,MAINTAINER,ONBUILD,è¿™æ ·æ˜¯ä¸ºäº†é˜²æ­¢åœ¨æ„å»ºè¿‡ç¨‹ä¸­äº§ç”Ÿé€’å½’è°ƒç”¨çš„é—®é¢˜ã€‚.dockerignoreåœ¨æ‰§è¡Œbuildçš„æ—¶å€™å¿½ç•¥æ‰ä¸éœ€è¦çš„æ–‡ä»¶ã€‚ åœ¨DockerfileåŒç›®å½•ä¸‹åˆ›å»º.dockerignore,å°†è¦å¿½ç•¥çš„æ–‡ä»¶å¡«åˆ°é‡Œé¢å³å¯.VOLUMEå¯ä»¥ç†è§£ä¸ºè®¾ç½®(å…±äº«ç›®å½•ï¼Œç£ç›˜æŒ‚è½½),æ·»åŠ åˆ°å®¹å™¨ä¸­,å¹¶æ²¡æœ‰çœŸæ­£æäº¤åˆ°é•œåƒæ–‡ä»¶ä¸­ è¿™ä¸ªæŒ‡ä»¤ç”¨æ¥å‘åŸºäºé•œåƒåˆ›å»ºçš„å®¹å™¨æ·»åŠ å·ï¼Œä¸€ä¸ªå·å¯ä»¥å­˜åœ¨äºä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨å†…çš„ç‰¹å®šçš„ç›®å½•ã€‚ å·çš„ç‰¹ç‚¹ 1ï¼šå·å¯ä»¥åœ¨å®¹å™¨é—´å…±äº«å’Œé‡ç”¨ 2ï¼šå¯¹å·çš„ä¿®æ”¹æ˜¯ç«‹åˆ»ç”Ÿæ•ˆçš„ 3ï¼šå¯¹å·çš„ä¿®æ”¹ä¸ä¼šå¯¹æ›´æ–°é•œåƒäº§ç”Ÿå½±å“ 4ï¼šå·ä¼šä¸€ç›´å­˜åœ¨ç›´åˆ°æ²¡æœ‰ä»»ä½•å®¹å™¨å†ä½¿ç”¨å®ƒã€‚ å·åŠŸèƒ½å¯ä»¥è®©æˆ‘ä»¬å°†ä¸€äº›æ•°æ®æ·»åŠ åˆ°é•œåƒä¸­è€Œä¸æ˜¯å°†å°†è¿™ä¸ªå†…å®¹æäº¤åˆ°é•œåƒä¸­ã€‚å¹¶ä¸”å…è®¸æˆ‘ä»¬åœ¨å¤šä¸ªå®¹å™¨é—´å…±äº«è¿™äº›å†…å®¹ã€‚ æ ¼å¼ï¼šVOLUME [&quot;/usr/projrct&quot;] è¿˜å¯ä»¥ä¸€æ¬¡æŒ‡å®šå¤šä¸ªVOLUME [&quot;/usr/project&quot;,&quot;/data&quot;] åˆ›å»ºæ•°æ®å· VOLUME [&quot;/usr/projrct&quot;] æˆ–è€…åœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™åˆ›å»ºdocker run -it -v /webapp centos /bin/bash æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœåªæ˜¯å£°æ˜æ•°æ®å·è€Œæ²¡æœ‰æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šçš„å…·ä½“ç›®å½•ï¼Œdockerä¼šåœ¨/var/lib/docker/vfs/dir/ ç›®å½•ä¸‹åˆ†é…ä¸€ä¸ªå…·æœ‰å”¯ä¸€åå­—çš„ç›®å½•ç»™è¯¥æ•°æ®å·ã€‚é€šè¿‡docker inspect å‘½ä»¤å¯ä»¥æŸ¥çœ‹å…·ä½“è·¯å¾„ æŒ‡å®šå®¿ä¸»ä¸»æœºç›®å½•ä½œä¸ºæ•°æ®å· å®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½• docker run -it -v /usr/local/webapp:/webapp centos /bin/bash æ³¨æ„ï¼šå¦‚æœå®¹å™¨å†…éƒ¨å·²ç»å­˜åœ¨webappç›®å½•ï¼Œé‚£ä¹ˆç›®å½•ä¸­çš„æ–‡ä»¶å°†ä¼šè¢«è¦†ç›–ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°æ®å·æ˜¯å…·æœ‰è¯»å†™æƒé™ï¼Œrwæƒé™ï¼Œå¯ä»¥æ”¹ä¸ºåªè¯»æƒé™,ro docker run -it -v /usr/local/webapp:/webapp:ro centos /bin/bash ä½¿ç”¨åœºæ™¯: å®¹å™¨é‡Œé¢çš„tomcat/webapps/ç›®å½•å’Œæœ¬åœ°å®¿ä¸»æœºçš„ç›®å½•å¯¹åº”ä¸Š,æœ¬åœ°ä¿®æ”¹ä»£ç å, ç›´æ¥é‡å¯å®¹å™¨å³å¯(å¦‚æœæ˜¯htmlè¿é‡å¯éƒ½ä¸ç”¨äº†),ç›¸å½“äºä¸€ä¸ªåŠ¨æ€éƒ¨ç½².é•œåƒæ“ä½œdockerçš„æ„å»ºç¼“å­˜ ç”±äºæ¯ä¸€æ­¥çš„æ„å»ºè¿‡ç¨‹éƒ½ä¼šå°†ç»“æœæäº¤ä¸ºé•œåƒï¼Œæ‰€ä»¥dockerçš„æ„å»ºé•œåƒè¿‡ç¨‹å°±æ˜¾å¾—éå¸¸èªæ˜ï¼Œå®ƒä¼šå°†ä¹‹å‰çš„é•œåƒå±‚çœ‹ä½œç¼“å­˜ã€‚å†è¿›è¡Œé‡æ–°æ„å»ºæ—¶ä¼šä»ç¬¬ä¸€æ¡å‘ç”Ÿäº†å˜åŒ–çš„æŒ‡ä»¤å¼€å§‹ï¼Œå‰é¢çš„éƒ½ä½¿ç”¨ç¼“å­˜ ä¸ä½¿ç”¨æ„å»ºç¼“å­˜çš„ä¸¤ç§æ–¹å¼: å¯ä»¥ä½¿ç”¨ --no-cache å‚æ•°æ¥æŒ‡å®šä¸ä½¿ç”¨ç¼“å­˜åŠŸèƒ½ ä¸€èˆ¬ä¼šåœ¨dockerfileä¸­ä½¿ç”¨ENVæŒ‡ä»¤è®¾ç½®ä¸€ä¸ªæ—¶é—´(ENV CREATE_TIME 2015-01-01),å†™åœ¨FROMä¸‹é¢,è¿™æ ·åªè¦ä¸€æ”¹äº†è¿™ä¸ªå°±ä¸ä¼šä½¿ç”¨æ„å»ºç¼“å­˜äº† å®¹å™¨ç«¯å£æ˜ å°„é»˜è®¤æƒ…å†µä¸‹dockerä¸ä¼šè‡ªåŠ¨æ‰“å¼€è¿™äº›ç«¯å£ï¼Œå¿…é¡»åœ¨è¿è¡Œå®¹å™¨çš„æ—¶å€™æŒ‡å®š-P(å¤§å†™)å‚æ•°ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“å¼€exposeæŒ‡å®šçš„æ‰€æœ‰ç«¯å£ã€‚ ä¼šéšæœºæ˜ å°„åˆ°å®¿ä¸»æœºçš„ä¸€ä¸ªç«¯å£ä¸Š EXPOSEæŒ‡ä»¤å¯ä»¥åŒæ—¶æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªéœ€è¦å¯¹å¤–å¼€æ”¾çš„ç«¯å£ expose 80 8080 6379å¯¹å¤–å¼€æ”¾ç«¯å£çš„ä¸¤ç§æ–¹å¼ -P(å¤§å†™) è¿™æ ·çš„è¯ä¼šå°†dockerfileæ–‡ä»¶ä¸­EXPOSE æŒ‡ä»¤æŒ‡å®šçš„æ‰€æœ‰ç«¯å£ä¸€å¹¶å…¬å¼€ -p(å°å†™)å¯ä»¥æ‰‹å·¥æŒ‡å®šéœ€è¦å¯¹å¤–å…¬å¼€çš„ç«¯å£å¦‚æœæ²¡æœ‰ä½¿ç”¨exposeæŒ‡å®šéœ€è¦å¯¹å¤–å¼€æ”¾çš„ç«¯å£ï¼Œè¿˜å¯ä»¥åœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™åŠ¨æ€æŒ‡å®šï¼Œä½¿ç”¨-p(å°å†™)å‚æ•° -p 80(dockerä¼šåœ¨å®¿ä¸»æœºä¸Šéšæœºé€‰æ‹©ä¸€ä¸ªä½äº49000~49900å†…æœªè¢«ä½¿ç”¨çš„ç«¯å£æ¥æ˜ å°„åˆ°å®¹å™¨ä¸­çš„80ç«¯å£ä¸Š) -p 8080:8080(æŠŠå®¿ä¸»æœºä¸Šçš„8080ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„8080ç«¯å£) å‰é¢çš„è¡¨ç¤ºå®¿ä¸»æœº -p 80:80 -p 8080:8080 åŒæ—¶æŒ‡å®šå¤šä¸ªä½¿ç”¨docker ps å¯ä»¥æŸ¥çœ‹å®¹å™¨çš„ç«¯å£åˆ†é…æƒ…å†µ æˆ–è€…ä½¿ç”¨docker port å®¹å™¨ID/åç§°æŸ¥çœ‹ æ¨é€é•œåƒåˆ°Docker Hub(éœ€è¦å…ˆç™»å½•ï¼šdocker login)docker push ç”¨æˆ·ID/é•œåƒå(docker 1.6ä»¥ä¸‹ç‰ˆæœ¬è¿™æ ·ä½¿ç”¨) docker1.6éœ€è¦ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ‰èƒ½æ¨é€ docker tag image_id docker.io/login_name/image_name docker push docker.io/login_name/image_name æ¨é€å¯èƒ½ä¼šæŠ¥é”™ï¼Œcdn-registry-1.docker.io: no such host æ˜¯å› ä¸ºç½‘ç»œé—®é¢˜ã€é‡è¯•å‡ æ¬¡ã€‚åˆ é™¤é•œåƒdocker rmi ç”¨æˆ·ID/é•œåƒå æˆ–è€…docker rmi `docker images -a -q` åˆ é™¤æ‰€æœ‰æœªæ‰“æ ‡ç­¾çš„é•œåƒ docker rmi -f $(docker images --filter &apos;dangling=true&apos;)","link":"/2017/02/28/Docker%E6%95%99%E7%A8%8B/Docker%E6%95%99%E7%A8%8B-%E5%9B%9B-Dockerfile%E8%AF%A6%E8%A7%A3/"},{"title":"08.JavaWebåŸºç¡€-Response-Request","text":"1.Response1.1 å“åº”è¡ŒsetStatus(int status);// è®¾ç½®çŠ¶æ€ç 1.2 å“åº”å¤´setHeader(String name, String value) è®¾ç½®æŒ‡å®šçš„å¤´ï¼Œä¸€èˆ¬å¸¸ç”¨ã€‚ ä¾‹å¦‚ï¼šsetHeader(&quot;location&quot;,&quot;http://www.itheima.com&quot;); setDateHeader(String name, long date) è®¾ç½®æ—¶é—´çš„ è¿™é‡Œä½¿ç”¨longçš„åŸå› æ˜¯å› ä¸º : new Date().getTime()çš„è¿”å›å€¼æ˜¯long setIntHeader(String name, int value) è®¾ç½®æ•´å‹ ä¾‹å¦‚ï¼šsetIntHeader(&quot;expires&quot;, 1000) è®¾ç½®è¿‡æœŸæ—¶é—´çš„(ç¼“å­˜é¡µé¢æ—¶é—´)ã€‚0è¡¨ç¤ºä¸ç¼“å­˜ç°ä»£æµè§ˆå™¨ä¸å¥½ä½¿ æ‹“å±• : é‡å®šå‘ æ–¹å¼1ï¼š ä½¿ç”¨302çŠ¶æ€ç å’Œlocationè¯·æ±‚å¤´æ¥å®ç° response.setStatus(302); response.setHeader(&quot;location&quot;, &quot;1.html&quot;); response.setHeader(&quot;location&quot;, &quot;/day08/1.html&quot;); æ–¹å¼2: response.sendRedirect(&quot;1.html&quot;); å¤‡æ³¨: ä½¿ç”¨refreshè·³è½¬ä¹Ÿèƒ½å®ç°å’Œé‡å®šå‘ç›¸åŒçš„æ•ˆæœ ä¸¤æ¬¡è®¿é—®çš„çŠ¶æ€ç éƒ½æ˜¯200 ï¼ˆæœ‰å¯èƒ½ç¬¬äºŒä¸ª304 è¯»å–æµè§ˆå™¨ç¼“å­˜ï¼‰ æ ¼å¼ï¼šç§’ --&gt; æŒ‡å®šç§’æ•°åˆ·æ–°å½“å‰é¡µé¢ response.setHeader(&quot;refresh&quot;, &quot;2&quot;); æ ¼å¼ï¼šç§’;url=&quot;&quot; --&gt; æŒ‡å®šç§’ä¹‹åè·³è½¬åˆ°æŒ‡å®šçš„url response.setHeader(&quot;refresh&quot;, &quot;0;url=1.html&quot;);1.3 å“åº”ä½“Responseæä¾›å­—ç¬¦æµå’Œå­—èŠ‚æµ.ä¸€èˆ¬æƒ…å†µï¼Œå¦‚æœæ˜¯æµï¼Œå¿…é¡»å…³é—­æµã€‚ä½†servletä¸­å¦‚æœä½¿ç”¨å¯ä»¥ä¸å…³é—­å¦‚æœæ²¡æœ‰å…³é—­æµï¼Œtomcatåœ¨è¯·æ±‚ç»“æŸæ—¶ï¼Œå°†è‡ªåŠ¨çš„å…³é—­æ³¨æ„ï¼šresponse çš„ä¸¤ä¸ªæµä¸èƒ½åŒæ—¶ä½¿ç”¨ 1.3.1 å­—èŠ‚æµServletOutputStream out = response.getOutputStream(); out.println(&quot;1234&quot;); //out.print(&quot;å“ˆå“ˆ&quot;); //å¼‚å¸¸ï¼šä¸èƒ½ç›´æ¥å‘é€ä¸­æ–‡ out.write(&quot;å“ˆå“ˆ&quot;.getBytes(&quot;UTF-8&quot;)); //æœ‰å¯èƒ½ä¹±ç  -- tomcatå‘é€çš„å­—èŠ‚ï¼Œtomcatæœ¬èº«æ²¡æœ‰å¤„ç†ï¼Œæ˜¯å¦ä¹±ç å–å†³äºæµè§ˆå™¨æŸ¥çœ‹æ–¹å¼ç¼–ç å‘é€å“åº”ä½“ï¼Œå³å‘é€htmlæºç å¦‚æœprintln()å°†htmlæºç è¿›è¡Œå›è½¦æ¢è¡Œï¼Œå¦‚æœå¸Œæœ›é¡µé¢çš„æ˜¾ç¤ºè¦æ¢è¡Œ&lt;br/&gt; tomcaté»˜è®¤ç¼–ç ä½¿ç”¨ï¼šISO-8859-1 ï¼ˆè‹±æ–‡ï¼‰ 1.3.2 å­—ç¬¦æµå¦‚æœå‘é€çš„å­—ç¬¦ï¼Œtomcatå°†å¤„ç†å­—ç¬¦ï¼Œé»˜è®¤ä½¿ç”¨ISO-8859-1ç¼–ç å¤„ç†è¯·æ±‚ä½“å†…å®¹ã€‚ 2.1 é€šçŸ¥tomcatå‘é€çš„æ•°æ®ç¼–ç  -- æ³¨æ„å¿…é¡»åœ¨ä½¿ç”¨æµä¹‹å‰ response.setCharacterEncoding(&quot;UTF-8&quot;); æ³¨æ„ï¼šåªé€šçŸ¥tomcatï¼Œä½†ä¸æ§åˆ¶æµè§ˆå™¨è¡Œä¸º 2.2 é€šè¿‡tomcatå’Œæµè§ˆå™¨ --å¼ºåˆ¶è¦æ±‚æµè§ˆå™¨æŸ¥çœ‹ç¼–ç  æ–¹å¼1ï¼šæ‰‹åŠ¨æ–¹æ¡ˆ response.setHeader(&quot;content-type&quot;, &quot;text/html;charset=UTF-8&quot;); æ–¹å¼2ï¼šä½¿ç”¨apiã€ã€‘ response.setContentType(&quot;text/html;charset=UTF-8&quot;); 2.3 é€šçŸ¥tomcatï¼Œåœ¨ä½¿ç”¨html&lt;meta&gt;é€šçŸ¥æµè§ˆå™¨ (htmlæºç ) æ³¨æ„ï¼š&lt;meta&gt;å»ºè®®æµè§ˆå™¨åº”è¯¥ä½¿ç”¨ç¼–ç ï¼Œä¸èƒ½å¼ºåˆ¶è¦æ±‚ã€‚1.3.3 responseè¾“å‡ºç¼“å­˜responseä¸­ä½¿ç”¨æµå‘æµè§ˆå™¨å‘é€æ•°æ®ï¼Œé¦–å…ˆæ•°æ®å°†å†™å…¥æ•°æ®æµçš„ç¼“å­˜ä¸­ï¼Œä½†ç¼“å­˜å¤§å°8kæ—¶ï¼Œå°†è‡ªåŠ¨åˆ·æ–°åˆ°æµè§ˆå™¨ã€‚ isCommitted() ç¼“å­˜æ˜¯å¦åˆ·æ–°è¿‡ flushBuffer() æ‰‹åŠ¨çš„åˆ·æ–° è¾“å‡ºç¼“å­˜ getBufferSize() è·å¾—å¤§å° resetBuffer() æ¸…ç©ºç¼“å­˜ // è¾“å‡ºç¼“å­˜8kb System.out.println(response.isCommitted()); //è¾“å‡ºfalseè¡¨ç¤ºç¼“å­˜æ²¡æœ‰æäº¤ for(int i = 0 ; i &lt; 1024 * 8 ; i ++){ response.getOutputStream().print(&quot;a&quot;); } System.out.println(response.isCommitted()); //è¾“å‡ºfalseè¡¨ç¤ºç¼“å­˜æ²¡æœ‰æäº¤ // ä½†æ˜¯æ­¤æ—¶ç¼“å­˜å·²ç»æ»¡äº† response.getOutputStream().print(&quot;a&quot;); System.out.println(response.isCommitted());//è¾“å‡ºtrueè¡¨ç¤ºç¼“å­˜æº¢å‡ºäº†,æäº¤äº† //æ‰‹åŠ¨åˆ·æ–° System.out.println(response.isCommitted()); response.getOutputStream().print(&quot;a&quot;); //response.flushBuffer(); //åˆ·æ–°response è¾“å‡ºç¼“å­˜ //response.getOutputStream().flush(); //åˆ·æ–°ä½¿ç”¨çš„æµç¼“å­˜,ä¹Ÿèƒ½è¾¾åˆ°åˆ·æ–°ç¼“å­˜çš„æ•ˆæœ response.getOutputStream().close(); System.out.println(response.isCommitted());2.Request2.1 ç›¸å…³APIå®é™…è®¿é—®è·¯å¾„ http://localhost:8080/day08/Demo05Servlet?username=jack&amp;password=1234 //1 ç»Ÿä¸€èµ„æºæ ‡è®°ç¬¦ ã€‚ä¾‹å¦‚ï¼š /day08/Demo05Servlet String uri = request.getRequestURI(); //2ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼šä¾‹å¦‚ï¼šhttp://localhost:8080/day08/Demo05Servlet StringBuffer url = request.getRequestURL(); //3 åè®®å’Œç‰ˆæœ¬ ï¼Œ ä¾‹å¦‚ï¼š HTTP/1.1 String protocol = request.getProtocol(); //åè®®ï¼Œä¾‹å¦‚ï¼š http String scheme = request.getScheme(); //4 ä¸»æœºï¼ˆåŸŸåï¼‰ , ä¾‹å¦‚ï¼šlocalhost ï¼Œå¦‚æœä½¿ç”¨ipåœ°å€ï¼Œå°±æ˜¾ç¤ºip String serverName = request.getServerName(); //5 ç«¯å£ , ä¾‹å¦‚ï¼š8080 int port = request.getServerPort(); //6 å‘å¸ƒåˆ°tomcatä¸‹çš„é¡¹ç›®åç§° ã€ã€‘ String contextPath = request.getContextPath(); //7 servletè·¯å¾„ , ä¾‹å¦‚ï¼š/Demo05Servletã€ã€‘ String servletPath = request.getServletPath(); //8 æ‰€æœ‰è¯·æ±‚å‚æ•°ï¼ŒåŠï¼Ÿä¹‹åæ‰€æœ‰ ,ä¾‹å¦‚ï¼š username=jack&amp;password=1234 String queryString = request.getQueryString(); //9è¿œç¨‹ä¸»æœºçš„ipåœ°å€ã€ã€‘ String remoteAddr = request.getRemoteAddr(); jspä¸­å¸¸å†™çš„è¿™æ®µä»£ç  String path = request.getContextPath(); String basePath = request.getScheme() + &quot;://&quot; + request.getServerName() + &quot;:&quot; + request.getServerPort() + path + &quot;/&quot;;2.2 Requestè·å–å‚æ•°// è·å–å•ä¸ªå‚æ•° String username = request.getParameter(&quot;username&quot;); // è·å–ä¸€ç»„å‚æ•° String[] loves = request.getParameterValues(&quot;loves&quot;); // è·å–æ‰€æœ‰çš„å‚æ•° Map&lt;String, String[]&gt; allDataMap = request.getParameterMap();2.3 ä¹±ç å¤„ç†public class Demo07Servlet extends HttpServlet { public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { //getè¯·æ±‚ //1 è·å¾—å†…å®¹ String username =request.getParameter(&quot;username&quot;); String userpwd = request.getParameter(&quot;userpwd&quot;); //2 getè¯·æ±‚ä¹±ç å¤„ç† username = new String(username.getBytes(&quot;ISO-8859-1&quot;),&quot;UTF-8&quot;); userpwd = new String(userpwd.getBytes(&quot;ISO-8859-1&quot;),&quot;UTF-8&quot;); System.out.println(username); System.out.println(userpwd); } public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { //0å¤„ç†postè¯·æ±‚ ä¹±ç  request.setCharacterEncoding(&quot;UTF-8&quot;); //1 è·å¾—å†…å®¹ String username =request.getParameter(&quot;username&quot;); System.out.println(username); String userpwd = request.getParameter(&quot;userpwd&quot;); System.out.println(userpwd); } }è¿™é‡Œçš„ä¹±ç å¤„ç†æ–¹å¼è¿˜æ˜¯éå¸¸å°å„¿ç§‘çš„,åé¢ä¼šå­¦ä¹ Filteræ¥å…¨å±€ç»Ÿä¸€å¤„ç†GETå’ŒPOSTä¹±ç äº† 2.4 RequestDispatcher è¯·æ±‚è°ƒåº¦å¯¹è±¡2.4.1 è¯·æ±‚è½¬å‘forward(ServletRequest request, ServletResponse response) A è½¬å‘ Bï¼Œåªè¾“å‡ºBå†…å®¹åˆ°æµè§ˆå™¨ã€‚ï¼ˆå¦‚æœAæ²¡æœ‰æ•°æ®å‘é€ response.isComitted = falseï¼Œå°†æ¸…ç©ºç¼“å­˜ï¼‰ è¯·æ±‚è½¬å‘åªè¾“å‡ºæœ€åä¸€ä¸ªservletå†…å®¹ å¦‚æœ isCommitted = true ï¼Œåœ¨è¿›è¡Œforwardå°†æŠ›å¼‚å¸¸ã€‚ä¸€èˆ¬æƒ…å†µå¦‚æœè¾“å‡ºå°‘é‡çš„æ•°æ®ï¼Œè®¤ä¸ºisCommitted=false2.4.2 è¯·æ±‚åŒ…å«include(ServletRequest request, ServletResponse response) A åŒ…å« Bï¼Œå…ˆè¾“å‡ºAå†…å®¹åˆ°æµè§ˆå™¨ï¼Œåœ¨è¾“å‡ºBçš„å†…å®¹åˆ°æµè§ˆå™¨ã€‚ è¯·æ±‚åŒ…å«ï¼Œè¾“å‡ºæ‰€æœ‰servlet æ±‡æ€»åçš„å†…å®¹ã€‚2.4 è¯·æ±‚è½¬å‘å’Œé‡å®šå‘å¯¹æ¯”æµè§ˆå™¨å‘é€è¯·æ±‚ï¼Œå¯èƒ½æ¶‰åŠå¤šä¸ªé¡µé¢ã€‚ç¤ºæ„å›¾ : è¯·æ±‚æ¬¡æ•° è½¬å‘ï¼š1æ¬¡ é‡å®šå‘ï¼š2æ¬¡ æµè§ˆå™¨åœ°å€æ æ˜¯å¦æ”¹å˜ è½¬å‘ï¼šä¸æ”¹å˜ é‡å®šå‘ï¼šæ”¹å˜ requestä½œç”¨åŸŸæ•°æ®æ˜¯å¦å…±äº« è½¬å‘ï¼šå…±äº«ï¼ˆä¸¤ä¸ªrequestå¯¹è±¡ï¼Œä½†æ•°æ®å…±äº«çš„ï¼ˆå…‹éš†ï¼‰ï¼‰ é‡å®šå‘ï¼šä¸å…±äº«ï¼ˆåˆ›å»ºä¸¤ä¸ªæ–°çš„requestå¯¹è±¡ï¼Œä¸”æ²¡æœ‰å…³ç³»çš„ï¼‰ apiä½¿ç”¨ è½¬å‘ï¼šrequest.getRequestDispatcher(&quot;....&quot;).forward(request,response); -- è®©å½“æ¬¡è¯·æ±‚ç»§ç»­å»¶ç»­ä¸‹å»ã€‚ é‡å®šå‘ï¼šè¯·æ±‚é€šè¿‡æµè§ˆå™¨æ”¹å˜æ–¹æ³•ã€‚response.sendRedirect(&quot;location&quot;) ä½¿ç”¨èŒƒå›´ è½¬å‘ï¼šåªèƒ½åœ¨å½“å‰webé¡¹ç›®ä¸­è½¬å‘ï¼Œä¸èƒ½è½¬å‘åˆ°å¦ä¸€ä¸ªwebé¡¹ç›®ä¸­ï¼Œ/è¡¨ç¤ºwebé¡¹ç›®æ ¹ã€‚ ä¾‹å¦‚ï¼šD:\\java\\tomcat\\apache-tomcat-7.0.53\\webapps\\day08 request.getRequestDispatcher(&quot;/a/b/oneServlet&quot;).forward() http://localhost:8080/day08/a/b/oneServlet é‡å®šå‘ï¼šæ”¹å˜æ–¹å‘ä»»æ„ã€‚å¦‚æœé‡å®šå‘åˆ°å½“å‰tomcatä¸‹ï¼Œ/è¡¨ç¤ºwebç«™ç‚¹ ä¾‹å¦‚ï¼šD:\\java\\tomcat\\apache-tomcat-7.0.53\\webapps\\ response.sendRedirect(&quot;/a/b/oneServlet&quot;); http://localhost:8080/a/b/oneServlet è¿™é‡Œå¦‚æœæƒ³è¦è¾¾åˆ°å’Œä¸Šé¢çš„ä¸€æ ·çš„è®¿é—®è·¯å¾„å°±éœ€è¦åŠ ä¸Šé¡¹ç›®åç§°`/day08/a/b/oneServlet` 3.æ€»ç»“1.webé¡¹ç›®æ ¹ï¼š(context root) å¼€å‘ï¼šG:\\Workspaces\\hei16\\day08\\WebRoot\\ è¿è¡Œï¼šD:\\java\\tomcat\\apache-tomcat-7.0.53\\webapps\\day08\\ 2. webç«™ç‚¹æ ¹ï¼š è¿è¡Œï¼šD:\\java\\tomcat\\apache-tomcat-7.0.53\\webapps\\ 3.ç¼–ç  é¡µé¢ï¼ˆhtmlã€jspï¼‰ã€servlet è¯·æ±‚å’Œå“åº” ç¼–ç  å¿…é¡»ä¿æŒä¸€è‡´ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼šservletå¼€å§‹2æ®µå†…å®¹ request.setCharacterEncoding(&quot;UTF-8&quot;); response.setContentType(&quot;text/html;charset=UTF-8&quot;); 4.è¯·æ±‚è½¬å‘ç‰¹ç‚¹ * è¯·æ±‚è·¯å¾„æ²¡æœ‰æ”¹å˜ï¼Œä½†å¯ä»¥æ¶‰åŠæœåŠ¡å™¨ç«¯å¤šä¸ªèµ„æºï¼ˆä½ å’Œåª³å¦‡ï¼‰ * å¯ä»¥åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­ï¼Œå…±äº«requestä½œç”¨åŸŸçš„æ•°æ®ã€‚ * ä¸€æ¬¡è¯·æ±‚ï¼Œä½¿ç”¨è¯·æ±‚è½¬å‘ï¼Œtomcatå°†åˆ›å»ºä¸¤ä¸ªrequestï¼Œå’Œä¸€ä¸ªresponseå¯¹è±¡ ä¸¤ä¸ªrequestå¯¹è±¡æ•°æ®ç›¸åŒçš„ï¼ˆå¯ä»¥ç†è§£æˆå¯¹è±¡è¢«å…‹éš†äº†ï¼‰","link":"/2016/11/21/JavaWeb%E5%9F%BA%E7%A1%80/08-JavaWeb%E5%9F%BA%E7%A1%80-Request-Response/"},{"title":"11-JavaWebåŸºç¡€-EL-JSTL","text":"ELè¡¨è¾¾å¼ELä»‹ç»ELï¼ˆExpression Languageï¼‰ ç›®çš„ï¼šä¸ºäº†ä½¿JSPå†™èµ·æ¥æ›´åŠ ç®€å•ã€‚è¡¨è¾¾å¼è¯­è¨€çš„çµæ„Ÿæ¥è‡ªäº ECMAScript å’Œ XPath è¡¨è¾¾å¼è¯­è¨€ï¼Œå®ƒæä¾›äº†åœ¨ JSP ä¸­ç®€åŒ–è¡¨è¾¾å¼çš„æ–¹æ³•ï¼Œè®©Jspçš„ä»£ç æ›´åŠ ç®€åŒ–ã€‚ ELåŸºæœ¬è¯­æ³• elæ ¼å¼ï¼š ${ è¡¨è¾¾å¼ } ä½œç”¨ï¼š è·å¾—è‡ªå®šä¹‰æ•°æ®ï¼šè‡ªå®šä¹‰æ•°æ®å¿…é¡»åœ¨ä½œç”¨åŸŸä¸­ æ‰§è¡Œè¿ç®— è·å¾—servletçš„api è°ƒç”¨javaæ–¹æ³• elå†…ç½®å¯¹è±¡ï¼š11ä¸ª 4ä¸ªä½œç”¨åŸŸï¼špageScopeã€requestScopeã€sessionScopeã€applicationScope pageContext ï¼Œè¡¨ç¤ºçš„å°±æ˜¯jsp PageContextå¯¹è±¡ param ä¸€ä¸ªè¯·æ±‚å‚æ•° ${param.username} request.getParameter(&quot;username&quot;); paramValues ä¸€ç»„ ${paramValues.loves} request.getParameterValues(&quot;loves&quot;); header ä¸€ä¸ªå¤´ ${header.referer} request.getHeader(&quot;referer&quot;); headerValues ä¸€ç»„å¤´ ${header.cookie} request.getHeaders(&quot;cookie&quot;); cookie è·å¾—cookieå¯¹è±¡ initParam webé¡¹ç›®åˆå§‹åŒ–å‚æ•°ï¼Œ servletContext.getInitParameter(&quot;xxx&quot;); è¯­æ³•åˆ—è¡¨ ä»£ç è¯¦ç»† : https://github.com/chiahaolu/JavaEEDemo/blob/master/day11_el_jstl_ums/web/el_base.jsp ELå‡½æ•°åœ¨JSPé¡µé¢ä¸­å¼•ç”¨ç³»ç»Ÿå‡½æ•°åº“ &lt;%@taglib uri=&quot;http://java.sun.com/jsp/jstl/functions&quot; prefix=&quot;fn&quot; %&gt; ä»£ç  : https://github.com/chiahaolu/JavaEEDemo/blob/master/day11_el_jstl_ums/web/el_function.jsp è‡ªå®šä¹‰ELå‡½æ•°1.ç¡®å®šå®ç°ç±»public class MyFunctions {//å¦‚æœå¤§äºæŒ‡å®šé•¿åº¦ï¼Œæˆªå–å¹¶æ˜¾ç¤ºåˆ†éš”ç¬¦ public static String mysub(String str,int length , String split){ if(str == null){ return &quot;&quot;; } if(str.length() &lt;= length){ return str; } return str.substring(0, length) + split; } }2.ç¼–å†™é…ç½®æ–‡ä»¶(WEB-INFç›®å½•ä¸‹ç¼–å†™myfn.tld)&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;taglib xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd&quot; version=&quot;2.0&quot;&gt; &lt;tlib-version&gt;1.0&lt;/tlib-version&gt; &lt;short-name&gt;myfn&lt;/short-name&gt; &lt;uri&gt;http://www.itheima.com/lt/myfn&lt;/uri&gt; &lt;!-- å®šä¹‰å‡½æ•° --&gt; &lt;function&gt; &lt;name&gt;sub&lt;/name&gt;&lt;!-- è®¿é—®çš„åç§° --&gt; &lt;!-- å®ç°ç±» --&gt; &lt;function-class&gt;com.itheima.b_fn.MyFunctions&lt;/function-class&gt; &lt;!-- å‡½æ•°ç­¾å String mysub(String str,int length , String split) ç­¾åæ ¼å¼ï¼š è¿”å›å€¼ æ–¹æ³•å(å‚æ•°åˆ—è¡¨)--&gt; &lt;function-signature&gt;java.lang.String mysub(java.lang.String,int,java.lang.String)&lt;/function-signature&gt; &lt;/function&gt; &lt;/taglib&gt;3.jspé¡µé¢ä¸­å¼•ç”¨è‡ªå®šä¹‰çš„å‡½æ•°åº“&lt;%@taglib uri=&quot;http://www.itheima.com/lt/myfn&quot; prefix=&quot;myfn&quot; %&gt;JSTLJSTLåŸºæœ¬ä»‹ç» JavaServer Pages Standard Tag Library(JSPæ ‡å‡†æ ‡ç­¾åº“)ï¼Œæ˜¯jspè§„èŒƒä¸€éƒ¨åˆ†ã€‚sunå®šä¹‰è§„èŒƒåŠæ¥å£,apache å¯¹è§„èŒƒè¿›è¡Œå®ç°ã€‚ å¯¼å…¥jaråŒ… myeclipseåœ¨å‘å¸ƒé¡¹ç›®åˆ°tomcatæ—¶ï¼Œè‡ªåŠ¨æ·»åŠ jstl.jaråŒ…. eclipseéœ€è¦æ‰‹åŠ¨å¯¼å…¥jaråŒ…. IntellJå°†`jstl.jar`å’Œ`standard.jar`å¯¼å…¥åˆ°WEB-INFç›®å½•ä¸‹çš„libåŒ…ä¸‹. ä½¿ç”¨æ ¼å¼ï¼š&lt;å‰ç¼€:æ ‡ç­¾å å±æ€§=å€¼ /&gt; æ ‡ç­¾åº“åˆ†ç±»: å¯¼å…¥æ–¹å¼: &lt;%@taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot; %&gt; æ ‡ç­¾ä»‹ç»æ ¸å¿ƒåº“æ ‡ç­¾ outæ ‡ç­¾ å°†åˆ¶å®šå†…å®¹è¾“å‡ºåˆ°æµè§ˆå™¨,é»˜è®¤æ”¯æŒELè¡¨è¾¾å¼. ä¸»è¦ç”¨é€”:å°†htmlæºç è¿›è¡Œè½¬ä¹‰. escapeXml:è¡¨ç¤ºæ˜¯å¦è½¬ä¹‰,é»˜è®¤å€¼:true &lt;c:out value=&quot;abc&quot;&gt;&lt;/c:out&gt;&lt;br/&gt; &lt;c:out value=&quot;${empty user }&quot;&gt;&lt;/c:out&gt;&lt;br/&gt; &lt;c:out value=&quot;&lt;a&gt;ä½ æ•¢ç‚¹æˆ‘&lt;/a&gt;&quot; escapeXml=&quot;false&quot;&gt;&lt;/c:out&gt;&lt;br/&gt; setæ ‡ç­¾ ç»™æŒ‡å®šçš„ä½œç”¨åŸŸè®¾ç½®å†…å®¹ value è®¾ç½®å€¼ var å±æ€§åç§° scope ä½œç”¨åŸŸ (page/request/session/application è¿™é‡Œçš„åå­—å’Œelè¡¨è¾¾å¼çš„ä¸ä¸€æ ·) ç›¸å½“äº : pageContext.setAttribute(var,value,scope) &lt;c:set value=&quot;request_å±Œ&quot; var=&quot;dzd&quot; scope=&quot;request&quot; &gt;&lt;/c:set&gt; &lt;c:remove var=&quot;dzd&quot; scope=&quot;page&quot;/&gt; &lt;%--ç§»é™¤ä½œç”¨åŸŸå†…å®¹ å¦‚æœæ²¡å†™scopeå°±ä¾æ¬¡ç§»é™¤ --%&gt; ${dzd} &lt;%--ä¾æ¬¡ä»å››ä¸ªä½œç”¨åŸŸä¸­è·å– pageã€requestã€sessionã€application --%&gt; &lt;br/&gt; ${requestScope.dzd } &lt;br/&gt; ifæ ‡ç­¾ if(test){ æ ‡ç­¾ä½“ } ç™»å½•çš„æ¡ˆä¾‹æ”¹è¿›: &lt;c:set var=&quot;loginUser&quot; value=&quot;xxx&quot; scope=&quot;session&quot;&gt;&lt;/c:set&gt; &lt;c:if test=&quot;${not empty sessionScope.loginUser }&quot;&gt; æ¬¢è¿ï¼Œxxx &lt;/c:if&gt; &lt;c:if test=&quot;${empty sessionScope.loginUser }&quot;&gt; &lt;a href=&quot;&quot;&gt;ç™»å½•&lt;/a&gt; &lt;/c:if&gt; choosæ ‡ç­¾ &lt;c:choose &gt;ç›¸å½“äº switch &lt;c:when&gt; ç›¸å½“äº case &lt;c:otherwise&gt; ç›¸å½“äº default forTokensæ ‡ç­¾(ä¸å¸¸ç”¨) å°†è‡ªå®šå­—ç¬¦ä¸²ï¼Œå®‰è£…æŒ‡å®šç¬¦å·è¿›è¡Œåˆ†å‰²ï¼Œå¹¶éå†ã€‚ &lt;c:forTokens items=&quot;www.itheima.com&quot; delims=&quot;.&quot; var=&quot;s&quot;&gt; ${s} , &lt;br/&gt; &lt;/c:forTokens&gt; catchæ ‡ç­¾(ä¸å¸¸ç”¨) &lt;c:catch&gt; ç­‰æ•ˆ try{}catch{} urlæ ‡ç­¾(å¸¸ç”¨) &lt;%-- &lt;c:url valur=&quot;&quot; var=&quot;&quot; scope=&quot;&quot;&gt; valueè®¾ç½®urlï¼Œå¦‚æœ/å¼€å¤´ï¼Œè‡ªåŠ¨æ·»åŠ é¡¹ç›®åã€‚ å¦‚æœæ²¡æœ‰è®¾ç½®varï¼Œå°†ç›´æ¥è¾“å‡ºåˆ°æµè§ˆå™¨ï¼Œå¦‚æœè®¾ç½®varï¼Œå°†ä¿å­˜åˆ°æŒ‡å®š(scope)çš„ä½œç”¨åŸŸï¼Œé»˜è®¤page --%&gt; &lt;a href=&quot;${pageContext.request.contextPath}/c_core3.jsp&quot;&gt;å½“å‰é¡µé¢&lt;/a&gt; &lt;br/&gt; &lt;a href=&quot;&lt;c:url value=&apos;/c_core3.jsp&apos;/&gt;&quot;&gt;å½“å‰é¡µé¢&lt;/a&gt; &lt;br/&gt; &lt;c:url value=&apos;/c_core3.jsp&apos; var=&quot;baseUrl&quot; &gt; &lt;c:param name=&quot;username&quot; value=&quot;å‡¤å„¿&quot;&gt;&lt;/c:param&gt; &lt;%--è‡ªåŠ¨è¿›è¡Œurlç¼–ç  --%&gt; &lt;/c:url&gt; &lt;a href=&quot;${baseUrl}&quot;&gt;å½“å‰é¡µé¢&lt;/a&gt; &lt;br/&gt; redirectæ ‡ç­¾ &lt;%--é‡å®šå‘ ï¼Œurlè®¾ç½®é‡å®šå‘ä½ç½® å¦‚æœ/å¼€å¤´ï¼Œä¸éœ€è¦é¡¹ç›®åç§° &lt;c:redirect url=&quot;/index.jsp&quot;&gt;&lt;/c:redirect&gt; --%&gt; forEachæ ‡ç­¾ items ç”¨äºè®¾ç½®éœ€è¦éå†çš„å†…å®¹ å¦‚æœå­—ç¬¦ä¸²ï¼Œå°†ç›´æ¥è¾“å‡º å¦‚æœæ•°ç»„å’ŒListï¼Œéå†æ¯ä¸€é¡¹ å¦‚æœMapï¼Œéå†æ¯ä¸€é¡¹Map.Entry begin/end è¿™å’Œitemsåªèƒ½å­˜åœ¨ä¸€ç»„ var ç”¨äºå­˜æ”¾éå†æ¯ä¸€é¡¹å†…å®¹,å­˜æ”¾pageä½œç”¨åŸŸï¼Œåªèƒ½åœ¨å¾ªç¯ä½“ä¸­ä½¿ç”¨ã€‚ fmtæ ‡ç­¾&lt;%--æ ¼å¼åŒ– æ—¶é—´ --%&gt; &lt;% pageContext.setAttribute(&quot;date&quot;, new Date()); //new SimpleDateFormat() %&gt; &lt;fmt:formatDate value=&quot;${date}&quot; pattern=&quot;yyyy-MM-dd hh:mm:ss:SSS&quot;/&gt; &lt;br/&gt; &lt;fmt:formatNumber value=&quot;3.1415926&quot; pattern=&quot;#.##&quot;&gt;&lt;/fmt:formatNumber&gt; &lt;br/&gt; &lt;fmt:formatNumber value=&quot;3&quot; pattern=&quot;#.##&quot;&gt;&lt;/fmt:formatNumber&gt; &lt;br/&gt; &lt;fmt:formatNumber value=&quot;3&quot; pattern=&quot;0.00&quot;&gt;&lt;/fmt:formatNumber&gt; &lt;br/&gt;è‡ªå®šä¹‰æ ‡ç­¾1.ç¼–å†™å®ç°ç±»è¦æ±‚ï¼šè‡ªå®šä¹‰çš„ç±»éœ€è¦å®ç°æ¥å£`SimpleTag`æˆ–è€…ç»§æ‰¿ç±»`SimpleTagSupport` ä¼ ç»Ÿæ ‡ç­¾ï¼šå®ç°æ¥å£Tagï¼Œç»§æ‰¿ç±»TagSupportï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ï¼Œä½†å®ç°ç¹çã€‚ ç®€å•æ ‡ç­¾ï¼šæ¥å£SimpleTagï¼Œç»§æ‰¿SimpleTagSupport ï¼Œåœ¨jsp2.0ä¹‹åæä¾› æä¾›æ ‡è®°æ¥å£çˆ¶ç±»ï¼šJspTag ä¸€èˆ¬å®ç°ç±»æ˜¯ä»¥Tagç»“å°¾çš„,è¡¨æ˜å®ƒæ˜¯ä¸€ä¸ªæ ‡ç­¾ç±» ä¾‹å¦‚:MyDateTag public class MyContentTag extends SimpleTagSupport { private boolean show; public void setShow(boolean show) { this.show = show; } @Override public void doTag() throws JspException, IOException { if(show){ this.getJspBody().invoke(null);//æ‰§è¡Œæ ‡ç­¾ä½“ï¼Œå¹¶è¾“å‡ºåˆ°æµè§ˆå™¨ } //throw new SkipPageException();//å½“å‰æ ‡ç­¾ä¹‹åçš„å†…å®¹å°†ä¸å†æ‰§è¡Œ } }2.ç¼–å†™tldé…ç½®æ–‡ä»¶tldæ˜¯taglib description çš„ç¼©å†™ ï¼Œ æ ‡ç­¾ç±»åº“çš„æè¿°æ–‡ä»¶ï¼Œæ˜¯jspè§£æç¨‹åºå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶è·å¾—ç›¸åº”çš„å®ç°ç±» tldæ–‡ä»¶åŸºäºxmlæ–‡ä»¶ï¼Œæ‰©å±•åä¸ºtldï¼Œå†…å®¹xml tldä½ç½®ï¼š 1.WEB-INFç›®å½•ï¼ŒåŠå­ç›®å½•ï¼Œä½† classesã€libç›®å½•é™¤å¤– 2.WEB-INF/lib/*.jar/META-INF/ç›®å½•ä¸‹ï¼Œjaræ–‡ä»¶å†… &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;taglib xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd&quot; version=&quot;2.1&quot;&gt; &lt;!-- æ ‡ç­¾åº“çš„ç‰ˆæœ¬ --&gt; &lt;tlib-version&gt;1.0&lt;/tlib-version&gt; &lt;!-- å»ºè®®ä½¿ç”¨å‰ç¼€åç§° --&gt; &lt;short-name&gt;my&lt;/short-name&gt; &lt;!-- å¼•ç”¨æ ‡ç­¾åº“æ—¶ï¼Œä½¿ç”¨åç§°ï¼Œå»ºè®®ä½¿ç”¨ï¼šurlä½œä¸ºåç§°ï¼Œå¯ä»¥ä»»æ„ --&gt; &lt;uri&gt;http://www.itheima.com/lt/mytag&lt;/uri&gt; &lt;!-- é…ç½®æ ‡ç­¾ --&gt; &lt;tag&gt; &lt;!-- æ ‡ç­¾è®¿é—®åç§° --&gt; &lt;name&gt;date&lt;/name&gt; &lt;!-- æ ‡ç­¾çš„å®ç°ç±» --&gt; &lt;tag-class&gt;com.itheima.e_tag.MyDateTag&lt;/tag-class&gt; &lt;!-- æ ‡ç­¾ä½“å†…å®¹è®¾ç½® --&gt; &lt;body-content&gt;empty&lt;/body-content&gt; &lt;!-- empty æ²¡æœ‰æ ‡ç­¾ä½“ --&gt; &lt;/tag&gt; &lt;tag&gt; &lt;name&gt;date2&lt;/name&gt; &lt;tag-class&gt;com.itheima.e_tag.MyDateTag2&lt;/tag-class&gt; &lt;body-content&gt;empty&lt;/body-content&gt; &lt;!-- &lt;attribute&gt; : ç”¨äºè®¾ç½®å±æ€§ï¼Œç¡®å®šå®ç°ç±»æ‰§è¡Œçš„setteræ–¹æ³• &lt;name&gt; ï¼š å±æ€§åç§°--&gt; &lt;attribute&gt; &lt;name&gt;pattern&lt;/name&gt; &lt;/attribute&gt; &lt;/tag&gt; &lt;tag&gt; &lt;name&gt;content&lt;/name&gt; &lt;tag-class&gt;com.itheima.e_tag.MyContentTag&lt;/tag-class&gt; &lt;body-content&gt;scriptless&lt;/body-content&gt; &lt;!-- scriptlessï¼šä¸æ”¯æŒjspè„šæœ¬&lt;% %&gt;,æ”¯æŒelå‡½æ•°å’Œå…¶ä»–æ ‡ç­¾ --&gt; &lt;attribute&gt; &lt;name&gt;show&lt;/name&gt; &lt;!-- ç”¨äºé…ç½®æ ‡ç­¾æ˜¯å¦æ”¯æŒè¿è¡Œæ—¶è¡¨è¾¾å¼çš„ã€‚åŠelè¡¨è¾¾å¼ --&gt; &lt;rtexprvalue&gt;true&lt;/rtexprvalue&gt; &lt;/attribute&gt; &lt;/tag&gt; &lt;/taglib&gt;3.åœ¨jspä¸­å¼•ç”¨é…ç½®æ–‡ä»¶,ä½¿ç”¨æ ‡ç­¾&lt;%@taglib uri=&quot;http://www.itheima.com/lt/mytag&quot; prefix=&quot;my&quot; %&gt;ç®€å•æ ‡ç­¾çš„ç”Ÿå‘½å‘¨æœŸ åˆ›å»ºæ ‡ç­¾å®ä¾‹ è®¾ç½®PageContextï¼Œæ‰§è¡ŒsetJspContext() æ¯ä¸€ä¸ªå±æ€§setteræ–¹æ³•ï¼Œæ‰§è¡Œ setPattern() å¦‚æœæœ‰æ ‡ç­¾ä½“ï¼Œæ‰§è¡ŒsetJspBody() æ‰§è¡ŒdoTag() æ‰§è¡Œæ ‡ç­¾ä½“ this.getJspBody().invoke(null) ; è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚ åœ¨doTag()æ–¹æ³•ä½“ä¸­ï¼Œthrow SkipPageException() å¼‚å¸¸ å¯ä»¥é˜»æ­¢å½“å‰æ ‡ç­¾ä¹‹åå†…å®¹çš„è¾“å‡ºã€‚","link":"/2016/12/12/JavaWeb%E5%9F%BA%E7%A1%80/11-JavaWeb%E5%9F%BA%E7%A1%80-EL-JSTL/"},{"title":"AJAXç¬”è®°","text":"Ajaxä»‹ç»&amp;ç¼–å†™æµç¨‹ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼ä»æµè§ˆå™¨ç«¯å‘é€è¯·æ±‚ï¼Œè¯·æ±‚æœåŠ¡å™¨ç«¯èµ„æºï¼Œå¹¶è·å¾—å†…å®¹ä¸€ç§æŠ€æœ¯ã€‚ajax ä¸æ˜¯æ–°æŠ€æœ¯ï¼Œæ˜¯å¤šä¸ªæŠ€æœ¯æ•´åˆï¼šjavascriptã€htmlã€cssã€xmlï¼ŒXMLHttpRequest ä½¿ç”¨æ­¥éª¤: 1.è·å¾—æ ¸å¿ƒç±»ï¼ˆå¼•æ“ï¼‰ 2.ç¼–å†™å›è°ƒå‡½æ•°ï¼Œè·å¾—å“åº”å†…å®¹ 3.å»ºç«‹è¿æ¥ 4å‘é€è¯·æ±‚åŒæ­¥æ“ä½œ : è®¿é—®servletåœ°å€æ æ”¹å˜å¼‚æ­¥æ“ä½œ : è®¿é—®servletåœ°å€æ ä¸æ”¹å˜ Jsonlibéœ€è¦å¯¼å…¥çš„jaråŒ…: commons-beanutils-1.8.3.jar commons-collections-3.2.1.jar commons-lang-2.6.jar commons-logging-1.1.1.jar ezmorph-1.0.6.jar json-lib-2.4-jdk15.jarJavaå¯¹è±¡è½¬json: JSONArray.fromObject(javaObject).toString()Jsonè½¬Javaå¯¹è±¡: JSONObject obj = JSONObject.fromObject(jsonStr); Bean bean = (Bean) JSONObject.toBean(obj, Bean.class);æ³¨æ„: JsonConfigé…ç½®ä¿¡æ¯,è®¾ç½®æ’é™¤çš„å­—æ®µ User user = new User(&quot;u001&quot;, &quot;jack&quot;, &quot;1234&quot;); // é…ç½®ä¿¡æ¯ --è®¾ç½®æ’é™¤ JsonConfig jsonConfig = new JsonConfig(); jsonConfig.setExcludes(new String[]{&quot;username&quot;,&quot;password&quot;}); // java å¯¹è±¡ è½¬æ¢ json --&gt; {&apos;k&apos;:&apos;v&apos;,.....} String str = JSONObject.fromObject(user,jsonConfig).toString(); System.out.println(str);// {&quot;id&quot;:&quot;u001&quot;}XStreaméœ€è¦å¯¼å…¥çš„jaråŒ…: xmlpull-1.1.3.1.jar xpp3_min-1.1.4c.jar xstream-1.4.7.jarJavaå¯¹è±¡è½¬xml: public void demo02(){ User user = new User(&quot;u007&quot;, &quot;è·¯å®¶è±ª&quot;, &quot;123&quot;); //1 æ ¸å¿ƒç±» XStream xStream = new XStream(); // * è®¾ç½®åˆ«å,å¦‚æœä¸è®¾ç½®çš„è¯ä¼šä½¿ç”¨Userç±»çš„å…¨é™å®šç±»åæ¥ä½œä¸ºæ ¹å…ƒç´  xStream.alias(&quot;user&quot;, User.class); //2 è½¬æ¢æˆxml String xmlData = xStream.toXML(user); System.out.println(xmlData); /* * &lt;user&gt; &lt;id&gt;u007&lt;/id&gt; &lt;username&gt;è·¯å®¶è±ª&lt;/username&gt; &lt;password&gt;123&lt;/password&gt; &lt;/user&gt; */ } è®¾ç½®å±æ€§çš„å€¼: public void demo03(){ User user = new User(&quot;u007&quot;, &quot;è·¯å®¶è±ª&quot;, &quot;123&quot;); //1 æ ¸å¿ƒç±» XStream xStream = new XStream(); // * è®¾ç½®å…ƒç´ åˆ«å xStream.alias(&quot;user&quot;, User.class); // * è®¾ç½®å±æ€§åˆ«å , ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ ‡å”®:æŒ‡å®šjavabean/propertyå±æ€§å/xmlä¸­æ˜¾ç¤ºçš„å±æ€§å xStream.aliasAttribute(User.class, &quot;id&quot;, &quot;id&quot;); //2 è½¬æ¢æˆxml String xmlData = xStream.toXML(user); System.out.println(xmlData); /* * &lt;user id=&quot;u007&quot;&gt; &lt;username&gt;è·¯å®¶è±ª&lt;/username&gt; &lt;password&gt;123&lt;/password&gt; &lt;/user&gt; */ } å¿½ç•¥å­—æ®µ: public void demo06(){ User user = new User(&quot;u007&quot;, &quot;è·¯å®¶è±ª&quot;, &quot;123&quot;); //1 æ ¸å¿ƒç±» XStream xStream = new XStream(); // * è®¾ç½®å…ƒç´ åˆ«å xStream.alias(&quot;user&quot;, User.class); // * è®¾ç½®å±æ€§åˆ«å , æŒ‡å®šjavabean property ä½¿ç”¨å…¶ä»–åˆ«å xStream.aliasAttribute(User.class, &quot;id&quot;, &quot;id&quot;); // * å¿½ç•¥æŒ‡å®šçš„å­—æ®µ xStream.omitField(User.class, &quot;username&quot;); //2 è½¬æ¢æˆxml String xmlData = xStream.toXML(user); System.out.println(xmlData); /* * &lt;user id=&quot;u007&quot;&gt; &lt;password&gt;123&lt;/password&gt; &lt;/user&gt; */ }xmlè½¬Javaå¯¹è±¡: public void demo04(){ String str = &quot;&lt;user id=&apos;u007&apos;&gt;&lt;username&gt;è·¯å®¶è±ª&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;&quot;; //1 æ ¸å¿ƒç±» XStream xStream = new XStream(); // * è®¾ç½®å…ƒç´ åˆ«å xStream.alias(&quot;user&quot;, User.class); // * è®¾ç½®å±æ€§åˆ«å , æŒ‡å®šjavabean property ä½¿ç”¨å…¶ä»–åˆ«å xStream.aliasAttribute(User.class, &quot;id&quot;, &quot;id&quot;); //2 xmlè½¬æ¢æˆ javabean User user = (User)xStream.fromXML(str); System.out.println(user); }æ¡ˆä¾‹ä¸€:åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å­˜åœ¨htmlä»£ç : &lt;input id=&quot;name&quot; type=&quot;text&quot; name=&quot;name&quot; onblur=&quot;sendData(this)&quot; onfocus=&quot;document.getElementById(&apos;spanId&apos;).innerHTML=&apos;&apos;&quot;/&gt; &lt;span id=&quot;spanId&quot;&gt;&lt;/span&gt;jsä»£ç : &lt;script type=&quot;text/javascript&quot;&gt; function sendData(obj) { // 0.è·å¾—è¾“å…¥çš„æ•°æ® var inputValue = obj.value; /* 1 åˆ›å»ºæ ¸å¿ƒç±» XMLHttpRequest ajaxå¼•æ“ï¼Œä¸åŒçš„æµè§ˆå™¨å¯¹æ­¤å¯¹è±¡çš„åˆ›å»ºæ–¹å¼ä¸åŒã€‚å­˜åœ¨æµè§ˆå™¨å…¼å®¹é—®é¢˜ * åœ¨æ‰€æœ‰ç°ä»£æµè§ˆå™¨ä¸­ï¼ˆåŒ…æ‹¬ IE 7ï¼‰ï¼š xmlhttp=new XMLHttpRequest() * åœ¨ Internet Explorer 5 å’Œ 6 ä¸­ï¼š xmlhttp=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;) */ var xmlhttp = null; if (window.XMLHttpRequest) {// code for all new browsers xmlhttp = new XMLHttpRequest(); } else if (window.ActiveXObject) {// code for IE5 and IE6 xmlhttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;); } /* 2 è®¾ç½®å›è°ƒå‡½æ•°ï¼Œé€šè¿‡å±æ€§è®¾ç½® onreadystatechange * ç›®çš„ï¼šå‘é€è¯·æ±‚ä¹‹åå¯ä»¥è·å¾—æœåŠ¡å™¨å“åº”å†…å®¹ã€‚ * ä¸€èˆ¬æƒ…å†µä½¿ç”¨åŒ¿åå‡½æ•°å®ç° * ajaxå¼•æ“åœ¨ä¸åŒçš„é˜¶æ®µéƒ½ä¼šè°ƒç”¨å›è°ƒå‡½æ•°ã€‚ * å±æ€§ï¼šreadyState å’Œ stauts 2.1 readyState è¿”å›æ•´å½¢æ•°æ®ï¼Œè¡¨ç¤ºå½“å‰æ‰§è¡ŒæŸä¸€ä¸ªé˜¶æ®µã€‚ * 0 åˆå§‹åŒ–çŠ¶æ€ã€‚æ ¸å¿ƒå¯¹è±¡åˆ›å»ºæ—¶é»˜è®¤å€¼ * 1 open() æ–¹æ³•å·²è°ƒç”¨ï¼Œè¿æ¥åˆ›å»ºå®Œæˆä¹‹åï¼Œajaxå¼•æ“å°†æ­¤çŠ¶æ€ä¿®æ”¹1 * 2 send() æ–¹æ³•å·²è°ƒç”¨ï¼Œå‘é€è¯·æ±‚ * 3 æ¥å—ä¸­ï¼Œ æ‰€æœ‰å“åº”å¤´éƒ¨éƒ½å·²ç»æ¥æ”¶åˆ°ã€‚å“åº”ä½“å¼€å§‹æ¥æ”¶ä½†æœªå®Œæˆã€‚ * 4 å“åº”å·²ç»å®Œå…¨æ¥æ”¶ã€‚ã€æŒæ¡ã€‘--æœåŠ¡å™¨å‘é€çš„æ‰€æœ‰æ•°æ®ï¼Œå·²ç»åˆ°ajaxå¼•æ“å†…éƒ¨ã€‚ 2.2 status è¡¨ç¤º å“åº”çš„httpçŠ¶æ€ç  * 200 æ­£å¸¸ã€æŒæ¡ã€‘ * 302 é‡å®šå‘ * 304 ç¼“å­˜ * 404 ä¸å­˜åœ¨ * 500 æœåŠ¡å™¨å¼‚å¸¸ */ xmlhttp.onreadystatechange = function () { if (xmlhttp.readyState == 4 &amp;&amp; xmlhttp.status == 200){ // 3.1 æ¥æ”¶æœåŠ¡å™¨å“åº”çš„æ•°æ®,è·å¾—jsonæ•°æ®,æ³¨æ„jsonä¹Ÿæ˜¯æ–‡æœ¬ var data = xmlhttp.responseText; // 3.2 å°†å­—ç¬¦ä¸²è½¬åŒ–æˆjsonå¯¹è±¡ ä½¿ç”¨æ ¼å¼:eval(&quot;(&apos;abc&apos;)&quot;); var jsonData = eval(&quot;(&quot;+data+&quot;)&quot;); // 3.3 åˆ¤æ–­ æ§åˆ¶æŒ‰é’®æ˜¯å¦å¯ç”¨ var buttonObj = document.getElementById(&quot;buttonId&quot;); var spanObj = document.getElementById(&quot;spanId&quot;); if (jsonData.flag) {// å¯ç”¨ buttonObj.removeAttribute(&quot;disabled&quot;); spanObj.style.color = &quot;#3D882D&quot;; } else {// ä¸å¯ç”¨ buttonObj.setAttribute(&quot;disabled&quot;,&quot;disabled&quot;); spanObj.style.color = &quot;#CC0000&quot;; } // 3.4 å°†ä¿¡æ¯æ˜¾ç¤ºåˆ°æŒ‡å®šä½ç½® spanObj.innerHTML = jsonData.msg; } }; //3 å»ºç«‹è¿æ¥ xmlhttp.open(&quot;POST&quot;,&quot;${pageContext.request.contextPath}/CustomerServlet?method=checkName&quot;); // 4 POSTè¯·æ±‚éœ€è¦è®¾ç½®ç¼–ç  xmlhttp.setRequestHeader(&quot;content-type&quot;, &quot;application/x-www-form-urlencoded&quot;); //5 å‘é€è¯·æ±‚ æ ¼å¼: name=lujiahao&amp;password=1234 xmlhttp.send(&quot;name=&quot; + inputValue); } &lt;/script&gt;Servletç«¯ä»£ç : /** * AjaxæŸ¥è¯¢ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ */ private void checkName(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException{ // 0å“åº”ä¹±ç  response.setContentType(&quot;application/json;charset=UTF-8&quot;); try { // 1.è·å¾—æ•°æ®å¹¶å°è£… String name = request.getParameter(&quot;name&quot;); // 2.é€šçŸ¥serviceæŸ¥è¯¢æ‰€æœ‰ //CustomerServeice customerServeice = new CustomerServiceImpl(); // customerServeice.checkName(name); PrintWriter out = response.getWriter(); if (name == null || &quot;&quot;.equals(name)) { out.print(&quot;{&apos;flag&apos;:false,&apos;msg&apos;:&apos;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&apos;}&quot;); return; } else if (&quot;lujiahao&quot;.equals(name)) { out.print(&quot;{&apos;flag&apos;:false,&apos;msg&apos;:&apos;ç”¨æˆ·åå·²ç»å­˜åœ¨&apos;}&quot;); } else { out.print(&quot;{&apos;flag&apos;:true,&apos;msg&apos;:&apos;ç”¨æˆ·åå¯ç”¨&apos;}&quot;); } } catch (Exception e){ // 1.æ‰“å°æ—¥å¿— e.printStackTrace(); } }æ¡ˆä¾‹äºŒ:çœå¸‚å¿ä¸‰çº§è”åŠ¨","link":"/2016/07/28/JavaWeb%E5%9F%BA%E7%A1%80/AJAX%E7%AC%94%E8%AE%B0/"},{"title":"09.JavaWebåŸºç¡€-cookie-session","text":"1.ä¼šè¯æŠ€æœ¯ ä¼šè¯å¯ç®€å•ç†è§£ä¸ºï¼šç”¨æˆ·å¼€ä¸€ä¸ªæµè§ˆå™¨ï¼Œç‚¹å‡»å¤šä¸ªè¶…é“¾æ¥ï¼ˆå¤šæ¬¡è¯·æ±‚ï¼‰ï¼Œè®¿é—®æœåŠ¡å™¨å¤šä¸ªwebèµ„æºï¼Œç„¶åå…³é—­æµè§ˆå™¨ï¼Œæ•´ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºä¸€ä¸ªä¼šè¯ã€‚ ä¼šè¯æŠ€æœ¯ï¼š cookieï¼šæµè§ˆå™¨ç«¯ä¼šè¯æŠ€æœ¯ sessionï¼šæœåŠ¡å™¨ç«¯ä¼šè¯æŠ€æœ¯ ç›®çš„ï¼šåœ¨ä¸€æ¬¡ä¼šè¯ä¸­ï¼ˆå¤šæ¬¡è¯·æ±‚ï¼‰å…±äº«æ•°æ®ã€‚ 3 cookieæŠ€æœ¯ï¬ cookieæŠ€æœ¯ä¸å±€é™javaï¼Œå…¶ä»–è¯­è¨€ä¹Ÿæ”¯æŒã€‚ä¾‹å¦‚ï¼šphpã€javascriptç­‰ï¬ JavaEE è§„èŒƒæä¾›å·¥å…·ç±»å¯¹Cookieè¿›è¡Œæ“ä½œã€‚javax.servlet.http.Cookieç±»ï¬ cookie æ˜¯ä»€ä¹ˆ 1. servletåˆ›å»ºcookieï¼Œä¿å­˜å°‘é‡æ•°æ®ï¼Œå‘é€æµè§ˆå™¨ã€‚ 2. æµè§ˆå™¨è·å¾—æœåŠ¡å™¨å‘é€çš„cookieæ•°æ®ï¼Œå°†è‡ªåŠ¨çš„ä¿å­˜åˆ°æµè§ˆå™¨ç«¯ã€‚ 3. ä¸‹æ¬¡è®¿é—®æ—¶ï¼Œæµè§ˆå™¨å°†è‡ªåŠ¨æºå¸¦cookieæ•°æ®å‘é€ç»™æœåŠ¡å™¨ã€‚ï¬ cookieæ“ä½œ 1.åˆ›å»ºcookieï¼šnew Cookie(name,value) 2.å‘é€cookieåˆ°æµè§ˆå™¨ï¼šHttpServletResponse.addCookie(Cookie) 3.servletæ¥æ”¶cookieï¼šHttpServletRequest.getCookies() æµè§ˆå™¨å‘é€çš„æ‰€æœ‰cookieï¬ cookieç‰¹ç‚¹ æ¯ä¸€ä¸ªcookieæ–‡ä»¶å¤§å°ï¼š4kb ï¼Œ å¦‚æœè¶…è¿‡4kbæµè§ˆå™¨ä¸è¯†åˆ« ä¸€ä¸ªwebç«™ç‚¹ï¼ˆwebé¡¹ç›®ï¼‰ï¼šå‘é€20ä¸ª ä¸€ä¸ªæµè§ˆå™¨ä¿å­˜æ€»å¤§å°ï¼š300ä¸ª cookie ä¸å®‰å…¨ï¼Œå¯èƒ½æ³„éœ²ç”¨æˆ·ä¿¡æ¯ã€‚æµè§ˆå™¨æ”¯æŒç¦ç”¨cookieæ“ä½œã€‚ é»˜è®¤æƒ…å†µç”Ÿå‘½å‘¨æœŸï¼šä¸æµè§ˆå™¨ä¼šè¯ä¸€æ ·ï¼Œå½“æµè§ˆå™¨å…³é—­æ—¶cookieé”€æ¯çš„ã€‚â€”ä¸´æ—¶cookie ï¬ cookie api getName() è·å¾—åç§° getValue() è·å¾—å€¼ setValue(java.lang.String newValue) è®¾ç½®å†…å®¹ setMaxAge(int expiry) è®¾ç½®æœ‰æ•ˆæ—¶é—´ã€ã€‘ setPath(java.lang.String uri) è®¾ç½®è·¯å¾„ã€ã€‘ setDomain(java.lang.String pattern) è®¾ç½®åŸŸå , ä¸€èˆ¬æ— æ•ˆï¼Œæœ‰æµè§ˆå™¨è‡ªåŠ¨è®¾ç½®ï¼ŒsetDomain(&quot;.itheima.com&quot;) www.itheima.com / bbs.itheima.com éƒ½å¯ä»¥è®¿é—® a.b.itheima.comæ— æ³•è®¿é—® isHttpOnly() æ˜¯å¦åªæ˜¯httpåè®®ä½¿ç”¨ã€‚åªèƒ½servletçš„é€šè¿‡getCookies()è·å¾—ï¼Œjavascriptä¸èƒ½è·å¾—ã€‚ setComment(java.lang.String purpose) (äº†è§£) setSecure(boolean flag) (äº†è§£) setVersion(int v) (äº†è§£)3.1 è·¯å¾„ï¬ cookieé»˜è®¤è·¯å¾„ï¼šå½“å‰è®¿é—®çš„servlet çˆ¶è·¯å¾„ ä¾‹å¦‚ï¼šhttp://localhost:8080/day09/a/b/c/SendCookieServlet é»˜è®¤è·¯å¾„ï¼š /day09/a/b/c/ï¬ é€šè¿‡ setPath ä¿®æ”¹cookieè®¿é—®è·¯å¾„ï¼Œä¸€èˆ¬ä½¿ç”¨ï¼šsetPath(â€œ/â€œ) â€“webç«™ç‚¹çš„æ ¹ï¼ˆæ²¡æœ‰é¡¹ç›®åï¼‰ è®¾ç½®è·¯å¾„ä¸servletè®¿é—®æ— å…³ã€‚servlet å»è·å¾—cookieæœ‰å…³ã€‚ï¬ å¦‚æœç¼–å†™ä¸€ä¸ªservlet è·å¾—cookie GetCookiesServlet â€“&gt; getCookies() http://localhost:8080/day09/a/b/c/SendCookieServlet1 â€“ã€‹/day09/a/b/c/ http://localhost:8080/day09/a/b/SendCookieServlet2 â€“ã€‹/day09/a/b/ http://localhost:8080/day09/a/SendCookieServlet3 â€“ã€‹/day09/a/ http://localhost:8080/day09/d/SendCookieServlet4 â€“ã€‹/day09/d å¦‚æœæ­¤è·å¾—cookie è®¿é—®è·¯å¾„ http://localhost:8080/day09/a/b/c/ ï¼Œä½¿ç”¨é¡¹ç›®ä¹‹åå†…å®¹&quot;/day09/a/b/c/&quot;.startWith(....) è®¿é—®çš„servletè·¯å¾„ï¼Œå¿…é¡»ä¸cookieæœ¬åœ°è®¾ç½®è·¯å¾„ åˆ¤æ–­ã€‚ é€šè¿‡getCookies()è·å¾— cookie1/cookie2/cookie3 é€šå¸¸ä½¿ç”¨setPath(&quot;/&quot;) å…¶ä»–servlet &quot;/day09&quot;.startWith(&quot;/&quot;) è‚¯å®šéƒ½æ˜¯/å¼€å¤´ã€‚æ‰€ä»¥å¯ä»¥è®¿é—® é€šé€”ï¼šä¿è¯åœ¨tomcatä¸‹æ‰€æœ‰çš„webé¡¹ç›®å¯ä»¥å…±äº«ç›¸åŒçš„cookie ä¾‹å¦‚ï¼štieba , wenku , beike å¤šä¸ªé¡¹ç›®å…±äº«æ•°æ®ã€‚ä¾‹å¦‚ç”¨æˆ·åã€‚ï¬ å½“å‰é¡¹ç›®è®¿é—®ï¼šsetPath(â€œ/day09/â€œ)3.2 æœ‰æ•ˆæ—¶é—´ï¬ é»˜è®¤æƒ…å†µï¼šcookieä¸´æ—¶ï¼Œå½“æµè§ˆå™¨å…³é—­é”€æ¯çš„ã€‚ï¬ setMaxAge å¯ä»¥ä¿®æ”¹cookieè¢«æµè§ˆå™¨ä¿å­˜çš„æ—¶é—´ã€‚æµè§ˆå™¨å°†cookieä¿¡æ¯å°†ä¿å­˜cookieæ–‡ä»¶ï¼Œæµè§ˆå™¨å…³é—­åæ–‡ä»¶ä»ç„¶å­˜åœ¨ï¼Œç›´åˆ°è®¾ç½®æ—¶é—´è¿‡æœŸå°†è¢«æµè§ˆå™¨è‡ªåŠ¨åˆ é™¤ã€‚å•ä½ï¼šç§’ â€“ æŒä¹…åŒ–cookieï¼ˆä¿å­˜æ–‡ä»¶ï¼‰ï¬ åˆ é™¤cookieï¼šä¿è¯åŸŸåã€è·¯å¾„å’Œcookieåç§°ä¸€è‡´æƒ…å†µä¸‹ï¼Œè®¾ç½® setMaxAge(0) å°†åˆ é™¤ã€‚ ï¬ cookieå”¯ä¸€æ ‡è¯†ï¼šåŸŸåã€è·¯å¾„ã€åç§° localhost / demo03_cookie_key baidu.com / mk localhost /day09/a/ cookie_key3.3 å‘é€ä¸­æ–‡æ•°æ®ï¬ cookie ä½¿ç”¨httpåè®®è¯·æ±‚å¤´å’Œå“åº”å¤´ï¼Œhttpåè®®ä¸æ”¯æŒä¸­æ–‡ï¼Œcookieæœ¬èº«ä¸æ”¯æŒä¸­æ–‡çš„ã€‚ï¬ å¦‚æœcookie valueè®¾ç½®ä¸­æ–‡ï¼ŒæœåŠ¡å™¨å°†æŠ›å¼‚å¸¸ã€‚ï¬ å¦‚æœcookieéœ€è¦å†™å…¥ä¸­æ–‡ï¼Œå¿…é¡»æ‰‹åŠ¨ç¼–ç ï¼ˆå‘é€ï¼‰ï¼Œå°†ç¼–ç åç»“æœå‘é€æµè§ˆå™¨ï¼Œä¹‹åæµè§ˆå™¨è¿”å›ç»™æœåŠ¡å™¨ä»ç„¶ç¼–ç åçš„ç»“æœï¼Œè¿˜éœ€è¦æ‰‹åŠ¨è§£ç ï¼ˆè·å–ï¼‰ã€‚ï¬ JDKæä¾›å·¥å…·ï¼Œè¿›è¡Œç¼–ç  URLEncoderï¼šç¼–ç  URLDecoderï¼šè§£ç //ç¼–ç  String str = URLEncoder.encode(â€œå±Œä¸­å±Œâ€, â€œUTF-8â€); System.out.println(str); //%E5%B1%8C%E4%B8%AD%E5%B1%8C //è§£ç  String value = URLDecoder.decode(str, â€œUTF-8â€); System.out.println(value); 3.4 cookieæ¡ˆä¾‹1ï¼šè®°ä½ç”¨æˆ·å è¡¨å•å¯ä»¥æäº¤ï¼ˆæ–‡æœ¬æ¡†ã€å¤é€‰æ¡†ï¼‰ â€”ä¸‹æ¬¡æµè§ˆæ—¶ï¼Œå¦‚æœæ›¾ç»è®°å½•åº”è¯¥å°†è®°å½•ç”¨æˆ·åæ˜¾ç¤ºåˆ°æ–‡æœ¬æ¡†ä¸­ã€‚ è¡¨å•å¿…é¡»æ˜¯servletè¾“å‡ºï¼Œä¸èƒ½æ˜¯htmlé¡µé¢ï¼Œå¦åˆ™æ–‡æœ¬æ¡†ä¸èƒ½æ˜¾ç¤ºè®°å½•æ•°æ®ã€‚ï¼ˆé™¤éjspï¼‰ ç‚¹å‡»æäº¤ï¼Œç¼–å†™servletå¤„ç†ï¼ˆæ˜¯å¦å‹¾é€‰ï¼‰ å¦‚æœå‹¾é€‰ï¼Œè®°å½•ç”¨æˆ·åï¼ˆè®°å½•æ•°æ®ä¸‹æ¬¡è¿˜å¯ä»¥è®¿é—®ï¼Œæ‰€ä»¥cookieï¼ŒæŒä¹…cookie setMaxAge(â€¦.)ï¼‰ å¦‚æœæ²¡æœ‰å‹¾é€‰ï¼Œåˆ é™¤cookieï¼Œæ³¨æ„ï¼šå”¯ä¸€æ ‡è¯†ï¼ˆåŸŸåã€è·¯å¾„ã€åç§°ï¼‰ï¼Œcookieå¿…é¡»å†æ¬¡å‘é€åˆ°æµè§ˆå™¨ã€‚ æ‰©å±•ï¼šå°†UrlEncoder å’Œ UrlDecoder ç»“åˆä½¿ç”¨ï¼ˆè§£å†³ä¸­æ–‡ç”¨æˆ·åï¼‰ 3.5 cookieæ¡ˆä¾‹2ï¼šå†å²è®°å½• ç‚¹å‡»æŸ¥è¯¢æ‰€æœ‰å•†å“ é€šè¿‡idæŸ¥è¯¢å•†å“è¯¦æƒ… â€“ åº”è¯¥è®°å½•æµè§ˆè®°å½• æŸ¥è¯¢æ‰€æœ‰çš„æµè§ˆè®°å½•ï¼Œæ˜¾ç¤ºè®°å½•æ•°æ® 4 sessionï¬ ç»å…¸åº”ç”¨ï¼šç”¨æˆ·ç™»å½•ã€JDè´­ç‰©è½¦ç­‰ï¬ ä¸€æ¬¡ä¼šè¯ä¸­ï¼ŒæœåŠ¡å™¨ç”¨äºå…±äº«æ•°æ®æŠ€æœ¯ã€‚ï¬ é»˜è®¤æƒ…å†µï¼šsessionéœ€è¦åŸºäºcookieä½¿ç”¨ã€‚åŠæ²¡æœ‰cookie sessionæ— æ•ˆã€‚ å½“ç¬¬ä¸€æ¬¡è°ƒç”¨ request.getSession() ï¼Œtomcatå°†åˆ›å»ºä¸€ä¸ªsessionå¯¹è±¡ï¼Œå¹¶å°†sessionå¯¹è±¡idå€¼ï¼Œä»¥cookieæ–¹å¼å‘é€ç»™æµè§ˆå™¨ï¼Œä¹‹åæµè§ˆå™¨å†æ¬¡è¯·æ±‚æ—¶ï¼Œå°†session id å‘é€æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡request.getSession() å°±å¯ä»¥è·å–ä¹‹å‰å·²ç»åˆ›å»ºå¥½çš„sessionå¯¹è±¡ã€‚ï¬ JavaEEè§„èŒƒæä¾›æ¥å£ï¼šjavax.servlet.http.HttpSession ç”¨äºæè¿°sessionå¯¹è±¡ã€‚ï¬ è·å¾—session request.getSession() è·å¾—sessionï¼Œå¦‚æœæ²¡æœ‰å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚ç­‰æ•ˆrequest.getSession(true) request.getSession(boolean) è·å¾—sessionï¼Œtrueï¼šæ²¡æœ‰å°†åˆ›å»ºï¼Œfalseï¼šæ²¡æœ‰å°†è¿”å›nullï¬ sessionå±æ€§æ“ä½œï¼šxxxAttribute session ä¹Ÿæ˜¯ servlet åŸŸå¯¹è±¡ã€‚ï¼ˆ3ä¸ªservletåŸŸå¯¹è±¡ï¼šServletRequestã€HttpSessionã€ServletContextï¼‰ï¬ sessionç”Ÿå‘½å‘¨æœŸ åˆ›å»ºï¼šç¬¬ä¸€æ¬¡è°ƒç”¨ getSession()æ—¶åˆ›å»º é”€æ¯ï¼š 1. è¶…æ—¶ï¼Œé»˜è®¤30åˆ†é’Ÿã€‚ web.xml ä¸­é…ç½® 30 å•ä½ï¼šåˆ†é’Ÿ 2.æ‰§è¡Œapi invalidate() å°†sessionå¯¹è±¡é”€æ¯äº†ã€‚ setMaxInactiveInterval(int interval) è®¾ç½®æœ‰æ•ˆæ—¶é—´ï¼Œå•ä½ç§’ 3.æœåŠ¡å™¨éæ­£å¸¸å…³é—­ã€‚ï¼ˆè‡ªæ€ï¼Œå°†JVMé©¬ä¸Šå…³é—­ï¼‰ å¦‚æœæ­£å¸¸å…³é—­ï¼Œsessionå°†è¢«æŒä¹…åŒ–ï¼ˆå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼‰ D:\\java\\tomcat\\apache-tomcat-7.0.53\\work\\Catalina\\localhost\\day09\\SESSIONS.ser å½“tomcaté‡æ–°å¯åŠ¨çš„æ—¶å€™è¿™ä¸ªæ–‡ä»¶å°±ä¼šè¢«åˆ é™¤ 4.1 URLé‡å†™ï¬ å½“æµè§ˆå™¨å°†cookieç¦ç”¨ï¼ŒåŸºäºcookieçš„sessionå°†ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œæ¯æ¬¡ä½¿ç”¨request.getSession() éƒ½å°†åˆ›å»ºä¸€ä¸ªnew sessionã€‚åªéœ€è¦å°†session id ä¼ é€’ç»™æœåŠ¡å™¨sessionå°±å¯ä»¥å·¥ä½œçš„ã€‚ï¬ é€šè¿‡URLå°†session id ä¼ é€’ç»™æœåŠ¡å™¨ï¼šURLé‡å†™ æ‰‹åŠ¨æ–¹å¼ï¼š url;jsessionid=â€¦. apiæ–¹å¼ï¼š encodeURL(java.lang.String url) è¿›è¡Œæ‰€æœ‰URLé‡å†™ encodeRedirectURL(java.lang.String url) è¿›è¡Œé‡å®šå‘ URLé‡å†™ å¦‚æœå‚æ•°urlä¸ºç©ºå­—ç¬¦ä¸åŒï¼Œå…¶ä»–éƒ½ä¸€æ ·ã€‚ å¦‚æœæµè§ˆå™¨ç¦ç”¨cookeï¼Œapiå°†è‡ªåŠ¨è¿½åŠ session id ï¼Œå¦‚æœæ²¡æœ‰ç¦ç”¨ï¼Œapiå°†ä¸è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚ æ³¨æ„ï¼šå¦‚æœæµè§ˆå™¨ç¦ç”¨cookieï¼Œwebé¡¹ç›®çš„æ‰€æœ‰urléƒ½éœ€æ‰‹åŠ¨é‡å†™ã€‚å¦åˆ™sessionå°†ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚ 5 æ€»ç»“cookie æµè§ˆå™¨ä¼šè¯æŠ€æœ¯ï¼Œç”¨äºåœ¨æµè§ˆå™¨ç¼“å­˜å†…å®¹ï¼Œè¾¾åˆ°æ•°æ®å…±äº«çš„ç›®çš„ ä½¿ç”¨ 1.æœåŠ¡å™¨åˆ›å»ºå¯¹è±¡ï¼Œæ·»åŠ æ•°æ® 2.æœåŠ¡å™¨å°†cookieå‘é€ç»™æµè§ˆå™¨ 3.æµè§ˆå™¨è‡ªåŠ¨æºå¸¦cookieæ•°æ®ï¼ŒæœåŠ¡å™¨è·å¾—æ•°æ®ã€‚ æµè§ˆå™¨æºå¸¦æ•°æ®ï¼Œæ ¹æ®cookieè·¯å¾„è®¾ç½®ã€‚ api setMaxAge æœ‰æ•ˆæ—¶é—´ï¼Œ0åˆ é™¤ï¼Œå¿…é¡»ä¿è¯è·¯å¾„åŒ¹é… setPath è®¾ç½®è®¿é—®è·¯å¾„ å”¯ä¸€æ ‡è¯†ï¼šåŸŸåã€è·¯å¾„ã€åç§°session æœåŠ¡å™¨ç«¯ä¼šè¯æŠ€æœ¯ï¼Œç”¨äºåœ¨æœåŠ¡å™¨å…±äº«æ•°æ®ã€‚ sessionå¿…é¡»ä½¿ç”¨cookieä¼ é€’session idï¼Œä¿è¯å¤šæ¬¡è¯·æ±‚ï¼Œæµè§ˆå™¨å¯ä»¥å…±äº« æœåŠ¡å™¨ä¸€ä¸ªsessionå¯¹è±¡ã€‚ å¦‚æœæµè§ˆå™¨ç¦ç”¨cookieï¼Œå¿…é¡»è¿›è¡ŒURLé‡å†™ã€‚ sessionç”Ÿå‘½å‘¨æœŸï¼š","link":"/2016/11/28/JavaWeb%E5%9F%BA%E7%A1%80/09-JavaWeb%E5%9F%BA%E7%A1%80-cookie-session/"},{"title":"JDBCç¬”è®°ä¸€","text":"1. JDBCç®€å•åº”ç”¨public class FirstJDBC { public static void main(String[] args) throws Exception { // 0.å‡†å¤‡å˜é‡ String driver = &quot;com.mysql.jdbc.Driver&quot;;// mysqlé©±åŠ¨å®ç°ç±» String url = &quot;jdbc:mysql://localhost:3306/day15_db&quot;;// ç¡®å®šæ•°æ®åº“æœåŠ¡å™¨åœ°å€,ç«¯å£å·,ä½¿ç”¨æ•°æ®åº“ String user = &quot;root&quot;;// ç™»å½•åç§° String password = &quot;1234&quot;;// ç™»å½•å¯†ç  // 1.æ³¨å†Œé©±åŠ¨ Class.forName(driver); // 2.è·å¾—é“¾æ¥ Connection conn = DriverManager.getConnection(url, user, password); // 3.è·å¾—è¯­å¥æ‰§è¡Œè€… Statement st = conn.createStatement(); // 4.å‘é€sqlè¯­å¥,æŸ¥è¯¢ ç»“æœç›¸å½“äºä¸€ä¸ªseté›†åˆ,æ¯ä¸€ä¸ªæˆå‘˜è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­ä¸€æ¡è®°å½• ResultSet rs = st.executeQuery(&quot;select * from t_user &quot;); // 5.å¤„ç†ç»“æœ rs.next();// ç§»åŠ¨åˆ°ç¬¬ä¸€è¡Œ // getXxxè·å–æŸä¸€è¡Œçš„æŒ‡å®šåˆ—æˆ–å­—æ®µå€¼ getXxx(int åˆ—æ•°),getXxx(String å­—æ®µå) int id = rs.getInt(&quot;id&quot;); String username = rs.getString(&quot;username&quot;); String userPassword = rs.getString(&quot;password&quot;); System.out.printf(&quot;id:&quot;+id+&quot; username:&quot;+username+&quot; password:&quot;+password); // 6.é‡Šæ”¾èµ„æº,ä¼˜å…ˆå…³é—­æœ€åä½¿ç”¨çš„ rs.close(); st.close(); conn.close(); } }2. Junit æµ‹è¯•1.éœ€è¦å¯¼å…¥ä¸¤ä¸ªjaråŒ…junit.jarhamcrest-core.jaræ”¾å…¥libsç›®å½•ä¸‹å³å¯2.ç±»åalt+enter,ç„¶åé€‰æ‹©éœ€è¦æ·»åŠ æµ‹è¯•çš„æ–¹æ³•å³å¯ æµ‹è¯•ç”¨ä¾‹æ–¹æ³•ï¼Œå…¬å…± æ²¡æœ‰è¿”å›å€¼ éé™æ€ æ–¹æ³•åè‡ªå®šä¹‰ æ²¡æœ‰å‚æ•°åˆ—è¡¨æ–¹æ³•åå»ºè®®ï¼štestæ–¹æ³•å() public class DemoTest { private Demo demo; @Before //æµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰ public void myBefore(){ System.out.println(&quot;ä¹‹å‰&quot;); demo = new Demo(); //åˆå§‹åŒ–æ•°æ® } @After //æµ‹è¯•æ–¹æ³•æ‰§è¡Œå public void myAfter(){ System.out.println(&quot;ä¹‹å&quot;); //æ–¹æ³•èµ„æº } @Test(timeout=1000) //timeout è®¾ç½®æµ‹è¯•æ—¶é—´ï¼Œå¦‚æœè¶…æ—¶æ€§èƒ½æœ‰é—®é¢˜ public void testAdd() { try { Thread.sleep(2000); } catch (Exception e) { } int sum = demo.add(1, 2); //æ–­è¨€ Assert.assertEquals(3, sum); assertEquals(3, sum); //ä½¿ç”¨é™æ€å¯¼å…¥çš„ç»“æœ } @Test public void testMul() { int sum = demo.mul(1, 2); } @BeforeClass public static void myBeforeClass(){ System.out.println(&quot;ç±»ä¹‹å‰&quot;); } @AfterClass public static void myAfterClass(){ System.out.println(&quot;ç±»ä¹‹å&quot;); } }3. JDBCå·¥å…·ç±»public class JdbcUtils { private static String url; private static String user; private static String password; // è¿™äº›é…ç½®æ–‡ä»¶çš„ä¸œè¥¿åªç”¨åŠ è½½ä¸€æ¬¡å°±å¯ä»¥äº†,å†™åœ¨é™æ€ä»£ç å—ä¸­ static { try { // å‚æ•°é…ç½®åº”è¯¥æ”¾åœ¨é…ç½®æ–‡ä»¶ä¸­ // 1. åŠ è½½propertiesæ–‡ä»¶ // æ–¹å¼1:ä½¿ç”¨ClassLoaderåŠ è½½èµ„æº //InputStream is = JdbcUtils.class.getClassLoader().getResourceAsStream(&quot;jdbcInfo.properties&quot;); // æ–¹å¼2:ä½¿ç”¨Classå¯¹è±¡åŠ è½½,å¿…é¡»åŠ ä¸Š/,è¡¨ç¤ºsrc InputStream is = JdbcUtils.class.getResourceAsStream(&quot;/jdbcInfo.properties&quot;); // 2. è§£æé…ç½®æ–‡ä»¶ Properties properties = new Properties(); properties.load(is); // 3. è·å¾—é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ® String driver = properties.getProperty(&quot;driver&quot;); url = properties.getProperty(&quot;url&quot;); user = properties.getProperty(&quot;user&quot;); password = properties.getProperty(&quot;password&quot;); // 4. æ³¨å†Œé©±åŠ¨ Class.forName(driver); } catch (Exception e){ throw new RuntimeException(e); } } /** * è·å¾—è¿æ¥ */ public static Connection getConnection(){ try { Connection conn = DriverManager.getConnection(url, user, password); return conn; } catch (Exception e){ // å°†ç¼–è¯‘æ—¶å¼‚å¸¸è½¬æ¢æˆè¿è¡Œæ—¶å¼‚å¸¸,å¼€å‘ä¸­å¸¸è§è¿è¡Œæ—¶å¼‚å¸¸ // throw new RuntimeException(e); // æ­¤å¤„å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ // ç±»ä¸ç±»ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢æ—¶å¯ä»¥ä½¿ç”¨returnè¿”å›æ•°æ®. // ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸è¿”å›å€¼ï¼Œè°ƒç”¨è€…try{} catch(e){ e.getMessage() è·å¾—éœ€è¦çš„æ•°æ®} throw new MyConnectionException(e); } } /** * é‡Šæ”¾èµ„æº */ public static void closeResource(Connection conn, Statement st, ResultSet rs){ try { if (rs != null) { rs.close(); } } catch (Exception e){ throw new RuntimeException(e); } finally { try { if (st != null) { st.close(); } } catch (Exception e){ throw new RuntimeException(e); } finally { try { if (conn != null) { conn.close(); } } catch (Exception e){ throw new RuntimeException(e); } } } } }4. è‡ªå®šä¹‰å¼‚å¸¸ç»§æ‰¿RuntimeException è¦†å†™æ–¹æ³•å°†ç¼–è¯‘æ—¶å¼‚å¸¸è½¬æ¢æˆè¿è¡Œæ—¶å¼‚å¸¸,å¼€å‘ä¸­å¸¸è§è¿è¡Œæ—¶å¼‚å¸¸throw new RuntimeException(e);ç±»ä¸ç±»ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢æ—¶å¯ä»¥ä½¿ç”¨returnè¿”å›æ•°æ®.ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸è¿”å›å€¼ï¼Œè°ƒç”¨è€…try{} catch(e){ e.getMessage() è·å¾—éœ€è¦çš„æ•°æ®} 5. æ¨¡æ¿ä»£ç public void demo1(){ Connection conn = null; Statement st = null; ResultSet rs = null; try { conn = JdbcUtils.getConnection(); // .... } catch (Exception e){ throw new RuntimeException(e); } finally { // é‡Šæ”¾èµ„æº JdbcUtils.closeResource(conn,st,rs); } }6. Apiè¯¦è§£6.1 æ³¨å†Œé©±åŠ¨1.0 æ‰€æœ‰çš„é©±åŠ¨å®ç°ç±»å¿…é¡»å®ç°è§„èŒƒæ¥å£ï¼Œjava.sql.Driveræ¥å£ 1.1 åŸå§‹ç¼–å†™æ–¹å¼ï¼šDriverManager.registerDriver(new Driver()); ç‰¹ç‚¹ï¼šå¿…é¡»å¯¼åŒ… import com.mysql.jdbc.Driver; ç¡¬ç¼–ç¨‹ï¼Œå†…å®¹å†™æ­»çš„ï¼Œæ— æ³•æ‰©å±•ï¼Œä¸æ˜“äºæ•°æ®å˜è¿(æ›´æ¢) æºç ï¼špublic class com.mysql.jdbc.Driver implements java.sql.Driver 1.2 å»ºè®®ç¼–å†™æ–¹å¼ï¼šClass.forName(&quot;com.mysql.jdbc.Driver&quot;); ç‰¹ç‚¹ï¼šæŒ‡å®šç±»å¦‚æœæœ‰static{} é‡Œé¢çš„å†…å®¹å°†è‡ªåŠ¨æ‰§è¡Œã€‚ æºç ï¼š static { try { java.sql.DriverManager.registerDriver(new Driver()); } catch (SQLException E) { throw new RuntimeException(&quot;Can&apos;t register driver!&quot;); } } mysql Driverå®ç°ç±»ï¼Œå°†è‡ªå·±è¿›è¡Œæ³¨å†Œã€‚ ä¼˜ç‚¹ï¼šä½¿ç”¨å­—ç¬¦ä¸²æ–¹æ³•åŠ è½½åˆ°å†…å®¹ï¼ˆæ³¨å†Œï¼‰ï¼Œä¹‹åå¯ä»¥å°†é©±åŠ¨é…ç½®åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œä¹‹ååªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ•°æ®åº“å°±æ›´æ”¹ã€‚ 1.3 æ­¤è¡Œä»£ç å¯çœç•¥ï¼Œå»ºè®®ä¸è¦çœç•¥ã€‚ mysqlé©±åŠ¨ é«˜ç‰ˆæœ¬ï¼Œå°†è‡ªåŠ¨åŠ è½½é©±åŠ¨å¹¶æ³¨å†Œã€‚ æ–‡ä»¶ï¼šmysql-connector-java-5.1.22-bin.jar/META-INF/services/java.sql.Driver å†…å®¹ï¼šcom.mysql.jdbc.Driver 1.4 é”™è¯¯æ€»ç»“ * ClassNotFoundException ï¼Œæ˜¯å¦å¯¼å…¥jaråŒ…ï¼Ÿé©±åŠ¨åç§°æ˜¯å¦æ­£ç¡®ï¼Ÿ * java.lang.NoClassDefFoundError å¦‚æœé…ç½®æ–‡ä»¶æ”¾ç½®ä½ç½®é”™è¯¯å°±ä¼šæŠ¥è¿™ä¸ªå¼‚å¸¸ 1.5 mysql com.mysql.jdbc.Driver å­ç±» org.gjt.mm.mysql.Driver æºç ï¼špublic class Driver extends com.mysql.jdbc.Driver6.2 è·å¾—è¿æ¥2.1 ä»‹ç» ä½¿ç”¨è¿æ¥æ¥å£ï¼šjava.sql.Connection,åªæœ‰è·å¾—è¿æ¥æ‰å¯ä»¥æ“ä½œæ•°æ®åº“ã€‚ é€šè¿‡DriverManager é©±åŠ¨ç®¡ç†è€…ç±»è·å¾—è¿æ¥ã€‚getConnection(url,user,password) 2.2 url ç¡®å®šè®¿é—®æ•°æ®åº“ä½ç½® æ ¼å¼# åè®®:å­åè®®:å­åç§° åè®® å›ºå®šå€¼ --&gt; jdbc å­åè®® --&gt; ç¡®å®šæ•°æ®ï¼Œä¾‹å¦‚ï¼šmysqlã€oracle ç­‰ å­åç§° --&gt; localhostä¸»æœºï¼Œ3306ç«¯å£ï¼Œday15_dbæ•°æ®åº“åç§° å‚æ•° --&gt; jdbc:mysql://localhost:3306/day15_db?useUnicode=true&amp;characterEncoding=UTF-8 è®¾ç½®è¯·æ±‚ç¼–ç ï¼Œå®‰è£…å¦‚æœæŒ‡å®šUTF-8ï¼Œä¸éœ€è¦è®¾ç½®çš„ã€‚å¦‚æœå®‰è£…æ—¶è®¾ç½®çš„ç¼–ç ä¸ºISO8859-1ç¼–ç ï¼Œä¸­æ–‡ä¹±ç éœ€è¦å¦‚ä¸Šå¤„ç†ã€‚ ä¸»æœºé»˜è®¤localhostï¼Œç«¯å£é»˜è®¤3306 ç®€å†™æ–¹å¼ --&gt; jdbc:mysql:///day15_db 2.3 é”™è¯¯æ€»ç»“ * Unknown database &apos;day15_db2&apos; , è¡¨ç¤ºæ•°æ®åº“ä¸å­˜åœ¨ã€‚ * Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: YES) ï¼Œ è´¦å·å’Œå¯†ç ä¸åŒ¹é…6.3 Connectionæä¾›çš„ä¸åŒçš„æ“ä½œå¯¹è±¡3.1 æ“ä½œå¯¹è±¡ * Statement ï¼Œ è¯­å¥æ‰§è¡Œè€…ï¼Œè·å¾—æ–¹å¼ conn.createStatement()ã€ã€‘ * PreparedStatement , é¢„å¤„ç†å¯¹è±¡ï¼Œè·å¾—æ–¹æ³• conn.prepareStatement(sql)ã€ã€‘ * å¿…é¡»å…ˆæä¾›sqlè¯­å¥ï¼Œè¿›è¡Œé¢„å…ˆå¤„ç†ã€‚ * CallableStatement å­˜å‚¨è¿‡ç¨‹ï¼Œ prepareCall(String sql)ï¼Œå°†sqlè¯­å¥ç¼–å†™æ•°æ®åº“ï¼Œç›¸å½“äºæ•°æ®åº“å‡½æ•°ï¼Œæ‰§è¡Œæ—¶ åªéœ€è¦ä¼ é€’å®é™…å‚æ•° 3.2 Statement int executeUpdate(sql) æ‰§è¡ŒDDL/DMLè¯­å¥ï¼Œè¿”å›å½±å“çš„è¡Œæ•°ã€‚ã€ã€‘ ResultSet executeQuery(sql) æ‰§è¡ŒDQLè¯­å¥ï¼Œè¿”å›ç»“æœé›†ï¼ˆç›¸å½“äºä¸€ä¸ªè¡¨ï¼‰ã€ã€‘ boolean execute(sql) è¿”å›å€¼trueï¼Œè¡¨ç¤ºæ‰§è¡ŒDQLè¯­å¥ï¼Œå¿…é¡»é€šè¿‡ getResultSet() è·å¾—ç»“æœé›† è¿”å›å€¼falseï¼Œè¡¨ç¤ºæ‰§è¡ŒDML/DDLè¯­å¥ï¼Œå¿…é¡»é€šè¿‡ getUpdateCount() è·å¾—å½±å“è¡Œæ•° 3.3 æ»šåŠ¨ç»“æœé›† ï¼ˆäº†è§£ï¼‰ * jdbcè§„èŒƒ é»˜è®¤ç»“æœé›†forward ï¼Œåªèƒ½å‘å‰çš„ç»“æœé›†ã€‚ * æ»šåŠ¨ç»“æœé›†ï¼šå¯ä»¥å‘å‰ï¼Œä¹Ÿå¯ä»¥å‘åã€‚mysql ç›´æ¥æ”¯æŒæ»šåŠ¨ * ResultSet api next() ä¸‹ä¸€ä¸ªï¼ˆå‘å‰ï¼‰ previous() ä¸Šä¸€ä¸ªï¼ˆå‘åï¼‰ * ç»“æœé›†ResultSetè¦æ»šåŠ¨ï¼Œå‰æStatementå¿…é¡»è®¾ç½®æ”¯æŒçš„ã€‚ * ä½¿ç”¨æ–¹æ³•ï¼šcreateStatement(int resultSetType, int resultSetConcurrency) resultSetType - ç»“æœé›†ç±»å‹ï¼Œ ResultSet.TYPE_FORWARD_ONLYï¼Œä»…ä»…åªèƒ½å‘å‰ ResultSet.TYPE_SCROLL_INSENSITIVEï¼Œå¯ä»¥æ»šåŠ¨ï¼Œä¸æ•æ„Ÿã€‚æ»šåŠ¨ä¸­ï¼Œæ•°æ®åº“å‘ç”Ÿæ”¹å˜ï¼Œç»“æœé›†å†…å®¹ä¸æ”¹å˜çš„ã€‚ æ•°æ®åº“çš„æ•°æ®æ˜¯å¦åŒæ­¥åˆ°ç»“æœé›†ResultSetä¸­ã€‚ ResultSet.TYPE_SCROLL_SENSITIVEï¼Œå¯ä»¥æ»šåŠ¨ï¼Œæ•æ„Ÿã€‚æ»šåŠ¨ä¸­ï¼Œæ•°æ®åº“æ•°æ®å‘ç”Ÿæ”¹å˜ï¼Œç»“æœé›†å†…å®¹æ”¹å˜ã€‚ resultSetConcurrency - å¹¶å‘ç±»å‹ ResultSet.CONCUR_READ_ONLY ï¼Œç»“æœé›†åªèƒ½è¯»ï¼Œä¸èƒ½æ”¹ã€‚ ResultSet.CONCUR_UPDATABLEï¼Œç»“æœé›†å¯ä»¥æ›´æ–°ï¼Œæ•°æ®ä¸€å¹¶æ›´æ”¹ã€‚ ç»“æœé›†æ•°æ®åŒæ­¥åˆ°æ•°æ®åº“ * æ“ä½œ è·å¾— getXxx(int)è·å¾—æŒ‡å®šåˆ—å·çš„å†…å®¹ï¼Œ getXxx(String)è·å¾—æŒ‡å®šåˆ—å(å­—æ®µ)çš„å†…å®¹ ä¾‹å¦‚ï¼šgetString(4) è·å¾—ç¬¬4åˆ—ï¼Œ getString(&quot;username&quot;) è·å¾—å­—æ®µåç§°usernameçš„å€¼7.SQLæ³¨å…¥sqlæ³¨å…¥ ï¼šç”¨æˆ·è¾“å…¥å®é™…å‚æ•°ï¼Œä½œä¸ºäº†sqlè¯­å¥è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œæ•°æ®åº“ç¼–è¯‘åœ¨æ‰§è¡Œæ—¶ç”Ÿæ•ˆçš„ã€‚ select * from t_user where username = â€˜jackâ€™ or 1=1 or 1=â€™â€™ and password = â€˜12345â€™ select * from t_user where username = â€˜jackâ€™ â€“â€™ and password = â€˜12345â€™è§£å†³æ–¹æ¡ˆï¼š 1. æ‰‹åŠ¨æ–¹å¼ï¼š\\è½¬ä¹‰å•å¼•å· 2. ä½¿ç”¨é¢„å¤„ç†å¯¹è±¡ï¼Œé˜²æ­¢sqlæ³¨å…¥ 1) å…ˆæä¾›sqlè¯­å¥ï¼Œå°†å®é™…å‚æ•°ä½¿ç”¨å ä½ç¬¦?æ›¿æ¢ã€‚ ä¾‹å¦‚ï¼šselect * from t_user where username = ? and password = ? 2) è·å¾—é¢„å¤„ç†å¯¹è±¡ï¼Œè·å¾—å¯¹è±¡æ—¶å¿…é¡»æä¾›sqlè¯­å¥ï¼Œè®©sqlè¯­å¥é¢„å…ˆè¿›è¡Œç¼–è¯‘ã€‚ 3) è®¾ç½®å®é™…å‚æ•° PreparedStatement æä¾› setXxx(int , Object) å‚æ•°1ï¼šintè¡¨ç¤º ?ä½ç½®ï¼Œä»1å¼€å§‹ã€‚ å‚æ•°2ï¼šObjectå…·ä½“ç±»å‹ï¼Œå¦‚æœå­—ç¬¦ä¸²Stringç­‰ã€‚ 3. PreparedStatement æ¥å£ æ˜¯ Statementæ¥å£çš„å­æ¥å£ã€‚ ä½†æ˜¯execute(sql) çˆ¶ç±»æ–¹æ³•ï¼Œå­ç±»ä½¿ç”¨æŠ›å¼‚å¸¸ã€‚ä½¿ç”¨çš„æ²¡æœ‰å‚æ•°ã€‚ 8.é¢„å¤„ç†å¯¹è±¡PreparedStatementç‰¹ç‚¹ï¼š sql æ˜“äºç¼–å†™ï¼Œæ›´ä½³æ¸…æ™° æé«˜æ€§èƒ½ï¼Œç¼–è¯‘ä¸€æ¬¡ï¼Œå¯ä»¥æ‰§è¡Œå¤šæ¬¡ã€‚ ç¼–å†™æ­¥éª¤ï¼š 1.æä¾›sqlè¯­å¥ï¼Œå¹¶å°†å®é™…å‚æ•°ä½¿ç”¨ï¼Ÿå ä½ç¬¦ 2.è·å¾—é¢„å¤„ç†å¯¹è±¡ï¼Œæ³¨æ„æä¾›sqlè¯­å¥ 3.è®¾ç½®å®é™…å‚æ•°ï¼Œå°†?æ›¿æ¢å›æ¥ 4.æ‰§è¡Œï¼Œæ³¨æ„ï¼šä¸èƒ½è®¾ç½®sqlè¯­å¥ã€‚ Statement å’Œ PreparedStatement å¯¹æ¯”ï¼š ä¸€èˆ¬æƒ…å†µä½¿ç”¨PreparedStatementï¼Œä¹‹åå­¦ä¹ æ¡†æ¶DbUtilsåº•å±‚ä½¿ç”¨PreparedStatementï¼Œhibernateåº•å±‚ä½¿ç”¨ä¹Ÿæ˜¯ã€‚ å¦‚æœä½¿ç”¨Statementï¼Œå¿…é¡»ä¿è¯sqléƒ½æ˜¯è‡ªå·±ç¼–å†™ï¼Œå®é™…å‚æ•°éƒ½æ˜¯è‡ªå·±ä¼ é€’çš„ã€‚ PreparedStatement åº”ç”¨åœºæ™¯ 1.é˜²sqlæ³¨å…¥ 2.å¤§æ•°æ® å¤§æ•°æ®ç±»å‹ï¼šblob å­—èŠ‚ ã€text å­—ç¬¦ 3.æ‰¹å¤„ç†","link":"/2016/07/04/JavaWeb%E5%9F%BA%E7%A1%80/JDBC%E7%AC%94%E8%AE%B0%E4%B8%80/"},{"title":"JDBCç¬”è®°äºŒ","text":"1. JDBCæ‰¹å¤„ç†Statement å’Œ PreparedStatement éƒ½æä¾›æ‰¹å¤„ç†ã€‚ æ‰¹å¤„ç†ï¼šæ‰¹é‡å¤„ç†sqlè¯­å¥ã€‚ Statementçš„æ‰¹å¤„ç†ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ‰§è¡Œä¸åŒçš„sqlè¯­å¥ã€‚åº”ç”¨åœºæ™¯ï¼šç³»ç»Ÿåˆå§‹åŒ–ï¼ˆåˆ›å»ºæ•°æ®åº“ï¼Œåˆ›å»ºä¸åŒè¡¨ï¼‰ PreparedStatement çš„æ‰¹å¤„ç†ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¡sqlè¯­å¥ï¼Œå®é™…å‚æ•°å¯ä»¥æ‰¹é‡ã€‚åº”ç”¨åœºæ™¯ï¼šæ•°æ®çš„åˆå§‹åŒ– 1.1 StatementaddBatch(sql) ,ç»™æ‰¹å¤„ç†ç¼“å­˜ä¸­æ·»åŠ sqlè¯­å¥ã€‚ clearBatch(); æ¸…ç©ºæ‰¹å¤„ç†ç¼“å­˜ã€‚ executeBatch() , æ‰§è¡Œæ‰¹å¤„ç†ç¼“å­˜æ‰€æœ‰çš„sqlè¯­å¥ã€‚æ³¨æ„ï¼šæ‰§è¡Œå®Œæˆä¹‹åç¼“å­˜ä¸­çš„å†…å®¹ä»ç„¶å­˜åœ¨ã€‚1.2 PreparedStatementaddBatch() , å°†å®é™…å‚æ•°æ‰¹é‡è®¾ç½®ç¼“å­˜ä¸­ã€‚æ³¨æ„ï¼šè·å¾—é¢„å¤„ç†ä¹‹å‰å¿…é¡»æä¾›sqlè¯­å¥ã€‚ mysql é»˜è®¤æ²¡å¼€å¯æ‰¹å¤„ç†ã€‚ é€šè¿‡URLä¹‹åå‚æ•°å¼€å¯ï¼Œ ?rewriteBatchedStatements = true2. äº‹åŠ¡2.1 ä»€ä¹ˆæ˜¯äº‹åŠ¡ äº‹åŠ¡ï¼šä¸€ç»„ä¸šåŠ¡é€»è¾‘æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æˆåŠŸã€‚ äº‹åŠ¡ç‰¹æ€§ï¼šACID åŸå­æ€§ï¼šä¸€ä¸ªäº‹åŠ¡æ˜¯ä¸å¯åˆ’åˆ†çš„ä¸€ä¸ªæ•´ä½“ã€‚è¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆä¸æˆåŠŸã€‚ ä¸€è‡´æ€§ï¼šäº‹åŠ¡æ“ä½œå‰åæ•°æ®ä¸€è‡´ã€‚ï¼ˆæ•°æ®å®Œæ•´ï¼‰ã€‚è½¬è´¦å‰åï¼Œä¸¤ä¸ªäººå’Œä¸€æ ·çš„ã€‚ éš”ç¦»æ€§ï¼šå¤šä¸ªäº‹åŠ¡å¯¹åŒä¸€ä¸ªå†…å®¹å¹¶å‘æ“ä½œã€‚ æŒä¹…æ€§ï¼šäº‹åŠ¡æäº¤ï¼Œæ“ä½œæˆåŠŸäº†ã€‚ä¸èƒ½æ”¹å˜äº†ã€‚ä¿å­˜åˆ°æ•°æ®åº“ä¸­äº†ã€‚ éš”ç¦»é—®é¢˜ è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡ è¯»åˆ° å¦ä¸€ä¸ª äº‹åŠ¡ æ²¡æœ‰æäº¤çš„æ•°æ®ã€‚ ä¸å¯é‡å¤è¯»ï¼šä¸€ä¸ªäº‹åŠ¡ è¯»åˆ° å¦ä¸€ä¸ªäº‹åŠ¡ å·²ç»æäº¤çš„æ•°æ®ã€‚ï¼ˆupdateæ›´æ–°ï¼‰ è™šè¯»(å¹»è¯»)ï¼šä¸€ä¸ªäº‹åŠ¡ è¯»åˆ° å¦ä¸€ä¸ªäº‹åŠ¡ å·²ç»æäº¤çš„æ•°æ®ã€‚ï¼ˆinsertæ’å…¥ï¼‰ â€“ç†è®ºæ—¶ äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼šç”¨äºè§£å†³éš”ç¦»é—®é¢˜ è¯»æœªæäº¤ï¼šread uncommittedï¼Œä¸€ä¸ªäº‹åŠ¡è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æ²¡æœ‰æäº¤çš„æ•°æ®ã€‚å­˜æ”¾é—®é¢˜ï¼š3ä¸ª è¯»å·²æäº¤ï¼šread committedï¼Œä¸€ä¸ªäº‹åŠ¡è¯»åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æäº¤çš„æ•°æ®ã€‚è§£å†³ï¼šè„è¯»ï¼Œå­˜åœ¨2ä¸ªé—®é¢˜ å¯é‡å¤è¯»ï¼šrepeatable read ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­è¯»åˆ°æ•°æ®é‡å¤çš„ã€‚åŠæ—¶å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤ã€‚è§£å†³ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ï¼Œå­˜æ”¾1ä¸ªé—®é¢˜ã€‚ ä¸²è¡ŒåŒ–ï¼Œserializableï¼Œå•äº‹åŠ¡ï¼ŒåŒæ—¶åªèƒ½ä¸€ä¸ªäº‹åŠ¡åœ¨æ“ä½œã€‚å¦ä¸€ä¸ªäº‹åŠ¡æŒ‚èµ·(æš‚åœ)ã€‚è§£å†³ï¼š3ä¸ªé—®é¢˜ã€‚ é»˜è®¤éš”ç¦»çº§åˆ«mysqlé»˜è®¤éš”ç¦»çº§åˆ«ï¼šrepeatable readoracleé»˜è®¤éš”ç¦»çº§åˆ«ï¼šread committedå¯¹æ¯”ï¼šæ€§èƒ½ï¼šread uncommitted &gt; read committed &gt; repeatable read &gt; serializable å®‰å…¨ï¼šread uncommitted &lt; read committed &lt; repeatable read &lt; serializable 2.2 äº‹åŠ¡æ“ä½œ mysql å‘½ä»¤æ“ä½œ å¼€å¯äº‹åŠ¡ï¼šmysql&gt; start transaction; â€“å¼€å¯ç›¸å½“äºå…³é—­è‡ªåŠ¨æäº¤ æäº¤äº‹åŠ¡ï¼šmysql&gt; commit; â€“å…¨éƒ¨æˆåŠŸ å›æ»šäº‹åŠ¡ï¼šmysql&gt; rollback; â€“ä¿è¯å…¨éƒ¨ä¸æˆåŠŸ jdbc javaä»£ç æ“ä½œã€æŒæ¡ã€‘â€“ JDBCä¸­å¿…é¡»ä½¿ç”¨Connectionè¿æ¥è¿›è¡Œäº‹åŠ¡æ“ä½œã€‚ å¼€å¯äº‹åŠ¡ï¼šconn.setAutoCommit(false); æäº¤äº‹åŠ¡ï¼šconn.commit(); å›æ»šäº‹åŠ¡ï¼šconn.rollback(); mysql é»˜è®¤äº‹åŠ¡æäº¤çš„ï¼ŒåŠæ¯æ‰§è¡Œä¸€æ¡sqlè¯­å¥å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ã€‚æ‰©å±•ï¼šoracleäº‹åŠ¡é»˜è®¤ä¸æäº¤ï¼Œéœ€è¦æ‰‹åŠ¨æäº¤ã€‚ 2.3 ä¿å­˜ç‚¹Savepoint ä¿å­˜ç‚¹ï¼Œç”¨äºè®°å½•ç¨‹åºæ‰§è¡Œä½ç½®ï¼Œæ–¹ä¾¿å¯ä»¥éšæ„å›æ»šæŒ‡å®šçš„ä½ç½®ã€‚spring äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºABæ•´ä½“ï¼ˆå¿…é¡»ï¼‰ï¼ŒCDæ•´ä½“ï¼ˆå¯é€‰ï¼‰ Savepoint savepoint = null; try{ // 1 å¼€å¯äº‹åŠ¡ conn.setAutoCommit(false); A B // è®°å½•ä¿å­˜ç‚¹ savepoint = conn.setSavepoint(); C D //2 æäº¤ABCD conn.commit(); } catch(){ if(savepoint != null){ //CD æœ‰å¼‚å¸¸ï¼Œå›æ»šåˆ°CDä¹‹å‰ conn.rollback(savepoint); // æäº¤AB conn.commit(); } else { //ABæœ‰å¼‚å¸¸ ,å›æ»šåˆ°æœ€å¼€å§‹å¤„ conn.rollback(); } }2.4 ä¸¢å¤±æ›´æ–°æ¡ˆä¾‹A æŸ¥è¯¢æ•°æ®ï¼Œusername = â€˜jackâ€™ ,password = â€˜1234â€™B æŸ¥è¯¢æ•°æ®ï¼Œusername=â€jackâ€, password=â€1234â€A æ›´æ–°ç”¨æˆ·å username=â€roseâ€,password=â€™1234â€™ â€“&gt; username=â€roseâ€,password=â€1234â€B æ›´æ–°å¯†ç  password=â€9999â€ ,username=â€jackâ€ â€“&gt; username=â€jackâ€,password=â€™9999â€™ä¸¢å¤±æ›´æ–°ï¼šæœ€åæ›´æ–°æ•°æ®ï¼Œå°†å‰é¢æ›´æ–°çš„æ•°æ®è¦†ç›–äº†ã€‚ è§£å†³æ–¹æ¡ˆï¼šé‡‡ç”¨é”æœºåˆ¶ã€‚ä¹è§‚é”ï¼šä¸¢å¤±æ›´æ–°è‚¯å®šä¸ä¼šå‘ç”Ÿã€‚ ç»™è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µï¼ˆæ ‡è¯†ï¼‰ï¼Œç”¨äºè®°å½•æ“ä½œç‰ˆæœ¬ã€‚ username=&quot;jack&quot;,password=&quot;1234&quot;,version=&quot;1&quot; ï¼Œæ¯”è¾ƒç‰ˆæœ¬å·ï¼Œå¦‚æœä¸€æ ·ï¼Œä¿®æ”¹ç‰ˆæœ¬è‡ªåŠ¨+1.ã€‚å¦‚æœä¸ä¸€æ ·ï¼Œå¿…é¡»å…ˆæŸ¥è¯¢ï¼Œå†æ›´æ–°ã€‚æ‚²è§‚é”ï¼šä¸¢å¤±æ›´æ–°è‚¯å®šä¼šå‘ç”Ÿã€‚é‡‡ç”¨æ•°æ®åº“é”æœºåˆ¶ã€‚ è¯»é”ï¼šå…±äº«é”ï¼Œå¤§å®¶å¯ä»¥ä¸€èµ·è¯»ã€‚ select .... from .... lock in share mode; å†™é”ï¼šæ’ä»–é”ï¼Œåªèƒ½ä¸€ä¸ªè¿›è¡Œå†™ï¼Œä¸èƒ½æœ‰å…¶ä»–é”ï¼ˆå†™ã€è¯»ï¼‰ï¼Œæ‰€æœ‰æ›´æ–°updateæ“ä½œä¸¢å°†è‡ªåŠ¨è·å¾—å†™é”ã€‚ select ... from ... for update;æ³¨æ„ï¼šæ•°æ®åº“çš„é”ï¼Œå¿…é¡»åœ¨äº‹åŠ¡ä¸­ä½¿ç”¨ã€‚åªè¦äº‹åŠ¡æ“ä½œå®Œæˆï¼ˆcommit|rollback|è¶…æ—¶ï¼‰è‡ªåŠ¨é‡Šæ”¾é” 3. äº‹åŠ¡å®ä¾‹4. è¿æ¥æ± 1.ä¸ºä»€ä¹ˆä½¿ç”¨è¿æ¥æ± ï¼šè¿æ¥Connection åˆ›å»ºä¸é”€æ¯ æ¯”è¾ƒè€—æ—¶çš„ã€‚ä¸ºäº†æä¾›æ€§èƒ½ï¼Œå¼€å‘è¿æ¥æ± ã€‚2.ä»€ä¹ˆæ˜¯è¿æ¥æ±  javaeeè§„èŒƒè§„å®šï¼šè¿æ¥æ± å¿…é¡»å®ç°æ¥å£ï¼Œjavax.sql.DataSource (æ•°æ®æº) ä¸ºäº†è·å¾—è¿æ¥ getConnection() è¿æ¥æ± ç»™è°ƒç”¨è€…æä¾›è¿æ¥ï¼Œå½“è°ƒç”¨è€…ä½¿ç”¨ï¼Œæ­¤é“¾æ¥åªèƒ½ä¾›è°ƒåŠ¨è€…æ˜¯ä½¿ç”¨ï¼Œå…¶ä»–äººä¸èƒ½ä½¿ç”¨ã€‚ å½“è°ƒç”¨è€…ä½¿ç”¨å®Œæˆä¹‹åï¼Œå¿…é¡»å½’è¿˜ç»™è¿æ¥æ± ã€‚è¿æ¥å¿…é¡»é‡å¤ä½¿ç”¨ã€‚3.è‡ªå®šä¹‰è¿æ¥æ± 4.ç¬¬ä¸‰æ–¹è¿æ¥æ±  DBCPï¼Œapache C3P0 ï¼Œhibernate æ•´åˆ tomcat å†…ç½®ï¼ˆJNDIï¼‰4.1 DBCP1.Apacheæä¾›çš„2.å¯¼å…¥jaråŒ… commons-dbcp-1.4.jar æ ¸å¿ƒåŒ… commons-pool-1.6.jar ä¾èµ–åŒ…3.æ ¸å¿ƒç±» public class BasicDataSource implements DataSource4.æ‰‹åŠ¨è°ƒç”¨ //1 åˆ›å»ºæ ¸å¿ƒç±» BasicDataSource dataSource = new BasicDataSource(); //2 é…ç½®4ä¸ªåŸºæœ¬å‚æ•° dataSource.setDriverClassName(&quot;com.mysql.jdbc.Driver&quot;); dataSource.setUrl(&quot;jdbc:mysql:///day16_db&quot;); dataSource.setUsername(&quot;root&quot;); dataSource.setPassword(&quot;1234&quot;); //3 ç®¡ç†è¿æ¥é…ç½® dataSource.setMaxActive(30); //æœ€å¤§æ´»åŠ¨æ•° dataSource.setMaxIdle(20); //æœ€å¤§ç©ºé—²æ•° dataSource.setMinIdle(10); //æœ€å°ç©ºé—²æ•° dataSource.setInitialSize(15); //åˆå§‹åŒ–ä¸ªæ•°5.é…ç½®è°ƒç”¨ DBCPé‡‡ç”¨propertiesæ–‡ä»¶ï¼Œkey=value ï¼Œkeyä¸º BasicDataSourceå±æ€§ï¼ˆåŠsetterè·å¾—ï¼‰ //0 è¯»å–é…ç½®æ–‡ä»¶ InputStream is = TestDBCP.class.getClassLoader().getResourceAsStream(&quot;dbcpconfig.properties&quot;); Properties properties = new Properties(); properties.load(is); //1 åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å¾—é…ç½®ä¿¡æ¯ DataSource dataSource = BasicDataSourceFactory.createDataSource(properties);6.é…ç½®æ–‡ä»¶ dbcpconfig.properties #è¿æ¥è®¾ç½® driverClassName=com.mysql.jdbc.Driver url=jdbc:mysql://localhost:3306/day16_db username=root password=1234 #&lt;!-- åˆå§‹åŒ–è¿æ¥ --&gt; initialSize=10 #æœ€å¤§è¿æ¥æ•°é‡ maxActive=50 #&lt;!-- æœ€å¤§ç©ºé—²è¿æ¥ --&gt; maxIdle=20 #&lt;!-- æœ€å°ç©ºé—²è¿æ¥ --&gt; minIdle=5 #&lt;!-- è¶…æ—¶ç­‰å¾…æ—¶é—´ä»¥æ¯«ç§’ä¸ºå•ä½ 6000æ¯«ç§’/1000ç­‰äº60ç§’ --&gt; maxWait=60000 #JDBCé©±åŠ¨å»ºç«‹è¿æ¥æ—¶é™„å¸¦çš„è¿æ¥å±æ€§å±æ€§çš„æ ¼å¼å¿…é¡»ä¸ºè¿™æ ·ï¼š[å±æ€§å=property;] #æ³¨æ„ï¼š&quot;user&quot; ä¸ &quot;password&quot; ä¸¤ä¸ªå±æ€§ä¼šè¢«æ˜ç¡®åœ°ä¼ é€’ï¼Œå› æ­¤è¿™é‡Œä¸éœ€è¦åŒ…å«ä»–ä»¬ã€‚ connectionProperties=useUnicode=true;characterEncoding=gbk #æŒ‡å®šç”±è¿æ¥æ± æ‰€åˆ›å»ºçš„è¿æ¥çš„è‡ªåŠ¨æäº¤ï¼ˆauto-commitï¼‰çŠ¶æ€ã€‚ defaultAutoCommit=true #driver default æŒ‡å®šç”±è¿æ¥æ± æ‰€åˆ›å»ºçš„è¿æ¥çš„åªè¯»ï¼ˆread-onlyï¼‰çŠ¶æ€ã€‚ #å¦‚æœæ²¡æœ‰è®¾ç½®è¯¥å€¼ï¼Œåˆ™â€œsetReadOnlyâ€æ–¹æ³•å°†ä¸è¢«è°ƒç”¨ã€‚ï¼ˆæŸäº›é©±åŠ¨å¹¶ä¸æ”¯æŒåªè¯»æ¨¡å¼ï¼Œå¦‚ï¼šInformixï¼‰ defaultReadOnly= #driver default æŒ‡å®šç”±è¿æ¥æ± æ‰€åˆ›å»ºçš„è¿æ¥çš„äº‹åŠ¡çº§åˆ«ï¼ˆTransactionIsolationï¼‰ã€‚ #å¯ç”¨å€¼ä¸ºä¸‹åˆ—ä¹‹ä¸€ï¼šï¼ˆè¯¦æƒ…å¯è§javadocã€‚ï¼‰NONE,READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE defaultTransactionIsolation=READ_UNCOMMITTED4.2 C3P01.ç¬¬ä¸‰æ–¹æä¾›,éå¸¸ä¼˜ç§€2.å¯¼å…¥jaråŒ… c3p0-0.9.2-pre5.jar æ ¸å¿ƒåŒ… mchange-commons-java-0.2.3.jar ä¾èµ–åŒ… c3p0-oracle-thin-extras-0.9.2-pre5.jar ä½¿ç”¨oracleçš„ä¾èµ–3.æ ¸å¿ƒç±» ComboPooledDataSource4.æ‰‹åŠ¨è°ƒç”¨ //1 æ ¸å¿ƒç±» (æ—¥å¿—çº§åˆ«ï¼šdebug info warn error) ComboPooledDataSource dataSource = new ComboPooledDataSource(); //2 åŸºæœ¬4é¡¹ dataSource.setDriverClass(&quot;com.mysql.jdbc.Driver&quot;); dataSource.setJdbcUrl(&quot;jdbc:mysql:///day16_db&quot;); dataSource.setUser(&quot;root&quot;); dataSource.setPassword(&quot;1234&quot;); //3 ä¼˜åŒ– dataSource.setMaxPoolSize(30); //æœ€å¤§è¿æ¥æ± æ•° dataSource.setMinPoolSize(10); //æœ€å°è¿æ¥æ± æ•° dataSource.setInitialPoolSize(15); //åˆå§‹åŒ–è¿æ¥æ± æ•° dataSource.setAcquireIncrement(5); //æ¯ä¸€æ¬¡å¢å¼ºä¸ªæ•°5.é…ç½®è°ƒç”¨ åŠ è½½ä½ç½®ï¼šWEB-INF/classes (classpath , src) é…ç½®æ–‡ä»¶åç§°ï¼šc3p0-config.xml //1 c3p0...jar å°†è‡ªåŠ¨åŠ è½½é…ç½®æ–‡ä»¶ã€‚æ‰“åŒ…åä»WEB-INF/classes (src)ç›®å½•åŠ è½½åç§°ä¸ºc3p0-config.xmlçš„æ–‡ä»¶ //ComboPooledDataSource dataSource = new ComboPooledDataSource(); //è‡ªåŠ¨ä»é…ç½®æ–‡ä»¶ &lt;default-config&gt; ComboPooledDataSource dataSource = new ComboPooledDataSource(&quot;itheima&quot;); //æ‰‹åŠ¨æŒ‡å®šé…ç½®æ–‡ä»¶ &lt;named-config name=&quot;itheima&quot;&gt; 6.é…ç½®æ–‡ä»¶ c3p0-config.xml &lt;c3p0-config&gt; &lt;!-- é»˜è®¤é…ç½®ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåˆ™ä½¿ç”¨è¿™ä¸ªé…ç½® --&gt; &lt;default-config&gt; &lt;property name=&quot;driverClass&quot;&gt;com.mysql.jdbc.Driver&lt;/property&gt; &lt;property name=&quot;jdbcUrl&quot;&gt;jdbc:mysql:///day16_db&lt;/property&gt; &lt;property name=&quot;user&quot;&gt;root&lt;/property&gt; &lt;property name=&quot;password&quot;&gt;1234&lt;/property&gt; &lt;property name=&quot;checkoutTimeout&quot;&gt;30000&lt;/property&gt; &lt;property name=&quot;idleConnectionTestPeriod&quot;&gt;30&lt;/property&gt; &lt;property name=&quot;initialPoolSize&quot;&gt;10&lt;/property&gt; &lt;property name=&quot;maxIdleTime&quot;&gt;30&lt;/property&gt; &lt;property name=&quot;maxPoolSize&quot;&gt;100&lt;/property&gt; &lt;property name=&quot;minPoolSize&quot;&gt;10&lt;/property&gt; &lt;property name=&quot;maxStatements&quot;&gt;200&lt;/property&gt; &lt;user-overrides user=&quot;test-user&quot;&gt; &lt;property name=&quot;maxPoolSize&quot;&gt;10&lt;/property&gt; &lt;property name=&quot;minPoolSize&quot;&gt;1&lt;/property&gt; &lt;property name=&quot;maxStatements&quot;&gt;0&lt;/property&gt; &lt;/user-overrides&gt; &lt;/default-config&gt; &lt;!-- å‘½åçš„é…ç½® --&gt; &lt;named-config name=&quot;itheima&quot;&gt; &lt;property name=&quot;driverClass&quot;&gt;com.mysql.jdbc.Driver&lt;/property&gt; &lt;property name=&quot;jdbcUrl&quot;&gt;jdbc:mysql:///day16_db&lt;/property&gt; &lt;property name=&quot;user&quot;&gt;root&lt;/property&gt; &lt;property name=&quot;password&quot;&gt;1234&lt;/property&gt; &lt;!-- å¦‚æœæ± ä¸­æ•°æ®è¿æ¥ä¸å¤Ÿæ—¶ä¸€æ¬¡å¢é•¿å¤šå°‘ä¸ª --&gt; &lt;property name=&quot;acquireIncrement&quot;&gt;5&lt;/property&gt; &lt;property name=&quot;initialPoolSize&quot;&gt;20&lt;/property&gt; &lt;property name=&quot;minPoolSize&quot;&gt;10&lt;/property&gt; &lt;property name=&quot;maxPoolSize&quot;&gt;40&lt;/property&gt; &lt;property name=&quot;maxStatements&quot;&gt;0&lt;/property&gt; &lt;property name=&quot;maxStatementsPerConnection&quot;&gt;5&lt;/property&gt; &lt;/named-config&gt; &lt;/c3p0-config&gt; 4.3 JNDI tomcatç®¡ç†è¿æ¥æ±  JNDI(Java Naming and Directory Interface,Javaå‘½åå’Œç›®å½•æ¥å£)æ˜¯SUNå…¬å¸æä¾›çš„ä¸€ç§æ ‡å‡†çš„Javaå‘½åç³»ç»Ÿæ¥å£ï¼Œç”¨äºå­˜æ”¾javaä»»æ„å¯¹è±¡ï¼Œç»™å¯¹è±¡è¿›è¡Œå‘½åï¼ˆä½¿ç”¨ç›®å½•ç»“æ„ï¼‰ã€‚ä¾‹å¦‚ï¼š/a/b/c ä½œç”¨ï¼šåœ¨å¤šä¸ªé¡¹ç›®ä¹‹é—´å…±äº«æ•°æ®ï¼Œåªéœ€è¦ä¼ é€’åç§°ï¼Œå°±å¯ä»¥è·å¾—å¯¹è±¡ã€‚ ç†è§£ï¼šJNDI å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œç”¨äºå­˜æ”¾ä»»æ„å¯¹è±¡ã€‚ tomcat å°†è¿æ¥æ± å­˜æ”¾ JNDIå®¹å™¨ï¼Œå¯ä»¥è·å¾—ä½¿ç”¨ã€‚ä½¿ç”¨å‰æå¿…é¡»é€šçŸ¥tomcatè¿›è¡Œå­˜æ”¾ï¼Œé»˜è®¤æƒ…å†µä¸‹tomcatæ²¡æœ‰å­˜æ”¾ã€‚ é…ç½®:1.ç»™tomcaté…ç½®æ•°æ®æºï¼ˆè¿æ¥æ± ï¼‰ï¼Œä½¿ç”¨ æ ‡ç­¾ æ–¹å¼1ï¼š%tomcat%/conf/server.xml --&gt; åœ¨&lt;Host&gt;æ ‡ç­¾ä¸‹æ·»åŠ &lt;Context&gt; æ–¹å¼2ï¼š%tomcat%/conf/Catalina/localhost/day16.xml ---&gt; &lt;Context&gt; day16/META-INF/Context.xml åœ¨é¡¹ç›®çš„META-INFä¸‹åˆ›å»ºContext.xml,ä¼šè‡ªåŠ¨å‘å¸ƒåˆ°â€œæ–¹æ³•2â€æŒ‡å®šä½ç½® Context.xmlä¸­çš„å†…å®¹: &lt;Context&gt; &lt;!-- name å­˜æ”¾è¿›å»åç§° auth å­˜æ”¾ä½ç½® type ç¡®å®šå­˜æ”¾å†…å®¹ï¼Œtomcatå°†é€šè¿‡æŒ‡å®šæ¥å£åˆ›å»ºå®ä¾‹ï¼Œåº•å±‚ä½¿ç”¨DBCP å…¶ä»–éƒ½æ˜¯DBCPå±æ€§è®¾ç½® --&gt; &lt;Resource name=&quot;jdbc/itheima&quot; auth=&quot;Container&quot; type=&quot;javax.sql.DataSource&quot; maxActive=&quot;100&quot; maxIdle=&quot;30&quot; maxWait=&quot;10000&quot; username=&quot;root&quot; password=&quot;1234&quot; driverClassName=&quot;com.mysql.jdbc.Driver&quot; url=&quot;jdbc:mysql://localhost:3306/day16_db&quot;/&gt; &lt;/Context&gt;2 ä»JNDIå®¹å™¨è·å–ï¼Œåœ¨å½“å‰é¡¹ç›®web.xmlé…ç½® &lt;!-- ç»™å½“å‰é¡¹ç›®é…ç½®ï¼Œä»JNDIå®¹å™¨è·å¾—æŒ‡å®šåç§°å†…å®¹ --&gt; &lt;resource-ref&gt; &lt;res-ref-name&gt;jdbc/itheima&lt;/res-ref-name&gt; &lt;res-type&gt;javax.sql.DataSource&lt;/res-type&gt; &lt;res-auth&gt;Container&lt;/res-auth&gt; &lt;/resource-ref&gt;3.ä½¿ç”¨ //0 åŒ…åï¼šjavax.naming //1 åˆå§‹åŒ–JNDIå®¹å™¨ Context context = new InitialContext(); //2 è·å¾—æ•°æ®æº å›ºå®š â€œjava:/comp/envâ€ DataSource dataSource = (DataSource)context.lookup(&quot;java:/comp/env/jdbc/itheima&quot;);","link":"/2016/07/09/JavaWeb%E5%9F%BA%E7%A1%80/JDBC%E7%AC%94%E8%AE%B0%E4%BA%8C/"},{"title":"MySqlç¬”è®°","text":"1.æ•°æ®åº“çŸ¥è¯†åˆ†ç±»: ç½‘çŠ¶å‹æ•°æ®åº“ å±‚æ¬¡å‹æ•°æ®åº“ å…³ç³»å‹æ•°æ®åº“ Oracle ï¼š ç”²éª¨æ–‡ï¼Œoracleå…¬å¸ï¼Œå¤§å‹æ•°æ®ï¼Œæ”¶è´¹ db2 ï¼š IBMï¼Œå¤§å‹æ•°æ®ï¼Œæ”¶è´¹ Sql server ï¼š å¾®è½¯ï¼Œä¸­æ€§æ•°æ®ï¼Œæ”¶è´¹ã€‚(access office å°å‹) Mysql ï¼š å…è´¹ã€‚å°å‹ã€‚ï¼ˆå¼€æºï¼‰ â€“oracle 2.Mysqlå®‰è£… è®¾ç½®æ•°æ®åº“å­˜æ”¾ç›®å½• é€‰æ‹©é…ç½®ç±»å‹ é€‰æ‹©æœåŠ¡ç±»å‹ é€‰æ‹©æ•°æ®åº“ç±»å‹ è®¾ç½®å¹¶å‘è¿æ¥æ•° é…ç½®ç½‘ç»œå‚æ•° è®¾ç½®å­—ç¬¦é›† è®¾ç½®æœåŠ¡å’Œç¯å¢ƒé™å˜é‡ è®¾ç½®æ•°æ®åº“å¯†ç  æµ‹è¯• C:\\Users\\xxxxx&gt;mysql --version mysql Ver 14.14 Distrib 5.5.27, for Win64 (x86) 3.Mysqlç™»å½•&amp;ä¿®æ”¹æ•°æ®åº“å¯†ç mysql -h ä¸»æœº(ipåœ°å€) -u è´¦å· -p å¯†ç  use mysql; update user set password=password(&apos;1234&apos;) where user=&apos;root&apos;;4.å¸¸ç”¨å‘½ä»¤ æ˜¾ç¤ºå½“å‰æ•°æ®åº“æœåŠ¡å™¨ä¸­çš„æ•°æ®åº“åˆ—è¡¨ : show databases; ä½¿ç”¨æ•°æ®åº“ : use æ•°æ®åº“å; æ˜¾ç¤ºæ•°æ®åº“ä¸­çš„æ•°æ®è¡¨ : show tables; æ˜¾ç¤ºå½“å‰æ‰€ä½¿ç”¨çš„æ•°æ®åº“åç§° : select database(); æ˜¾ç¤ºå½“å‰æ•°æ®åº“çš„çŠ¶æ€ : status; æ˜¾ç¤ºæŸä¸ªè¡¨çš„è¡¨ç»“æ„ : desc è¡¨å; æ˜¾ç¤ºæ‰€æœ‰æ”¯æŒçš„å­—ç¬¦é›† : show character set; æŸ¥çœ‹åˆ›å»ºè¡¨çš„sqlè¯­å¥ : show create table è¡¨å; 5.SQLè¯­å¥5.1 DDLæ•°æ®å®šä¹‰è¯­è¨€(äº†è§£)&gt; æ“ä½œæ•°æ®åº“æˆ–è¡¨ç»“æ„5.1.1 æ•°æ®åº“æ“ä½œ åˆ›å»ºæ•°æ®åº“ : create database æ•°æ®åº“åç§°; æŸ¥è¯¢æ•°æ®åº“åˆ›å»ºè¯­å¥ : show create database æ•°æ®åº“åç§°; åˆ é™¤æ•°æ®åº“ : drop database [if exists] æ•°æ®åº“åç§°; ä¿®æ”¹æ•°æ® : alter database æ•°æ®åº“å character set å­—ç¬¦é›† collate æ¯”è¾ƒæ–¹å¼ä¸å»ºè®®ä¿®æ”¹ã€‚ 5.1.2 è¡¨ç»“æ„&gt; æ“ä½œè¡¨ä¹‹å‰,å¿…é¡»å…ˆåˆ‡æ¢æ•°æ®åº“. åˆ›å»ºè¡¨ : create table è¡¨å(å­—æ®µæè¿°,å­—æ®µæè¿°,...); create table users( id varchar(32), name varchar(50), age int ); åˆ é™¤è¡¨ : drop table è¡¨å; ä¿®æ”¹å­—æ®µç±»å‹ : alter table è¡¨å modify å­—æ®µåç§° æ–°ç±»å‹; ä¿®æ”¹å­—æ®µåç§° : alter table è¡¨å change æ—§å­—æ®µ æ–°å­—æ®µ æ–°å­—æ®µç±»å‹; æ·»åŠ å­—æ®µ : alter table è¡¨å add column å­—æ®µåç§° å­—æ®µç±»å‹; åˆ é™¤å­—æ®µ : alter table è¡¨å drop column å­—æ®µåç§°; é‡å‘½åè¡¨å : alter table è¡¨å rename [to] æ–°è¡¨æ˜; 5.1.3 æ•°æ®ç±»å‹å­—ç¬¦ä¸² char(n) å›ºå®šå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šchar(5) è¡¨ç¤ºå¯ä»¥å­˜æ”¾5ä¸ªå­—ç¬¦ï¼Œä¸”å¿…é¡»æ˜¯5ä¸ªã€‚ å¦‚æœæ’å…¥ â€œabcâ€,ç»“æœâ€œabc â€ å³è¾¹è‡ªåŠ¨æ·»åŠ ç©ºæ ¼ã€‚ varchar(n) å¯å˜é•¿å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼švarchar(5),è¡¨ç¤ºæœ€å¤šå­˜æ”¾5ä¸ªå­—ç¬¦ï¼Œå¦‚æœä¸å¤Ÿå°±åŸæ ·å­˜æ”¾ã€‚ å¦‚æœæ’å…¥â€œabcâ€ï¼Œç»“æœâ€œabcâ€æ•°å­— bit æ¯”ç‰¹ tinyint byte mediumint short int int ã€ã€‘ bigint long float float double(m,d) double ã€ã€‘ --mæ•°å­—é•¿åº¦ï¼Œdç²¾åº¦åŠå°æ•°ä½ numeric Number æ‰€æœ‰æ•°å­— ä¾‹å¦‚ï¼šdouble(5,2) 5è¡¨ç¤ºæ•´ä¸ªæ•°å­—ä¸º5ä½ï¼Œ2è¡¨ç¤ºå°æ•°ä½2ä¸ªã€‚æœ€å¤§å€¼ã€‚999.99æ—¶é—´æ—¥æœŸ ** ä¹‹åä½¿ç”¨javaæ—¥æœŸæ—¶é—´ç±»å‹ï¼šjava.util.Date ã€‚å¦‚æœè¦ä½¿ç”¨java.sql..ç±»å‹ï¼Œåªèƒ½å­˜æ”¾daoå±‚ date æ—¥æœŸ java.sql.Date datetime æ—¥æœŸæ—¶é—´ --- time æ—¶é—´ java.sql.Time timestamp æ—¶é—´æˆ³ java.sql.Timestamp sqlè½¬util ï¼š java.util.Date date = new java.sql.Date(long); utilè½¬sql ï¼š new java.sql.Date( new java.util.Date().getTime() )å¤§æ•°æ® å­—èŠ‚ï¼šå­˜æ”¾äºŒè¿›åˆ¶ ï¼ˆjava.sql.Blob ï¼šBinary Large Object äºŒè¿›åˆ¶å¤§å¯¹è±¡ï¼‰ TINYBLOB 255 blob 64k longblob 4G å­—ç¬¦ï¼šå­˜æ”¾æ–‡æœ¬ ï¼ˆjava.sql.Clob ï¼šCharacter Large Object å­—ç¬¦å¤§å¯¹è±¡ï¼‰ TINYTEXT 255 text 64k longtext 4G5.2 DMLæ•°æ®æ“ä½œè¯­è¨€(æŒæ¡)&gt; å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹çš„æ“ä½œ5.2.1 æ’å…¥æ•°æ®insert into è¡¨å(å­—æ®µåˆ—è¡¨) values(å­—æ®µå¯¹åº”å€¼);æ³¨æ„: å¤šä¸ªå­—æ®µä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš” å­—æ®µå€¼å¿…é¡»ä½¿ç”¨å¼•å·(å»ºè®®å•å¼•å·),å¦‚æœæ˜¯æ•´å½¢æ•°æ®å¼•å·å¯ä»¥çœç•¥ å­—æ®µé»˜è®¤å€¼ä¸ºnull5.2.2 æ›´æ–°æ•°æ®update è¡¨å set å­—æ®µå=å­—æ®µå€¼,å­—æ®µå=å­—æ®µå€¼,...; update è¡¨å set å­—æ®µå=å­—æ®µå€¼,å­—æ®µå=å­—æ®µå€¼,...where æ¡ä»¶;5.2.3 åˆ é™¤æ•°æ®delete from è¡¨å [where æ¡ä»¶];æ³¨æ„: delete from users; åˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®.è¿›è¡Œåˆ é™¤æ“ä½œç•™å¿ƒ,ä¸€èˆ¬æƒ…å†µåº”ç”¨ç³»ç»Ÿä¸è¿›è¡Œæ•°æ®åˆ é™¤,æä¾›ä¸€ä¸ªæ ‡è®°å­—æ®µ,é€»è¾‘åˆ é™¤(0è¡¨ç¤ºå·²åˆ é™¤,1è¡¨ç¤ºæ²¡æœ‰åˆ é™¤).5.3 çº¦æŸ ç»™å­—æ®µæ·»åŠ è§„åˆ™ï¼Œçº¦å®šå†…å®¹ç¼–å†™ã€‚æœ€ç»ˆä½œç”¨ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œä¸€è‡´æ€§ç­‰ã€‚ 5.3.1 ä¸»é”®çº¦æŸå…³é”®å­—:primary key è¦æ±‚:æ•°æ®å”¯ä¸€,ä¸èƒ½ä¸ºnull.1.å®šä¹‰è¡¨:å£°æ˜å­—æ®µæ—¶,å®šä¹‰ä¸»é”®.(primary key)åªèƒ½ä¿®é¥°ä¸€ä¸ªå­—æ®µ. create table pk01( id varchar(32) primary key , content varchar(50) );2.å®šä¹‰è¡¨ï¼Œå£°æ˜å­—æ®µä¹‹åï¼Œåœ¨çº¦æŸåŒºåŸŸå®šä¹‰ä¸»é”®ã€‚â€”ç‰¹ç‚¹ constraint primary key (å­—æ®µ1,å­—æ®µ2,â€¦.) å¯ä»¥è®¾ç½®å¤šä¸ªå­—æ®µ create table pk02( id varchar(32), content varchar(50), constraint primary key (id) );3.å®šä¹‰è¡¨ï¼Œå£°æ˜å­—æ®µï¼Œè¡¨åˆ›å»ºä¹‹åã€‚ä¿®æ”¹è¡¨ç»“æ„æ·»åŠ çº¦æŸã€‚â€“ç‰¹ç‚¹ï¼šä¹Ÿå¯ä»¥è®¾ç½®å¤šä¸ªå­—æ®µï¼Œæ›´çµæ´»ã€‚ create table pk03( id varchar(32), content varchar(50) ); alter table pk03 add constraint primary key (id); 5.3.2 å”¯ä¸€çº¦æŸå…³é”®å­—:unique è¦æ±‚:è¢«ä¿®é¥°çš„å­—æ®µä¸èƒ½é‡å¤1.å®šä¹‰è¡¨ï¼Œå£°æ˜å­—æ®µæ—¶ï¼Œå®šä¹‰å”¯ä¸€çº¦æŸã€‚â€” ç‰¹ç‚¹ï¼šuniqueåªèƒ½ä¿®é¥°ä¸€ä¸ªå­—æ®µ create table un01( id varchar(32), content varchar(50) unique );2.å®šä¹‰è¡¨ï¼Œå£°æ˜å­—æ®µä¹‹åï¼Œåœ¨çº¦æŸåŒºåŸŸå®šä¹‰å”¯ä¸€çº¦æŸã€‚â€”ç‰¹ç‚¹ constraintunique (å­—æ®µ1,å­—æ®µ2,â€¦.) å¯ä»¥è®¾ç½®å¤šä¸ªå­—æ®µ create table un02( id varchar(32), content varchar(50), constraint unique (content) );3.å®šä¹‰è¡¨ï¼Œå£°æ˜å­—æ®µï¼Œè¡¨åˆ›å»ºä¹‹åã€‚ä¿®æ”¹è¡¨ç»“æ„æ·»åŠ å”¯ä¸€çº¦æŸã€‚â€“ç‰¹ç‚¹ï¼šä¹Ÿå¯ä»¥è®¾ç½®å¤šä¸ªå­—æ®µï¼Œæ›´çµæ´»ã€‚ create table un03( id varchar(32), content varchar(50) ); alter table un03 add constraint unique (content); 5.3.3 éç©ºçº¦æŸå…³é”®å­—:not null è¦æ±‚:è¢«ä¿®é¥°çš„å­—æ®µä¸èƒ½ä¸ºnull1.å®šä¹‰è¡¨ï¼Œå£°æ˜å­—æ®µæ—¶ï¼Œæ·»åŠ çº¦æŸã€‚ create table nn01( id varchar(32), content varchar(50) not null ); create table nn02( id varchar(32), content varchar(50) not null default â€˜dzdâ€™ ); æ€»ç»“: ä¸»é”® = å”¯ä¸€ + éç©º 5.3.4 è‡ªåŠ¨å¢é•¿(mysqlç‰¹æœ‰)å®šä¹‰: å…³é”®å­—:auto_increment mysqlç‰¹æœ‰çš„ä¸€ä¸ªç‰¹æ®Šçš„å…³é”®å­—,è¢«ä¿®é¥°çš„å­—æ®µå°†è‡ªåŠ¨çš„ç´¯åŠ (oracleæ²¡æœ‰,ä½†æä¾›å¾ç£Šsequence) æ³¨æ„: 1.å­—æ®µç±»å‹å¿…é¡»æ˜¯æ•´å‹,ä¸€èˆ¬ä½¿ç”¨int 2.å¿…é¡»æ˜¯key(ä¸»é”®/å”¯ä¸€),ä¸€èˆ¬ä½¿ç”¨ä¸»é”®primary key 3.è¢«auto_incrementä¿®é¥°çš„å­—æ®µ,ä¸éœ€è¦æ‰‹åŠ¨ç»´æŠ¤æ•°æ®,mysqlå°†è‡ªåŠ¨ç»´æŠ¤ä»£ç ç¤ºä¾‹: create table ai01( id varchar(32) auto_increment, # é”™è¯¯ä»£ç  ä¸èƒ½ç”¨äºå­—ç¬¦ä¸² content varchar(50) ); create table ai02( id int auto_increment, # é”™è¯¯ä»£ç  å¿…é¡»æ˜¯primary key content varchar(50) ); create table ai03( id int primary key auto_increment, # æ­£ç¡®ä»£ç  content varchar(50) );é¢è¯•é¢˜: drop table ai03; #åˆ é™¤è¡¨ï¼Œæ•°æ®å’Œè¡¨éƒ½ä¸å­˜åœ¨äº†ã€‚ delete from ai03; #åˆ é™¤æ‰€æœ‰æ•°æ®ï¼Œè¡¨ä»ç„¶å­˜åœ¨ã€‚è¡¨ä¸­è®¡æ•°å™¨æ²¡æœ‰é‡ç½®ã€‚ truncate table ai03; #æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼Œè¡¨ä¸­çš„è®¡æ•°å™¨å°†é‡ç½®å½’0ã€‚ delete å’Œ truncate å¯¹æ¯” delete å°†æ•°æ®åˆ é™¤äº† truncate å…ˆåˆ é™¤äº†è¡¨ï¼Œå†åˆ›å»ºè¡¨ã€‚ 5.3.5 å¤–é”®çº¦æŸå…³é”®å­—:foreign key5.3.6 åˆ é™¤çº¦æŸåˆ é™¤ä¸»é”®ï¼šmysql&gt; `alter table è¡¨å drop primary key;` åˆ é™¤å”¯ä¸€ï¼šä¿®æ”¹åˆ— åˆ é™¤å¤–é”®ï¼šmysql&gt; `alter table è¡¨å drop foreign key åç§°;`5.3.7 cmdå‘½ä»¤è¡Œä¸­æ–‡ä¹±ç å¤„ç†set names gbk;5.4 DQLæ•°æ®æŸ¥è¯¢è¯­è¨€(æŒæ¡)5.4.1 æ— æ¡ä»¶æŸ¥è¯¢æŸ¥è¯¢æ‰€æœ‰: select * from users; select id,name,age from user;æŸ¥è¯¢éƒ¨åˆ†å­—æ®µ: select id,name from user;åˆå¹¶æŸ¥è¯¢æ¡ä»¶: select id,concat(firstname,secondname),age from users;å­—æ®µåˆ«å: select id,concat(firstname,secondname) as `å§“å`,age from users;ç‰¹æ®Šå­—ç¬¦æˆ–è€…å…³é”®å­—ä½¿ç”¨é‡éŸ³ç¬¦ `` 5.4.2 å¸¦æ¡ä»¶æŸ¥è¯¢æŸ¥è¯¢åˆ†æ•°ç­‰äº60çš„: select * from users where count=&apos;60&apos;;æŸ¥è¯¢å¹´é¾„å¤§äº18çš„å­¦ç”Ÿ: select * from users where age &gt; 18;æŸ¥è¯¢åˆ†æ•°åœ¨60-80ä¹‹é—´: select * from users where count &gt;= 60 and count &lt;= 80; select * from users where count between 60 and 80;æŸ¥è¯¢å¹´é¾„æ˜¯18æˆ–20çš„å­¦ç”Ÿ: select * from users where age = 18 or age = 20;æ¨¡ç³ŠæŸ¥è¯¢,ä¸å®Œå…¨åŒ¹é…: å­—æ®µ:like ç¬¦å·: %åŒ¹é…å¤šä¸ªæ•°æ® &apos;äº‘&apos; åªèƒ½åŒ¹é…ä¸€ä¸ªäº‘ &apos;%äº‘&apos; åŒ¹é…ä»¥äº‘ç»“å°¾çš„ &apos;äº‘%&apos; åŒ¹é…ä»¥äº‘å¼€å¤´çš„ &apos;%äº‘%&apos; åŒ…å«äº‘ _åŒ¹é…ä¸€ä¸ªæ•°æ®æŸ¥è¯¢åˆ†æ•°ç­‰äº60 æˆ–è€… åˆ†æ•°å¤§äº90å¹¶ä¸”å¹´é¾„å¤§äº23 select * from users where count = 60 or count &gt; 90 and age &gt; 23; select * from users where count = 60 or (count &gt; 90 and age &gt; 23); ### è¿ç®—ç¬¦ä¼˜å…ˆçº§ and ä¼˜å…ˆ oræŸ¥è¯¢æ²¡æœ‰è€ƒè¯•çš„å­¦ç”Ÿ select * from users where count is null;æŸ¥è¯¢æ‰€æœ‰è€ƒè¯•çš„å­¦ç”Ÿ select * from users where count is not null;è¿ç®—ç¬¦ ä¸ç›¸ç­‰ != &lt;&gt; 5.4.3 èšåˆå‡½æ•°èšåˆå‡½æ•°ï¼šå¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œç»Ÿè®¡ï¼Œæ˜¾ç¤ºä¸€ä¸ªæ•°æ®ï¼ˆä¸€è¡Œä¸€åˆ—çš„æ•°æ®ï¼‰ èšåˆå‡½æ•°ä¸ç»Ÿè®¡ nullå€¼ã€‚æœ‰å¤šå°‘æ¡è®°å½• count(* | å­—æ®µ) select count(*) from users; select count(id) from users; #7 select count(count) from users; #6å¹³å‡æˆç»© avg select avg(count) from users; #ä¸ç²¾å‡†ï¼ˆæ²¡æœ‰nullï¼‰ select sum(count)/count(id) from users; #ç²¾å‡†ï¼ˆè®¡ç®—nullï¼‰æœ€é«˜æˆç»© max select max(count) from users;æœ€å°å¹´é¾„ min select min(age) from users;ç­çº§æ€»æˆç»© sum select sum(count) from users;æŸ¥è¯¢æ‰€æœ‰çš„å¹´é¾„æ•°(æ’åº) å»é‡å¤ distinct æ’åº select..... order by å­—æ®µ1 å…³é”®å­—, å­—æ®µ2 å…³é”®å­—,.... ### å…³é”®å­— asc å‡åº ï¼Œ desc é™åº select distinct age from users order by age desc; # age asc ç­‰æ•ˆ age [asc] 5.4.4 åˆ†ç»„æŸ¥è¯¢æ·»åŠ ç­çº§å­—æ®µï¼ˆclassesï¼‰ alter table users add column classes varchar(3); update users set classes = 1; update users set classes = 2 where id=&apos;u005&apos; or id =&apos;u006&apos; or id =&apos;u007&apos;; update users set classes = 2 where id in (&apos;u005&apos;,&apos;u006&apos;,&apos;u007&apos;);æŸ¥è¯¢1ç­å’Œ2ç­çš„å¹³å‡æˆç»© åˆ†ç»„ select ... group by åˆ†ç»„å­—æ®µ; select classes,avg(count) from users group by classes; select classes,sum(count)/count(id) from users group by classes;æŸ¥è¯¢ç­çº§ï¼Œå¹³å‡æˆç»©ä¸åŠæ ¼çš„ï¼Œç­çº§æˆå‘˜ä¿¡æ¯ (æŸ¥è¯¢2ç­ï¼Œæˆå‘˜ä¿¡æ¯) select * from users where classes = 2;å¤šè¡¨æ“ä½œselect * from A,B where A.classes = B.classes and avg &lt; 60; è¡¨çš„åˆ«åselect ... from è¡¨å [as] åˆ«åå­æŸ¥è¯¢ï¼Œä¸€æ¡selectè¯­å¥ï¼Œä½œä¸ºå¦ä¸€ä¸ªselectä¸€éƒ¨åˆ†ã€‚select * from users,( select classes,sum(count)/count(id) as cavg from users group by classes) as Bwhere users.classes = B.classes and cavg &lt; 60; å­æŸ¥è¯¢ç‰¹ç‚¹#æŸ¥è¯¢ç»“æœä¸€è¡Œä¸€åˆ—ï¼Œå¯ä»¥ä½¿ç”¨ select id,(xxx) from select ... from ... where id= (xxxx) #æŸ¥è¯¢ç»“æœä¸€è¡Œå¤šåˆ—(æŸ¥è¯¢å¤šä¸ªå€¼)ï¼Œä½¿ç”¨å…³é”®å­— in ï¼Œall ç­‰ #æŸ¥è¯¢ç»“æœå¤šè¡Œå¤šåˆ—ï¼Œå¯ä»¥å½“å¦ä¸€ä¸ªè¡¨ä½¿ç”¨","link":"/2016/06/30/JavaWeb%E5%9F%BA%E7%A1%80/MySql%E7%AC%94%E8%AE%B0/"},{"title":"Rediså­¦ä¹ ç¬”è®°","text":"Redisï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ä»2010å¹´3æœˆ15æ—¥èµ·ï¼ŒRedisçš„å¼€å‘å·¥ä½œç”±VMwareä¸»æŒã€‚ä»2013å¹´5æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±PivotalèµåŠ©ã€‚ 1.ç®€ä»‹1.1 å®šä¹‰é«˜æ€§èƒ½çš„kvç¼“å­˜å’Œæ•°æ®åº“.å­˜å‚¨ç»“æ„å°±æ˜¯kvï¼Œå½¢å¼å¦‚ä¸‹ï¼š 1.2 åº”ç”¨åœºæ™¯ ç”¨æ¥åšç¼“å­˜(ehcache/memcached)â€”â€”redisçš„æ‰€æœ‰æ•°æ®æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼ˆå†…å­˜æ•°æ®åº“ï¼‰ å¯ä»¥åœ¨æŸäº›ç‰¹å®šåº”ç”¨åœºæ™¯ä¸‹æ›¿ä»£ä¼ ç»Ÿæ•°æ®åº“ åœ¨ä¸€äº›å¤§å‹ç³»ç»Ÿä¸­ï¼Œå·§å¦™åœ°å®ç°ä¸€äº›ç‰¹å®šçš„åŠŸèƒ½ï¼šsessionå…±äº«ã€è´­ç‰©è½¦åªè¦ä½ æœ‰ä¸°å¯Œçš„æƒ³è±¡åŠ›ï¼Œrediså¯ä»¥ç”¨åœ¨å„ç§å®˜ç½‘è¯´æ˜ä¸Šæ²¡æœ‰æåˆ°çš„åœºæ™¯ã€‚ã€‚ã€‚ã€‚ã€‚ 1.3 redisçš„ç‰¹æ€§ redisæ•°æ®è®¿é—®é€Ÿåº¦å¿«ï¼ˆæ•°æ®åœ¨å†…å­˜ä¸­ï¼‰ redisçš„æ•°æ®æœ‰æŒä¹…åŒ– æŒä¹…åŒ–æœºåˆ¶æœ‰ä¸¤ç§ï¼š 1ã€å®šæœŸå°†å†…å­˜æ•°æ®dumpåˆ°ç£ç›˜ 2ã€aofæŒä¹…åŒ–æœºåˆ¶â€”â€”ç”¨è®°æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯ä¸€æ¡æ•°æ®æ›´æ–°æ“ä½œï¼Œä¸€æ—¦å‡ºç°ç¾éš¾äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—é‡æ”¾æ¥æ¢å¤æ•´ä¸ªæ•°æ®åº“ redisè¿˜æ”¯æŒé›†ç¾¤æ¨¡å¼ï¼ˆå®¹é‡å¯ä»¥çº¿æ€§æ‰©å±•ï¼‰ redisç›¸æ¯”å…¶ä»–ç¼“å­˜å·¥å…·ï¼ˆehcach/memcachedï¼‰ï¼Œæœ‰ä¸€ä¸ªé²œæ˜çš„ä¼˜åŠ¿ï¼šæ”¯æŒä¸°å¯Œçš„æ•°æ®ç»“æ„ 1.4 Rediså®‰è£…TODO:windowsç‰ˆæœ¬å·²ç»æ€»ç»“äº†linuxç‰ˆæœ¬çš„å®‰è£…æ€»ç»“åˆ°é‚£ç¯‡ç¬”è®°ä¸­ 2. Rediså­˜å‚¨çš„æ•°æ®ç»“æ„2.1 String1.æ’å…¥/è¯»å–æ•°æ® set sessionid-0001 &quot;zhangsan&quot; get sessionid-0001 2.å¯¹stringç±»å‹æ•°æ®è¿›è¡Œå¢å‡ï¼ˆå‰ææ˜¯è¿™æ¡æ•°æ®çš„valueå¯ä»¥çœ‹æˆæ•°å­—ï¼‰ DECR key å‡å»1 INCR key åŠ ä¸Š1 DECRBY key decrement å‡å»decrement INCRBY key increment åŠ ä¸Šincrement3.ä¸€æ¬¡æ€§æ’å…¥æˆ–è€…è·å–å¤šæ¡æ•°æ® MSET key1 value1 key2 value2 ... æ’å…¥å¤šæ¡æ•°æ® MGET key1 key2 è·å–å¤šæ¡æ•°æ®2.2 List1.ä»å¤´éƒ¨æ’å…¥æ•°æ® LPUSH key value1 value2 value3 2.ä»å°¾éƒ¨æ’å…¥æ•°æ® RPUSH key value1 value2 value3 3.è¯»å–listä¸­çš„values LRANGE key start end lrange task-queue 0 -1 è¯»å–æ•´ä¸ªlist4.ä»å¤´éƒ¨å¼¹å‡ºä¸€ä¸ªå…ƒç´  LPOP key5.ä»å°¾éƒ¨å¼¹å‡ºä¸€ä¸ªå…ƒç´  RPOP key6.ä»ä¸€ä¸ªlistçš„å°¾éƒ¨å¼¹å‡ºä¸€ä¸ªå…ƒç´ æ’å…¥åˆ°å¦ä¸€ä¸ªlist RPOPLPUSH key1 key2æ¡ˆä¾‹: ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ(è¯¦è§åé¢ç¬”è®°) 2.3 HashRedisä¸­çš„Hashesç±»å‹å¯ä»¥çœ‹æˆå…·æœ‰String Keyå’ŒString Valueçš„mapå®¹å™¨ 1.æ’å…¥ä¸€æ¡hashç±»å‹çš„æ•°æ® hset key field value2.è·å–ä¸€æ¡hashç±»å‹æ•°æ®çš„value å–å‡ºä¸€æ¡hashç±»å‹æ•°æ®ä¸­æ‰€æœ‰field-valueå¯¹ hgetall key å–å‡ºhashæ•°æ®ä¸­æ‰€æœ‰fields hkeys value å–å‡ºhashæ•°æ®ä¸­æ‰€æœ‰çš„value hvals key å–å‡ºhashæ•°æ®ä¸­ä¸€ä¸ªæŒ‡å®šfieldçš„å€¼ hget key field3.ä¸ºhashæ•°æ®ä¸­æŒ‡å®šçš„ä¸€ä¸ªfieldçš„å€¼è¿›è¡Œå¢å‡ hincrby key field increment hincrby user001:zhangsan xiaomi 14.ä»hashæ•°æ®ä¸­åˆ é™¤ä¸€ä¸ªå­—æ®µfieldåŠå…¶å€¼ hdel key field hdel user001:zhangsan iphone2.4 Set1.æ’å…¥ä¸€æ¡setæ•°æ® sadd key value value value ... sadd frieds:zhangsan bingbing baby fengjie furong ruhua feifei2.æ˜¾ç¤ºsetæ•°æ®çš„ä¸ªæ•° scard key3.è·å–ä¸€æ¡setæ•°æ®çš„æ‰€æœ‰members smembers frieds:zhangsan 1) &quot;fengjie&quot; 2) &quot;baby&quot; 3) &quot;furong&quot; 4) &quot;bingbing&quot; 5) &quot;feifei&quot; 6) &quot;ruhua&quot; 4.åˆ¤æ–­ä¸€ä¸ªæˆå‘˜æ˜¯å¦å±äºæŸæ¡æŒ‡å®šçš„setæ•°æ® redis 127.0.0.1:6379&gt; sismember frieds:zhangsan liuyifei #å¦‚æœä¸æ˜¯ï¼Œåˆ™è¿”å›0 (integer) 0 redis 127.0.0.1:6379&gt; sismember frieds:zhangsan baby #å¦‚æœæ˜¯ï¼Œåˆ™è¿”å›1 (integer) 1 5.æ±‚ä¸¤ä¸ªsetæ•°æ®çš„å·®é›† æ±‚å·®é›† redis 127.0.0.1:6379&gt; sdiff frieds:zhangsan friends:xiaotao 1) &quot;furong&quot; 2) &quot;fengjie&quot; 3) &quot;ruhua&quot; 4) &quot;feifei&quot; æ±‚å·®é›†ï¼Œå¹¶å°†ç»“æœå­˜å…¥åˆ°å¦ä¸€ä¸ªset redis 127.0.0.1:6379&gt; sdiffstore zhangsan-xiaotao frieds:zhangsan friends:xiaotao (integer) 46.æ±‚äº¤é›†ï¼Œæ±‚å¹¶é›† æ±‚äº¤é›† redis 127.0.0.1:6379&gt; sinterstore zhangsan^xiaotao frieds:zhangsan friends:xiaotao (integer) 2 æ±‚å¹¶é›† redis 127.0.0.1:6379&gt; sunion frieds:zhangsan friends:xiaotao 1) &quot;fengjie&quot; 2) &quot;tangwei&quot; 3) &quot;liuyifei&quot; 4) &quot;bingbing&quot; 5) &quot;ruhua&quot; 6) &quot;feifei&quot; 7) &quot;baby&quot; 8) &quot;songhuiqiao&quot; 9) &quot;furong&quot; 10) &quot;yangmi&quot; 2.5 SortedSet1.å¾€redisåº“ä¸­æ’å…¥ä¸€æ¡sortedsetæ•°æ® redis 127.0.0.1:6379&gt; zadd nanshen:yanzhi:bang 70 liudehua 90 huangbo 100 weixiaobao 250 yanggang 59 xiaotao (integer) 52.ä»sortedsetä¸­æŸ¥è¯¢æœ‰åºç»“æœ #æ­£åºç»“æœ redis 127.0.0.1:6379&gt; zrange nanshen:yanzhi:bang 0 4 1) &quot;xiaotao&quot; 2) &quot;liudehua&quot; 3) &quot;huangbo&quot; 4) &quot;weixiaobao&quot; 5) &quot;yanggang&quot; #å€’åºç»“æœ redis 127.0.0.1:6379&gt; zrevrange nanshen:yanzhi:bang 0 4 1) &quot;yanggang&quot; 2) &quot;weixiaobao&quot; 3) &quot;huangbo&quot; 4) &quot;liudehua&quot; 5) &quot;xiaotao&quot; 3.æŸ¥è¯¢æŸä¸ªæˆå‘˜çš„åæ¬¡ åœ¨æ­£åºæ¦œä¸­çš„åæ¬¡ redis 127.0.0.1:6379&gt; zrank nanshen:yanzhi:bang xiaotao (integer) 0 åœ¨å€’åºæ¦œä¸­çš„åæ¬¡ redis 127.0.0.1:6379&gt; zrevrank nanshen:yanzhi:bang xiaotao (integer) 4 4.ä¿®æ”¹æˆå‘˜çš„åˆ†æ•° redis 127.0.0.1:6379&gt; zincrby nanshen:yanzhi:bang 300 xiaotao &quot;359&quot; redis 127.0.0.1:6379&gt; zrevrank nanshen:yanzhi:bang xiaotao (integer) 0 3. å®ä¾‹3.1 Listå®ä¾‹â€“ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿç”Ÿäº§è€…ä¸æ–­äº§ç”Ÿä»»åŠ¡ï¼Œæ”¾å…¥task-queueæ’é˜Ÿæ¶ˆè´¹è€…ä¸æ–­æ‹¿å‡ºä»»åŠ¡æ¥å¤„ç†ï¼ŒåŒæ—¶æ”¾å…¥ä¸€ä¸ªtmp-queueæš‚å­˜ï¼Œå¦‚æœä»»åŠ¡å¤„ç†æˆåŠŸï¼Œåˆ™æ¸…é™¤tmp-queueï¼Œå¦åˆ™ï¼Œå°†ä»»åŠ¡å¼¹å›task-queueä¸Šè¿°æœºåˆ¶æ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆï¼ŒçœŸå®ç‰ˆçš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿä¼šæ›´åŠ å¤æ‚ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šï¼ˆå¢åŠ äº†ä¸€ä¸ªä¸“é—¨ç”¨æ¥ç®¡ç†æš‚å­˜é˜Ÿåˆ—çš„è§’è‰²ï¼Œä»¥ä¾¿å°±ç®—æ¶ˆè´¹è€…ç¨‹åºå¤±è´¥é€€å‡ºï¼Œé‚£äº›å¤„ç†å¤±è´¥çš„ä»»åŠ¡ä¾ç„¶å¯ä»¥è¢«å¼¹å›task-queueï¼‰ ä»£ç : /** * ä½¿ç”¨redisæ¨¡æ‹Ÿä»»åŠ¡è°ƒåº¦ * Created by lujiahao on 2016/7/7. */ public class TaskSchedulerSystem { /** * æ¨¡æ‹Ÿä¸€ä¸ªç”Ÿäº§è€… */ public static class TaskProducer implements Runnable { Jedis jedis = new Jedis(&quot;127.0.0.1&quot;,6379); @Override public void run() { Random random = new Random(); while (true) { try { Thread.sleep(random.nextInt(600) + 600); // ç”Ÿæˆä¸€ä¸ªä»»åŠ¡ UUID taskid = UUID.randomUUID(); // å°†ä»»åŠ¡æ’å…¥ä»»åŠ¡é˜Ÿåˆ—:task-queue jedis.lpush(&quot;task-queue&quot;,taskid.toString()); System.out.println(taskid+&quot;ä»»åŠ¡è¢«æ’å…¥&quot;); } catch (InterruptedException e) { e.printStackTrace(); } } } } /** * æ¨¡æ‹Ÿä¸€ä¸ªæ¶ˆè´¹è€… */ public static class TaskConsumer implements Runnable{ Jedis jedis = new Jedis(&quot;127.0.0.1&quot;,6379); @Override public void run() { Random random = new Random(); while (true){ try { // ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä¸€ä¸ªä»»åŠ¡,å¹¶å°†ä»»åŠ¡æ”¾å…¥æš‚å­˜é˜Ÿåˆ—tmp-queue jedis.rpoplpush(&quot;task-queue&quot;, &quot;tmp-queue&quot;); // æ¨¡æ‹Ÿå¤„ç†ä»»åŠ¡--sleep---ä¸šåŠ¡é€»è¾‘ Thread.sleep(1000); // æ¨¡æ‹ŸæˆåŠŸå’Œå¤±è´¥çš„å¶ç„¶æƒ…å†µ if (random.nextInt(13) % 7 == 0){ // å¤±è´¥,å°†ä»»åŠ¡ä»æš‚å­˜é˜Ÿåˆ—tmp-queueå¼¹å›åˆ°ä»»åŠ¡é˜Ÿåˆ—task-queue String taskid = jedis.rpoplpush(&quot;tmp-queue&quot;, &quot;task-queue&quot;); System.out.println(taskid+&quot;ä»»åŠ¡å¤„ç†å¤±è´¥,å¼¹å›ä»»åŠ¡é˜Ÿåˆ—&quot;); } else { // æˆåŠŸ,å°†ä»»åŠ¡ä»æš‚å­˜é˜Ÿåˆ—ä¸­æ¸…é™¤ String taskid = jedis.rpop(&quot;tmp-queue&quot;); System.out.println(taskid+&quot;ä»»åŠ¡å¤„ç†æˆåŠŸ,ä»æš‚å­˜é˜Ÿåˆ—ä¸­æ¸…é™¤&quot;); } } catch (InterruptedException e) { e.printStackTrace(); } } } } public static void main(String[] args) throws InterruptedException { // å¯åŠ¨ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹,äº§ç”Ÿæ¨¡æ‹Ÿä»»åŠ¡ new Thread(new TaskProducer()).start(); Thread.sleep(500); // å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹,æ¨¡æ‹Ÿä»»åŠ¡çš„å¤„ç† new Thread(new TaskConsumer()).start(); // è®©ä¸»çº¿ç¨‹ä¼‘çœ  Thread.sleep(Integer.MAX_VALUE); } }3.2 SortedSetå®ä¾‹â€“LOLè‹±é›„æ•°æ®æ’è¡Œæ¦œ/** * LOLç›’å­è‹±é›„æ•°æ®æ’è¡Œæ¦œçš„æ¨¡æ‹Ÿå®ç° * Created by lujiahao on 2016/7/7. */ public class LOLHerosTopN { private static class PlayerTask implements Runnable { String[] heros = {&quot;å‹ç¼©&quot;, &quot;å‰‘åœ£&quot;, &quot;è›®ç‹&quot;, &quot;ç”·æª&quot;, &quot;å¥³è­¦&quot;, &quot;é˜¿ç‹¸&quot;, &quot;çŒ´å­&quot;, &quot;èµµä¿¡&quot;, &quot;ç›–ä¼¦&quot;}; Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379); @Override public void run() { Random random = new Random(); while (true) { String hero = heros[random.nextInt(heros.length)]; try { Thread.sleep(1000); jedis.zincrby(&quot;lol:hero:rank&quot;, 1, hero); } catch (InterruptedException e) { e.printStackTrace(); } } } } private static class ViewerTask implements Runnable { Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379); int i = 1; @Override public void run() { while (true) { System.out.println(&quot;ç¬¬&quot;+i+&quot;æ¬¡è·å–æ¦œå•:&quot;); try { Thread.sleep(2000); Set&lt;Tuple&gt; herosAndScore = jedis.zrevrangeWithScores(&quot;lol:hero:rank&quot;, 0, -1); for (Tuple tuple : herosAndScore) { System.out.println(tuple.getElement()+&quot;:&quot;+tuple.getScore()); } i++; } catch (InterruptedException e) { e.printStackTrace(); } } } } public static void main(String[] args) throws InterruptedException { new Thread(new PlayerTask()).start(); Thread.sleep(1000); new Thread(new ViewerTask()).start(); Thread.sleep(Long.MAX_VALUE); } }","link":"/2020/04/11/Redis/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"title":"03-Shiroè‡ªå®šä¹‰RealmåŠåŠ å¯†","text":"Shiroçš„iniæ–¹å¼é…ç½®ç”¨æˆ·åå¯†ç ï¼Œçµæ´»æ€§å·®ï¼Œå®‰å…¨æ€§ä¸ä½³ã€‚æœ¬æ–‡ä»‹ç»è‡ªå®šä¹‰RealmåŠåŠ å¯†ï¼Œå¯ä»¥å®‰å…¨çš„è·å–æ•°æ®è®¤è¯ã€‚ Shiroä»Realmè·å–å®‰å…¨æ•°æ®(å¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™)ï¼Œå°±æ˜¯è¯´SecurityManagerè¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå®ƒéœ€è¦ä»Realmè·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒä»¥ç¡®å®šç”¨æˆ·èº«ä»½æ˜¯å¦åˆæ³•ã€‚ä¹Ÿéœ€è¦ä»Realmå¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰² / æƒé™è¿›è¡ŒéªŒè¯ç”¨æˆ·æ˜¯å¦èƒ½è¿›è¡Œæ“ä½œï¼Œå¯ä»¥æŠŠRealmçœ‹æˆ DataSourceï¼Œå³å®‰å…¨æ•°æ®æºã€‚ 1. è‡ªå®šä¹‰Realm1.1 æ–°å»ºMyRealmç±»æ–°å»ºMyRealmå¹¶ç»§æ‰¿AuthorizingRealmï¼Œé‡å†™getNameï¼ŒdoGetAuthorizationInfoï¼ŒdoGetAuthenticationInfoä¸‰ä¸ªæ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041/** * è‡ªå®šä¹‰realmå®ç° * * @author lujiahao * @date 2019/10/14 */public class MyRealm extends AuthorizingRealm { @Override public String getName() { return \"myRealm\"; } /** * ç”¨æˆ·æƒé™å’Œè§’è‰² */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) { return null; } /** * ç”¨æˆ·è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // è·å–ç”¨æˆ·ä¿¡æ¯ String username = (String) token.getPrincipal(); // æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–ç”¨æˆ·åå’Œå¯†ç  String dbUsername = \"lujiahao\"; String dbPassword = \"123\"; // éªŒè¯ç”¨æˆ· if (!dbUsername.equals(username)) { return null; } // å‚æ•°åˆ—è¡¨ä¾æ¬¡æ˜¯ï¼š ç”¨æˆ·å å¯†ç  å½“å‰realmåå­— SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(username, dbPassword, getName()); return info; }} 1.2 é…ç½®æ–‡ä»¶æ–°å»ºshiro-realm.inié…ç½®æ–‡ä»¶ 1234# å£°æ˜ä¸€ä¸ªrealmmyRealm=com.lujiahao.realms.MyRealm# æŒ‡å®šsecuritymanagerçš„realmså®ç°securityManager.realms=$myRealm 1.3 æµ‹è¯•ç±»123456789101112131415161718192021222324252627282930/** * æµ‹è¯•è‡ªå®šä¹‰realm */@Testpublic void testCustomRealm() { // 1.åŠ è½½é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºSecurityMangerå·¥å‚ Factory&lt;SecurityManager&gt; factory = new IniSecurityManagerFactory(\"classpath:shiro-realm.ini\"); // 2.è·å¾—SecurityManagerå®ä¾‹å¯¹è±¡ SecurityManager securityManager = factory.getInstance(); // 3.å°†SecurityMangerç»‘å®šåˆ°å½“å‰è¿è¡Œç¯å¢ƒä¸­ SecurityUtils.setSecurityManager(securityManager); // 4.åˆ›å»ºå½“å‰ç™»å½•ä¸»ä½“ Subject currentUser = SecurityUtils.getSubject(); // 5.ç»‘å®šä¸»ä½“ç™»å½•çš„èº«ä»½å‡­è¯ï¼ˆå³è´¦æˆ·å¯†ç ï¼‰ UsernamePasswordToken token = new UsernamePasswordToken(\"lujiahao222\", \"123\"); // 6.ä¸»ä½“ç™»å½• try { currentUser.login(token); System.out.println(\"ç”¨æˆ·èº«ä»½éªŒè¯ï¼š\" + currentUser.isAuthenticated()); } catch (UnknownAccountException e) { System.out.println(\"è´¦æˆ·ä¿¡æ¯é”™è¯¯ï¼šæ— æ­¤è´¦æˆ·ä¿¡æ¯\"); } catch (IncorrectCredentialsException e) { System.out.println(\"å¯†ç é”™è¯¯ï¼\"); } catch (Exception e) { e.printStackTrace(); } // 7.æ³¨é”€ç™»å½• currentUser.logout(); System.out.println(\"ç”¨æˆ·èº«ä»½éªŒè¯ï¼š\" + currentUser.isAuthenticated());} 2. åŠ å¯†Shiroæä¾›äº†base64å’Œ16è¿›åˆ¶å­—ç¬¦ä¸²ç¼–ç  / è§£ç çš„APIæ”¯æŒï¼Œæ–¹ä¾¿ä¸€äº›ç¼–ç è§£ç æ“ä½œã€‚Shiroå†…éƒ¨çš„ä¸€äº›æ•°æ®çš„å­˜å‚¨åŠè¡¨ç¤ºéƒ½ä½¿ç”¨ base64å’Œ16è¿›åˆ¶å­—ç¬¦ä¸²ã€‚æ•£åˆ—ç®—æ³•æ˜¯ä¸€ç§ä¸å¯é€†çš„ç®—æ³•ï¼Œä¸€èˆ¬ç”¨äºå­˜å‚¨å¯†ç ä¹‹ç±»çš„æ•°æ®ï¼Œå¸¸è§çš„æ•£åˆ—ç®—æ³•å¦‚MD5ã€SHAç­‰ç­‰ã€‚ 2.1 æ–°å»ºEncryRealmç±»å¥—è·¯åŒä¸ŠğŸ˜ 123456789101112131415161718192021222324252627282930313233343536373839404142/** * åŠ å¯† * @author lujiahao * @date 2019/10/14 */public class EncryRealm extends AuthorizingRealm { @Override public String getName() { return \"encryRealm\"; } /** * ç”¨æˆ·æƒé™å’Œè§’è‰² */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) { return null; } /** * ç”¨æˆ·è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // è·å–ç”¨æˆ·ä¿¡æ¯ String username = (String) token.getPrincipal(); // æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–ç”¨æˆ·åå’Œå¯†ç  String dbUsername = \"lujiahao\"; // æ¨¡æ‹Ÿdbä¸­çš„å¯†ç ï¼šå¯†ç +ç›+æ•£åˆ—æ¬¡æ•° String dbPassword = \"6b74111749b5409fa32e05b02816b760\"; // éªŒè¯ç”¨æˆ· if (!dbUsername.equals(username)) { return null; } // å‚æ•°åˆ—è¡¨ä¾æ¬¡æ˜¯ï¼š ç”¨æˆ·å å¯†ç  ç› å½“å‰realmåå­— // è¿™é‡Œä¼ å…¥çš„å¯†ç ä¸€å®šæ˜¯ç»è¿‡md5çš„ï¼Œä¸ç„¶ä¼šæŠ¥å¼‚å¸¸ SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(username, dbPassword, ByteSource.Util.bytes(username), getName()); return info; }} 2.2 é…ç½®æ–‡ä»¶æ–°å»ºshiro-encry-realm.inié…ç½®æ–‡ä»¶ 1234567891011121314[main]#å®šä¹‰å‡­è¯åŒ¹é…å™¨credentialsMatcher = org.apache.shiro.authc.credential.HashedCredentialsMatcher#æ•£åˆ—ç®—æ³•credentialsMatcher.hashAlgorithmName = md5#æ•£åˆ—æ¬¡æ•°credentialsMatcher.hashIterations = 2# å£°æ˜ä¸€ä¸ªrealmmyRealm=com.lujiahao.realms.EncryRealm#å°†å‡­è¯åŒ¹é…å™¨è®¾ç½®åˆ°realmmyRealm.credentialsMatcher = $credentialsMatcher# æŒ‡å®šsecuritymanagerçš„realmså®ç°securityManager.realms=$myRealm 2.3 æµ‹è¯•ç±»123456789101112131415161718192021222324252627282930/** * æµ‹è¯•è‡ªå®šä¹‰åŠ å¯†realm */@Testpublic void testCustomEncryRealm() { // 1.åŠ è½½é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºSecurityMangerå·¥å‚ Factory&lt;SecurityManager&gt; factory = new IniSecurityManagerFactory(\"classpath:shiro-encry-realm.ini\"); // 2.è·å¾—SecurityManagerå®ä¾‹å¯¹è±¡ SecurityManager securityManager = factory.getInstance(); // 3.å°†SecurityMangerç»‘å®šåˆ°å½“å‰è¿è¡Œç¯å¢ƒä¸­ SecurityUtils.setSecurityManager(securityManager); // 4.åˆ›å»ºå½“å‰ç™»å½•ä¸»ä½“ Subject currentUser = SecurityUtils.getSubject(); // 5.ç»‘å®šä¸»ä½“ç™»å½•çš„èº«ä»½å‡­è¯ï¼ˆå³è´¦æˆ·å¯†ç ï¼‰ UsernamePasswordToken token = new UsernamePasswordToken(\"lujiahao\", \"123\"); // 6.ä¸»ä½“ç™»å½• try { currentUser.login(token); System.out.println(\"ç”¨æˆ·èº«ä»½éªŒè¯ï¼š\" + currentUser.isAuthenticated()); } catch (UnknownAccountException e) { System.out.println(\"è´¦æˆ·ä¿¡æ¯é”™è¯¯ï¼šæ— æ­¤è´¦æˆ·ä¿¡æ¯\"); } catch (IncorrectCredentialsException e) { System.out.println(\"å¯†ç é”™è¯¯ï¼\"); } catch (Exception e) { e.printStackTrace(); } // 7.æ³¨é”€ç™»å½• currentUser.logout(); System.out.println(\"ç”¨æˆ·èº«ä»½éªŒè¯ï¼š\" + currentUser.isAuthenticated());} Tips12SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(username, dbPassword, ByteSource.Util.bytes(username), getName()); ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°éœ€è¦æ˜¯ç»è¿‡md5åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œä¸ç„¶ä¼šæŠ¥å¼‚å¸¸ï¼Œå¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829org.apache.shiro.authc.AuthenticationException: Authentication failed for token submission [org.apache.shiro.authc.UsernamePasswordToken - lujiahao, rememberMe=false]. Possible unexpected error? (Typical or expected login exceptions should extend from AuthenticationException). at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78) at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57) at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290) at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71) at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288) at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58) at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268) at org.junit.runners.ParentRunner.run(ParentRunner.java:363) at org.apache.shiro.authc.AbstractAuthenticator.authenticate(AbstractAuthenticator.java:214) at org.junit.runner.JUnitCore.run(JUnitCore.java:137) at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68) at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:47) at org.apache.shiro.mgt.AuthenticatingSecurityManager.authenticate(AuthenticatingSecurityManager.java:106) at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:242) at org.apache.shiro.mgt.DefaultSecurityManager.login(DefaultSecurityManager.java:274)...Caused by: java.lang.IllegalArgumentException: Odd number of characters. at org.apache.shiro.codec.Hex.decode(Hex.java:128) at org.apache.shiro.codec.Hex.decode(Hex.java:107) at org.apache.shiro.codec.Hex.decode(Hex.java:95) at org.apache.shiro.authc.credential.HashedCredentialsMatcher.getCredentials(HashedCredentialsMatcher.java:353) at org.apache.shiro.authc.credential.HashedCredentialsMatcher.doCredentialsMatch(HashedCredentialsMatcher.java:380) at org.apache.shiro.realm.AuthenticatingRealm.assertCredentialsMatch(AuthenticatingRealm.java:600) at org.apache.shiro.realm.AuthenticatingRealm.getAuthenticationInfo(AuthenticatingRealm.java:581) at org.apache.shiro.authc.pam.ModularRealmAuthenticator.doSingleRealmAuthentication(ModularRealmAuthenticator.java:180) at org.apache.shiro.authc.pam.ModularRealmAuthenticator.doAuthenticate(ModularRealmAuthenticator.java:267) at org.apache.shiro.authc.AbstractAuthenticator.authenticate(AbstractAuthenticator.java:198) ... 26 more å‚è€ƒèµ„æ–™ http://shiro.apache.org/10-minute-tutorial.html https://blog.csdn.net/weixin_38278878/article/details/81054672 https://blog.csdn.net/qq_35981283/article/details/78559375 https://mrbird.cc/tags/Shiro/ ä»£ç è·å–https://github.com/lujiahao0708/LearnSpring Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/10/14/Shiro/03-Shiro%E8%87%AA%E5%AE%9A%E4%B9%89Realm%E5%8F%8A%E5%8A%A0%E5%AF%86/"},{"title":"ã€ŠElasticsearchæŠ€æœ¯è§£æä¸å®æˆ˜ã€‹Chapter 1.1ï¼šElasticsearchå…¥é—¨å’Œå€’æ’ç´¢å¼•","text":"1. ç®€ä»‹Elasticsearchæ˜¯ä¸€ä¸ªæœºé‡Luceneæ„å»ºçš„å¼€æºã€åˆ†å¸ƒå¼ã€RESTfulæ¥å£å…¨æ–‡æœç´¢å¼•æ“ã€‚åŒæ—¶ï¼ŒElasticsearchè¿˜æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ–‡æ¡£æ•°æ®åº“ï¼Œèƒ½å¤Ÿæ‰©å±•è‡³æ•°ç™¾ä¸ªæœåŠ¡å™¨å­˜å‚¨ä»¥å¤„ç†PBçº§æ•°æ®ï¼Œé€šå¸¸ä½œä¸ºå¤æ‚æœç´¢åœºæ™¯çš„é¦–é€‰åˆ©å™¨ã€‚ Elasticsearchçš„ä¼˜ç‚¹ï¼š æ¨ªå‘å¯æ‰©å±•æ€§ï¼šåªéœ€è¦å¢åŠ ä¸€å°æœåŠ¡å™¨ï¼Œé…ç½®å®Œæ¯•å³å¯åŠ å…¥é›†ç¾¤ã€‚ åˆ†ç‰‡æœºåˆ¶æä¾›æ›´å¥½çš„åˆ†å¸ƒæ€§ï¼šåŒä¸€ä¸ªç´¢å¼•åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œç±»ä¼¼äºHDFSçš„å—æœºåˆ¶ï¼Œåˆ†è€Œæ²»ä¹‹çš„æ–¹å¼æå‡å¤„ç†æ•ˆç‡ã€‚ é«˜å¯ç”¨ï¼šæä¾›å¤åˆ¶æœºåˆ¶ï¼Œä¸€ä¸ªåˆ†ç‰‡å¯ä»¥è®¾ç½®å¤šä¸ªå‰¯æœ¬ï¼Œåœ¨æŸå°æœåŠ¡å™¨å®•æœºæƒ…å†µä¸‹ï¼Œé›†ç¾¤ä¾æ—§å¯ä»¥å·¥ä½œï¼Œå¹¶åœ¨å®•æœºæœåŠ¡å™¨é‡å¯åæ¢å¤æ•°æ®ã€‚ ä½¿ç”¨ç®€å•ï¼šå¼€ç®±å³ç”¨ï¼Œå¿«é€Ÿæ­å»ºæœç´¢æœåŠ¡ã€‚ Elasticsearch wiki:https://zh.wikipedia.org/wiki/Elasticsearch 2. æ•°æ®åº“æœç´¢åœ¨æ•°æ®é‡å°‘çš„æƒ…å†µä¸‹å¯ä»¥å½“åšæœç´¢æœåŠ¡æ¥ä½¿ç”¨ï¼Œç„¶è€Œæ•°æ®åº“å½’æ ¹ç»“åº•æ˜¯åšæŒä¹…åŒ–å­˜å‚¨ã€‚å¦‚æœæ•°æ®é‡å¤§å°±éœ€è¦åšæœç´¢æœåŠ¡ï¼Œåº•å±‚æ•°æ®è¿˜æ˜¯å…³ç³»æ•°æ®åº“ã€‚æˆ‘å¸è€ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè®¢å•è¡¨ï¼Œæ•°æ®é‡å·²ç»é«˜è¾¾ä¸¤äº¿ï¼Œå®¢æœç­‰åå°ç³»ç»Ÿé€šå¸¸å¸¦æœ‰èŒƒå›´æˆ–æ‰¹é‡æ¡ä»¶ç­‰æŸ¥è¯¢ï¼Œè¿™æ—¶æ•°æ®åº“åŸºæœ¬ä¸Šå°±æ— æ³•å“åº”äº†ï¼ŒæŠ¥è­¦æ ¹æœ¬åœä¸ä¸‹æ¥ã€‚å› æ­¤ï¼Œç”¨æ•°æ®åº“æ¥å®ç°æœç´¢ï¼Œæ€§èƒ½å·®ï¼Œå¯ç”¨æ€§ä¸é«˜ã€‚ 3. LuceneLuceneæ˜¯ä¸€ä¸ªå¼€æºçš„å…¨æ–‡æœç´¢å¼•æ“å·¥å…·åŒ…ï¼Œå…¶ç›®çš„æ˜¯ä¸ºå¼€å‘è€…æä¾›ä¸€ä¸ªç®€å•å·¥å…·åŒ…ï¼Œä»¥å¿«é€Ÿå®ç°å…¨æ–‡æ£€ç´¢çš„åŠŸèƒ½ã€‚ Lucene wiki:https://zh.wikipedia.org/wiki/Lucene 4. å€’æ’ç´¢å¼•å€’æ’ç´¢å¼•ä¸­çš„ç´¢å¼•å¯¹è±¡æ˜¯æ–‡æ¡£æˆ–è€…æ–‡æ¡£é›†åˆä¸­çš„å•è¯ç­‰ï¼Œç”¨æ¥å­˜å‚¨è¿™äº›å•è¯åœ¨ä¸€ä¸ªæ–‡æ¡£æˆ–è€…ä¸€ç»„æ–‡æ¡£ä¸­çš„å­˜å‚¨ä½ç½®ï¼Œæ˜¯å¯¹æ–‡æ¡£æˆ–è€…æ–‡æ¡£é›†åˆçš„ä¸€ç§æœ€å¸¸ç”¨çš„ç´¢å¼•æœºåˆ¶ã€‚æœç´¢å¼•æ“çš„å…³é”®æ­¥éª¤å°±æ˜¯å»ºç«‹å€’æ’ç´¢å¼•ï¼Œä¸‹é¢ä»‹ç»Luceneæ˜¯å¦‚ä½•å»ºç«‹å€’æ’ç´¢å¼•å’Œç›¸åº”çš„ç”Ÿæˆç®—æ³•ã€‚ å‡è®¾æœ‰ä¸¤ç¯‡æ–‡ç« ï¼šæ–‡ç« 1ï¼šTom lives in Guangzhou, I live in Guangzhou too.æ–‡ç« 2ï¼šHe once lived in Shanghai. 4.1 å–å¾—å…³é”®è¯Luceneæ˜¯åŸºäºå…³é”®è¯ç´¢å¼•å’ŒæŸ¥è¯¢çš„ï¼Œé¦–å…ˆè¦è¿›è¡Œå…³é”®è¯æå–ï¼š åˆ†è¯ï¼šè‹±æ–‡å•è¯ç”±ç©ºæ ¼åˆ†éš”ï¼Œè¾ƒå¥½å¤„ç†ï¼›ä¸­æ–‡è¯è¯­ç”±äºæ˜¯è¿åœ¨ä¸€èµ·çš„ï¼Œéœ€è¦è¿›è¡Œç‰¹æ®Šçš„åˆ†è¯å¤„ç†ï¼ˆåé¢ä¼šä»‹ç»åˆ†è¯å™¨ç›¸å…³çŸ¥è¯†ï¼‰ã€‚ è¿‡æ»¤æ— æ¦‚å¿µè¯è¯­ï¼šè‹±æ–‡ä¸­â€œinâ€â€œonceâ€â€œtooâ€ç­‰è¯æ²¡æœ‰å®é™…æ„ä¹‰ï¼›ä¸­æ–‡ä¸­â€œçš„â€â€œæ˜¯â€ç­‰ä¹Ÿæ— å®é™…æ„ä¹‰ï¼Œè¿™äº›æ— æ¦‚å¿µè¯è¯­å¯ä»¥è¿‡æ»¤æ‰ã€‚ ç»Ÿä¸€å¤§å°å†™ï¼šâ€œheâ€å’Œâ€œHEâ€è¡¨ç¤ºçš„å«ä¹‰ä¸€æ ·ï¼Œæ‰€ä»¥å•è¯éœ€è¦ç»Ÿä¸€å¤§å°å†™ã€‚ è¯­ä¹‰è¿˜åŸï¼šé€šå¸¸ç”¨æˆ·æŸ¥è¯¢â€œliveâ€æ—¶å¸Œæœ›èƒ½å°†â€œlivesâ€å’Œâ€œlivedâ€ä¹ŸæŸ¥è¯¢å‡ºæ¥ï¼Œæ‰€ä»¥éœ€è¦å°†â€œlivesâ€å’Œâ€œlivedâ€è¿˜åŸæˆâ€œliveâ€ã€‚ è¿‡æ»¤æ ‡ç‚¹ç¬¦å· ç»è¿‡ä»¥ä¸Šè¿‡æ»¤ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š æ–‡ç« 1å…³é”®è¯ï¼štom live guangzhou i live guangzhou æ–‡ç« 2å…³é”®è¯ï¼šhe live shanghai 4.2 å»ºç«‹å€’æ’ç´¢å¼•å…³é”®è¯å»ºç«‹å®Œæˆåï¼Œå°±å¯ä»¥è¿›è¡Œå€’æ’ç´¢å¼•å»ºç«‹äº†ã€‚è¿‡æ»¤åçš„å…³ç³»æ˜¯ï¼šâ€œæ–‡ç« å·â€œå¯¹â€æ–‡ç« ä¸­æ‰€æœ‰å…³é”®è¯â€œï¼Œå€’æ’ç´¢å¼•æŠŠè¿™ä¸ªå…³ç³»å€’è¿‡æ¥å˜æˆï¼šâ€å…³é”®è¯â€œå¯¹â€æ‹¥æœ‰å…³é”®è¯çš„æ‰€æœ‰æ–‡ç« å·â€œã€‚ é€šå¸¸ä»…çŸ¥é“å…³é”®è¯åœ¨å“ªäº›æ–‡ç« ä¸­å‡ºç°è¿˜ä¸å¤Ÿï¼Œè¿˜éœ€è¦çŸ¥é“å…³é”®è¯åœ¨æ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°å’Œä½ç½®ï¼Œé€šå¸¸æœ‰ä¸¤ç§ä½ç½®ï¼š å­—ç¬¦ä½ç½®ï¼Œå³è®°å½•è¯¥è¯æ˜¯æ–‡ç« ä¸­ç¬¬å‡ ä¸ªå­—ç¬¦ï¼ˆä¼˜ç‚¹æ˜¯æ˜¾ç¤ºå¹¶å®šä½å…³é”®è¯å¿«ï¼‰ã€‚ å…³é”®è¯ä½ç½®ï¼Œå³è®°å½•è¯¥è¯æ˜¯æ–‡ç« ä¸­çš„ç¬¬å‡ ä¸ªå…³é”®è¯ï¼ˆä¼˜ç‚¹æ˜¯èŠ‚çº¦ç´¢å¼•ç©ºé—´ã€è¯ç»„æŸ¥è¯¢å¿«ï¼‰ï¼ŒLuceneä¸­è®°å½•çš„å°±æ˜¯è¿™ç§ä½ç½®ã€‚ ä»¥ä¸Šå°±æ˜¯Luceneç´¢å¼•ç»“æ„ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå…³é”®å­—æ˜¯æŒ‰å­—ç¬¦é¡ºåºæ’åˆ—çš„ï¼ˆLuceneæ²¡æœ‰ä½¿ç”¨Bæ ‘ç»“æ„ï¼‰ï¼Œå› æ­¤Luceneå¯ä»¥ä½¿ç”¨äºŒå…ƒæœç´¢ç®—æ³•å¿«é€Ÿå®šä½å…³é”®è¯ã€‚ 4.3 å®ç°Luceneå°†ä¸Šé¢ä¸‰åˆ—åˆ†åˆ«ä½œä¸ºè¯å…¸æ–‡ä»¶ï¼ˆTerm Dictionaryï¼‰ã€é¢‘ç‡æ–‡ä»¶ï¼ˆfrequenciesï¼‰ã€ä½ç½®æ–‡ä»¶ï¼ˆpositionsï¼‰ä¿å­˜ã€‚å…¶ä¸­è¯å…¸æ–‡ä»¶ä¸ä»…ä¿å­˜äº†æ¯ä¸ªå…³é”®è¯ï¼Œè¿˜ä¿ç•™äº†æŒ‡å‘é¢‘ç‡æ–‡ä»¶å’Œä½ç½®æ–‡ä»¶çš„æŒ‡é’ˆï¼Œé€šè¿‡æŒ‡é’ˆå¯ä»¥æ‰¾åˆ°è¯¥å…³é”®å­—çš„é¢‘ç‡ä¿¡æ¯å’Œä½ç½®ä¿¡æ¯ã€‚ Luceneä¸­ä½¿ç”¨äº†fieldçš„æ¦‚å¿µï¼Œç”¨äºè¡¨è¾¾ä¿¡æ¯æ‰€åœ¨çš„ä½ç½®ï¼ˆå¦‚æ ‡é¢˜ä¸­ã€æ–‡ç« ä¸­ã€urlä¸­ï¼‰ï¼Œåœ¨å»ºç´¢å¼•ä¸­ï¼Œè¯¥fieldä¿¡æ¯ä¹Ÿè®°å½•åœ¨è¯å…¸æ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªå…³é”®è¯éƒ½æœ‰ä¸€ä¸ªfieldä¿¡æ¯ï¼Œå› ä¸ºæ¯ä¸ªå…³é”®å­—ä¸€å®šå±äºä¸€ä¸ªæˆ–å¤šä¸ªfieldã€‚ 4.4 å‹ç¼©ç®—æ³•ä¸ºäº†å‡å°ç´¢å¼•æ–‡ä»¶çš„å¤§å°ï¼ŒLuceneå¯¹ç´¢å¼•è¿˜æ˜¯ç”¨äº†å‹ç¼©æŠ€æœ¯ã€‚é¦–å…ˆï¼Œå¯¹è¯å…¸æ–‡ä»¶ä¸­çš„å…³é”®è¯è¿›è¡Œå‹ç¼©ï¼Œå…³é”®è¯å‹ç¼©ä¸º&lt;å‰ç¼€é•¿åº¦,åç¼€&gt;ï¼Œä¾‹å¦‚ï¼šå½“å‰è¯ä¸ºâ€é˜¿æ‹‰ä¼¯è¯­â€œï¼Œä¸Šä¸€ä¸ªè¯ä¸ºâ€é˜¿æ‹‰ä¼¯â€œ,é‚£ä¹ˆâ€é˜¿æ‹‰ä¼¯è¯­â€œå‹ç¼©ä¸º&lt;3,è¯­&gt;ã€‚å…¶æ¬¡å¤§é‡ç”¨åˆ°çš„æ˜¯å¯¹æ•°å­—çš„å‹ç¼©ï¼Œæ•°å­—åªä¿å­˜ä¸ä¸Šä¸€ä¸ªå€¼çš„å·®å€¼ï¼ˆè¿™æ ·å¯ä»¥å‡å°‘æ•°å­—çš„é•¿åº¦ï¼Œè¿›è€Œå‡å°‘ä¿å­˜è¯¥æ•°å­—éœ€è¦çš„å­—èŠ‚æ•°ï¼‰ã€‚ä¾‹å¦‚å½“å‰æ–‡ç« å·æ˜¯16389ï¼ˆä¸å‹ç¼©è¦ç”¨3ä¸ªå­—èŠ‚ï¼‰ï¼Œä¸Šä¸€æ–‡ç« å·æ˜¯16382ï¼Œå‹ç¼©åä¿å­˜7ï¼ˆåªç”¨ä¸€ä¸ªå­—èŠ‚ï¼‰ã€‚ å‹ç¼©ç®—æ³•æ¨èé˜…è¯»:https://www.cnblogs.com/dreamroute/p/8484457.html 4.5 å®æˆ˜æŸ¥è¯¢å•è¯â€liveâ€œï¼ŒLuceneå…ˆå¯¹è¯å…¸äºŒå…ƒæŸ¥æ‰¾ï¼Œæ‰¾åˆ°è¯¥è¯ï¼Œé€šè¿‡æŒ‡å‘é¢‘ç‡æ–‡ä»¶çš„æŒ‡é’ˆè¯»å‡ºæ‰€æœ‰æ–‡ç« å·ï¼Œç„¶åè¿”å›ç»“æœã€‚è¯å…¸é€šå¸¸éå¸¸å°ï¼Œå¯ä»¥è¾¾åˆ°æ¯«ç§’çº§è¿”å›ã€‚è€Œç”¨æ™®é€šçš„é¡ºåºåŒ¹é…ç®—æ³•ï¼Œä¸å»ºç«‹ç´¢å¼•ï¼Œè€Œæ˜¯å¯¹æ‰€æœ‰æ–‡ç« çš„å†…å®¹è¿›è¡Œå­—ç¬¦ä¸²åŒ¹é…ï¼Œè¿‡ç¨‹æ˜¯å¾ˆç¼“æ…¢çš„ï¼Œå½“æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œè€—æ—¶æ›´åŠ ä¸¥é‡ã€‚ 5. åŸºç¡€æ¦‚å¿µ5.1 ç´¢å¼•è¯ï¼ˆtermï¼‰Elasticsearchä¸­èƒ½å¤Ÿè¢«ç´¢å¼•çš„ç²¾ç¡®å€¼ã€‚fooã€Fooã€FOOå‡ ä¸ªå•è¯æ˜¯ä¸åŒçš„ç´¢å¼•è¯ã€‚ç´¢å¼•è¯å¯ä»¥é€šè¿‡termæŸ¥è¯¢è¿›è¡Œå‡†ç¡®çš„æœç´¢ã€‚ 5.2 æ–‡æœ¬ï¼ˆtextï¼‰æ–‡æœ¬ä¼šè¢«æ‹†åˆ†æˆä¸€ä¸ªä¸ªç´¢å¼•è¯å­˜å‚¨åœ¨ç´¢å¼•åº“ä¸­ï¼Œä¸ºåç»­æœç´¢æä¾›æ”¯æŒã€‚ 5.3 åˆ†æï¼ˆanalysisï¼‰åˆ†ææ˜¯å°†æ–‡æœ¬è½¬æ¢ä¸ºç´¢å¼•è¯çš„è¿‡ç¨‹ï¼Œå…¶ç»“æœä¾èµ–äºåˆ†è¯å™¨ã€‚ 5.4 é›†ç¾¤ï¼ˆclusterï¼‰é›†ç¾¤ç”±ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚ElasticsearchèŠ‚ç‚¹å¦‚æœæœ‰ç›¸åŒçš„é›†ç¾¤åç§°ä¼šè‡ªåŠ¨åŠ å…¥åˆ°åŒä¸€ä¸ªé›†ç¾¤ï¼Œå› æ­¤å¦‚æœä½ æ‹¥æœ‰å¤šä¸ªç‹¬ç«‹é›†ç¾¤ï¼Œæ¯ä¸ªé›†ç¾¤éƒ½è¦è®¾ç½®ä¸åŒçš„åç§°ã€‚ 5.5 èŠ‚ç‚¹ï¼ˆnodeï¼‰èŠ‚ç‚¹æ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šç‹¬ç«‹çš„æœåŠ¡ï¼Œæ˜¯é›†ç¾¤çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥å­˜å‚¨æ•°æ®ï¼Œå¹¶å‚ä¸é›†ç¾¤çš„ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚ 5.6 è·¯ç”±ï¼ˆroutingï¼‰æ–‡æ¡£å­˜å‚¨æ—¶æ˜¯é€šè¿‡æ•£åˆ—å€¼è¿›è¡Œè®¡ç®—ï¼Œæœ€ç»ˆé€‰æ‹©å­˜å‚¨åœ¨ä¸»åˆ†ç‰‡ä¸­ï¼Œè¿™ä¸ªå€¼é»˜è®¤æ˜¯ç”±æ–‡æ¡£çš„IDç”Ÿæˆã€‚ 5.7 åˆ†ç‰‡ï¼ˆshardï¼‰åˆ†ç‰‡æ˜¯å•ä¸ªLuceneå®ä¾‹ï¼Œæ˜¯Elasticsearchç®¡ç†çš„æ¯”è¾ƒåº•å±‚çš„åŠŸèƒ½ã€‚å½“ç´¢å¼•å ç”¨ç©ºé—´å¾ˆå¤§è¶…è¿‡ä¸€ä¸ªèŠ‚ç‚¹çš„ç‰©ç†å­˜å‚¨ï¼ŒElasticsearchå°†ç´¢å¼•åˆ‡åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼Œåˆ†æ•£åœ¨ä¸åŒçš„ç‰©ç†èŠ‚ç‚¹ä¸Šï¼Œä»¥è§£å†³å•ç‰©ç†èŠ‚ç‚¹å­˜å‚¨ç©ºé—´æœ‰é™çš„é—®é¢˜ã€‚ 5.8 ä¸»åˆ†ç‰‡ï¼ˆprimary shardï¼‰æ¯ä¸ªæ–‡æ¡£éƒ½å­˜å‚¨åœ¨ä¸€ä¸ªåˆ†ç‰‡ä¸­ï¼Œå­˜å‚¨æ–‡æ¡£æ—¶ç³»ç»Ÿä¼šé¦–å…ˆå­˜å‚¨åœ¨ä¸»åˆ†ç‰‡ä¸­ï¼Œç„¶åå¤åˆ¶åˆ°ä¸åŒçš„å‰¯æœ¬ä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ªç´¢å¼•æ‹¥æœ‰5ä¸ªä¸»åˆ†ç‰‡ï¼Œåˆ†ç‰‡ä¸€æ—¦å»ºç«‹ï¼Œä¸»åˆ†ç‰‡æ•°é‡å°±æ— æ³•ä¿®æ”¹ã€‚ 5.9 å‰¯æœ¬åˆ†ç‰‡ï¼ˆreplica shardï¼‰æ¯ä¸ªä¸»åˆ†ç‰‡æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå‰¯æœ¬ï¼Œæ˜¯ä¸»åˆ†ç‰‡çš„å¤åˆ¶ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯ï¼š å¢åŠ é«˜å¯ç”¨æ€§ï¼šå½“ä¸»åˆ†ç‰‡å¤±è´¥æ—¶ï¼ŒæŸä¸€å‰¯æœ¬åˆ†ç‰‡æå‡ä¸ºä¸»åˆ†ç‰‡ æé«˜æ€§èƒ½ï¼šå‰¯æœ¬åˆ†ç‰‡æ•°é‡å¯ä»¥åŠ¨æ€é…ç½®ï¼Œå¯ä»¥ä¸ºä¸»åˆ†ç‰‡åˆ†æ‹…æŸ¥è¯¢å‹åŠ›ã€‚ å…è®¸æ°´å¹³åˆ†å‰²æ‰©å±•æ•°æ® å…è®¸åˆ†é…å’Œå¹¶è¡Œæ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½å’Œååé‡ã€‚ 5.10 å¤åˆ¶ï¼ˆreplicaï¼‰ä¸»åˆ†ç‰‡çš„æ•°æ®ä¼šå¤åˆ¶åˆ°å‰¯æœ¬åˆ†ç‰‡ä¸­ï¼Œè¿™æ ·é¿å…äº†å•ç‚¹é—®é¢˜ï¼Œå½“æŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œå¤åˆ¶å¯ä»¥å¯¹æ•…éšœè¿›è¡Œè½¬ç§»ï¼Œä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨ã€‚ 5.11 ç´¢å¼•ï¼ˆindexï¼‰ç´¢å¼•æ˜¯å…·æœ‰ç›¸åŒç»“æ„çš„æ–‡æ¡£åˆé›†ã€‚ 5.12 ç±»å‹ï¼ˆtypeï¼‰ä¸€ä¸ªç´¢å¼•å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ï¼Œç±»å‹æ˜¯ç´¢å¼•çš„é€»è¾‘åˆ†åŒºã€‚ 5.13 æ–‡æ¡£ï¼ˆdocumentï¼‰æ–‡æ¡£æ˜¯å­˜å‚¨åœ¨Elasticsearchä¸­çš„ä¸€ä¸ªJSONæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå°±åƒå…³ç³»æ•°æ®åº“ä¸­è¡¨çš„ä¸€è¡Œè®°å½•ã€‚ 5.14 æ˜ å°„ï¼ˆmappingï¼‰æ˜ å°„åƒå…³ç³»æ•°æ®åº“ä¸­çš„è¡¨ç»“æ„ï¼Œæ¯ä¸ªç´¢å¼•éƒ½æœ‰ä¸€ä¸ªæ˜ å°„ï¼Œå®ƒå®šä¹‰äº†ç´¢å¼•ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µç±»å‹ã€‚æ˜ å°„å¯ä»¥äº‹å…ˆè¢«å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨ç¬¬ä¸€æ¬¡å­˜å‚¨æ–‡æ¡£æ—¶è¢«è‡ªåŠ¨è¯†åˆ«ã€‚ 5.15 å­—æ®µï¼ˆfieldï¼‰æ–‡æ¡£ä¸­åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå­—æ®µï¼Œå­—æ®µå¯ä»¥æ˜¯ä¸€ä¸ªç®€å•çš„å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–å¯¹è±¡çš„åµŒå¥—ç»“æ„ã€‚å­—æ®µç±»ä¼¼äºå…³ç³»æ•°æ®åº“ä¸­è¡¨çš„åˆ—ï¼Œæ¯ä¸ªå­—æ®µéƒ½å¯¹åº”ä¸€ä¸ªå­—æ®µç±»å‹ã€‚ 5.16 æ¥æºå­—æ®µï¼ˆsource fieldï¼‰é»˜è®¤æƒ…å†µä¸‹æºæ–‡æ¡£å°†è¢«å­˜å‚¨åœ¨_sourceå­—æ®µä¸­ï¼ŒæŸ¥è¯¢æ—¶è¿”å›è¯¥å­—æ®µã€‚ 5.17 ä¸»é”®ï¼ˆIDï¼‰IDæ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªIDï¼Œæ–‡æ¡£çš„index/type/idå¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚ 5.18 Elasticsearchæ ¸å¿ƒæ¦‚å¿µ vs. æ•°æ®åº“æ ¸å¿ƒæ¦‚å¿µ Elasticsearch æ•°æ®åº“ Document row è¡Œ Type table è¡¨ Index database åº“ Tipsæœ¬æ–‡åŒæ­¥å‘è¡¨åœ¨å…¬ä¼—å·ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨ï¼ğŸ˜åç»­ç¬”è®°æ¬¢è¿å…³æ³¨è·å–ç¬¬ä¸€æ—¶é—´æ›´æ–°ï¼","link":"/2019/04/12/%E3%80%8AElasticsearch%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/Chapter%201.1%20Elasticsearch%E5%85%A5%E9%97%A8%E5%92%8C%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 10ï¼šç”¨Optionalå–ä»£null","text":"1965å¹´ï¼Œè‹±å›½ä¸€ä½åä¸ºTony Hoareçš„è®¡ç®—æœºç§‘å­¦å®¶åœ¨è®¾è®¡ALGOL Wè¯­è¨€æ—¶æå‡ºäº†nullå¼•ç”¨çš„æƒ³æ³•ã€‚ALGOL Wæ˜¯ç¬¬ä¸€æ‰¹åœ¨å †ä¸Šåˆ†é…è®°å½•çš„ç±»å‹è¯­è¨€ä¹‹ä¸€ã€‚Hoareé€‰æ‹©nullå¼•ç”¨è¿™ç§æ–¹å¼ï¼Œâ€œåªæ˜¯å› ä¸ºè¿™ç§æ–¹æ³•å®ç°èµ·æ¥éå¸¸å®¹æ˜“â€ã€‚è™½ç„¶ä»–çš„è®¾è®¡åˆè¡·å°±æ˜¯è¦â€œé€šè¿‡ç¼–è¯‘å™¨çš„è‡ªåŠ¨æ£€æµ‹æœºåˆ¶ï¼Œç¡®ä¿æ‰€æœ‰ä½¿ç”¨å¼•ç”¨çš„åœ°æ–¹éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„â€ï¼Œä»–è¿˜æ˜¯å†³å®šä¸ºnullå¼•ç”¨å¼€ä¸ªç»¿ç¯ï¼Œå› ä¸ºä»–è®¤ä¸ºè¿™æ˜¯ä¸ºâ€œä¸å­˜åœ¨çš„å€¼â€å»ºæ¨¡æœ€å®¹æ˜“çš„æ–¹å¼ã€‚å¾ˆå¤šå¹´åï¼Œä»–å¼€å§‹ä¸ºè‡ªå·±æ›¾ç»åšè¿‡è¿™æ ·çš„å†³å®šè€Œåæ‚”ä¸å·²ï¼ŒæŠŠå®ƒç§°ä¸ºâ€œæˆ‘ä»·å€¼ç™¾ä¸‡çš„é‡å¤§äº‹ç‰©â€ã€‚å®é™…ä¸Šï¼ŒHoareçš„è¿™æ®µè¯ä½ä¼°äº†è¿‡å»äº”åå¹´æ¥æ•°ç™¾ä¸‡ç¨‹åºå‘˜ä¸ºä¿®å¤ç©ºå¼•ç”¨æ‰€è€—è´¹çš„ä»£ä»·ã€‚è¿‘åå¹´å‡ºç°çš„å¤§å¤šæ•°ç°ä»£ç¨‹åºè®¾è®¡è¯­è¨€1ï¼ŒåŒ…æ‹¬Javaï¼Œéƒ½é‡‡ç”¨äº†åŒæ ·çš„è®¾è®¡æ–¹å¼ï¼Œå…¶åŸå› æ˜¯ä¸ºäº†ä¸æ›´è€çš„è¯­è¨€ä¿æŒå…¼å®¹ï¼Œæˆ–è€…å°±åƒHoareæ›¾ç»é™ˆè¿°çš„é‚£æ ·ï¼Œâ€œä»…ä»…æ˜¯å› ä¸ºè¿™æ ·å®ç°èµ·æ¥æ›´åŠ å®¹æ˜“â€ã€‚ 1. å¦‚ä½•ä¸ºç¡®å®çš„å€¼å»ºæ¨¡123456789101112131415public class Person { private Car car; public Car getCar() { return car; } }public class Car { private Insurance insurance; public Insurance getInsurance() { return insurance; }}public class Insurance { private String name; public String getName() { return name; }}public String getCarInsuranceName(Person person) { return person.getCar().getInsurance().getName();} ä¸Šé¢è¿™æ®µä»£ç çš„é—®é¢˜å°±åœ¨äºï¼Œå¦‚æœpersonæ²¡æœ‰è½¦ï¼Œå°±ä¼šé€ æˆç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ 1.1 é‡‡ç”¨é˜²å¾¡å¼æ£€æŸ¥å‡å°‘NullPointerException1.1.1 æ·±å±‚è´¨ç–‘ç®€å•æ¥è¯´å°±æ˜¯åœ¨éœ€è¦çš„åœ°æ–¹æ·»åŠ nullæ£€æŸ¥ 1234567891011public String getCarInsuranceName(Person person) { if (person != null) { Car car = person.getCar(); if (car != null) { Insurance insurance = car.getInsurance(); if (insurance != null) { return insurance.getName(); } } return \"Unknown\";} ä¸Šè¿°ä»£ç ä¸å…·å¤‡æ‰©å±•æ€§ï¼ŒåŒæ—¶è¿˜ç‰ºç‰²äº†ä»£ç çš„å¯è¯»æ€§ã€‚ 1.1.2 è¿‡å¤šçš„é€€å‡ºè¯­å¥1234567891011121314public String getCarInsuranceName(Person person) { if (person == null) { return \"Unknown\"; } Car car = person.getCar(); if (car == null) { return \"Unknown\"; } Insurance insurance = car.getInsurance(); if (insurance == null) { return \"Unknown\"; } return insurance.getName();} è¿™ç§æ¨¡å¼ä¸­æ–¹æ³•çš„é€€å‡ºç‚¹æœ‰å››å¤„ï¼Œä½¿å¾—ä»£ç çš„ç»´æŠ¤å¼‚å¸¸è‰°éš¾ã€‚ 1.2 nullå¸¦æ¥çš„ç§ç§é—®é¢˜ å®ƒæ˜¯é”™è¯¯ä¹‹æºã€‚ NullPointerExceptionæ˜¯ç›®å‰Javaç¨‹åºå¼€å‘ä¸­æœ€å…¸å‹çš„å¼‚å¸¸ã€‚å®ƒä¼šä½¿ä½ çš„ä»£ç è†¨èƒ€ã€‚ å®ƒè®©ä½ çš„ä»£ç å……æ–¥ç€æ·±åº¦åµŒå¥—çš„nullæ£€æŸ¥ï¼Œä»£ç çš„å¯è¯»æ€§ç³Ÿç³•é€é¡¶ã€‚ å®ƒè‡ªèº«æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚ nullè‡ªèº«æ²¡æœ‰ä»»ä½•çš„è¯­ä¹‰ï¼Œå°¤å…¶æ˜¯æ˜¯å®ƒä»£è¡¨çš„æ˜¯åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­ä»¥ä¸€ç§é”™è¯¯çš„æ–¹å¼å¯¹ç¼ºå¤±å˜é‡å€¼çš„å»ºæ¨¡ã€‚ å®ƒç ´åäº†Javaçš„å“²å­¦ã€‚ Javaä¸€ç›´è¯•å›¾é¿å…è®©ç¨‹åºå‘˜æ„è¯†åˆ°æŒ‡é’ˆçš„å­˜åœ¨ï¼Œå”¯ä¸€çš„ä¾‹å¤–æ˜¯:nullæŒ‡é’ˆã€‚ å®ƒåœ¨Javaçš„ç±»å‹ç³»ç»Ÿä¸Šå¼€äº†ä¸ªå£å­ã€‚ nullå¹¶ä¸å±äºä»»ä½•ç±»å‹ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è¢«èµ‹å€¼ç»™ä»»æ„å¼•ç”¨ç±»å‹çš„å˜é‡ã€‚è¿™ä¼šå¯¼è‡´é—®é¢˜ï¼Œ åŸå› æ˜¯å½“è¿™ä¸ªå˜é‡è¢«ä¼ é€’åˆ°ç³»ç»Ÿä¸­çš„å¦ä¸€ä¸ªéƒ¨åˆ†åï¼Œä½ å°†æ— æ³•è·çŸ¥è¿™ä¸ªnullå˜é‡æœ€åˆèµ‹å€¼åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ã€‚ 1.3 å…¶ä»–è¯­è¨€ä¸­nullçš„æ›¿ä»£å“ Groovyä¸­çš„å®‰å…¨å¯¼èˆªæ“ä½œç¬¦ Haskellä¸­çš„Maybeç±»å‹ Scalaä¸­çš„Option[T] 2. Optionalç±»å…¥é—¨å˜é‡å­˜åœ¨æ—¶ï¼ŒOptionalç±»åªæ˜¯å¯¹ç±»ç®€å•å°è£…ã€‚å˜é‡ä¸å­˜åœ¨æ—¶ï¼Œç¼ºå¤±çš„å€¼ä¼šè¢«å»ºæ¨¡æˆä¸€ä¸ªâ€œç©ºâ€çš„Optionalå¯¹è±¡ï¼Œç”±æ–¹æ³•Optional.empty()è¿”å›ã€‚Optional.empty()æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒè¿”å›Optionalç±»çš„ç‰¹å®šå•ä¸€å®ä¾‹ã€‚ å¼•å…¥Optionalç±»çš„æ„å›¾å¹¶éè¦æ¶ˆé™¤æ¯ä¸€ä¸ªnullå¼•ç”¨ï¼Œç›¸åçš„æ˜¯ï¼Œå®ƒçš„ç›®æ ‡æ˜¯å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è®¾è®¡å‡ºæ™®é€‚çš„APIã€‚ 3. åº”ç”¨Optionalçš„å‡ ç§æ¨¡å¼3.1 åˆ›å»ºOptionalå¯¹è±¡3.1.1 å£°æ˜ä¸€ä¸ªç©ºçš„Optionalæ­£å¦‚å‰æ–‡å·²ç»æåˆ°ï¼Œä½ å¯ä»¥é€šè¿‡é™æ€å·¥å‚æ–¹æ³•Optional.emptyï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡: 1Optional&lt;Car&gt; optCar = Optional.empty(); 3.1.2 ä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»ºOptionalä½ è¿˜å¯ä»¥ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•Optional.ofï¼Œä¾æ®ä¸€ä¸ªéç©ºå€¼åˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡: 1Optional&lt;Car&gt; optCar = Optional.of(car); å¦‚æœcaræ˜¯ä¸€ä¸ªnullï¼Œè¿™æ®µä»£ç ä¼šç«‹å³æŠ›å‡ºä¸€ä¸ªNullPointerExceptionï¼Œè€Œä¸æ˜¯ç­‰åˆ°ä½ è¯•å›¾è®¿é—®carçš„å±æ€§å€¼æ—¶æ‰è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚ 3.2.3 å¯æ¥å—nullçš„Optionalæœ€åï¼Œä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•Optional.ofNullableï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå…è®¸nullå€¼çš„Optionalå¯¹è±¡: 1Optional&lt;Car&gt; optCar = Optional.ofNullable(car); å¦‚æœcaræ˜¯nullï¼Œé‚£ä¹ˆå¾—åˆ°çš„Optionalå¯¹è±¡å°±æ˜¯ä¸ªç©ºå¯¹è±¡ã€‚ 3.2 ä½¿ç”¨mapä»Optionalå¯¹è±¡ä¸­æå–å’Œè½¬æ¢å€¼ä»å¯¹è±¡ä¸­æå–ä¿¡æ¯æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„æ¨¡å¼ã€‚ 1234567String name = null; if(insurance != null){ name = insurance.getName(); }ä¸ºäº†æ”¯æŒè¿™ç§æ¨¡å¼ï¼ŒOptionalæä¾›äº†ä¸€ä¸ªmapæ–¹æ³•ã€‚Optional&lt;Insurance&gt; optInsurance = Optional.ofNullable(insurance); Optional&lt;String&gt; name = optInsurance.map(Insurance::getName); 3.3 ä½¿ç”¨flatMapé“¾æ¥Optionalå¯¹è±¡ä½¿ç”¨æµæ—¶ï¼ŒflatMapæ–¹æ³•æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸€ä¸ªæµã€‚ è¿™ä¸ªæ–¹æ³•ä¼šåº”ç”¨åˆ°æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªæ–°çš„æµçš„æµã€‚ä½†æ˜¯flagMapä¼šç”¨æµçš„å†…å®¹æ›¿æ¢æ¯ä¸ªæ–°ç”Ÿæˆçš„æµã€‚æ¢å¥è¯è¯´ï¼Œç”±æ–¹æ³•ç”Ÿæˆçš„å„ä¸ªæµä¼šè¢«åˆå¹¶æˆ–è€…æ‰å¹³åŒ–ä¸ºä¸€ä¸ªå•ä¸€çš„æµã€‚ 12345public String getCarInsuranceName(Optional&lt;Person&gt; person) { return person.flatMap(Person::getCar) .flatMap(Car::getInsurance) .map(Insurance::getName) .orElse(\"Unknown\");} 3.4 é»˜è®¤è¡Œä¸ºåŠè§£å¼•ç”¨Optionalå¯¹è±¡ get()æ˜¯è¿™äº›æ–¹æ³•ä¸­æœ€ç®€å•ä½†åˆæœ€ä¸å®‰å…¨çš„æ–¹æ³•ã€‚å¦‚æœå˜é‡å­˜åœ¨ï¼Œå®ƒç›´æ¥è¿”å›å°è£…çš„å˜é‡å€¼ï¼Œå¦åˆ™å°±æŠ›å‡ºä¸€ä¸ªNoSuchElementExceptionå¼‚å¸¸ã€‚æ‰€ä»¥ï¼Œé™¤éä½ éå¸¸ç¡®å®šOptionalå˜é‡ä¸€å®šåŒ…å«å€¼ï¼Œå¦åˆ™ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ˜¯ä¸ªç›¸å½“ç³Ÿç³•çš„ä¸»æ„ã€‚æ­¤å¤–ï¼Œè¿™ç§æ–¹å¼å³ä¾¿ç›¸å¯¹äºåµŒå¥—å¼çš„nullæ£€æŸ¥ï¼Œä¹Ÿå¹¶æœªä½“ç°å‡ºå¤šå¤§çš„æ”¹è¿›ã€‚ orElse(T other)æ˜¯æˆ‘ä»¬åœ¨ä»£ç æ¸…å•10-5ä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼Œæ­£å¦‚ä¹‹å‰æåˆ°çš„ï¼Œå®ƒå…è®¸ä½ åœ¨ Optionalå¯¹è±¡ä¸åŒ…å«å€¼æ—¶æä¾›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ orElseGet(Supplier&lt;? extends T&gt; other)æ˜¯orElseæ–¹æ³•çš„å»¶è¿Ÿè°ƒç”¨ç‰ˆï¼ŒSupplier æ–¹æ³•åªæœ‰åœ¨Optionalå¯¹è±¡ä¸å«å€¼æ—¶æ‰æ‰§è¡Œè°ƒç”¨ã€‚å¦‚æœåˆ›å»ºé»˜è®¤å€¼æ˜¯ä»¶è€—æ—¶è´¹åŠ›çš„å·¥ä½œï¼Œä½ åº”è¯¥è€ƒè™‘é‡‡ç”¨è¿™ç§æ–¹å¼(å€Ÿæ­¤æå‡ç¨‹åºçš„æ€§èƒ½)ï¼Œæˆ–è€…ä½ éœ€è¦éå¸¸ç¡®å®šæŸä¸ªæ–¹æ³•ä»…åœ¨ Optionalä¸ºç©ºæ—¶æ‰è¿›è¡Œè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘è¯¥æ–¹å¼(è¿™ç§æƒ…å†µæœ‰ä¸¥æ ¼çš„é™åˆ¶æ¡ä»¶)ã€‚ orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)å’Œgetæ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œå®ƒä»¬é­é‡Optionalå¯¹è±¡ä¸ºç©ºæ—¶éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä½†æ˜¯ä½¿ç”¨orElseThrowä½ å¯ä»¥å®šåˆ¶ô³µå¸Œæœ›æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚ ifPresent(Consumer&lt;? super T&gt;)è®©ä½ èƒ½åœ¨å˜é‡å€¼å­˜åœ¨æ—¶æ‰§è¡Œä¸€ä¸ªä½œä¸ºå‚æ•°ä¼ å…¥çš„æ–¹æ³•ï¼Œå¦åˆ™å°±ä¸è¿›è¡Œä»»ä½•æ“ä½œã€‚ 3.5 ä¸¤ä¸ªOptionalå¯¹è±¡çš„ç»„åˆ1234567public Optional&lt;Insurance&gt; nullSafeFindCheapestInsurance(Optional&lt;Person&gt; person, Optional&lt;Car&gt; car) { if (person.isPresent() &amp;&amp; car.isPresent()) { return Optional.of(findCheapestInsurance(person.get(), car.get())); } else { return Optional.empty(); }} 3.6 ä½¿ç”¨filterå‰”é™¤ç‰¹å®šçš„å€¼filteræ–¹æ³•æ¥å—ä¸€ä¸ªè°“è¯ä½œä¸ºå‚æ•°ã€‚å¦‚æœOptionalå¯¹è±¡çš„å€¼å­˜åœ¨ï¼Œå¹¶ä¸”å®ƒç¬¦åˆè°“è¯çš„æ¡ä»¶ï¼Œ filteræ–¹æ³•å°±è¿”å›å…¶å€¼;å¦åˆ™å®ƒå°±è¿”å›ä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡ã€‚ 12345678Insurance insurance = ...;if(insurance != null &amp;&amp; \"CambridgeInsurance\".equals(insurance.getName())){ System.out.println(\"okâ€);}Optional&lt;Insurance&gt; optInsurance = ...;optInsurance.filter(insurance -&gt; \"CambridgeInsurance\".equals(insurance.getName())) .ifPresent(x -&gt; System.out.println(\"ok\")); Optionalç±»ä¸­çš„æ–¹æ³•è¿›è¡Œäº†åˆ†ç±»å’Œæ¦‚æ‹¬: 4. ä½¿ç”¨Optionalçš„å®æˆ˜ç¤ºä¾‹4.1 ç”¨Optionalå°è£…å¯èƒ½ä¸ºnullçš„å€¼1Optional&lt;Object&gt; value = Optional.ofNullable(map.get(\"key\")); æ¯æ¬¡ä½ å¸Œæœ›å®‰å…¨åœ°å¯¹æ½œåœ¨ä¸ºnullçš„å¯¹è±¡è¿›è¡Œè½¬æ¢ï¼Œå°†å…¶æ›¿æ¢ä¸ºOptionalå¯¹è±¡æ—¶ï¼Œéƒ½å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ 4.2 å¼‚å¸¸ä¸Optionalçš„å¯¹æ¯”1234567public static Optional&lt;Integer&gt; stringToInt(String s) {try {return Optional.of(Integer.parseInt(s)); } catch (NumberFormatException e) { return Optional.empty(); }} æˆ‘ä»¬çš„å»ºè®®æ˜¯ï¼Œä½ å¯ä»¥å°†å¤šä¸ªç±»ä¼¼çš„æ–¹æ³•å°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»ä¸­ï¼Œè®©æˆ‘ä»¬ç§°ä¹‹ä¸ºOptionalUtilityã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ ä»¥åå°±èƒ½ç›´æ¥è°ƒç”¨OptionalUtility.stringToIntæ–¹æ³•ï¼Œå°†Stringè½¬æ¢ä¸ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œè€Œä¸å†éœ€è¦è®°å¾—ä½ åœ¨å…¶ä¸­å°è£…äº†ç¬¨æ‹™çš„ try/catchçš„é€»è¾‘äº†ã€‚ 4.3 æŠŠæ‰€æœ‰å†…å®¹ç»“åˆèµ·æ¥12345678910111213141516171819public int readDuration(Properties props, String name) { String value = props.getProperty(name); if (value != null) { try { int i = Integer.parseInt(value); if (i &gt; 0) { return i; } } catch (NumberFormatException nfe) { } } return 0; }// ä¼˜åŒ–ç‰ˆæœ¬public int readDuration(Properties props, String name) { return Optional.ofNullable(props.getProperty(name)) .flatMap(OptionalUtility::stringToInt) .filter(i -&gt; i &gt; 0) .orElse(0);} 5. å°ç»“è¿™ä¸€ç« ä¸­ï¼Œä½ å­¦åˆ°äº†ä»¥ä¸‹çš„å†…å®¹ã€‚ nullå¼•ç”¨åœ¨ä¸Šè¢«å¼•å…¥åˆ°ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ï¼Œç›®çš„æ˜¯ä¸ºäº†è¡¨ç¤ºå˜é‡å€¼çš„ã€‚ Java 8ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç±»java.util.Optionalï¼Œå¯¹å­˜åœ¨æˆ–ç¼ºå¤±çš„å˜é‡å€¼è¿›è¡Œå»ºæ¨¡ã€‚ ä½ å¯ä»¥ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•Optional.emptyã€Optional.ofä»¥åŠOptional.ofNullableåˆ›å»ºOptionalå¯¹è±¡ã€‚ Optionalç±»æ”¯æŒå¤šç§æ–¹æ³•ï¼Œæ¯”å¦‚mapã€flatMapã€filterï¼Œå®ƒä»¬åœ¨æ¦‚å¿µä¸Šä¸Streamç±»ä¸­å¯¹åº”çš„æ–¹æ³•ååˆ†ç›¸ä¼¼ã€‚ ä½¿ç”¨Optionalä¼šä½¿ä½ æ›´ç§¯æåœ°è§£å¼•ç”¨Optionalå¯¹è±¡ï¼Œä»¥åº”å¯¹å˜é‡å€¼ç¼ºå¤±çš„é—®é¢˜ï¼Œæœ€ç»ˆï¼Œä½ èƒ½æ›´æœ‰æ•ˆåœ°æ­¢ä»£ç ä¸­å‡ºç°ä¸è€Œè‡³çš„ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ ä½¿ç”¨Optionalèƒ½å¸®åŠ©ä½ è®¾è®¡æ›´å¥½çš„APIï¼Œç”¨æˆ·åªéœ€è¦é˜…è¯»æ–¹æ³•ç­¾åï¼Œå°±èƒ½äº†è§£è¯¥æ–¹æ³•æ˜¯å¦æ¥å—ä¸€ä¸ªOptionalç±»å‹çš„å€¼ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/22/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%2010%EF%BC%9A%E7%94%A8Optional%E5%8F%96%E4%BB%A3null/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 2ï¼šé€šè¿‡è¡Œä¸ºå‚æ•°åŒ–ä¼ é€’ä»£ç ","text":"ä½ å°†äº†è§£è¡Œä¸ºå‚æ•°åŒ–ï¼Œè¿™æ˜¯Java 8éå¸¸ä¾èµ–çš„ä¸€ç§è½¯ä»¶å¼€å‘æ¨¡å¼ï¼Œä¹Ÿæ˜¯å¼•å…¥ Lambdaè¡¨è¾¾å¼çš„ä¸»è¦åŸå› ã€‚è¡Œä¸ºå‚æ•°åŒ–å°±æ˜¯å¯ä»¥å¸®åŠ©ä½ å¤„ç†é¢‘ç¹å˜æ›´çš„éœ€æ±‚çš„ä¸€ç§è½¯ä»¶å¼€å‘æ¨¡å¼ã€‚ä¸€è¨€ä»¥è”½ä¹‹ï¼Œå®ƒæ„å‘³ ç€æ‹¿å‡ºä¸€ä¸ªä»£ç å—ï¼ŒæŠŠå®ƒå‡†å¤‡å¥½å´ä¸å»æ‰§è¡Œå®ƒã€‚è¿™ä¸ªä»£ç å—ä»¥åå¯ä»¥è¢«ä½ ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†è°ƒç”¨ã€‚æœ¬ç« é€šè¿‡ç­›é€‰è‹¹æœè¿™ä¸ªå®é™…éœ€æ±‚æ¥ä¸€æ­¥æ­¥å¼•å‡ºLambdaè¡¨è¾¾å¼ï¼ŒåŒæ—¶æˆ‘ä¹Ÿä¼šæŠŠä»£ç è´´å‡ºæ¥ï¼Œè¯»å®Œä½ ä¼šçœ‹åˆ°ä»£ç æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥çš„å‘Lambdaè½¬åŒ–ã€‚å¤šä»£ç æ¥è¢­ï¼Œä¿æŠ¤æˆ‘æ–¹ADCï¼ï¼ ä»£ç æ¼”åŒ–1.å®ä¹ ç”Ÿç‰ˆæœ¬12345678910111213141516171819202122232425package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.List;/** * ç­›é€‰ç»¿è‰²è‹¹æœ * @author lujiahao * @date 2019-02-19 18:28 */public class FilterAppleV0 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); List&lt;Apple&gt; greenAppleList = new ArrayList&lt;&gt;(); for (Apple apple : appleList) { if (\"green\".equals(apple.getColor())) { greenAppleList.add(apple); } } System.out.println(\"åŸé›†åˆ:\" + appleList); System.out.println(\"ç»¿è‹¹æœé›†åˆ:\" + greenAppleList); }} è¿™ç§ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºå®ä¹ ç”Ÿç‰ˆæœ¬ï¼Œæ˜¯å› ä¸ºæ­¤ç§å†™æ³•æ¯”è¾ƒåˆçº§ï¼Œæ‰€æœ‰ä»£ç åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å®ç°ã€‚æ²¡æœ‰è¿›è¡Œæ–¹æ³•çš„æŠ½å–ï¼Œä¸ç¬¦åˆé¢å‘å¯¹è±¡çš„ç†å¿µï¼Œå¸Œæœ›å¤§å®¶åœ¨ç¼–ç å·¥ä½œæ—¶é¿å…è¿™ç§å†™æ³•ã€‚ 2.æ–¹æ³•æŠ½å–ç‰ˆæœ¬1234567891011121314151617181920212223242526272829303132333435package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.List;/** * ç­›é€‰ç»¿è‰²è‹¹æœ * @author lujiahao * @date 2019-02-19 18:30 */public class FilterAppleV1 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); List&lt;Apple&gt; filterGreenApples = filterGreenApples(appleList); System.out.println(\"ç»¿è‹¹æœé›†åˆ:\" + filterGreenApples); } /** * ç­›é€‰ç»¿è‰²è‹¹æœ * @param appleList * @return */ public static List&lt;Apple&gt; filterGreenApples(List&lt;Apple&gt; appleList) { List&lt;Apple&gt; resultList = new ArrayList&lt;&gt;(); for (Apple apple : appleList) { if (\"green\".equals(apple.getColor())) { resultList.add(apple); } } return resultList; }} æ­¤ç‰ˆæœ¬å¯¹ç­›é€‰ç»¿è‰²è‹¹æœçš„æ–¹æ³•è¿›è¡Œäº†ç®€å•çš„æŠ½å–ï¼Œç›¸è¾ƒäºä¸Šä¸ªç‰ˆæœ¬æœ‰äº†å¾ˆå¤§çš„æå‡ã€‚ç„¶è€Œï¼Œå¦‚æœéœ€æ±‚æ–¹æ”¹å˜æƒ³æ³•ï¼Œæƒ³ç­›é€‰çº¢è‰²çš„è‹¹æœã€‚å¤åˆ¶filterGreenApples() æ–¹æ³•å¹¶å°†å…¶ä¸­çš„ç»¿è‰²ç­›é€‰æ¡ä»¶æ”¹ä¸ºçº¢è‰²ï¼Œç¡®å®å¯ä»¥å®ç°ã€‚ä½†æ˜¯ï¼Œè¿™æ ·æœ‰å¤ªå¤šé‡å¤çš„æ¨¡æ¿ä»£ç ï¼Œä¸æ˜¯è‰¯å¥½çš„ç¼–ç è§„èŒƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ç­›é€‰æ¡ä»¶é¢œè‰²è¿›ä¸€æ­¥æŠ½è±¡åŒ–ã€‚ 3.ç­›é€‰æ¡ä»¶ä½œä¸ºå‚æ•°ä¼ å…¥1234567891011121314151617181920212223242526272829303132333435363738package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.List;/** * éœ€è¦åˆ¤æ–­çš„å±æ€§ä½œä¸ºå‚æ•°ä¼ å…¥ * @author lujiahao * @date 2019-02-19 18:30 */public class FilterAppleV2 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); List&lt;Apple&gt; filterGreenApples = filterApples(appleList, \"green\"); System.out.println(\"ç­›é€‰ç»¿è‰²è‹¹æœ:\" + filterGreenApples); List&lt;Apple&gt; filterRedApples = filterApples(appleList, \"red\"); System.out.println(\"ç­›é€‰çº¢è‰²è‹¹æœ:\" + filterRedApples); } /** * ç­›é€‰ç‰¹å®šé¢œè‰²è‹¹æœ * @param appleList * @return */ public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; appleList, String color) { List&lt;Apple&gt; resultList = new ArrayList&lt;&gt;(); for (Apple apple : appleList) { if (color.equals(apple.getColor())) { resultList.add(apple); } } return resultList; }} æ»¡è¶³äº†é¢œè‰²çš„ç­›é€‰æ¡ä»¶ï¼Œç„¶è€Œéœ€æ±‚æ–¹åˆçµå…‰ä¸€é—ªï¼Œç­›é€‰å¤§äº150å…‹çš„è‹¹æœã€‚æ— è®ºæ˜¯å¤åˆ¶filterApples() æ–¹æ³•ï¼Œè¿˜æ˜¯å¢åŠ é‡é‡ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œéƒ½æ˜¯ä¸æ¨èçš„ç¼–ç ä¹ æƒ¯ã€‚ç¬¬ä¸€ç§æ–¹æ³•å¤åˆ¶äº†å¤§éƒ¨åˆ†çš„ä»£ç æ¥å®ç°éå†ï¼Œå®ƒæ‰“ç ´äº†DRYï¼ˆDonâ€™t Repeat Yourselfï¼‰çš„è½¯ä»¶å·¥ç¨‹åŸåˆ™ï¼›ç¬¬äºŒç§æ–¹æ³•å¹¶ä¸èƒ½è€ƒè™‘åˆ°æ‰€æœ‰æƒ…å†µï¼Œå¹¶ä¸”æ¯æ¬¡ä¿®æ”¹éƒ½å¯¹åŸæœ‰ä»£ç äº§ç”Ÿäº†å½±å“ï¼Œæ— æ³•åšåˆ°ä¿®æ”¹å¯¹å¤–å°é—­çš„åŸåˆ™ã€‚ 4.è¡Œä¸ºå‚æ•°åŒ–123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.List;/** * è¡Œä¸ºå‚æ•°åŒ– * @author lujiahao * @date 2019-02-19 18:30 */public class FilterAppleV3 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); List&lt;Apple&gt; filterGreenApples = filterApples(appleList, new AppleGreenColorPredicate()); System.out.println(\"ç­›é€‰ç»¿è‰²è‹¹æœ:\" + filterGreenApples); List&lt;Apple&gt; filterHeavyApples = filterApples(appleList, new AppleHeavyWeightPredicate()); System.out.println(\"ç­›é€‰é‡é‡å¤§äº150è‹¹æœ:\" + filterHeavyApples); } /** * ç­›é€‰ç»¿è‰²è‹¹æœ * @param appleList * @return */ public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; appleList, ApplePredicate predicate) { List&lt;Apple&gt; resultList = new ArrayList&lt;&gt;(); for (Apple apple : appleList) { // è°“è¯å¯¹è±¡å°è£…äº†æ¡ä»¶ if (predicate.filter(apple)) { resultList.add(apple); } } return resultList; } public interface ApplePredicate { boolean filter(Apple apple); } public static class AppleHeavyWeightPredicate implements ApplePredicate { @Override public boolean filter(Apple apple) { return apple.getWeight() &gt; 150; } } public static class AppleGreenColorPredicate implements ApplePredicate { @Override public boolean filter(Apple apple) { return \"green\".equals(apple.getColor()); } }} æˆ‘ä»¬å¯¹è‹¹æœçš„æ‰€æœ‰å±æ€§è¿›è¡Œæ›´é«˜ä¸€ä¸ªå±‚æ¬¡çš„æŠ½è±¡å»ºæ¨¡ï¼Œé€šè¿‡å®šä¹‰ApplePredicate æ¥å£ï¼ŒAppleHeavyWeightPredicate å’Œ AppleGreenColorPredicate åˆ†åˆ«å®ç°è¯¥æ¥å£æ¥è¾¾åˆ°è¿›è¡Œä¸åŒçš„ç­›é€‰åŠŸèƒ½ã€‚å®¢æˆ·ç«¯è°ƒç”¨ä¸­åˆ›å»ºä¸åŒçš„å®ç°ç±»ï¼Œå¯¹äºfilterApple() æ–¹æ³•è€Œè¨€ï¼Œæ˜¯ä¼ å…¥äº†ä¸åŒçš„è¡Œä¸ºï¼Œå³è¡Œä¸ºå‚æ•°åŒ–ã€‚è¡Œä¸ºå‚æ•°åŒ–ï¼šè®©æ–¹æ³•æ¥å—å¤šç§è¡Œä¸º(æˆ–æˆ˜ç•¥)ä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨ï¼Œæ¥å®Œæˆä¸åŒçš„è¡Œä¸ºã€‚å…¶åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 5.åŒ¿åå†…éƒ¨ç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.List;/** * ä½¿ç”¨åŒ¿åç±» * @author lujiahao * @date 2019-02-19 18:30 */public class FilterAppleV4 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); List&lt;Apple&gt; filterGreenApples = filterApples(appleList, new ApplePredicate() { @Override public boolean filter(Apple apple) { return \"green\".equals(apple.getColor()); } }); System.out.println(\"ç­›é€‰ç»¿è‰²è‹¹æœ:\" + filterGreenApples); List&lt;Apple&gt; filterHeavyApples = filterApples(appleList, new ApplePredicate() { @Override public boolean filter(Apple apple) { return apple.getWeight() &gt; 150; } }); System.out.println(\"ç­›é€‰é‡é‡å¤§äº150è‹¹æœ:\" + filterHeavyApples); } /** * ç­›é€‰ç»¿è‰²è‹¹æœ * @param appleList * @return */ public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; appleList, ApplePredicate predicate) { List&lt;Apple&gt; resultList = new ArrayList&lt;&gt;(); for (Apple apple : appleList) { // è°“è¯å¯¹è±¡å°è£…äº†æ¡ä»¶ if (predicate.filter(apple)) { resultList.add(apple); } } return resultList; } public interface ApplePredicate { boolean filter(Apple apple); }} å½“æ¯æ¬¡æœ‰æ–°çš„æŸ¥è¯¢éœ€æ±‚æå‡ºï¼Œéƒ½è¦æ–°å»ºä¸€ä¸ªå®ç°ç±»ï¼Œéšç€æ¡ä»¶è¶Šæ¥è¶Šå¤šï¼Œå®ç°ç±»çš„æ•°é‡ä¹Ÿåœ¨æ€¥å‰§ä¸Šå‡ã€‚æ­¤æ—¶ï¼Œé€šè¿‡ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œæ¥å‡å°‘å®ç°ç±»è¿‡å¤šçš„æ¨¡æ¿ä»£ç ã€‚ç„¶è€Œï¼ŒåŒ¿åå†…éƒ¨ç±»å¹¶éå®Œç¾ï¼Œç¬¬ä¸€ï¼Œå®ƒå¾€å¾€å¾ˆç¬¨é‡ï¼Œå› ä¸ºå®ƒå ç”¨äº†å¾ˆå¤šç©ºé—´ï¼›ç¬¬äºŒï¼Œå¾ˆå¤šç¨‹åºå‘˜è§‰å¾—å®ƒç”¨èµ·æ¥å¾ˆè®©äººè´¹è§£ã€‚ 6.ä½¿ç”¨ Lambda è¡¨è¾¾å¼12345678910111213141516171819202122232425262728293031323334353637383940414243package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.List;/** * ä½¿ç”¨Lambdaè¡¨è¾¾å¼ * @author lujiahao * @date 2019-02-19 18:30 */public class FilterAppleV5 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); List&lt;Apple&gt; filterGreenApples = filterApples(appleList, (Apple apple) -&gt; \"green\".equals(apple.getColor())); System.out.println(\"ç­›é€‰ç»¿è‰²è‹¹æœ:\" + filterGreenApples); List&lt;Apple&gt; filterHeavyApples = filterApples(appleList, (Apple apple) -&gt; apple.getWeight() &gt; 150); System.out.println(\"ç­›é€‰é‡é‡å¤§äº150è‹¹æœ:\" + filterHeavyApples); } /** * ç­›é€‰ç»¿è‰²è‹¹æœ * @param appleList * @return */ public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; appleList, ApplePredicate predicate) { List&lt;Apple&gt; resultList = new ArrayList&lt;&gt;(); for (Apple apple : appleList) { // è°“è¯å¯¹è±¡å°è£…äº†æ¡ä»¶ if (predicate.filter(apple)) { resultList.add(apple); } } return resultList; } public interface ApplePredicate { boolean filter(Apple apple); }} ä¸å¾—ä¸æ‰¿è®¤è¿™ä»£ç çœ‹ä¸Šå»æ¯”å…ˆå‰å¹²å‡€å¾ˆå¤šï¼Œè€Œä¸”å®ƒçœ‹èµ·æ¥æ›´åƒæ˜¯åœ¨é™ˆè¿°é—®é¢˜æœ¬èº«ï¼Œæ›´åŠ é€šä¿—æ˜“æ‡‚ã€‚ 7.List ç±»å‹æŠ½è±¡åŒ–12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849package com.lujiahao.learnjava8.chapter2;import java.util.ArrayList;import java.util.Arrays;import java.util.List;import java.util.function.*;/** * Listç±»å‹æŠ½è±¡è¯ * * @author lujiahao * @date 2019-02-19 18:30 */public class FilterAppleV6 { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); List&lt;Apple&gt; filterGreenApples = filter(appleList, (Apple apple) -&gt; \"green\".equals(apple.getColor())); System.out.println(\"ç­›é€‰ç»¿è‰²è‹¹æœ:\" + filterGreenApples); System.out.println(\"=============================================\"); List&lt;Integer&gt; numberList = Arrays.asList(1, 2, 3); System.out.println(\"åŸé›†åˆ:\" + numberList); List&lt;Integer&gt; numbers = filter(numberList, (Integer i) -&gt; i % 2 == 0); System.out.println(\"èƒ½è¢«2æ•´é™¤çš„æ•°:\" + numbers); } /** * ç­›é€‰ç»¿è‰²è‹¹æœ */ public static &lt;T&gt; List&lt;T&gt; filter(List&lt;T&gt; list, Predicate&lt;T&gt; predicate) { List&lt;T&gt; resultList = new ArrayList&lt;&gt;(); for (T t : list) { // è°“è¯å¯¹è±¡å°è£…äº†æ¡ä»¶ if (predicate.filter(t)) { resultList.add(t); } } return resultList; } public interface Predicate&lt;T&gt; { boolean filter(T t); }} åœ¨é€šå¾€æŠ½è±¡çš„è·¯ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ›´è¿›ä¸€æ­¥ã€‚ç›®å‰ï¼ŒfilterApplesæ–¹æ³•è¿˜åªé€‚ç”¨äºAppleã€‚è¿˜å¯ä»¥å°†Listç±»å‹æŠ½è±¡åŒ–ï¼Œä»è€Œæ”¯æŒæ‰€æœ‰ç±»å‹ã€‚ 8.æ¼”åŒ–å°ç»“è¿™ä¸€è·¯æ¼”åŒ–ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºä»£ç æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥è½¬åŒ–çš„æ›´åŠ ç®€æ´æ›´åŠ ä¼˜é›…ï¼Œå¯¹æ­¤æˆ‘ä»¬è¿›è¡Œæ€»ç»“ï¼š å®ä¾‹1.ç”¨ Comparator æ’åº123456789101112131415161718192021222324252627package com.lujiahao.learnjava8.chapter2;import java.util.Comparator;import java.util.List;/** * ç”¨ Comparator æ’åº * @author lujiahao * @date 2019-03-02 18:34 */public class ComparatorDemo { public static void main(String[] args) { List&lt;Apple&gt; appleList = DataUtil.generateApples(); System.out.println(\"åŸé›†åˆ:\" + appleList); appleList.sort(new Comparator&lt;Apple&gt;() { @Override public int compare(Apple o1, Apple o2) { return o1.getWeight().compareTo(o2.getWeight()); } }); System.out.println(\"æŒ‰é‡é‡å‡åº:\" + appleList); appleList.sort((Apple a1, Apple a2) -&gt; a1.getColor().compareTo(a2.getColor())); System.out.println(\"æŒ‰é¢œè‰²å­—å…¸æ’åº:\" + appleList); }} 2.ç”¨ Runnable æ‰§è¡Œä»£ç å—123456789101112131415161718192021222324252627package com.lujiahao.learnjava8.chapter2;/** * ç”¨ Runnable æ‰§è¡Œä»£ç å— * @author lujiahao * @date 2019-03-02 18:42 */public class RunnableDemo { public static void main(String[] args) { Thread t = new Thread(new Runnable() { @Override public void run() { System.out.println(\"Hello Java 8!\"); } }); t.start(); Thread t1 = new Thread(() -&gt; System.out.println(\"Hello Lambda!\")); t1.start(); try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } }} 3.GUI äº‹ä»¶å¤„ç†12345678Button button = new Button(â€œSendâ€);button.setOnAction(new EventHandler&lt;ActionEvent&gt;() { public void handle(ActionEvent event) { lable.setText(â€œSend!!â€); }}button.setOnAction((ActionEvent event) -&gt; lable.setText(â€œSend!!â€)); å°çŒ¿ä¹‹å‰æå®‰å“å¼€å‘çš„ï¼Œå„ç§æ§ä»¶çš„ç›‘å¬éƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼Œæƒ³æƒ³ä»¥å‰å„ç§ä»£ç å•Šå•Šå•Š~ æ€»ç»“ä»¥ä¸‹æ˜¯ä½ åº”ä»æœ¬ç« ä¸­å­¦åˆ°çš„å…³é”®æ¦‚å¿µã€‚ è¡Œä¸ºå‚æ•°åŒ–ï¼Œå°±æ˜¯ä¸€ä¸ªæ–¹æ³•æ¥å—å¤šä¸ªä¸åŒçš„è¡Œä¸ºä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨å†…éƒ¨ä½¿ç”¨å®ƒä»¬ï¼Œå®Œæˆä¸åŒè¡Œä¸ºçš„èƒ½åŠ›ã€‚ è¡Œä¸ºå‚æ•°åŒ–å¯è®©ä»£ç æ›´å¥½åœ°é€‚åº”ä¸æ–­å˜åŒ–çš„è¦æ±‚ï¼Œå‡è½»æœªæ¥çš„å·¥ä½œé‡ã€‚ ä¼ é€’ä»£ç ï¼Œå°±æ˜¯å°†æ–°è¡Œä¸ºä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•ã€‚ä½†åœ¨Java 8ä¹‹å‰è¿™å®ç°èµ·æ¥å¾ˆå•°å—¦ã€‚ä¸ºæ¥å£å£°æ˜è®¸å¤šåªç”¨ä¸€æ¬¡çš„å®ä½“ç±»è€Œé€ æˆçš„å•°å—¦ä»£ç ï¼Œåœ¨Java 8ä¹‹å‰å¯ä»¥ç”¨åŒ¿åç±»æ¥å‡å°‘ã€‚ Java APIåŒ…å«å¾ˆå¤šå¯ä»¥ç”¨ä¸åŒè¡Œä¸ºè¿›è¡Œå‚æ•°åŒ–çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬æ’åºã€çº¿ç¨‹å’ŒGUIå¤„ç†ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/03/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%202%EF%BC%9A%E9%80%9A%E8%BF%87%E8%A1%8C%E4%B8%BA%E5%8F%82%E6%95%B0%E5%8C%96%E4%BC%A0%E9%80%92%E4%BB%A3%E7%A0%81/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 6ï¼šç”¨æµæ”¶é›†æ•°æ®","text":"1. æ”¶é›†å™¨ç®€ä»‹collect() æ¥æ”¶ä¸€ä¸ªç±»å‹ä¸º Collector çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å†³å®šäº†å¦‚ä½•æŠŠæµä¸­çš„å…ƒç´ èšåˆåˆ°å…¶å®ƒæ•°æ®ç»“æ„ä¸­ã€‚Collectors ç±»åŒ…å«äº†å¤§é‡å¸¸ç”¨æ”¶é›†å™¨çš„å·¥å‚æ–¹æ³•ï¼ŒtoList() å’Œ toSet() å°±æ˜¯å…¶ä¸­æœ€å¸¸è§çš„ä¸¤ä¸ªï¼Œé™¤äº†å®ƒä»¬è¿˜æœ‰å¾ˆå¤šæ”¶é›†å™¨ï¼Œç”¨æ¥å¯¹æ•°æ®è¿›è¡Œå¯¹å¤æ‚çš„è½¬æ¢ã€‚ æŒ‡ä»¤å¼ä»£ç å’Œå‡½æ•°å¼å¯¹æ¯”ï¼š è¦æ˜¯åšå¤šçº§åˆ†ç»„ï¼ŒæŒ‡ä»¤å¼å’Œå‡½æ•°å¼ä¹‹é—´çš„åŒºåˆ«å°±ä¼šæ›´åŠ æ˜æ˜¾:ç”±äºéœ€è¦å¥½å¤šå±‚åµŒå¥—å¾ªç¯å’Œæ¡ä»¶ï¼ŒæŒ‡ä»¤å¼ä»£ç å¾ˆå¿«å°±å˜å¾—æ›´éš¾é˜…è¯»ã€æ›´éš¾ç»´æŠ¤ã€æ›´éš¾ä¿®æ”¹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå‡½æ•°å¼ç‰ˆæœ¬åªè¦å†åŠ ä¸Š ä¸€ä¸ªæ”¶é›†å™¨å°±å¯ä»¥è½»æ¾åœ°å¢å¼º é¢„å®šä¹‰æ”¶é›†å™¨ï¼Œä¹Ÿå°±æ˜¯é‚£äº›å¯ä»¥ä»Collectorsç±»æä¾›çš„å·¥å‚æ–¹æ³•(ä¾‹å¦‚groupingBy)åˆ›å»ºçš„æ”¶é›†å™¨ã€‚å®ƒä»¬ä¸»è¦æä¾›äº†ä¸‰å¤§åŠŸèƒ½: å°†æµå…ƒç´ å½’çº¦å’Œæ±‡æ€»ä¸ºä¸€ä¸ªå€¼ å…ƒç´ åˆ†ç»„ å…ƒç´ åˆ†åŒº 2. ä½¿ç”¨æ”¶é›†å™¨åœ¨éœ€è¦å°†æµé¡¹ç›®é‡ç»„æˆé›†åˆæ—¶ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨æ”¶é›†å™¨(Streamæ–¹æ³•collect çš„å‚æ•°)ã€‚å†å®½æ³›ä¸€ç‚¹æ¥è¯´ï¼Œä½†å‡¡è¦æŠŠæµä¸­æ‰€æœ‰çš„é¡¹ç›®åˆå¹¶æˆä¸€ä¸ªç»“æœæ—¶å°±å¯ä»¥ç”¨ã€‚è¿™ä¸ªç»“æœå¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œå¯ä»¥å¤æ‚å¦‚ä»£è¡¨ä¸€æ£µæ ‘çš„å¤šçº§æ˜ å°„ï¼Œæˆ–æ˜¯ç®€å•å¦‚ä¸€ä¸ªæ•´æ•°ã€‚ 3. æ”¶é›†å™¨å®ä¾‹3.1 æµä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼Collectors.maxByå’Œ Collectors.minByï¼Œæ¥è®¡ç®—æµä¸­çš„æœ€å¤§æˆ–æœ€å°å€¼ã€‚è¿™ä¸¤ä¸ªæ”¶é›†å™¨æ¥æ”¶ä¸€ä¸ªComparatorå‚æ•°æ¥æ¯”è¾ƒæµä¸­çš„å…ƒç´ ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªComparatoræ¥æ ¹æ®æ‰€å«çƒ­é‡å¯¹èœè‚´è¿›è¡Œæ¯”è¾ƒï¼š 123456System.out.println(\"æ‰¾å‡ºçƒ­é‡æœ€é«˜çš„é£Ÿç‰©:\");Optional&lt;Dish&gt; collect = DataUtil.genMenu().stream().collect(Collectors.maxBy(Comparator.comparingInt(Dish::getCalories)));collect.ifPresent(System.out::println);System.out.println(\"æ‰¾å‡ºçƒ­é‡æœ€ä½çš„é£Ÿç‰©:\");Optional&lt;Dish&gt; collect1 = DataUtil.genMenu().stream().collect(Collectors.minBy(Comparator.comparingInt(Dish::getCalories)));collect1.ifPresent(System.out::println); 3.2 æ±‡æ€»æ±‚å’ŒCollectorsç±»ä¸“é—¨ä¸ºæ±‡æ€»æä¾›äº†ä¸€ä¸ªå·¥å‚æ–¹æ³•:Collectors.summingIntã€‚å®ƒå¯æ¥å—ä¸€ä¸ªæŠŠå¯¹è±¡æ˜ å°„ä¸ºæ±‚å’Œæ‰€éœ€intçš„å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ”¶é›†å™¨;è¯¥æ”¶é›†å™¨åœ¨ä¼ é€’ç»™æ™®é€šçš„collectæ–¹æ³•åå³æ‰§è¡Œæˆ‘ä»¬éœ€è¦çš„æ±‡æ€»æ“ä½œã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œä½ å¯ä»¥è¿™æ ·æ±‚å‡ºèœå•åˆ—è¡¨çš„æ€»çƒ­é‡: 123456Integer collect = DataUtil.genMenu().stream().collect(Collectors.summingInt(Dish::getCalories));System.out.println(\"æ€»çƒ­é‡:\" + collect);Double collect1 = Arrays.asList(0.1, 0.2, 0.3).stream().collect(Collectors.summingDouble(Double::doubleValue));System.out.println(\"doubleå’Œ:\" + collect1);Long collect2 = Arrays.asList(1L, 2L, 3L).stream().collect(Collectors.summingLong(Long::longValue));System.out.println(\"longå’Œ:\" + collect2); 3.3 æ±‡æ€»æ±‚å¹³å‡å€¼Collectors.averagingIntï¼ŒaveragingLongå’ŒaveragingDoubleå¯ä»¥è®¡ç®—æ•°å€¼çš„å¹³å‡æ•°ï¼š 123456Double collect = DataUtil.genMenu().stream().collect(Collectors.averagingInt(Dish::getCalories));System.out.println(\"å¹³å‡çƒ­é‡:\" + collect);Double collect1 = Arrays.asList(0.1, 0.2, 0.3).stream().collect(Collectors.averagingDouble(Double::doubleValue));System.out.println(\"double å¹³å‡å€¼:\" + collect1);Double collect2 = Arrays.asList(1L, 2L, 3L).stream().collect(Collectors.averagingLong(Long::longValue));System.out.println(\"long å¹³å‡å€¼:\" + collect2); 3.4 æ±‡æ€»åˆé›†ä½ å¯èƒ½æƒ³è¦å¾—åˆ°ä¸¤ä¸ªæˆ–æ›´å¤šè¿™æ ·çš„ç»“æœï¼Œè€Œä¸”ä½ å¸Œæœ›åªéœ€ä¸€æ¬¡æ“ä½œå°±å¯ä»¥å®Œæˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨summarizingIntå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ä¸€æ¬¡summarizingæ“ä½œä½ å¯ä»¥å°±æ•°å‡ºèœå•ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œå¹¶å¾—åˆ°çƒ­é‡æ€»å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼å’Œæœ€å°å€¼: 123456IntSummaryStatistics collect = DataUtil.genMenu().stream().collect(Collectors.summarizingInt(Dish::getCalories));System.out.println(\"int:\" + collect);DoubleSummaryStatistics collect1 = Arrays.asList(0.1, 0.2, 0.3).stream().collect(Collectors.summarizingDouble(Double::doubleValue));System.out.println(\"double:\" + collect1);LongSummaryStatistics collect2 = Arrays.asList(1L, 2L, 3L).stream().collect(Collectors.summarizingLong(Long::longValue));System.out.println(\"long:\" + collect2); 3.5 è¿æ¥å­—ç¬¦ä¸²joiningå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ä¼šæŠŠå¯¹æµä¸­æ¯ä¸€ä¸ªå¯¹è±¡åº”ç”¨toStringæ–¹æ³•å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ 1String collect = DataUtil.genMenu().stream().map(Dish::getName).collect(Collectors.joining()); è¯·æ³¨æ„ï¼Œjoiningåœ¨å†…éƒ¨ä½¿ç”¨äº†StringBuilderæ¥æŠŠç”Ÿæˆçš„å­—ç¬¦ä¸²é€ä¸ªè¿½åŠ èµ·æ¥ã€‚å¹¸å¥½ï¼Œjoiningå·¥å‚æ–¹æ³•æœ‰ä¸€ä¸ªé‡è½½ç‰ˆæœ¬å¯ä»¥æ¥å—å…ƒç´ ä¹‹é—´çš„åˆ†ç•Œç¬¦ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªéƒ½å¥½åˆ†éš”çš„åç§°åˆ—è¡¨: 1String collect1 = DataUtil.genMenu().stream().map(Dish::getName).collect(Collectors.joining(\",\")); 4. å¹¿ä¹‰çš„å½’çº¦æ±‡æ€»æ‰€æœ‰æ”¶é›†å™¨ï¼Œéƒ½æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨reducingå·¥å‚æ–¹æ³•å®šä¹‰çš„å½’çº¦è¿‡ç¨‹çš„ç‰¹æ®Šæƒ…å†µè€Œå·²ã€‚Collectors.reducingå·¥å‚æ–¹æ³•æ˜¯æ‰€æœ‰è¿™äº›ç‰¹æ®Šæƒ…å†µçš„ä¸€èˆ¬åŒ–ã€‚å®ƒéœ€è¦ä¸‰ä¸ªå‚æ•°: ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½’çº¦æ“ä½œçš„èµ·å§‹å€¼ï¼Œä¹Ÿæ˜¯æµä¸­æ²¡æœ‰å…ƒç´ æ—¶çš„è¿”å›å€¼ï¼Œæ‰€ä»¥å¾ˆæ˜¾ç„¶å¯¹äºæ•°å€¼å’Œè€Œè¨€0æ˜¯ä¸€ä¸ªåˆé€‚çš„å€¼ã€‚ ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ä½ åœ¨6.2.2èŠ‚ä¸­ä½¿ç”¨çš„å‡½æ•°ï¼Œå°†èœè‚´è½¬æ¢æˆä¸€ä¸ªè¡¨ç¤ºå…¶æ‰€å«çƒ­é‡çš„intã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªBinaryOperatorï¼Œå°†ä¸¤ä¸ªé¡¹ç›®ç´¯ç§¯æˆä¸€ä¸ªåŒç±»å‹çš„å€¼ã€‚è¿™é‡Œå®ƒå°±æ˜¯å¯¹ä¸¤ä¸ªintæ±‚å’Œã€‚ ä¸‹é¢ä¸¤ä¸ªæ˜¯ç›¸åŒçš„æ“ä½œï¼š 12Optional&lt;Dish&gt; collect = DataUtil.genMenu().stream().collect(Collectors.maxBy(Comparator.comparingInt(Dish::getCalories)));Optional&lt;Dish&gt; mostCalorieDish = menu.stream().collect(reducing((d1, d2) -&gt; d1.getCalories() &gt; d2.getCalories() ? d1 : d2)); 5. åˆ†ç»„ç”¨Collectors.groupingByå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨å°±å¯ä»¥è½»æ¾åœ°å®Œæˆä»»åŠ¡ï¼š 1Map&lt;Dish.Type, List&lt;Dish&gt;&gt; collect = DataUtil.genMenu().stream().collect(Collectors.groupingBy(Dish::getType)); ç»™groupingByæ–¹æ³•ä¼ é€’äº†ä¸€ä¸ªFunction(ä»¥æ–¹æ³•å¼•ç”¨çš„å½¢å¼)ï¼Œå®ƒæå–äº†æµä¸­æ¯ ä¸€é“Dishçš„Dish.Typeã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªFunctionå«ä½œåˆ†ç±»å‡½æ•°ï¼Œå› ä¸ºå®ƒç”¨æ¥æŠŠæµä¸­çš„å…ƒç´ åˆ†æˆä¸åŒçš„ç»„ã€‚åˆ†ç»„æ“ä½œçš„ç»“æœæ˜¯ä¸€ä¸ªMapï¼ŒæŠŠåˆ†ç»„å‡½æ•°è¿”å›çš„å€¼ä½œä¸ºæ˜ å°„çš„é”®ï¼ŒæŠŠæµä¸­æ‰€æœ‰å…·æœ‰è¿™ä¸ªåˆ†ç±»å€¼çš„é¡¹ç›®çš„åˆ—è¡¨ä½œä¸ºå¯¹åº”çš„æ˜ å°„å€¼ã€‚ 5.1 å¤šçº§åˆ†ç»„è¦å®ç°å¤šçº§åˆ†ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç”±åŒå‚æ•°ç‰ˆæœ¬çš„Collectors.groupingByå·¥å‚æ–¹æ³•åˆ›å»ºçš„æ”¶é›†å™¨ï¼Œå®ƒé™¤äº†æ™®é€šçš„åˆ†ç±»å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ¥å—collectorç±»å‹çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚é‚£ä¹ˆè¦è¿›è¡ŒäºŒçº§åˆ†ç»„çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªå†…å±‚groupingByä¼ é€’ç»™å¤–å±‚groupingByï¼Œå¹¶å®šä¹‰ä¸€ä¸ªä¸ºæµä¸­é¡¹ç›®åˆ†ç±»çš„äºŒçº§æ ‡å‡†ï¼š 12345678910Map&lt;Dish.Type, Map&lt;CaloricLevel, List&lt;Dish&gt;&gt;&gt; collect1 = DataUtil.genMenu().stream().collect( Collectors.groupingBy(Dish::getType, Collectors.groupingBy(dish -&gt; { if (dish.getCalories() &lt;= 400) { return CaloricLevel.DIET; } else if (dish.getCalories() &lt;= 700) { return CaloricLevel.NORMAL; } else return CaloricLevel.FAT; }))); 5.2 æŒ‰å­ç»„æ”¶é›†æ•°æ®ä¼ é€’ç»™ç¬¬ä¸€ä¸ªgroupingByçš„ç¬¬äºŒä¸ªæ”¶é›†å™¨å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œè€Œä¸ä¸€å®šæ˜¯å¦ä¸€ä¸ªgroupingByã€‚ä¾‹å¦‚ï¼Œè¦æ•°ä¸€æ•°èœå•ä¸­æ¯ç±»èœæœ‰å¤šå°‘ä¸ªï¼Œå¯ä»¥ä¼ é€’countingæ”¶é›†å™¨ä½œä¸ºgroupingByæ”¶é›†å™¨çš„ç¬¬äºŒä¸ªå‚æ•°: 1Map&lt;Dish.Type, Long&gt; collect2 = DataUtil.genMenu().stream().collect(Collectors.groupingBy(Dish::getType, Collectors.counting())); è¿˜è¦æ³¨æ„ï¼Œæ™®é€šçš„å•å‚æ•°groupingBy(f)(å…¶ä¸­fæ˜¯åˆ†ç±»å‡½æ•°)å®é™…ä¸Šæ˜¯groupingBy(f, toList())çš„ç®€ä¾¿å†™æ³•ã€‚æŠŠæ”¶é›†å™¨è¿”å›çš„ç»“æœè½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ Collectors.collectingAndThenå·¥å‚æ–¹æ³•è¿”å›çš„æ”¶é›†å™¨ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè¦è½¬æ¢çš„æ”¶é›†å™¨ä»¥åŠè½¬æ¢å‡½æ•°ï¼Œå¹¶è¿”å›å¦ä¸€ä¸ªæ”¶é›†å™¨ã€‚ 12345Map&lt;Dish.Type, Dish&gt; collect3 = DataUtil.genMenu().stream().collect(Collectors.groupingBy(Dish::getType, Collectors.collectingAndThen( Collectors.maxBy(Comparator.comparingInt(Dish::getCalories)), Optional::get ))); è¿™ä¸ªæ“ä½œæ”¾åœ¨è¿™é‡Œæ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºreducingæ”¶é›†å™¨æ°¸è¿œéƒ½ä¸ä¼šè¿”å›Optional.empty()ã€‚ å¸¸å¸¸å’ŒgroupingByè”åˆä½¿ç”¨çš„å¦ä¸€ä¸ªæ”¶é›†å™¨æ˜¯mappingæ–¹æ³•ç”Ÿæˆçš„ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°:ä¸€ä¸ªå‡½æ•°å¯¹æµä¸­çš„å…ƒç´ åšå˜æ¢ï¼Œå¦ä¸€ä¸ªåˆ™å°†å˜æ¢çš„ç»“æœå¯¹è±¡æ”¶ô°èµ·æ¥ã€‚å…¶ç›®çš„æ˜¯åœ¨ç´¯åŠ ä¹‹å‰å¯¹æ¯ä¸ªè¾“å…¥å…ƒç´ åº”ç”¨ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥è®©æ¥å—ç‰¹å®šç±»å‹å…ƒç´ çš„æ”¶ô°å™¨é€‚åº”ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä½¿ç”¨è¿™ä¸ªæ”¶é›†å™¨çš„å®é™…ä¾‹å­ã€‚æ¯”æ–¹è¯´ä½ æƒ³è¦çŸ¥é“ï¼Œå¯¹äºæ¯ç§ç±»å‹çš„Dishï¼Œ èœå•ä¸­éƒ½æœ‰å“ªäº›CaloricLevelã€‚ 1234567891011Map&lt;Dish.Type, Set&lt;CaloricLevel&gt;&gt; collect4 = DataUtil.genMenu().stream().collect(Collectors.groupingBy( Dish::getType, Collectors.mapping( dish -&gt; { if (dish.getCalories() &lt;= 400) { return CaloricLevel.DIET; } else if (dish.getCalories() &lt;= 700) { return CaloricLevel.NORMAL; } else return CaloricLevel.FAT; }, Collectors.toSet() ))); 6. åˆ†åŒºåˆ†åŒºæ˜¯åˆ†ç»„çš„ç‰¹æ®Šæƒ…å†µ:ç”±ä¸€ä¸ªè°“è¯(è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼çš„å‡½æ•°)ä½œä¸ºåˆ†ç±»å‡½æ•°ï¼Œå®ƒç§°åˆ†ç±»å‡½æ•°ã€‚åˆ†åŒºå‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¿™æ„å‘³ç€å¾—åˆ°çš„åˆ†ç»„Mapçš„é”®ç±»å‹æ˜¯Booleanï¼Œäºæ˜¯å®ƒæœ€å¤šå¯ä»¥ åˆ†ä¸ºä¸¤ç»„â€”â€”trueæ˜¯ä¸€ç»„ï¼Œfalseæ˜¯ä¸€ç»„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæƒ³è¦æŠŠèœæŒ‰ç…§ç´ é£Ÿå’Œéç´ é£Ÿåˆ†å¼€: 123456Map&lt;Boolean, List&lt;Dish&gt;&gt; collect = DataUtil.genMenu().stream().collect(Collectors.partitioningBy(Dish::isVegetarian));System.out.println(collect.get(true));partitioningBy å·¥å‚æ–¹æ³•æœ‰ä¸€ä¸ªé‡è½½ç‰ˆæœ¬ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä¼ é€’ç¬¬äºŒä¸ªæ”¶é›†å™¨:Map&lt;Boolean, Map&lt;Dish.Type, List&lt;Dish&gt;&gt;&gt; collect1 = DataUtil.genMenu().stream().collect(Collectors.partitioningBy( Dish::isVegetarian, Collectors.groupingBy(Dish::getType))); åˆ†åŒºçœ‹ä½œåˆ†ç»„ä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚ 7. Collectorsç±»çš„é™æ€å·¥å‚æ–¹æ³• 8. æ”¶é›†å™¨æ¥å£1234567public interface Collector&lt;T, A, R&gt; { Supplier&lt;A&gt; supplier(); BiConsumer&lt;A, T&gt; accumulator(); Function&lt;A, R&gt; finisher(); BinaryOperator&lt;A&gt; combiner(); Set&lt;Characteristics&gt; characteristics();} æœ¬åˆ—è¡¨é€‚ç”¨ä»¥ä¸‹å®šä¹‰: Tæ˜¯æµä¸­è¦æ”¶é›†çš„é¡¹ç›®çš„æ³›å‹ã€‚ Aæ˜¯ç´¯åŠ å™¨çš„ç±»å‹ï¼Œç´¯åŠ å™¨æ˜¯åœ¨æ”¶é›†è¿‡ç¨‹ä¸­ç”¨äºç´¯ç§¯éƒ¨åˆ†ç»“æœçš„å¯¹è±¡ã€‚ Ræ˜¯æ‰‹æœºæ“ä½œå¾—åˆ°çš„å¯¹è±¡(é€šå¸¸ä½†å¹¶ä¸ä¸€å®šæ˜¯é›†åˆ)çš„ç±»å‹ã€‚ 8.1 å»ºç«‹æ–°çš„ç»“æœå®¹å™¨:supplieræ–¹æ³•supplieræ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªç»“æœä¸ºç©ºçš„Supplierï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ— å‚æ•°å‡½æ•°ï¼Œåœ¨è°ƒç”¨æ—¶å®ƒä¼šåˆ›å»ºä¸€ä¸ªç©ºçš„ç´¯åŠ å™¨å®ä¾‹ï¼Œä¾›æ•°æ®æ”¶é›†è¿‡ç¨‹ä½¿ç”¨ã€‚ 8.2 å°†å…ƒç´ æ·»åŠ åˆ°ç»“æœå®¹å™¨:accumulatoræ–¹æ³•accumulatoræ–¹æ³•ä¼šè¿”å›æ‰§è¡Œå½’çº¦æ“ä½œçš„å‡½æ•°ã€‚å½“éå†åˆ°æµä¸­ç¬¬nä¸ªå…ƒç´ æ—¶ï¼Œè¿™ä¸ªå‡½æ•°æ‰§è¡Œæ—¶ä¼šæœ‰ä¸¤ä¸ªå‚æ•°:ä¿å­˜å½’çº¦ç»“æœçš„ç´¯åŠ å™¨(å·²æ”¶é›†äº†æµä¸­çš„å‰n-1ä¸ªé¡¹ç›®)ï¼Œè¿˜æœ‰ç¬¬nä¸ªå…ƒç´ æœ¬èº«ã€‚è¯¥å‡½æ•°å°†è¿”å›voidï¼Œå› ä¸ºç´¯åŠ å™¨æ˜¯åŸä½æ›´æ–°ï¼Œå³å‡½æ•°çš„æ‰§è¡Œæ”¹å˜äº†å®ƒçš„å†…éƒ¨çŠ¶æ€ä»¥ä½“ç°éå†çš„å…ƒç´ çš„æ•ˆæœã€‚ 8.3 å¯¹ç»“æœå®¹å™¨åº”ç”¨æœ€ç»ˆè½¬æ¢:finisheræ–¹æ³•åœ¨éå†å®Œæµåï¼Œfinisheræ–¹æ³•å¿…é¡»è¿”å›åœ¨ç´¯ç§¯è¿‡ç¨‹çš„æœ€åè¦è°ƒç”¨çš„ä¸€ä¸ªå‡½æ•°ï¼Œä»¥ä¾¿å°†ç´¯åŠ å™¨å¯¹è±¡è½¬æ¢ä¸ºæ•´ä¸ªé›†åˆæ“ä½œçš„æœ€ç»ˆç»“æœã€‚é¡ºåºå½’çº¦è¿‡ç¨‹çš„é€»è¾‘æ­¥éª¤: 8.4 åˆå¹¶ä¸¤ä¸ªç»“æœå®¹å™¨:combineræ–¹æ³•å››ä¸ªæ–¹æ³•ä¸­çš„æœ€åä¸€ä¸ªâ€”â€”combineræ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¾›å½’çº¦æ“ä½œä½¿ç”¨çš„å‡½æ•°ï¼Œå®ƒå®šä¹‰äº†å¯¹æµçš„å„ä¸ªå­éƒ¨åˆ†è¿›è¡Œå¹¶è¡Œå¤„ç†æ—¶ï¼Œå„ä¸ªå­éƒ¨åˆ†å½’çº¦æ‰€å¾—çš„ç´¯åŠ å™¨è¦å¦‚ä½•åˆå¹¶: åŸå§‹æµä¼šä»¥é€’å½’æ–¹å¼æ‹†åˆ†ä¸ºå­æµï¼Œç›´åˆ°å®šä¹‰æµæ˜¯å¦éœ€è¦è¿›ä¸€æ­¥æ‹†åˆ†çš„ä¸€ä¸ªæ¡ä»¶ä¸ºé(å¦‚æœåˆ†å¸ƒå¼å·¥ä½œå•ä½å¤ªå°ï¼Œå¹¶è¡Œè®¡ç®—å¾€å¾€æ¯”é¡ºåºè®¡ç®—è¦æ…¢ï¼Œè€Œä¸”è¦æ˜¯ç”Ÿæˆçš„å¹¶è¡Œä»»åŠ¡æ¯”å¤„ç†å™¨å†…æ ¸æ•°å¤šå¾ˆå¤šçš„è¯å°±æ¯«æ— æ„ä¹‰äº†)ã€‚ ç°åœ¨ï¼Œæ‰€æœ‰çš„å­æµéƒ½å¯ä»¥å¹¶è¡Œå¤„ç†ï¼Œå³å¯¹æ¯ä¸ªå­æµåº”ç”¨å›¾6-7æ‰€ç¤ºçš„é¡ºåºå½’çº¦ç®—æ³•ã€‚ æœ€åï¼Œä½¿ç”¨æ”¶é›†å™¨combineræ–¹æ³•è¿”å›çš„å‡½æ•°ï¼Œå°†æ‰€æœ‰çš„éƒ¨åˆ†ç»“æœä¸¤ä¸¤åˆå¹¶ã€‚è¿™æ—¶ä¼šæŠŠåŸå§‹æµæ¯æ¬¡æ‹†åˆ†æ—¶å¾—åˆ°çš„å­æµå¯¹åº”çš„ç»“æœåˆå¹¶èµ·æ¥ 8.5 characteristicsæ–¹æ³•æœ€åä¸€ä¸ªæ–¹æ³•â€”â€”characteristicsä¼šè¿”å›ä¸€ä¸ªä¸å¯å˜çš„Characteristicsé›†åˆï¼Œå®ƒå®šä¹‰äº†æ”¶é›†å™¨çš„è¡Œä¸ºâ€”â€”å°¤å…¶æ˜¯å…³äºæµæ˜¯å¦å¯ä»¥å¹¶è¡Œå½’çº¦ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›ä¼˜åŒ–çš„æç¤ºã€‚Characteristicsæ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªé¡¹ç›®çš„æšä¸¾ã€‚ UNORDEREDâ€”â€”å½’çº¦ç»“æœä¸å—æµä¸­é¡¹ç›®çš„éå†å’Œç´¯ç§¯é¡ºåºçš„å½±å“ã€‚ CONCURRENTâ€”â€”accumulatorå‡½æ•°å¯ä»¥ä»å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ï¼Œä¸”è¯¥æ”¶é›†å™¨å¯ä»¥å¹¶è¡Œå½’çº¦æµã€‚å¦‚æœæ”¶é›†å™¨æ²¡æœ‰æ ‡ä¸ºUNORDEREDï¼Œé‚£å®ƒä»…åœ¨ç”¨äºæ— åºæ•°æ®æºæ—¶æ‰å¯ä»¥å¹¶è¡Œå½’çº¦ã€‚ IDENTITY_FINISHâ€”â€”è¿™è¡¨æ˜å®Œæˆå™¨æ–¹æ³•è¿”å›çš„å‡½æ•°æ˜¯ä¸€ä¸ªæ’ç­‰å‡½æ•°ï¼Œå¯ä»¥è·³è¿‡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç´¯åŠ å™¨å¯¹è±¡å°†ä¼šç›´æ¥ç”¨ä½œå½’çº¦è¿‡ç¨‹çš„æœ€ç»ˆç»“æœã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œå°†ç´¯åŠ å™¨Aä¸åŠ æ£€æŸ¥åœ°è½¬æ¢ä¸ºç»“æœRæ˜¯å®‰å…¨çš„ã€‚ 9. å°ç»“ collectæ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå®ƒæ¥å—çš„å‚æ•°æ˜¯å°†æµä¸­å…ƒç´ ç´¯ç§¯åˆ°æ±‡æ€»ç»“æœçš„å„ç§æ–¹å¼(ç§°ä¸ºæ”¶é›†å™¨)ã€‚ é¢„å®šä¹‰æ”¶é›†å™¨åŒ…æ‹¬å°†æµå…ƒç´ å½’çº¦å’Œæ±‡æ€»åˆ°ä¸€ä¸ªå€¼ï¼Œä¾‹å¦‚è®¡ç®—æœ€å°å€¼ã€æœ€å¤§å€¼æˆ–å¹³å‡å€¼ã€‚è¿™äº›æ”¶é›†å™¨æ€»ç»“åœ¨è¡¨6-1ä¸­ã€‚ é¢„å®šä¹‰æ”¶é›†å™¨å¯ä»¥ç”¨groupingByå¯¹æµä¸­å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼Œæˆ–ç”¨partitioningByè¿›è¡Œåˆ†åŒºã€‚ æ”¶é›†å™¨å¯ä»¥é«˜æ•ˆåœ°å¤åˆèµ·æ¥ï¼Œè¿›è¡Œå¤šçº§åˆ†ç»„ã€åˆ†åŒºå’Œå½’çº¦ã€‚ ä½ å¯ä»¥å®ç°Collectoræ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•æ¥å¼€å‘ä½ è‡ªå·±çš„æ”¶é›†å™¨ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/16/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%206%EF%BC%9A%E7%94%A8%E6%B5%81%E6%94%B6%E9%9B%86%E6%95%B0%E6%8D%AE/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 3ï¼šLambdaè¡¨è¾¾å¼","text":"1. Lambdaç®€ä»‹å¯ä»¥æŠŠLambdaè¡¨è¾¾å¼ç†è§£ä¸ºç®€æ´åœ°è¡¨ç¤ºå¯ä¼ é€’çš„åŒ¿åå‡½æ•°çš„ä¸€ç§æ–¹å¼ï¼šå®ƒæ²¡æœ‰åç§°ï¼Œä½†å®ƒæœ‰å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä¸»ä½“ã€è¿”å›ç±»å‹ï¼Œå¯èƒ½è¿˜æœ‰ä¸€ä¸ªå¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ã€‚ åŒ¿åâ€”â€”æˆ‘ä»¬è¯´åŒ¿åï¼Œæ˜¯å› ä¸ºå®ƒä¸åƒæ™®é€šçš„æ–¹æ³•é‚£æ ·æœ‰ä¸€ä¸ªæ˜ç¡®çš„åç§°:å†™å¾—å°‘è€Œæƒ³å¾—å¤š! å‡½æ•°â€”â€”æˆ‘ä»¬è¯´å®ƒæ˜¯å‡½æ•°ï¼Œæ˜¯å› ä¸ºLambdaå‡½æ•°ä¸åƒæ–¹æ³•é‚£æ ·å±äºæŸä¸ªç‰¹å®šçš„ç±»ã€‚ä½†å’Œæ–¹æ³•ä¸€æ ·ï¼ŒLambdaæœ‰å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä¸»ä½“ã€è¿”å›ç±»å‹ï¼Œè¿˜å¯èƒ½æœ‰å¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸åˆ—è¡¨ã€‚ ä¼ é€’â€”â€”Lambdaè¡¨è¾¾å¼å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•æˆ–å­˜å‚¨åœ¨å˜é‡ä¸­ã€‚ ç®€æ´â€”â€”æ— éœ€åƒåŒ¿åç±»é‚£æ ·å†™å¾ˆå¤šæ¨¡æ¿ä»£ç ã€‚ 2. Lambdaå†™æ³•(parameters) -&gt; expression æˆ– (parameters) -&gt; { statements; }egï¼š(Apple a1, Apple a2) -&gt; a1.getWeight().compareTo(a2.getWeight());Lambdaè¡¨è¾¾å¼æœ‰ä¸‰ä¸ªéƒ¨åˆ†: å‚æ•°åˆ—è¡¨â€”â€”è¿™é‡Œå®ƒé‡‡ç”¨äº†Comparatorä¸­compareæ–¹æ³•çš„å‚æ•°ï¼Œä¸¤ä¸ªAppleã€‚ ç®­å¤´â€”â€”ç®­å¤´-&gt;æŠŠå‚æ•°åˆ—è¡¨ä¸Lambdaä¸»ä½“åˆ†éš”å¼€ã€‚ Lambdaä¸»ä½“â€”â€”æ¯”è¾ƒä¸¤ä¸ªAppleçš„é‡é‡ã€‚è¡¨è¾¾å¼å°±æ˜¯Lambdaçš„è¿”å›å€¼äº†ã€‚ 3. å‡½æ•°å¼æ¥å£å’Œå‡½æ•°æè¿°ç¬¦å‡½æ•°å¼æ¥å£å°±æ˜¯åªå®šä¹‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ã€‚æ¥å£ä¸Šæ ‡æœ‰@FunctionalInterfaceè¡¨ç¤ºè¯¥æ¥å£ä¼šè®¾è®¡æˆ ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå¦‚æœä½ ç”¨@FunctionalInterfaceå®šä¹‰äº†ä¸€ä¸ªæ¥å£ï¼Œè€Œå®ƒå´ä¸æ˜¯å‡½æ•°å¼æ¥å£çš„è¯ï¼Œç¼–è¯‘å™¨å°†è¿”å›ä¸€ä¸ªæç¤ºåŸå› çš„é”™è¯¯ã€‚æ¥å£ç°åœ¨è¿˜å¯ä»¥æ‹¥æœ‰é»˜è®¤æ–¹æ³•(å³åœ¨ç±»æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡Œå®ç°æ—¶ï¼Œ å…¶ä¸»ä½“ä¸ºæ–¹æ³•æä¾›é»˜è®¤å®ç°çš„æ–¹æ³•)ã€‚å“ªæ€•æœ‰å¾ˆå¤šé»˜è®¤æ–¹æ³•ï¼Œåªè¦æ¥å£åªå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒå°±ä»ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ å‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•çš„ç­¾åå°±æ˜¯Lambdaè¡¨è¾¾å¼çš„ç­¾åã€‚æˆ‘ä»¬å°†è¿™ç§æŠ½è±¡æ–¹æ³•å«ä½œï¼šå‡½æ•°æè¿°ç¬¦ã€‚ä¾‹å¦‚ï¼ŒRunnableæ¥å£å¯ä»¥çœ‹ä½œä¸€ä¸ªä»€ä¹ˆä¹Ÿä¸æ¥å—ä»€ä¹ˆä¹Ÿä¸è¿”å›(void)çš„å‡½æ•°çš„ç­¾åï¼Œå› ä¸ºå®ƒåªæœ‰ä¸€ä¸ªå«ä½œrunçš„æŠ½è±¡æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä»€ä¹ˆä¹Ÿä¸æ¥å—ï¼Œä»€ä¹ˆä¹Ÿä¸è¿”å›(void)ã€‚ 4. ä¸‰ç§å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£4.1 Predicate1234567891011121314151617/** * Represents a predicate (boolean-valued function) of one argument. * &lt;p&gt;This is a &lt;a href=\"package-summary.html\"&gt;functional interface&lt;/a&gt; * whose functional method is {@link #test(Object)}. * @param &lt;T&gt; the type of the input to the predicate * @since 1.8 */@FunctionalInterfacepublic interface Predicate&lt;T&gt; { /** * Evaluates this predicate on the given argument. * @param t the input argument * @return {@code true} if the input argument matches the predicate, * otherwise {@code false} */ boolean test(T t);} Predicateçš„è‹±æ–‡ç¤ºæ„æ˜¯ï¼šè°“è¯ã€‚Predicateæ¥å£å®šä¹‰äº†ä¸€ä¸ªåå«testçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæ¥å—æ³›å‹Tå¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªbooleanã€‚ 4.2 Consumer1234567891011121314151617/*** Represents an operation that accepts a single input argument and returns no* result. Unlike most other functional interfaces, {@code Consumer} is expected* to operate via side-effects.* &lt;p&gt;This is a &lt;a href=\"package-summary.html\"&gt;functional interface&lt;/a&gt;* whose functional method is {@link #accept(Object)}.* @param &lt;T&gt; the type of the input to the operation* @since 1.8*/@FunctionalInterfacepublic interface Consumer&lt;T&gt; { /** * Performs this operation on the given argument. * @param t the input argument */ void accept(T t);} Consumerçš„è‹±æ–‡ç¤ºæ„æ˜¯ï¼šæ¶ˆè´¹è€…ã€‚Consumeræ¥å£å®šä¹‰äº†ä¸€ä¸ªåå«acceptçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæ¥å—æ³›å‹Tå¯¹è±¡ï¼Œå¹¶æ²¡æœ‰è¿”å›ä»»ä½•å€¼ã€‚ 4.3 Function1234567891011121314151617/*** Represents a function that accepts one argument and produces a result.* &lt;p&gt;This is a &lt;a href=\"package-summary.html\"&gt;functional interface&lt;/a&gt;* whose functional method is {@link #apply(Object)}.* @param &lt;T&gt; the type of the input to the function* @param &lt;R&gt; the type of the result of the function* @since 1.8*/@FunctionalInterfacepublic interface Function&lt;T, R&gt; { /** * Applies this function to the given argument. * @param t the function argument * @return the function result */ R apply(T t);} Functionçš„è‹±æ–‡ç¤ºæ„æ˜¯ï¼šåŠŸèƒ½ã€‚Functionæ¥å£å®šä¹‰äº†ä¸€ä¸ªåå«applyçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæ¥å—æ³›å‹Tå¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ³›å‹Rçš„å¯¹è±¡ã€‚ Javaè¿˜æœ‰ä¸€ä¸ªè‡ªåŠ¨è£…ç®±æœºåˆ¶æ¥å¸®åŠ©ç¨‹åºå‘˜æ‰§è¡Œè¿™ä¸€ä»»åŠ¡:è£…ç®±å’Œæ‹†ç®±æ“ä½œæ˜¯è‡ªåŠ¨å®Œæˆçš„ã€‚ä½†è¿™åœ¨æ€§èƒ½æ–¹é¢æ˜¯è¦ä»˜å‡ºä»£ä»·çš„ã€‚è£…ç®±åçš„å€¼æœ¬è´¨ä¸Šå°±æ˜¯æŠŠåŸå§‹ç±»å‹åŒ…è£¹èµ·æ¥ï¼Œå¹¶ä¿å­˜åœ¨å †é‡Œã€‚å› æ­¤ï¼Œè£…ç®±åçš„å€¼éœ€è¦æ›´å¤šçš„å†…å­˜ï¼Œå¹¶éœ€è¦é¢å¤–çš„å†…å­˜æœç´¢æ¥è·å–è¢«åŒ…è£¹çš„åŸå§‹å€¼ã€‚Java 8ä¸ºæˆ‘ä»¬å‰é¢æ‰€è¯´çš„å‡½æ•°å¼æ¥å£å¸¦æ¥äº†ä¸€ä¸ªä¸“é—¨çš„ç‰ˆæœ¬ï¼Œä»¥ä¾¿åœ¨è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯åŸå§‹ç±»å‹æ—¶é¿å…è‡ªåŠ¨è£…ç®±çš„æ“ä½œã€‚ 4.4 Java 8ä¸­çš„å¸¸ç”¨å‡½æ•°å¼æ¥å£ 5. ç±»å‹æ£€æŸ¥ã€ç±»å‹æ¨æ–­ä»¥åŠé™åˆ¶5.1 ç±»å‹æ£€æŸ¥Lambdaçš„ç±»å‹æ˜¯ä»ä½¿ç”¨Lambdaçš„ä¸Šä¸‹æ–‡æ¨æ–­å‡ºæ¥çš„ã€‚ä¸Šä¸‹æ–‡(æ¯”å¦‚ï¼Œæ¥å—å®ƒä¼ é€’çš„æ–¹æ³•çš„å‚æ•°ï¼Œæˆ–æ¥å—å®ƒçš„å€¼çš„å±€éƒ¨å˜é‡)ä¸­Lambdaè¡¨è¾¾å¼éœ€è¦çš„ç±»å‹ç§°ä¸ºç›®æ ‡ç±»å‹ã€‚ç±»å‹æ£€æŸ¥è¿‡ç¨‹å¯ä»¥åˆ†è§£ä¸ºå¦‚ä¸‹æ‰€ç¤ºã€‚ é¦–å…ˆï¼Œä½ è¦æ‰¾å‡ºfilteræ–¹æ³•çš„å£°æ˜ã€‚ ç¬¬äºŒï¼Œè¦æ±‚å®ƒæ˜¯Predicate(ç›®æ ‡ç±»å‹)å¯¹è±¡çš„ç¬¬äºŒä¸ªæ­£å¼å‚æ•°ã€‚ ç¬¬ä¸‰ï¼ŒPredicateæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå®šä¹‰äº†ä¸€ä¸ªå«ä½œtestçš„æŠ½è±¡æ–¹æ³•ã€‚ ç¬¬å››ï¼Œtestæ–¹æ³•æè¿°äº†ä¸€ä¸ªå‡½æ•°æè¿°ç¬¦ï¼Œå®ƒå¯ä»¥æ¥å—ä¸€ä¸ªAppleï¼Œå¹¶è¿”å›ä¸€ä¸ªboolean. æœ€åï¼Œfilterçš„ä»»ä½•å®é™…å‚æ•°éƒ½å¿…é¡»åŒ¹é…è¿™ä¸ªè¦æ±‚ã€‚ è¿™æ®µä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‰€ä¼ é€’çš„Lambdaè¡¨è¾¾å¼ä¹ŸåŒæ ·æ¥å—Appleä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª booleanã€‚è¯·æ³¨æ„ï¼Œå¦‚æœLambdaè¡¨è¾¾å¼æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œé‚£ä¹ˆæŠ½è±¡æ–¹æ³•æ‰€å£°æ˜çš„throwsè¯­å¥ä¹Ÿå¿… é¡»ä¸ä¹‹åŒ¹é…ã€‚æœ‰äº†ç›®æ ‡ç±»å‹çš„æ¦‚å¿µï¼ŒåŒä¸€ä¸ªLambdaè¡¨è¾¾å¼å°±å¯ä»¥ä¸ä¸åŒçš„å‡½æ•°å¼æ¥å£è”ç³»èµ·æ¥ï¼Œåªè¦å®ƒ ä»¬çš„æŠ½è±¡æ–¹æ³•ç­¾åèƒ½å¤Ÿå…¼å®¹ã€‚æ¯”å¦‚ï¼Œå‰é¢æåˆ°çš„Callableå’ŒPrivilegedActionï¼Œè¿™ä¸¤ä¸ªæ¥å£éƒ½ä»£è¡¨ç€ä»€ä¹ˆä¹Ÿä¸æ¥å—ä¸”è¿”å›ä¸€ä¸ªæ³›å‹Tçš„å‡½æ•°ã€‚ å› æ­¤ï¼Œä¸‹é¢ä¸¤ä¸ªèµ‹å€¼æ˜¯æœ‰æ•ˆçš„: 12Callable&lt;Integer&gt; c = () -&gt; 42;PrivilegedAction&lt;Integer&gt; p = () -&gt; 42; ç‰¹æ®Šçš„voidå…¼å®¹è§„åˆ™å¦‚æœä¸€ä¸ªLambdaçš„ä¸»ä½“æ˜¯ä¸€ä¸ªè¯­å¥è¡¨è¾¾å¼ï¼Œ å®ƒå°±å’Œä¸€ä¸ªè¿”å›voidçš„å‡½æ•°æè¿°ç¬¦å…¼å®¹(å½“ç„¶éœ€è¦å‚æ•°åˆ—è¡¨ä¹Ÿå…¼å®¹)ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤è¡Œéƒ½æ˜¯åˆæ³•çš„ï¼Œå°½ç®¡Listçš„addæ–¹æ³•è¿”å›äº†ä¸€ä¸ª booleanï¼Œè€Œä¸æ˜¯Consumerä¸Šä¸‹æ–‡(T -&gt; void)æ‰€è¦æ±‚çš„void: 1234// Predicateè¿”å›äº†ä¸€ä¸ªboolean Predicate&lt;String&gt; p = s -&gt; list.add(s); // Consumerè¿”å›äº†ä¸€ä¸ªvoid Consumer&lt;String&gt; b = s -&gt; list.add(s); 5.2 ç±»å‹æ¨æ–­Javaç¼–è¯‘å™¨ä¼šä»ä¸Šä¸‹æ–‡(ç›®æ ‡ç±»å‹)æ¨æ–­å‡ºç”¨ä»€ä¹ˆå‡½æ•°å¼æ¥ å£æ¥é…åˆLambdaè¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€å®ƒä¹Ÿå¯ä»¥æ¨æ–­å‡ºé€‚åˆLambdaçš„ç­¾åï¼Œå› ä¸ºå‡½æ•°æè¿°ç¬¦å¯ä»¥é€šè¿‡ç›®æ ‡ç±»å‹æ¥å¾—åˆ°ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œç¼–è¯‘å™¨å¯ä»¥äº†è§£Lambdaè¡¨è¾¾å¼çš„å‚æ•°ç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨Lambdaè¯­æ³•ä¸­çœå»æ ‡æ³¨å‚æ•°ç±»å‹ã€‚ 1234// æ²¡æœ‰ç±» å‹æ¨æ–­Comparator&lt;Apple&gt; c = (Apple a1, Apple a2) -&gt; a1.getWeight().compareTo(a2.getWeight()); // æœ‰ç±»å‹æ¨æ–­Comparator&lt;Apple&gt; c = (a1, a2) -&gt; a1.getWeight().compareTo(a2.getWeight()); 5.3 ä½¿ç”¨å±€éƒ¨å˜é‡Lambdaè¡¨è¾¾å¼ ä¹Ÿå…è®¸ä½¿ç”¨è‡ªç”±å˜é‡(ä¸æ˜¯å‚æ•°ï¼Œè€Œæ˜¯åœ¨å¤–å±‚ä½œç”¨åŸŸä¸­å®šä¹‰çš„å˜é‡)ï¼Œå°±åƒåŒ¿åç±»ä¸€æ ·ã€‚ å®ƒä»¬è¢« ç§°ä½œæ•è·Lambdaã€‚Lambdaæ•è·çš„å±€éƒ¨å˜é‡å¿…é¡»æ˜¾å¼å£°æ˜ä¸ºfinalï¼Œ æˆ–äº‹å®ä¸Šæ˜¯finalã€‚æ¢å¥è¯è¯´ï¼ŒLambdaè¡¨è¾¾å¼åªèƒ½æ•è·æŒ‡æ´¾ç»™å®ƒä»¬çš„å±€éƒ¨å˜é‡ä¸€æ¬¡ã€‚ ç¬¬ä¸€ï¼Œå®ä¾‹å˜é‡å’Œå±€éƒ¨å˜é‡èƒŒåçš„å®ç°æœ‰ä¸€ ä¸ªå…³é”®ä¸åŒã€‚å®ä¾‹å˜é‡éƒ½å­˜å‚¨åœ¨å †ä¸­ï¼Œè€Œå±€éƒ¨å˜é‡åˆ™ä¿å­˜åœ¨æ ˆä¸Šã€‚å¦‚æœLambdaå¯ä»¥ç›´æ¥è®¿é—®å±€éƒ¨å˜é‡ï¼Œè€Œä¸”Lambdaæ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨çš„ï¼Œåˆ™ä½¿ç”¨Lambdaçš„çº¿ç¨‹ï¼Œå¯èƒ½ä¼šåœ¨åˆ†é…è¯¥å˜é‡çš„çº¿ç¨‹å°†è¿™ä¸ªå˜é‡æ”¶å›ä¹‹åï¼Œå»è®¿é—®è¯¥å˜é‡ã€‚å› æ­¤ï¼ŒJavaåœ¨è®¿é—®è‡ªç”±å±€éƒ¨å˜é‡æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨è®¿é—®å®ƒçš„å‰¯æœ¬ï¼Œè€Œä¸æ˜¯è®¿é—®åŸå§‹å˜é‡ã€‚å¦‚æœå±€éƒ¨å˜é‡ä»…ä»…èµ‹å€¼ä¸€æ¬¡é‚£å°±æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«äº†â€”â€”å› æ­¤å°±æœ‰äº†è¿™ä¸ªé™åˆ¶ã€‚ ç¬¬äºŒï¼Œè¿™ä¸€é™åˆ¶ä¸é¼“åŠ±ä½ ä½¿ç”¨æ”¹å˜å¤–éƒ¨å˜é‡çš„å…¸å‹å‘½ä»¤å¼ç¼–ç¨‹æ¨¡å¼(æˆ‘ä»¬ä¼šåœ¨ä»¥åçš„å„ç« ä¸­ è§£é‡Šï¼Œè¿™ç§æ¨¡å¼ä¼šé˜»ç¢å¾ˆå®¹æ˜“åšåˆ°çš„å¹¶è¡Œå¤„ç†)ã€‚ 6. æ–¹æ³•å¼•ç”¨æ–¹æ³•å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œä»…ä»…è°ƒç”¨ç‰¹å®šæ–¹æ³•çš„Lambdaçš„ä¸€ç§å¿«æ· å†™æ³•ï¼Œæ–¹æ³•å¼•ç”¨çœ‹ä½œé’ˆå¯¹ä»…ä»…æ¶‰åŠå•ä¸€æ–¹æ³•çš„Lambdaçš„è¯­æ³•ç³–ã€‚ç›®æ ‡å¼•ç”¨æ”¾åœ¨åˆ†éš”ç¬¦::å‰ï¼Œæ–¹æ³•çš„åç§°æ”¾åœ¨åé¢ã€‚æ–¹æ³•å¼•ç”¨ä¸»è¦æœ‰ä¸‰ç±»ï¼š (1) æŒ‡å‘é™æ€æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨(ä¾‹å¦‚Integerçš„parseIntæ–¹æ³•ï¼Œå†™ä½œInteger::parseInt)ã€‚ (2) æŒ‡å‘ä»»æ„ç±»å‹å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨(ä¾‹å¦‚Stringçš„lengthæ–¹æ³•ï¼Œå†™ä½œ String::length)ã€‚ (3) æŒ‡å‘ç°æœ‰å¯¹è±¡çš„å®ä¾‹æ–¹æ³•çš„æ–¹æ³•å¼•ç”¨(å‡è®¾ä½ æœ‰ä¸€ä¸ªå±€éƒ¨å˜é‡expensiveTransaction ç”¨äºå­˜æ”¾Transactionç±»å‹çš„å¯¹è±¡ï¼Œå®ƒæ”¯æŒå®ä¾‹æ–¹æ³•getValueï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å†™expensive- Transaction::getValue)ã€‚ 1234567å¯¹äºä¸€ä¸ªç°æœ‰æ„é€ å‡½æ•°ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒçš„åç§°å’Œå…³é”®å­—newæ¥åˆ›å»ºå®ƒçš„ä¸€ä¸ªå¼•ç”¨: ClassName::newã€‚å®ƒçš„åŠŸèƒ½ä¸æŒ‡å‘é™æ€æ–¹æ³•çš„å¼•ç”¨ç±»ä¼¼ã€‚Supplier&lt;Apple&gt; c1 = Apple::new;Apple a1 = c1.get(); è¿™å°±ç­‰ä»·äº:Supplier&lt;Apple&gt; c1 = () -&gt; new Apple(); // åˆ©ç”¨é»˜è®¤æ„é€ å‡½æ•°åˆ›å»º Appleçš„Lambdaè¡¨è¾¾å¼Apple a1 = c1.get(); // è°ƒç”¨Supplierçš„getæ–¹æ³• å°†äº§ç”Ÿä¸€ä¸ªæ–°çš„Apple 7. å¤åˆLambdaè¡¨è¾¾å¼çš„æœ‰ç”¨æ–¹æ³•7.1 æ¯”è¾ƒå™¨å¤åˆ1234567Comparator&lt;Apple&gt; c = Comparator.comparing(Apple::getWeight);// é€†åº æŒ‰é‡é‡é€’ å‡æ’åºinventory.sort(comparing(Apple::getWeight).reversed());// æ¯”è¾ƒå™¨é“¾ æŒ‰é‡é‡é€’å‡æ’åº;ä¸¤ä¸ªè‹¹æœä¸€æ ·é‡æ—¶ï¼Œè¿›ä¸€æ­¥æŒ‰å›½å®¶æ’åºinventory.sort(comparing(Apple::getWeight) .reversed() .thenComparing(Apple::getCountry)); 7.2 è°“è¯å¤åˆ12345678// äº§ç”Ÿç°æœ‰Predicate å¯¹è±¡redAppleçš„éPredicate&lt;Apple&gt; notRedApple = redApple.negate();// é“¾æ¥ä¸¤ä¸ªè°“è¯æ¥ç”Ÿæˆå¦ ä¸€ä¸ªPredicateå¯¹è±¡ ä¸€ä¸ªè‹¹æœæ—¢æ˜¯çº¢è‰²åˆæ¯”è¾ƒé‡Predicate&lt;Apple&gt; redAndHeavyApple = redApple.and(a -&gt; a.getWeight() &gt; 150);// é“¾æ¥Predicateçš„æ–¹æ³•æ¥æ„é€ æ›´å¤æ‚Predicateå¯¹è±¡ è¡¨è¾¾è¦ä¹ˆæ˜¯é‡(150å…‹ä»¥ä¸Š)çš„çº¢è‹¹æœï¼Œè¦ä¹ˆæ˜¯ç»¿è‹¹æœPredicate&lt;Apple&gt; redAndHeavyAppleOrGreen = redApple.and(a -&gt; a.getWeight() &gt; 150) .or(a -&gt; \"green\".equals(a.getColor()));è¯·æ³¨æ„ï¼Œandå’Œoræ–¹æ³•æ˜¯æŒ‰ç…§åœ¨è¡¨è¾¾å¼é“¾ä¸­çš„ä½ç½®ï¼Œä»å·¦å‘å³ç¡®å®šä¼˜ å…ˆçº§çš„ã€‚å› æ­¤ï¼Œa.or(b).and(c)å¯ä»¥çœ‹ä½œ(a || b) &amp;&amp; cã€‚ 7.3 å‡½æ•°å¤åˆ123456789101112131415andThenæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå…ˆå¯¹è¾“å…¥åº”ç”¨ä¸€ä¸ªç»™å®šå‡½æ•°ï¼Œå†å¯¹è¾“å‡ºåº”ç”¨å¦ä¸€ä¸ªå‡½æ•°ã€‚ æ¯”å¦‚ï¼ŒFunction&lt;Integer, Integer&gt; f = x -&gt; x + 1;Function&lt;Integer, Integer&gt; g = x -&gt; x * 2;Function&lt;Integer, Integer&gt; h = f.andThen(g);int result = h.apply(1);æ•°å­¦ä¸Šä¼šå†™ä½œg(f(x))æˆ–(g o f)(x)è¿™å°†è¿”å›4composeæ–¹æ³•ï¼Œå…ˆæŠŠç»™å®šçš„å‡½æ•°ç”¨ä½œcomposeçš„å‚æ•°é‡Œé¢ç»™çš„é‚£ä¸ªå‡½ æ•°ï¼Œç„¶åå†æŠŠå‡½æ•°æœ¬èº«ç”¨äºç»“æœã€‚Function&lt;Integer, Integer&gt; f = x -&gt; x + 1;Function&lt;Integer, Integer&gt; g = x -&gt; x * 2;Function&lt;Integer, Integer&gt; h = f.compose(g);int result = h.apply(1);æ•°å­¦ä¸Šä¼šå†™ä½œf(g(x))æˆ–(f o g)(x) è¿™å°†è¿”å›3 8. å°ç»“ä»¥ä¸‹æ˜¯ä½ åº”ä»æœ¬ç« ä¸­å­¦åˆ°çš„å…³é”®æ¦‚å¿µã€‚ Lambdaè¡¨è¾¾å¼å¯ä»¥ç†è§£ä¸ºä¸€ç§åŒ¿åå‡½æ•°:å®ƒæ²¡æœ‰åç§°ï¼Œä½†æœ‰å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä¸»ä½“ã€è¿”å›ç±»å‹ï¼Œå¯èƒ½è¿˜æœ‰ä¸€ä¸ªå¯ä»¥æŠ›å‡ºçš„å¼‚å¸¸çš„åˆ—è¡¨ã€‚ Lambdaè¡¨è¾¾å¼è®©ä½ å¯ä»¥ç®€æ´åœ°ä¼ é€’ä»£ç ã€‚ å‡½æ•°å¼æ¥å£å°±æ˜¯ä»…ä»…å£°æ˜äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ã€‚ åªæœ‰åœ¨æ¥å—å‡½æ•°å¼æ¥å£çš„åœ°æ–¹æ‰å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼ã€‚ Lambdaè¡¨è¾¾å¼å…è®¸ä½ ç›´æ¥å†…è”ï¼Œä¸ºå‡½æ•°å¼æ¥å£çš„æŠ½è±¡æ–¹æ³•æä¾›å®ç°ï¼Œå¹¶ä¸”å°†æ•´ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‡½æ•°å¼æ¥å£çš„ä¸€ä¸ªå®ä¾‹ã€‚ Java 8è‡ªå¸¦ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼Œæ”¾åœ¨java.util.functionåŒ…é‡Œï¼ŒåŒ…æ‹¬Predicateã€Function&lt;T,R&gt;ã€Supplierã€Consumerå’ŒBinaryOperatorï¼Œå¦‚è¡¨3-2æ‰€è¿°ã€‚ ä¸ºäº†é¿å…è£…ç®±æ“ä½œï¼Œå¯¹Predicateå’ŒFunction&lt;T, R&gt;ç­‰é€šç”¨å‡½æ•°å¼æ¥å£çš„åŸå§‹ç±»å‹ç‰¹åŒ–:IntPredicateã€IntToLongFunctionç­‰ã€‚ ç¯ç»•æ‰§è¡Œæ¨¡å¼(å³åœ¨æ–¹æ³•æ‰€å¿…éœ€çš„ä»£ç ä¸­é—´ï¼Œä½ éœ€è¦æ‰§è¡Œç‚¹å„¿ä»€ä¹ˆæ“ä½œï¼Œæ¯”å¦‚èµ„æºåˆ†é… å’Œæ¸…ç†)å¯ä»¥é…åˆLambdaæé«˜çµæ´»æ€§å’Œå¯é‡ç”¨æ€§ã€‚ Lambdaè¡¨è¾¾å¼æ‰€éœ€è¦ä»£è¡¨çš„ç±»å‹ç§°ä¸ºç›®æ ‡ç±»å‹ã€‚ æ–¹æ³•å¼•ç”¨è®©ä½ é‡å¤ä½¿ç”¨ç°æœ‰çš„æ–¹æ³•å®ç°å¹¶ç›´æ¥ä¼ é€’å®ƒä»¬ã€‚ Comparatorã€Predicateå’ŒFunctionç­‰å‡½æ•°å¼æ¥å£éƒ½æœ‰å‡ ä¸ªå¯ä»¥ç”¨æ¥ç»“åˆLambdaè¡¨è¾¾å¼çš„é»˜è®¤æ–¹æ³•ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/07/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%203%EF%BC%9ALambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/"},{"title":"ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬¬äºŒç«  Java å†…å­˜åŒºåŸŸä¸å†…å­˜æº¢å‡ºå¼‚å¸¸","text":"è‘—åæ•°å­¦å®¶åç½—åºšå…ˆç”Ÿè¯´ï¼šâ€œè¯»ä¸€æœ¬ä¹¦è¦è¶Šè¯»è¶Šè–„ã€‚â€ä¹¦è¶Šè¯»è¶Šè–„çš„è¿‡ç¨‹ï¼Œå°±æ˜¯åœ¨å¤šæ¬¡é‡å¤é˜…è¯»ä¸­ä¸æ–­åˆ é™¤å†—ä½™ä¿¡æ¯çš„è¿‡ç¨‹ï¼Œæµ“ç¼©çš„ä¸»è¦åŠæ³•æ˜¯ï¼šåˆ—æçº²ä¸å†™æ¢—æ¦‚ã€‚å‰è€…å¿…é¡»åœ¨è®¤çœŸè¯»çš„åŸºç¡€ä¸Šï¼Œç†æ¸…æ–‡ç« çš„è„‰ç»œï¼Œç„¶åé€æ®µæ¦‚æ‹¬å†…å®¹ï¼›åè€…ä¹Ÿå¿…é¡»åå¤é˜…è¯»,æŒæ¡è¯¾æ–‡è¦ç‚¹ï¼Œå°†å†…å®¹åŠ ä»¥é«˜åº¦æµ“ç¼©ã€‚æµ“ç¼©æ³•å°±æ˜¯åšå­¦åçº¦ï¼Œåšç§¯è–„å‘ï¼ŒæŠŠåšä¹¦è¯»è–„ï¼ŒåˆæŠŠè–„ä¹¦ç§¯åšçš„è¯»ä¹¦æ–¹æ³•ã€‚ 2.1 æ¦‚è¿°ä»æ¦‚å¿µä¸Šä»‹ç» Java è™šæ‹Ÿæœºå†…å­˜çš„å„ä¸ªåŒºåŸŸï¼Œè®²è§£è¿™äº›åŒºåŸŸçš„ä½œç”¨ã€æœåŠ¡å¯¹è±¡ä»¥åŠå…¶ä¸­å¯èƒ½äº§ç”Ÿçš„é—®é¢˜ï¼Œè¿™æ˜¯ç¿»è¶Šè™šæ‹Ÿæœºå†…å­˜ç®¡ç†è¿™å µå›´å¢™çš„ç¬¬ä¸€æ­¥ã€‚ 2.2 è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ JVM å†…å­˜ç»“æ„çš„å¸ƒå±€å’Œç›¸åº”çš„æ§åˆ¶å‚æ•° : 2.2.1 ç¨‹åºè®¡æ•°å™¨ ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå›ºå®šå®½åº¦çš„æ•´æ•°çš„å­˜å‚¨ç©ºé—´ çº¿ç¨‹ç§æœ‰ å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ Java è™šæ‹Ÿæœºè§„èŒƒä¸­å”¯ä¸€ä¸€ä¸ªæ²¡æœ‰è§„å®š OutOfMemoryError çš„åŒºåŸŸ å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œ Java æ–¹æ³•ï¼Œå­˜å‚¨çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼›å¦‚æœæ­£åœ¨æ‰§è¡Œ Native æ–¹æ³•ï¼Œå…¶å€¼ä¸ºç©º(Undefined)ã€‚ ç»å…¸é—®é¢˜æ‰©å±• : Java ç¨‹åºè®¡æ•°å™¨ä¸ºä»€ä¹ˆä¸è§„å®š OutOfMemoryError ï¼Ÿ 2.2.2 Java è™šæ‹Ÿæœºæ ˆ(Java Virtual Machine Stacks) çº¿ç¨‹ç§æœ‰ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ è¿è¡Œ Java æ–¹æ³•( å­—èŠ‚ç  ) æœåŠ¡ æè¿°çš„æ˜¯ Java æ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ : æ ˆå¸§(Stack Frame)ï¼ŒåŒ…å«ï¼šå±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ StackOverflowError å¼‚å¸¸ï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼ŒæŠ›å‡ºæ­¤å¼‚å¸¸ OutOfMemoryError å¼‚å¸¸ï¼šå¦‚æœè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¦‚æœæ‰©å±•æ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼ŒæŠ›å‡ºæ­¤å¼‚å¸¸ 2.2.3 æœ¬åœ°æ–¹æ³•æ ˆ(Native Method Stack) çº¿ç¨‹ç§æœ‰ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ è¿è¡Œ Nativeæ–¹æ³•æœåŠ¡ ä¸Javaè™šæ‹Ÿæœºæ ˆç›¸ä¼¼ï¼Œä¹Ÿä¼šæŠ›å‡ºStackOverflowErrorå¼‚å¸¸å’ŒOutOfMemoryErrorå¼‚å¸¸ 2.2.4 Java å †(Java Heap) JVM æ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œåƒåœ¾å›æ”¶çš„ä¸»è¦æ“ä½œåŒºåŸŸ æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œè™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»º æ‰€æœ‰å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½è¦åœ¨å †ä¸Šåˆ†é…(éç»å¯¹ï¼ŒJIT å’Œé€ƒé€¸åˆ†ææŠ€æœ¯å‘å±•) ç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œé€»è¾‘ä¸Šæ˜¯è¿ç»­çš„ åˆ’åˆ†ä¸ºï¼šæ–°ç”Ÿä»£( Edenç©ºé—´ã€From Survivorç©ºé—´ã€To Survivorç©ºé—´ (åˆ†é…æ¯”ä¾‹ 8:1:1) )å’Œè€å¹´ä»£ æ§åˆ¶å‚æ•° -Xms è®¾ç½®å †çš„æœ€å°ç©ºé—´å¤§å° -Xmx è®¾ç½®å †çš„æœ€å¤§ç©ºé—´å¤§å° -XX:NewSize è®¾ç½®æ–°ç”Ÿä»£æœ€å°ç©ºé—´å¤§å° -XX:MaxNewSize è®¾ç½®æ–°ç”Ÿä»£æœ€å°ç©ºé—´å¤§å°ã€‚ OutOfMemoryErrorå¼‚å¸¸ï¼šå¦‚æœå †ä¸­æ²¡æœ‰å†…å­˜å®Œæˆå®ä¾‹åˆ†é…ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•æ‰©å±•ï¼ŒæŠ›å‡ºæ­¤å¼‚å¸¸ 2.2.5 æ–¹æ³•åŒº(Method Area) æ‰€æœ‰çº¿ç¨‹å…±äº« Java è™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œåˆ«åéå † Non-Heapï¼ŒåŒ…å«ï¼šç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ® HotSpot è™šæ‹Ÿæœºç§°ä¸ºâ€œæ°¸ä¹…ä»£â€(Permanent Generation) å›æ”¶æ•ˆç‡å¹¶ä¸é«˜ OutOfMemoryErrorå¼‚å¸¸ï¼šå½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼ŒæŠ›å‡ºæ­¤å¼‚å¸¸ 2.2.6 è¿è¡Œæ—¶å¸¸é‡æ± (Runtime Constant Pool) æ–¹æ³•åŒºä¸€éƒ¨åˆ†ï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº« å­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ OutOfMemoryError å¼‚å¸¸ï¼šæ–¹æ³•åŒºä¸€éƒ¨åˆ†ï¼Œå—åˆ°æ–¹æ³•åŒºå†…å­˜é™åˆ¶ï¼Œå½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶ï¼ŒæŠ›å‡ºæ­¤å¼‚å¸¸ æ‰©å±• æ·±å…¥è§£æString#intern 2.2.7 ç›´æ¥å†…å­˜(Direct Memory) å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯ Java è™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸ OutOfMemoryError å¼‚å¸¸ï¼šé…ç½®è™šæ‹Ÿæœºå‚æ•°æ—¶ï¼Œä½¿å¾—å„ä¸ªå†…å­˜åŒºåŸŸæ€»å’Œå¤§äºç‰©ç†å†…å­˜é™åˆ¶ï¼Œä»è€Œå¯¼è‡´åŠ¨æ€æ‰©å±•æ—¶å‡ºç°å¼‚å¸¸ 2.3 HotSpot è™šæ‹Ÿæœºå¯¹è±¡æ¢ç§˜2.3.1 å¯¹è±¡çš„åˆ›å»º ç±»åŠ è½½æ£€æŸ¥ï¼šnew ç±»åï¼Œæ ¹æ® new çš„å‚æ•°åœ¨å¸¸é‡æ± ä¸­å®šä½ä¸€ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªç¬¦å·å¼•ç”¨,è¯´æ˜ç±»è¿˜æœªåŠ è½½ï¼Œåˆ™è¿›è¡Œç±»çš„åŠ è½½/è§£æå’Œåˆå§‹åŒ–ã€‚ è™šæ‹Ÿæœºä¸ºå¯¹è±¡åˆ†é…å†…å­˜(ä½äºå †ä¸­) å°†åˆ†é…çš„å†…å­˜åˆå§‹åŒ–ä¸ºé›¶å€¼(ä¸åŒ…æ‹¬å¯¹è±¡å¤´)ï¼Œå¦‚æœä½¿ç”¨ TLAB ï¼Œè¿™ä¸€è¿‡ç¨‹å¯ä»¥æå‰è‡³ TLAB åˆ†é…æ—¶è¿›è¡Œ è°ƒç”¨å¯¹è±¡çš„&lt;init&gt;æ–¹æ³• å †å†…å­˜åˆ†é…ä¸¤ç§æ–¹å¼ï¼šæŒ‡é’ˆç¢°æ’(Bump the Pointer) : Java å †ä¸­çš„å†…å­˜æ˜¯è§„æ•´çš„ï¼Œæ‰€æœ‰ç”¨è¿‡çš„å†…å­˜éƒ½æ”¾åœ¨ä¸€è¾¹ï¼Œç©ºé—²çš„å†…å­˜æ”¾åœ¨å¦ä¸€è¾¹ï¼Œä¸­é—´æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºåˆ†ç•Œç‚¹çš„æŒ‡ç¤ºå™¨ï¼Œåˆ†é…å†…å­˜ä¹Ÿå°±æ˜¯æŠŠæŒ‡é’ˆå‘ç©ºé—²ç©ºé—´é‚£è¾¹ç§»åŠ¨ä¸€æ®µä¸å†…å­˜å¤§å°ç›¸ç­‰çš„è·ç¦»ã€‚ä¾‹å¦‚ï¼šSerialã€ParNew ç­‰æ”¶é›†å™¨ã€‚ç©ºé—²åˆ—è¡¨(Free List) : Java å †ä¸­çš„å†…å­˜ä¸æ˜¯è§„æ•´çš„ï¼Œå·²ä½¿ç”¨çš„å†…å­˜å’Œç©ºé—²çš„å†…å­˜ç›¸äº’äº¤é”™ï¼Œå°±æ²¡æœ‰åŠæ³•ç®€å•çš„è¿›è¡ŒæŒ‡é’ˆç¢°æ’äº†ã€‚è™šæ‹Ÿæœºå¿…é¡»ç»´æŠ¤ä¸€å¼ åˆ—è¡¨ï¼Œè®°å½•å“ªäº›å†…å­˜å—æ˜¯å¯ç”¨çš„ï¼Œåœ¨åˆ†é…çš„æ—¶å€™ä»åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´åˆ’åˆ†ç»™å¯¹è±¡å®ä¾‹ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ã€‚ä¾‹å¦‚ï¼šCMS è¿™ç§åŸºäº Mark-Sweep ç®—æ³•çš„æ”¶é›†å™¨ã€‚ å †å†…å­˜åˆ†é…å¹¶å‘è§£å†³æ–¹æ¡ˆï¼šå¯¹åˆ†é…å†…å­˜ç©ºé—´çš„åŠ¨ä½œè¿›è¡ŒåŒæ­¥å¤„ç†ï¼Œå®é™…ä¸Šè™šæ‹Ÿæœºé‡‡ç”¨ CAS é…ä¸Šå¤±è´¥é‡è¯•çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ã€‚æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†² TLAB (Thread Local Allocation Buffer)ï¼ŒæŠŠå†…å­˜åˆ†é…çš„åŠ¨ä½œæŒ‰ç…§çº¿ç¨‹åˆ’åˆ†ä¸ºåœ¨ä¸åŒçš„ç©ºé—´ä¹‹ä¸­è¿›è¡Œï¼Œå³æ¯ä¸ªçº¿ç¨‹åœ¨Javaå †ä¸­é¢„å…ˆåˆ†é…ä¸€å°å—å†…å­˜ï¼Œç§°ä¸ºæœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²(TLAB)ã€‚å“ªä¸ªçº¿ç¨‹è¦åˆ†é…å†…å­˜ï¼Œå°±åœ¨å“ªä¸ªçº¿ç¨‹çš„TLABä¸Šåˆ†é…ã€‚åªæœ‰TLABç”¨å®Œå¹¶åˆ†é…æ–°çš„TLABæ—¶ï¼Œæ‰éœ€è¦åŒæ­¥é”å®šã€‚ 2.3.2 å¯¹è±¡çš„å†…å­˜å¸ƒå±€ å¯¹è±¡å¤´( Header ) å¯¹è±¡è‡ªèº«è¿è¡Œæ—¶æ•°æ® ( Mark Word )ï¼ŒåŒ…å«ï¼šå“ˆå¸Œç  / GCåˆ†ä»£å¹´é¾„ / é”çŠ¶æ€æ ‡å¿— / çº¿ç¨‹æŒæœ‰çš„é” / åå‘çº¿ç¨‹ID / åå‘æ—¶é—´æˆ³ ç±»å‹æŒ‡é’ˆï¼šå¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ å®ä¾‹æ•°æ®( Instance Data ) å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ ç¨‹åºä»£ç ä¸­å®šä¹‰çš„å„ç§ç±»å‹çš„å­—æ®µå†…å®¹ HotSpot è™šæ‹Ÿæœºé»˜è®¤åˆ†é…ç­–ç•¥ï¼šlongs/doubles/ints/shorts/chars/bytes/booleans/oops(Oridinary Object Pointers) å¯¹é½å¡«å……( Padding ),å¹¶ä¸æ˜¯å¿…ç„¶å­˜åœ¨çš„ï¼Œä»…ä»…èµ·ç€å ä½ç¬¦çš„ä½œç”¨ã€‚ 2.3.2 å¯¹è±¡çš„è®¿é—®å®šä½ ä½¿ç”¨å¥æŸ„ï¼šJava å †ä¸­åˆ†é…ä¸€å—å†…å­˜,reference ä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡å¥æŸ„åœ°å€,ä½¿ç”¨å¥æŸ„æ¥è®¿é—®çš„æœ€å¤§å¥½å¤„å°±æ˜¯ reference ä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­å®ä¾‹æ•°æ®åœ°å€ï¼Œreference æœ¬èº«ä¸ç”¨æ”¹å˜ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç›´æ¥æŒ‡é’ˆï¼šJava å †ä¸­åˆ†é…ä¸€å—å†…å­˜ï¼Œreference ä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡å®ä¾‹åœ°å€ï¼ŒHostSpot ä½¿ç”¨æ­¤ç§æ–¹å¼ï¼ŒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ï¼Œæå‡äº†é€Ÿåº¦ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 2.4 å®æˆ˜ï¼šOutOfMemoryError å¼‚å¸¸ MacBook Pro Retina, 2.6 GHz Intel Core i7, 16 GB 2133 MHz LPDDR3, OS X Yosemite JDK 1.8 2.4.1 Java å †æº¢å‡º12345678910111213141516171819/** * Java å †å†…å­˜æº¢å‡º * VM Args: -Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryError * @author lujiahao * @date 2018-12-21 14:47 */public class HeapOOM { static class OOMObject { } public static void main(String[] args) { List&lt;OOMObject&gt; list = new ArrayList&lt;&gt;(); while (true) { list.add(new OOMObject()); System.out.println(list.size()); } }} 12345678910111213java.lang.OutOfMemoryError: Java heap spaceDumping heap to java_pid1439.hprof ...Heap dump file created [28440089 bytes in 0.115 secs]Exception in thread \"main\" java.lang.OutOfMemoryError: Java heap space at java.util.Arrays.copyOf(Arrays.java:3210) at java.util.Arrays.copyOf(Arrays.java:3181) at java.util.ArrayList.grow(ArrayList.java:265) at java.util.ArrayList.ensureExplicitCapacity(ArrayList.java:239) at java.util.ArrayList.ensureCapacityInternal(ArrayList.java:231) at java.util.ArrayList.add(ArrayList.java:462) at OutOfMemory.HeapOOM.main(HeapOOM.java:20)Process finished with exit code 1 2.4.2 è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæº¢å‡º123456789101112131415161718192021222324/** * è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæº¢å‡º * VM Args: -Xss128k * @author lujiahao * @date 2018-12-21 17:02 */public class JavaVMStackSOF { private int stackLength = 1; public void stackLeak() { stackLength++; stackLeak(); } public static void main(String[] args) { JavaVMStackSOF oom = new JavaVMStackSOF(); try { oom.stackLeak(); } catch (Throwable e) { System.out.println(\"stack length:\" + oom.stackLength); throw e; } }} 1234è®¾ç½®128k,å¯åŠ¨ä¼šæŠ¥ä¸‹é¢çš„é—®é¢˜The stack size specified is too small, Specify at least 160kError: Could not create the Java Virtual Machine.Error: A fatal exception has occurred. Program will exit. 12345ä¿®æ”¹ä¸º161kï¼Œå®ç°æ•ˆæœstack length:7738Exception in thread \"main\" java.lang.StackOverflowError at OutOfMemory.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:22) at OutOfMemory.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:22) 123456789101112131415161718192021222324252627282930/** * åˆ›å»ºçº¿ç¨‹å¯¼è‡´å†…å­˜æº¢å‡º å±é™©!!! å¯èƒ½å¯¼è‡´æ­»æœº,æˆ‘å°±ä¸è½»æ˜“å°è¯•äº† * VM Args: -Xss2M * @author lujiahao * @date 2018-12-21 17:11 */public class JavaVMStackOOM { private void dontStop() { while (true) { } } public void stackLeakByThread() { while (true) { Thread thread = new Thread(new Runnable() { @Override public void run() { dontStop(); } }); thread.start(); } } public static void main(String[] args) { JavaVMStackOOM oom = new JavaVMStackOOM(); oom.stackLeakByThread(); }} 2.4.3 æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡º1234567891011121314151617181920212223/** * è¿è¡Œæ—¶å¸¸é‡æ± å¯¼è‡´å†…å­˜æº¢å‡º * VM Args: -XX:PermSize=10m -XX:MaxPermSize=10M * jdk1.6 * * ä½¿ç”¨æ–°ç‰ˆæœ¬çš„jdkä¼šè¾“å‡º: * Java HotSpot(TM) 64-Bit Server VM warning: ignoring option PermSize=10m; support was removed in 8.0 * Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=10M; support was removed in 8.0 * * @author lujiahao * @date 2018-12-21 17:33 */public class RuntimeConstantPoolOOM { public static void main(String[] args) { // ä½¿ç”¨Listä¿æŒç‚¸å¸¸é‡æ± å¼•ç”¨,é¿å…Full GCå›æ”¶å¸¸é‡æ± è¡Œä¸º List&lt;String&gt; list = new ArrayList&lt;&gt;(); // 10MBçš„PermSizeåœ¨IntegerèŒƒå›´å†…è¶³å¤Ÿäº§ç”ŸOOMäº† int i = 0; while (true) { list.add(String.valueOf(i++).intern()); } }} 1234567891011121314151617181920212223/** * å€ŸåŠ©CGLibä½¿æ–¹æ³•åŒºå‡ºç°å†…å­˜æº¢å‡º * VM Args: -XX:PermSize=10M -XX:MaxPermSize=10M * @author lujiahao * @date 2018-12-21 17:40 */public class JavaMethodAreaOOM { static class OOMObject{} public static void main(String[] args) { while (true) { Enhancer enhancer = new Enhancer(); enhancer.setSuperclass(OOMObject.class); enhancer.setUseCache(false); enhancer.setCallback(new MethodInterceptor() { @Override public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable { return methodProxy.invokeSuper(objects, args); } }); enhancer.create(); } }} 2.4.4 æœ¬æœºç›´æ¥å†…å­˜æº¢å‡º123456789101112131415161718/** * æœ¬æœºç›´æ¥å†…å­˜æº¢å‡º(ä½¿ç”¨unsafeåˆ†é…æœ¬æœºå†…å­˜) * VM Args: -Xmx20M -XX:MaxDirectMemorySize=10M * @author lujiahao * @date 2018-12-21 17:51 */public class DirectMemoryOOM { public static final int _1MB = 1024 * 1024; public static void main(String[] args) throws Exception{ Field unsafeField = Unsafe.class.getDeclaredFields()[0]; unsafeField.setAccessible(true); Unsafe unsafe = (Unsafe) unsafeField.get(null); while (true) { unsafe.allocateMemory(_1MB); } }} æ¬¢è¿å¤§å®¶å…³æ³¨ğŸ˜","link":"/2019/01/11/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E3%80%8B%E7%AC%AC%E4%BA%8C%E7%AB%A0%20Java%E5%86%85%E5%AD%98%E5%8C%BA%E5%9F%9F%E4%B8%8E%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA%E5%BC%82%E5%B8%B8/"},{"title":"19-JavaWebåŸºç¡€-Filter","text":"1. ä»‹ç»å½“è®¿é—®èµ„æºæ—¶ï¼Œå¦‚æœä¸å¸Œæœ›æ­¤èµ„æºè¢«è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨è¿›è¡Œæ‹¦æˆªã€‚è®¿é—®ä¸€ä¸ªèµ„æºï¼Œéœ€è¦è·¯å¾„ï¼Œè¿‡æ»¤å™¨é€šè¿‡è·¯å¾„åŒ¹é…è¿›è¡Œèµ„æºæ‹¦æˆªã€‚è¿‡æ»¤å™¨å¿…é¡»å®ç°æ¥å£ï¼šjavax.servlet.Filter Filter init(FilterConfig):void åˆå§‹åŒ– doFilter(ServletRequest,ServletResponse,FilterChain):void è¿‡æ»¤æ–¹æ³• destroy():void é”€æ¯é»˜è®¤æƒ…å†µä¸‹è¿‡æ»¤å™¨ä¼šæ‹¦æˆªåŒ¹é…è·¯å¾„å’Œæ‰§è¡Œçš„èµ„æºéœ€è¦æ‰‹åŠ¨æ”¾è¡Œ:chain.doFilter(request,response); 2.ä½¿ç”¨æ–¹æ³•è¯¦è§ç»Ÿè®¡è®¿é—®æ¬¡æ•°çš„æ¡ˆä¾‹ 3.ç”Ÿå‘½å‘¨æœŸ3.1 init(FilterConfig) åˆå§‹åŒ–æ–¹æ³• æ‰§è¡Œæ—¶æœºï¼šæœåŠ¡å™¨å¯åŠ¨æ—¶æ‰§è¡Œ æ‰§è¡Œè€…ï¼štomcat FilterConfigï¼šå½“å‰è¿‡æ»¤å™¨çš„é…ç½®å¯¹è±¡ getFilterName():String è¿‡æ»¤åç§°,ç›¸å½“äº&lt;filter-name&gt;æ ‡ç­¾ getServletContext():ServletContext ServletContextå¯¹è±¡å¼•ç”¨ getInitParametes(String):String è·å¾—è¿‡æ»¤å™¨åˆå§‹åŒ–å‚æ•° getInitParameterNames():Enumeration è·å¾—è¿‡æ»¤å™¨åˆå§‹åŒ–å‚æ•°çš„æ‰€æœ‰åå­— &lt;filter&gt; &lt;filter-name&gt;CountFilter&lt;/filter-name&gt; &lt;filter-class&gt;com.lujiahao.cms.filter.CountFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/filter&gt;3.2 doFilter(ServletRequest,ServletResponse ,FilterChain) è·¯å¾„åŒ¹é…ä¸€æ¬¡æ‰§è¡Œä¸€æ¬¡ã€‚ä¸€æ¬¡è¯·æ±‚æ‹¦æˆªä¸€æ¬¡ã€‚3.3 destroy() æ‰§è¡Œæ—¶æœºï¼šæœåŠ¡å™¨æ­£å¸¸å…³é—­æ—¶æ‰§è¡Œ æ‰§è¡Œè€…ï¼štomcat4.doFilteræ–¹æ³•è¯¦è§£å‚æ•°1ServletRequest å’Œå‚æ•°2 ServletResponse å›é¡¾ï¼šObject List ArrayList ServletRequest HttpServletRequest tomcatå®ç°ç±» ç»“è®ºï¼šå¯ä»¥å¼ºè½¬è·å¾—Httpåè®®æœ‰å…³å¯¹è±¡ HttpServletRequest request = ï¼ˆHttpServletRequestï¼‰ req; HttpServletResponse request = ï¼ˆHttpServletResponseï¼‰ res;å‚æ•°3ï¼šFilterChain FilterChain è¿‡æ»¤å™¨é“¾ï¼Œå½“è¯·æ±‚èµ„æºæ—¶ï¼Œå¤šä¸ªè¿‡æ»¤å™¨éƒ½ç”Ÿæ•ˆï¼Œtomcatå°†ç”Ÿæˆä¸€ä¸ªé“¾ï¼Œç”¨äºå­˜æ”¾å¤šä¸ªè¿‡æ»¤å™¨ã€‚ ç¬¬ä¸€ä¸ªè¿‡æ»¤å™¨æ‰§è¡Œå®Œæˆï¼Œå¹¶å‘è¡Œæ—¶ï¼Œå°†æ‰§è¡Œç¬¬äºŒä¸ªè¿‡æ»¤å™¨ï¼Œã€‚ã€‚ã€‚ã€‚ã€‚å½“æœ€åä¸€ä¸ªè¿‡æ»¤å™¨æ”¾è¡Œæ—¶ï¼Œå°†æ‰§è¡Œèµ„æºã€‚ è¿‡æ»¤å™¨é“¾ä¸­ è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº ä¸ æ˜ å°„åœ¨web.xmlé…ç½®é¡ºåºä¸€è‡´çš„ã€‚web.xml å…ˆé…ç½®å…ˆæ‰§è¡Œ 5.&lt;url-pattern&gt;åŒ¹é…è·¯å¾„å›é¡¾ï¼šservletè·¯å¾„é…ç½® 1.å®Œå…¨åŒ¹é…ï¼Œå¿…é¡»/å¼€å¤´ ï¼Œä¾‹å¦‚ï¼š/a/b/c/oneServlet 2.ä¸å®Œå…¨åŒ¹é…ï¼Œä»¥/å¼€å¤´ *ç»“å°¾ï¼Œä¾‹å¦‚ï¼š/a/b/* , /* 3.é€šé…ç¬¦åŒ¹é…. *.å¼€å¤´ï¼Œä¾‹å¦‚ï¼š *.jsp ã€ *.do ã€*.action ç­‰ 4 ç¼ºçœ / ä»¥ä¸Šéƒ½æ²¡æœ‰åŒ¹é…å°†æ‰§è¡Œã€‚è¿‡æ»¤å™¨è·¯å¾„ç¼–å†™ï¼Œä¸servletä¸€è‡´çš„ï¼Œè¿‡æ»¤å™¨è¿‡æ»¤çš„å°±æ˜¯æŒ‡å®šservletã€‚ /oneServlet ã€ /twoServlet /* è¿‡æ»¤å™¨ å°†åŒ¹é…ä»¥ä¸Šä¸¤ä¸ªservlet6.dispatcheré…ç½® ç”¨äºé…ç½®è¿‡æ»¤å™¨åœ¨ä½•å¤„è¿›è¡Œæ‹¦æˆªã€‚ å–å€¼ï¼š REQUESTã€ FORWARDã€ INCLUDEã€ERROR request : è¡¨ç¤ºåœ¨è¯·æ±‚å¼€å§‹æ—¶æ‹¦æˆªã€‚é»˜è®¤å€¼ã€‚ forwardï¼šè¡¨ç¤ºåœ¨è¯·æ±‚è½¬å‘å¼€å§‹æ—¶æ‹¦æˆªã€‚åŠ request.getRequestDistacher(..).forward è¢«è°ƒç”¨æ—¶ã€‚ includeï¼šè¡¨ç¤ºåœ¨è¯·æ±‚åŒ…å«å¼€å§‹æ—¶æ‹¦æˆªã€‚åŠ request.getRequestDistacher(..).include è¢«è°ƒç”¨æ—¶ã€‚ error ï¼š è¡¨ç¤ºç¨‹åºå¼‚å¸¸ï¼Œæ˜¾ç¤ºå‹å¥½é¡µé¢ä¹‹å‰æ‹¦æˆªã€‚æ¡ˆä¾‹ã€‡ : dispatcheré…ç½®å‹å¥½é”™è¯¯é¡µé¢IEä¼šå°†500çš„é”™è¯¯ä»¥ä»–è‡ªå·±çš„æ–¹å¼å±•ç°å‡ºæ¥,è¿™å°±ä¸ç¬¦åˆéœ€æ±‚,æ‰€ä»¥éœ€è¦æ‰‹åŠ¨é…ç½®å‹å¥½é”™è¯¯é¡µé¢.å¦‚æœæœ‰å¤šä¸ªå‹å¥½é”™è¯¯ç•Œé¢,ä¸èƒ½åœ¨æ¯ä¸ªjspé¡µé¢æ›´æ”¹çŠ¶æ€ç ,è¿™å°±éœ€è¦ä¸€ä¸ªè¿‡æ»¤å™¨æ¥ç»Ÿä¸€è¿‡æ»¤. 1.åˆ›å»ºFriendErrorFilterå®ç°javax.servlet.Filteræ¥å£ /** * å‹å¥½é”™è¯¯ç•Œé¢è¿‡æ»¤å™¨ * Created by lujiahao on 2016/7/27. */ public class FriendErrorFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; HttpServletResponse response = (HttpServletResponse) servletResponse; // ä¿®æ”¹çŠ¶æ€ç  response.setStatus(200); // æ”¾è¡Œ filterChain.doFilter(request,response); } @Override public void destroy() { } }2.é…ç½®åˆ°tomcat(web.xml) &lt;!--é…ç½®å‹å¥½é”™è¯¯é¡µé¢è¿‡æ»¤å™¨--&gt; &lt;error-page&gt; &lt;error-code&gt;500&lt;/error-code&gt; &lt;location&gt;/demo0/frienderror.jsp&lt;/location&gt; &lt;/error-page&gt; &lt;!--å‹å¥½é”™è¯¯é¡µé¢è¿‡æ»¤å™¨--&gt; &lt;filter&gt; &lt;filter-name&gt;FriendErrorFilter&lt;/filter-name&gt; &lt;filter-class&gt;com.lujiahao.filter.FriendErrorFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;FriendErrorFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/frienderror.jsp&lt;/url-pattern&gt; &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt; &lt;/filter-mapping&gt;3.ç¼–å†™å‹å¥½é”™è¯¯ç•Œé¢(error.jsp) &lt;html&gt; &lt;head&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; æˆ‘æ˜¯å‹å¥½é”™è¯¯ç•Œé¢&lt;br/&gt; æœåŠ¡å™¨ç¹å¿™,è¯·ç¨åé‡è¯• &lt;/body&gt; &lt;/html&gt;4.æ¨¡æ‹ŸæœåŠ¡å™¨500é”™è¯¯ &lt;% int i = 1/0; %&gt;æ¡ˆä¾‹ä¸€ : ç»Ÿè®¡è®¿é—®æ¬¡æ•°åŸç†:å°†æ•°æ®è®°å½•åˆ°ServletContext æ‰€æœ‰ç”¨æˆ·å…±äº« 1.åˆ›å»ºCountFilterå®ç°javax.servlet.Filteræ¥å£ /** * ç»Ÿè®¡æ¬¡æ•°çš„è¿‡æ»¤å™¨ * Created by lujiahao on 2016/7/27. */ public class CountFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; HttpServletResponse response = (HttpServletResponse) servletResponse; // è·å¾—è®¿é—®è·¯å¾„ /pages/main/main.jsp String servletPath = request.getServletPath(); String filePath = servletPath.substring(servletPath.lastIndexOf(&quot;/&quot;)+1,servletPath.lastIndexOf(&quot;.&quot;)); // è·å¾—servletContextè·å–ç»Ÿè®¡æ•°æ® ServletContext servletContext = request.getSession().getServletContext(); Integer num = (Integer) servletContext.getAttribute(filePath); if (num == null) { num = 1;// ç¬¬ä¸€æ¬¡è®¿é—® } else { num ++; } // å­˜æ”¾åˆ°ServletContextä¸­ servletContext.setAttribute(filePath,num); // æ”¾è¡Œ filterChain.doFilter(request,response); } @Override public void destroy() { } }2.é…ç½®åˆ°tomcat(web.xml) &lt;!--ç»Ÿè®¡æ¬¡æ•°çš„è¿‡æ»¤å™¨--&gt; &lt;filter&gt; &lt;filter-name&gt;CountFilter&lt;/filter-name&gt; &lt;filter-class&gt;com.lujiahao.cms.filter.CountFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;CountFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/pages/main/main.jsp&lt;/url-pattern&gt; &lt;/filter-mapping&gt;3.JSPä¸­ä½¿ç”¨ è®¿é—®æ¬¡æ•°:${applicationScope.main}æ¬¡&lt;br/&gt;æ¡ˆä¾‹ä¸‰ : è‡ªåŠ¨ç™»å½•åŸç†å›¾: 1.ä¿®æ”¹ä»¥å‰çš„ç™»å½•é€»è¾‘,æ·»åŠ å¯¹è‡ªåŠ¨ç™»å½•çš„æ ‡è®° /** * ç™»å½•æ“ä½œ */ private void login(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { // 1.è·å–æ•°æ®å¹¶å°è£… Customer customer = LBeanUtils.populate(Customer.class, request.getParameterMap()); // 2.é€šçŸ¥serviceè¿›è¡Œç™»å½• CustomerServeice customerServeice = new CustomerServiceImpl(); Customer loginCustomer = customerServeice.login(customer); // 3.å¤„ç† if (loginCustomer != null) { // -------------è‡ªåŠ¨ç™»å½•start------------- // checkboxé€‰ä¸­çš„è¯è·å¾—çš„å€¼æ˜¯on String autologin = request.getParameter(&quot;autologin&quot;); if (autologin != null) { // å‹¾é€‰äº†è®°ä½å¯†ç , ä½¿ç”¨cookieå°†ç”¨æˆ·çš„ç™»å½•åå’Œå¯†ç å‘é€åˆ°æµè§ˆå™¨,å¹¶é€šçŸ¥æµè§ˆå™¨ä¿å­˜(æŒä¹…åŒ–cookie) // 1.åˆ›å»ºcookieå¯¹è±¡ String username = URLEncoder.encode(loginCustomer.getName(), &quot;UTF-8&quot;); String password = URLEncoder.encode(loginCustomer.getPwd(), &quot;UTF-8&quot;); // å­˜å…¥éœ€è¦è¿›è¡ŒURLEndodeç¼–ç ,ä¸ç„¶ä¼šæŠ¥é”™:http://blog.csdn.net/liuxiao723846/article/details/22155393 Cookie cookie = new Cookie(&quot;autoLoginCookie&quot;, username + &quot;&amp;&quot; + password); // 2.è®¾ç½®æœ‰æ•ˆæ—¶é—´ cookie.setMaxAge(60 * 60);// 1å°æ—¶ // 3.è®¾ç½®è·¯å¾„ cookie.setPath(&quot;/&quot;); // 4.å‘é€cookie response.addCookie(cookie); } // -------------è‡ªåŠ¨ç™»å½•end------------- // æˆåŠŸ -- sessionè®°å½•ç™»å½•çŠ¶æ€,é‡å®šå‘åˆ°ä¸»é¡µé¢ // * sessionä½œç”¨åŸŸä¿å­˜æ•°æ® request.getSession().setAttribute(&quot;loginCustomer&quot;, loginCustomer); response.sendRedirect(request.getContextPath() + &quot;/pages/main/main.jsp&quot;); } else { // ä¸æˆåŠŸ --- requestè®°å½•å½“æ¬¡è¯·æ±‚æç¤º,è¯·æ±‚è½¬å‘åˆ°login.jsp æ˜¾ç¤ºæ•°æ® request.setAttribute(&quot;msg&quot;, &quot;ç”¨æˆ·åå’Œå¯†ç ä¸åŒ¹é…&quot;); request.setAttribute(&quot;customer&quot;, customer);// å›æ˜¾æ•°æ® request.getRequestDispatcher(&quot;pages/login/login.jsp&quot;).forward(request, response); } }2.ç¼–å†™è‡ªåŠ¨ç™»å½•çš„è¿‡æ»¤å™¨ /** * è‡ªåŠ¨ç™»å½•çš„è¿‡æ»¤å™¨ * Created by lujiahao on 2016/7/27. */ public class AutoLoginFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; HttpServletResponse response = (HttpServletResponse) servletResponse; Customer loginCustomer = (Customer) request.getSession().getAttribute(&quot;loginCustomer&quot;); // 1.å·²ç»ç™»å½• if (loginCustomer != null) { filterChain.doFilter(request,response); return; } // 2.æ²¡æœ‰ç™»å½•,è·å–cookieä¿¡æ¯ Cookie[] allCookie = request.getCookies(); String cookieValue = null; if (allCookie != null) { for (Cookie cookie : allCookie) { if (&quot;autoLoginCookie&quot;.equals(cookie.getName())) { cookieValue = cookie.getValue(); break;// ä¸€æ—¦æŸ¥è¯¢åˆ°äº†å°±è·³å‡ºå¾ªç¯,æå‡æ€§èƒ½ } } } // 3.æ²¡æœ‰cookieä¿¡æ¯ if (cookieValue == null) { filterChain.doFilter(request,response); return; } // 4.æŸ¥è¯¢åˆ°cookieä¿¡æ¯,è·å¾—ç”¨æˆ·æ•°æ® String username = URLDecoder.decode(cookieValue.split(&quot;&amp;&quot;)[0],&quot;UTF-8&quot;); String password = URLDecoder.decode(cookieValue.split(&quot;&amp;&quot;)[1],&quot;UTF-8&quot;); Customer customer = new Customer(username,password); // 5.æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ CustomerServeice customerServeice = new CustomerServiceImpl(); loginCustomer = customerServeice.login(customer); // 6.æ²¡æœ‰æŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯----ä¾‹å¦‚:å¯†ç ä¿®æ”¹ if (loginCustomer == null) { filterChain.doFilter(request,response); // åº”è¯¥åˆ é™¤cookie Cookie cookie = new Cookie(&quot;autoLoginCookie&quot;,&quot;&quot;); cookie.setMaxAge(0);// åˆ é™¤ cookie.setPath(&quot;/&quot;);// ä¿å­˜çš„æ—¶å€™å†™çš„è·¯å¾„è¦å’Œè¿™é‡Œä¸€æ · response.addCookie(cookie); return; } // 7.æŸ¥è¯¢åˆ°ç”¨æˆ·ä¿¡æ¯,æ‰§è¡Œè‡ªåŠ¨ç™»å½• request.getSession().setAttribute(&quot;loginCustomer&quot;,loginCustomer); // æ”¾è¡Œ filterChain.doFilter(request,response); } @Override public void destroy() { } }æ¡ˆä¾‹å›› : GET/POSTä¸­æ–‡ä¹±ç ç»Ÿä¸€å¤„ç†1.æ—§çš„å¤„ç†æ–¹å¼: public class GetPostServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { /* String username = request.getParameter(&quot;username&quot;); String password = request.getParameter(&quot;password&quot;); //å¤„ç†ç¼–ç  username = new String(username.getBytes(&quot;ISO8859-1&quot;),&quot;UTF-8&quot;); password = new String(password.getBytes(&quot;ISO8859-1&quot;),&quot;UTF-8&quot;); System.out.println(&quot;get:&quot;); System.out.println(username); System.out.println(password); */ this.doPost(request, response); } @Override protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { //postè¯·æ±‚ä¹±ç  //request.setCharacterEncoding(&quot;UTF-8&quot;); String username = request.getParameter(&quot;username&quot;); String password = request.getParameter(&quot;password&quot;); System.out.println(&quot;post:&quot;); System.out.println(username); System.out.println(password); } }2.ä½¿ç”¨è¿‡æ»¤å™¨+è£…é¥°ç€æ¨¡å¼çš„å¤„ç†æ–¹å¼: /** * å¤„ç†Get/Postè¯·æ±‚ä¹±ç çš„è¿‡æ»¤å™¨ * Created by lujiahao on 2016/7/27. */ public class GetPostEncodingFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { } @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) servletRequest; HttpServletResponse response = (HttpServletResponse) servletResponse; //ç¼–ç è®¾ç½® å¦ä¸€ä¸ªfilterç¼–å†™ è¿™ä¸ªåªèƒ½è§£å†³POSTä¹±ç çš„é—®é¢˜ request.setCharacterEncoding(&quot;UTF-8&quot;); // è¿™ä¸ªé‡Œé¢æœ‰å¤„ç†GETä¹±ç  // ä½¿ç”¨è£…é¥°è€…æ¨¡å¼å¢å¼ºçš„request MyRequest myRequest = new MyRequest(request); // æ”¾è¡Œ filterChain.doFilter(myRequest,response); } @Override public void destroy() { } } /** * ä½¿ç”¨è£…é¥°è€…è®¾è®¡æ¨¡å¼ * HttpServletRequestWrapperæ˜¯ç³»ç»Ÿä¸ºæˆ‘ä»¬å‡†å¤‡å¥½çš„è£…é¥°è€…çš„çˆ¶ç±»,å·²ç»å®Œæˆäº†ç›¸åº”çš„å·¥ä½œ * Created by lujiahao on 2016/7/27. */ public class MyRequest extends HttpServletRequestWrapper { private boolean isEncoding = false;// é»˜è®¤æ˜¯æ²¡æœ‰ç¼–ç çš„ private HttpServletRequest request; public MyRequest(HttpServletRequest request) { super(request);// å°†tomcatçš„requestä¼ å…¥çˆ¶ç±»,æä¾›ç»™ä¸éœ€è¦å¢å¼ºçš„æ–¹æ³•ä½¿ç”¨ this.request = request; } // éœ€è¦å¢å¼ºçš„æ–¹æ³•ç›´æ¥è¦†å†™çˆ¶ç±»æ–¹æ³•å°±å¥½äº† // é€šè¿‡åç§°è·å¾—ç¬¬ä¸€ä¸ªå€¼ @Override public String getParameter(String name) { String[] parameterValues = this.getParameterValues(name); if (parameterValues == null) { return null; } return parameterValues[0]; } // é€šè¿‡åç§°è·å¾—æ‰€æœ‰çš„å€¼ @Override public String[] getParameterValues(String name) { return this.getParameterMap().get(name); } @Override public Map&lt;String, String[]&gt; getParameterMap() { // 1.è·å¾—tomcatåŸå§‹æ•°æ® Map&lt;String, String[]&gt; map = request.getParameterMap(); // 2.å¤„ç†getè¯·æ±‚çš„ä¹±ç  if (&quot;GET&quot;.equals(request.getMethod()) &amp;&amp; !isEncoding) { // 3.éå†map for(Map.Entry&lt;String,String[]&gt; entry : map.entrySet()){ // 4.è·å¾—æ‰€æœ‰valueæ•°æ® String[] value = entry.getValue(); // å¤„ç†æ‰€æœ‰ä¹±ç  for (int i = 0; i &lt; value.length; i++) { try { value[i] = new String(value[i].getBytes(&quot;ISO-8859-1&quot;),&quot;UTF-8&quot;); } catch (UnsupportedEncodingException e) { throw new RuntimeException(e); } } } isEncoding = true;// å·²ç»è§£å†³å®Œä¹±ç å°±ä¸è¦å†æ¬¡è§£å†³äº† } return map; } }æ¡ˆä¾‹äº” : é¡µé¢é™æ€åŒ– &amp; å…¨æ ˆå‹ç¼©é¡µé¢é™æ€åŒ–åŸç†å›¾:1.è£…é¥°è€…æ¨¡å¼å¢å¼ºHttpServletResponse public class MyResponse extends HttpServletResponseWrapper{ private HttpServletResponse response; //æä¾›è‡ªå®šä¹‰ç¼“å­˜ private ByteArrayOutputStream baos = new ByteArrayOutputStream(); private PrintWriter pw = null; public MyResponse(HttpServletResponse response) { super(response); this.response = response; } @Override public PrintWriter getWriter() throws IOException { if(pw == null){ pw = new PrintWriter(new OutputStreamWriter(baos , &quot;UTF-8&quot; )); System.out.println(&quot;æ‰§è¡Œ&quot; + pw); } return pw; } /** * è·å¾—è‡ªå®šä¹‰ç¼“å­˜å†…å®¹ * @return */ public byte[] getData(){ return baos.toByteArray(); } }2.è¿‡æ»¤å™¨å†™æ³• public class PageStaticFilter implements Filter { @Override public void init(FilterConfig filterConfig) throws ServletException { } @Override public void doFilter(ServletRequest req, ServletResponse resp, FilterChain chain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) req; HttpServletResponse response = (HttpServletResponse) resp; //1 è·å¾—é¡µé¢ä½ç½® //D:\\java\\tomcat\\apache-tomcat-7.0.53\\webapps\\day19_demo\\demo04\\1.html ServletContext sc = request.getSession().getServletContext(); String id= request.getParameter(&quot;id&quot;); String path = &quot;/demo04/&quot;+id+&quot;.html&quot;;// é™æ€é¡µé¢å­˜æ”¾çš„ä½ç½® String htmlPath = sc.getRealPath(path); //2 æ–‡ä»¶æ˜¯å¦å­˜åœ¨ File htmlFile = new File(htmlPath); if(htmlFile.exists()){ //å­˜åœ¨å°±æ˜¾ç¤º request.getRequestDispatcher(path).forward(request, response); return; } // è‡ªå®šä¹‰response æä¾›ç¼“å­˜ï¼Œç”¨äºå­˜æ”¾ å‘é€åˆ°æµè§ˆå™¨æ‰€æœ‰å†…å®¹ MyResponse myResponse = new MyResponse(response); //æ”¾è¡Œ chain.doFilter(request, myResponse); //å†…å®¹å·²ç»å†™å…¥åˆ°è‡ªå®šä¹‰ç¼“å­˜ byte[] arrayByte = myResponse.getData(); /***å†™å…¥åˆ°æ–‡ä»¶ start**/ //å°†æŒ‡å®šçš„å†…å®¹å†…å®¹åˆ°æ–‡ä»¶ FileOutputStream out = new FileOutputStream(htmlFile); out.write(arrayByte); out.close(); //æ‰‹åŠ¨å†™å…¥åˆ°æµè§ˆå™¨ response.getOutputStream().write(arrayByte); /***å†™å…¥åˆ°æ–‡ä»¶ end**/ /**å…¨ç«™å‹ç¼© ï¼Œ å°†éœ€è¦å‘é€çš„æ•°æ®ï¼Œå‹ç¼©ä¹‹åå†å‘ç»™æµè§ˆå™¨ï¼ŒèŠ‚çœæµé‡ å…¨ç«™å‹ç¼©å’Œé¡µé¢é™æ€åŒ–æ˜¯å†²çªçš„,éœ€è¦ä¸€ä¸ªä¸€ä¸ªæ¥æµ‹è¯•**/ /* // è®¾ç½®å‘é€çš„æ•°æ®ä½å‹ç¼©æ•°æ® response.setHeader(&quot;content-encoding&quot;, &quot;gzip&quot;); ByteArrayOutputStream baos = new ByteArrayOutputStream(); //å­˜æ”¾å‹ç¼©åçš„ç»“æœ GZIPOutputStream gzipOut = new GZIPOutputStream(baos); //å‹ç¼©çš„ä½ç½® gzipOut.write(arrayByte); //éœ€è¦å‹ç¼©çš„åŸå§‹æ•°æ® gzipOut.close(); response.getOutputStream().write(baos.toByteArray()); */ } @Override public void destroy() { } }æ‰©å±•:è£…é¥°è€…è®¾è®¡æ¨¡å¼ä¹±ç è§£å†³çš„åå‡ åˆ†é’Ÿçš„æ—¶å€™è®²äº†è¿™ä¸ªä¸œè¥¿ jaråŒ…å’ŒwaråŒ…çš„åŒºåˆ«javaé¡¹ç›® å‹ç¼© ï¼šjaråŒ…webé¡¹ç›® å‹ç¼©ï¼šwaråŒ… ã€‚ å½“waræ·»åŠ åˆ°tomcat/webappsä¸‹å°†è‡ªåŠ¨è§£å‹ jaråŒ…å’ŒwaråŒ…å‹ç¼©æ ¼å¼éƒ½æ˜¯ zip å‡çº§è®¢åˆ¶ç‰ˆHttpFilterè¿™ä¸ªéå¸¸å¥½,ç”¨åˆ°çš„æ€æƒ³å’ŒServletä¸­çš„service()æ–¹æ³•éå¸¸ç±»ä¼¼,å¥½å¥½æ€»ç»“ä¸€ä¸‹http://www.cnblogs.com/jianjianyang/p/5001471.html","link":"/2017/01/24/JavaWeb%E5%9F%BA%E7%A1%80/19-JavaWeb%E5%9F%BA%E7%A1%80-Filter/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 11ï¼šCompletableFutureï¼šç»„åˆå¼å¼‚æ­¥ç¼–ç¨‹","text":"æŸä¸ªç½‘ç«™çš„æ•°æ®æ¥è‡ªFacebookã€Twitterå’ŒGoogleï¼Œè¿™å°±éœ€è¦ç½‘ç«™ä¸äº’è”ç½‘ä¸Šçš„å¤šä¸ªWebæœåŠ¡é€šä¿¡ã€‚å¯æ˜¯ï¼Œä½ å¹¶ä¸å¸Œæœ›å› ä¸ºç­‰å¾…æŸäº›æœåŠ¡çš„å“åº”ï¼Œé˜»å¡åº”ç”¨ç¨‹åºçš„è¿è¡Œï¼Œæµªè´¹æ•°åäº¿å®è´µçš„CPUæ—¶é’Ÿå‘¨æœŸã€‚æ¯”å¦‚ï¼Œä¸è¦å› ä¸ºç­‰å¾…Facebookçš„æ•°æ®ï¼Œæš‚åœå¯¹æ¥è‡ªTwitterçš„æ•°æ®å¤„ç†ã€‚ ç¬¬7ç« ä¸­ä»‹ç»çš„åˆ†æ”¯/åˆå¹¶æ¡†æ¶ä»¥åŠå¹¶è¡Œæµæ˜¯å®ç°å¹¶è¡Œå¤„ç†çš„å®è´µå·¥å…·;å®ƒä»¬å°†ä¸€ä¸ªæ“ä½œåˆ‡åˆ†ä¸ºå¤šä¸ªå­æ“ä½œï¼Œåœ¨å¤šä¸ªä¸åŒçš„æ ¸ã€CPUç”šè‡³æ˜¯æœºå™¨ä¸Šå¹¶è¡Œåœ°æ‰§è¡Œè¿™äº›å­æ“ä½œã€‚ä¸æ­¤ç›¸åï¼Œå¦‚æœä½ çš„æ„å›¾æ˜¯å®ç°å¹¶å‘ï¼Œè€Œéå¹¶è¡Œï¼Œæˆ–è€…ä½ çš„ä¸»è¦ç›®æ ‡æ˜¯åœ¨åŒä¸€ä¸ªCPUä¸Šæ‰§è¡Œå‡ ä¸ªæ¾è€¦åˆçš„ä»»åŠ¡ï¼Œå……åˆ†åˆ©ç”¨CPUçš„æ ¸ï¼Œè®©å…¶è¶³å¤Ÿå¿™ç¢Œï¼Œä»è€Œæœ€å¤§åŒ–ç¨‹åºçš„ååé‡ï¼Œé‚£ä¹ˆä½ å…¶å®çœŸæ­£æƒ³åšçš„æ˜¯é¿å…å› ä¸ºç­‰å¾…è¿œç¨‹æœåŠ¡çš„è¿”å›ï¼Œæˆ–è€…å¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œè€Œé˜»å¡çº¿ç¨‹çš„æ‰§è¡Œï¼Œæµªè´¹å®è´µçš„è®¡ç®—èµ„æºï¼Œå› ä¸ºè¿™ç§ç­‰å¾…çš„æ—¶é—´å¾ˆå¯èƒ½ç›¸å½“é•¿ã€‚ 1. Futureæ¥å£Futureæ¥å£åœ¨Java 5ä¸­è¢«å¼•å…¥ï¼Œè®¾è®¡åˆè¡·æ˜¯å¯¹å°†æ¥æŸä¸ªæ—¶åˆ»ä¼šå‘ç”Ÿçš„ç»“æœè¿›è¡Œå»ºæ¨¡ã€‚å®ƒå»ºæ¨¡äº†ä¸€ç§å¼‚æ­¥è®¡ç®—ï¼Œè¿”å›ä¸€ä¸ªæ‰§è¡Œè¿ç®—ç»“æœçš„å¼•ç”¨ï¼Œå½“è¿ç®—ç»“æŸåï¼Œè¿™ä¸ªå¼•ç”¨è¢«è¿”å›ç»™è°ƒç”¨æ–¹ã€‚åœ¨Futureä¸­è§¦å‘é‚£äº›æ½œåœ¨è€—æ—¶çš„æ“ä½œæŠŠè°ƒç”¨çº¿ç¨‹è§£æ”¾å‡ºæ¥ï¼Œè®©å®ƒèƒ½ç»§ç»­æ‰§è¡Œå…¶ä»–æœ‰ä»·å€¼çš„å·¥ä½œï¼Œä¸å†éœ€è¦ç­‰å¾…è€—æ—¶çš„æ“ä½œå®Œæˆã€‚Futureçš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯å®ƒæ¯”æ›´åº•å±‚çš„Threadæ›´æ˜“ç”¨ã€‚è¦ä½¿ç”¨Futureï¼Œé€šå¸¸ä½ åªéœ€è¦å°†è€—æ—¶çš„æ“ä½œå°è£…åœ¨ä¸€ä¸ªCallableå¯¹è±¡ä¸­ï¼Œå†å°†å®ƒæäº¤ç»™ExecutorServiceã€‚ä½¿ç”¨Futureä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œä¸€ä¸ªè€—æ—¶çš„æ“ä½œ: çº¿ç¨‹å¯ä»¥åœ¨ExecutorServiceä»¥å¹¶å‘æ–¹å¼è°ƒç”¨å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œçš„åŒæ—¶ï¼Œå»æ‰§è¡Œä¸€äº›å…¶ä»–çš„ä»»åŠ¡ã€‚æ¥ç€ï¼Œå¦‚æœä½ å·²ç»è¿è¡Œåˆ°æ²¡æœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœå°±æ— æ³•ç»§ç»­ä»»ä½•æœ‰æ„ä¹‰çš„å·¥ä½œæ—¶ï¼Œå¯ä»¥è°ƒç”¨å®ƒçš„getæ–¹æ³•å»è·å–æ“ä½œçš„ç»“æœã€‚å¦‚æœæ“ä½œå·²ç»å®Œæˆï¼Œè¯¥æ–¹æ³•ä¼šç«‹åˆ»è¿”å›æ“ä½œçš„ç»“æœï¼Œå¦åˆ™å®ƒä¼šé˜»å¡ä½ çš„çº¿ç¨‹ï¼Œç›´åˆ°æ“ä½œå®Œæˆï¼Œè¿”å›ç›¸åº”çš„ç»“æœã€‚å¦‚æœè¯¥é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œæ°¸è¿œä¸è¿”å›äº†ä¼šæ€æ ·?Futureæä¾›äº†ä¸€ä¸ªæ— éœ€ä»»ä½•å‚æ•°çš„getæ–¹æ³•ï¼Œæ¨èä½¿ç”¨é‡è½½ç‰ˆæœ¬çš„getæ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªè¶…æ—¶çš„å‚æ•°ï¼Œå¯ä»¥å®šä¹‰çº¿ç¨‹ç­‰å¾…Futureç»“æœçš„æœ€é•¿æ—¶é—´ï¼Œé¿å…æ— ä¼‘æ­¢çš„ç­‰å¾…ã€‚ä¸‹å›¾æ˜¯Futureå¼‚æ­¥æ‰§è¡Œçº¿ç¨‹åŸç†å›¾ã€‚ 2. ä½¿ç”¨CompletableFutureæ„å»ºå¼‚æ­¥åº”ç”¨Futureæ¥å£æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å¾ˆéš¾è¡¨è¿°Futureç»“æœä¹‹é—´çš„ä¾èµ–æ€§ã€‚å› æ­¤æˆ‘ä»¬å¼•å…¥äº†CompletableFutureã€‚æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªâ€œæœ€ä½³ä»·æ ¼æŸ¥è¯¢å™¨â€œçš„åº”ç”¨ï¼Œå®ƒä¼šæŸ¥è¯¢å¤šä¸ªåœ¨çº¿å•†åº—ï¼Œä¾æ®ç»™å®šçš„äº§å“æˆ–æœåŠ¡æ‰¾å‡ºæœ€ä½çš„ä»·æ ¼ï¼Œæ¥å±•ç°CompletableFutureå®ç°å¼‚æ­¥åº”ç”¨ã€‚é€šè¿‡æ­¤ä¾‹ä½ èƒ½å­¦åˆ°è¿™äº›ï¼š å¦‚ä½•ç¼–å†™å¼‚æ­¥API å¦‚ä½•è®©ä½¿ç”¨åŒæ­¥APIçš„ä»£ç å˜ä¸ºéé˜»å¡ä»£ç  å¦‚ä½•ä½¿ç”¨æµæ°´çº¿å°†ä¸¤ä¸ªæ¥ç»­çš„å¼‚æ­¥æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ªå¼‚æ­¥è®¡ç®—æ“ä½œ å¦‚ä½•ä»¥å“åº”å¼çš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œçš„å®Œæˆäº‹ä»¶ åŒæ­¥APIå’Œå¼‚æ­¥APIï¼š åŒæ­¥APIå…¶å®åªæ˜¯å¯¹ä¼ ç»Ÿæ–¹æ³•è°ƒç”¨çš„å¦ä¸€ç§ç§°å‘¼:ä½ è°ƒç”¨äº†æŸä¸ªæ–¹æ³•ï¼Œè°ƒç”¨æ–¹åœ¨è¢«è°ƒç”¨æ–¹è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šç­‰å¾…ï¼Œè¢«è°ƒç”¨æ–¹è¿è¡Œç»“æŸè¿”å›ï¼Œè°ƒç”¨æ–¹å–å¾—è¢«è°ƒç”¨æ–¹çš„è¿”å›å€¼å¹¶ç»§ç»­è¿è¡Œã€‚å³ä½¿è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­è¿è¡Œï¼Œè°ƒç”¨æ–¹è¿˜æ˜¯éœ€è¦ç­‰å¾…è¢«è°ƒç”¨æ–¹ç»“æŸè¿è¡Œï¼Œè¿™å°±æ˜¯é˜»å¡å¼è°ƒç”¨è¿™ä¸ªåè¯çš„ç”±æ¥ã€‚ å¼‚æ­¥APIä¼šç›´æ¥è¿”å›ï¼Œæˆ–è€…è‡³å°‘åœ¨è¢«è°ƒç”¨æ–¹è®¡ç®—å®Œæˆä¹‹å‰ï¼Œå°†å®ƒå‰©ä½™çš„è®¡ç®—ä»»åŠ¡äº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹å»åšï¼Œè¯¥çº¿ç¨‹å’Œè°ƒç”¨æ–¹æ˜¯å¼‚æ­¥çš„â€”â€”è¿™å°±æ˜¯éé˜»å¡å¼è°ƒç”¨çš„ç”±æ¥ã€‚æ‰§è¡Œå‰©ä½™è®¡ç®—ä»»åŠ¡çš„çº¿ç¨‹ä¼šå°†å®ƒçš„è®¡ç®—ç»“æœè¿”å›ç»™è°ƒç”¨æ–¹ã€‚è¿”å›çš„æ–¹å¼è¦ä¹ˆæ˜¯é€šè¿‡å›è°ƒå‡½æ•°ï¼Œè¦ä¹ˆæ˜¯ç”±è°ƒç”¨æ–¹å†æ¬¡æ‰§è¡Œä¸€ä¸ªâ€œç­‰å¾…ï¼Œç›´åˆ°è®¡ç®—å®Œæˆâ€çš„æ–¹æ³•è°ƒç”¨ã€‚ 2.1 å®æˆ˜ï¼šå®ç°å¼‚æ­¥API2.1.1 åŒæ­¥æ–¹æ³• åŒæ­¥æ“ä½œä¸­ä¼šä¸ºç­‰å¾…åŒæ­¥äº‹ä»¶å®Œæˆè€Œç­‰å¾…1sï¼Œè¿™ç§æ˜¯æ— æ³•æ¥å—çš„ï¼Œå¯¹äºç¨‹åºä½“éªŒæ¥è¯´æ˜¯éå¸¸ä¸å¥½çš„ã€‚ 2.1.2 å°†åŒæ­¥æ–¹æ³•è½¬æ¢ä¸ºå¼‚æ­¥æ–¹æ³• Java 5å¼•å…¥äº†java.util.concurrent.Futureæ¥å£è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥è®¡ç®—(å³è°ƒç”¨çº¿ç¨‹å¯ä»¥ç»§ç»­è¿è¡Œï¼Œä¸ä¼šå› ä¸ºè°ƒç”¨æ–¹æ³•è€Œé˜»å¡)çš„ç»“æœã€‚è¿™æ„å‘³ç€Futureæ˜¯ä¸€ä¸ªæš‚æ—¶è¿˜ä¸å¯çŸ¥å€¼çš„å¤„ç†å™¨ï¼Œè¿™ä¸ªå€¼åœ¨è®¡ç®—å®Œæˆåï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨å®ƒçš„getæ–¹æ³•å–å¾—ã€‚è¿™ç§æ–¹å¼ä¸‹ï¼Œåœ¨è¿›è¡Œä»·æ ¼æŸ¥è¯¢çš„åŒæ—¶ï¼Œè¿˜èƒ½æ‰§è¡Œä¸€äº›å…¶ä»–çš„ä»»åŠ¡ï¼Œæ¯”å¦‚æŸ¥è¯¢å…¶ä»–å•†åº—ä¸­å•†å“çš„ä»·æ ¼ï¼Œä¸ä¼šé˜»å¡åœ¨é‚£é‡Œç­‰å¾…ç¬¬ä¸€å®¶å•†åº—è¿”å›è¯·æ±‚çš„ç»“æœã€‚æœ€åï¼Œå¦‚æœæ‰€æœ‰æœ‰æ„ä¹‰çš„å·¥ä½œéƒ½å·²ç»å®Œæˆï¼Œæ‰€æœ‰è¦æ‰§è¡Œçš„å·¥ä½œéƒ½ä¾èµ–äºå•†å“ä»·æ ¼æ—¶ï¼Œå†è°ƒç”¨Futureçš„getæ–¹æ³•ã€‚æ‰§è¡Œäº†è¿™ä¸ªæ“ä½œåï¼Œè¦ä¹ˆè·å¾—Futureä¸­å°è£…çš„å€¼(å¦‚æœå¼‚æ­¥ä»»åŠ¡å·²ç»å®Œæˆ)ï¼Œè¦ä¹ˆå‘ç”Ÿé˜»å¡ï¼Œç›´åˆ°è¯¥å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼ŒæœŸæœ›çš„å€¼èƒ½å¤Ÿè®¿é—®ã€‚åŒæ—¶ï¼Œå¦‚æœæŸä¸ªå•†å“ä»·æ ¼è®¡ç®—å‘ç”Ÿå¼‚å¸¸ï¼Œä¼šå°†å½“å‰çº¿ç¨‹æ€æ­»ï¼Œä»è€Œå¯¼è‡´ç­‰å¾…getæ–¹æ³•è¿”å›ç»“æœçš„å®¢æˆ·ç«¯æ°¸ä¹…åœ°è¢«é˜»å¡ã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨é‡è½½ç‰ˆæœ¬çš„getæ–¹æ³•ï¼Œè®¾ç½®è¶…æ—¶å‚æ•°æ¥é¿å…ã€‚ä¸ºäº†è®©å®¢æˆ·ç«¯èƒ½äº†è§£æ— æ³•æä¾›è¯·æ±‚å•†å“ä»·æ ¼çš„åŸå› ï¼Œä½ éœ€è¦ä½¿ç”¨CompletableFutureçš„completeExceptionallyæ–¹æ³•å°†å¯¼è‡´CompletableFutureå†…å‘ç”Ÿé—®é¢˜çš„å¼‚å¸¸æŠ›å‡ºã€‚ 2.1.3 ä½¿ç”¨å·¥å‚æ–¹æ³•supplyAsyncåˆ›å»ºCompletableFutureå¯¹è±¡ supplyAsyncæ–¹æ³•æ¥å—ä¸€ä¸ªç”Ÿäº§è€…(Supplier)ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªCompletableFutureå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å®Œæˆå¼‚æ­¥æ‰§è¡Œåä¼šè¯»å–è°ƒç”¨ç”Ÿäº§è€…æ–¹æ³•çš„è¿”å›å€¼ã€‚ç”Ÿäº§è€…æ–¹æ³•ä¼šäº¤ç”±ForkJoinPoolæ± ä¸­çš„æŸä¸ªæ‰§è¡Œçº¿ç¨‹(Executor)è¿è¡Œï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨supplyAsyncæ–¹æ³•çš„é‡è½½ç‰ˆæœ¬ï¼Œä¼ é€’ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸åŒçš„æ‰§è¡Œçº¿ç¨‹æ‰§è¡Œç”Ÿäº§è€…æ–¹æ³•ã€‚ 3. æ¶ˆé™¤ä»£ç é˜»å¡é—®é¢˜3.1 é¡ºåºåŒæ­¥è¯·æ±‚ 3.2 ä½¿ç”¨å¹¶è¡Œæµå¯¹è¯·æ±‚è¿›è¡Œå¹¶è¡Œæ“ä½œ 3.3 ä½¿ç”¨CompletableFutureå‘èµ·å¼‚æ­¥è¯·æ±‚ CompletableFutureç‰ˆæœ¬çš„ç¨‹åºä¼¼ä¹æ¯”å¹¶è¡Œæµç‰ˆæœ¬çš„ç¨‹åºè¿˜å¿«é‚£ä¹ˆä¸€ç‚¹å„¿ã€‚ä½†æ˜¯æœ€åè¿™ä¸ªç‰ˆæœ¬ä¹Ÿä¸å¤ªä»¤äººæ»¡æ„ã€‚å®ƒä»¬çœ‹èµ·æ¥ä¸ç›¸ä¼¯ä»²ï¼Œç©¶å…¶åŸå› éƒ½ä¸€æ ·:å®ƒä»¬å†…éƒ¨é‡‡ç”¨çš„æ˜¯åŒæ ·çš„é€šç”¨çº¿ç¨‹æ± ï¼Œé»˜è®¤éƒ½ä½¿ç”¨å›ºå®šæ•°ç›®çš„çº¿ç¨‹ï¼Œå…·ä½“çº¿ç¨‹æ•°å–å†³äºRuntime.getRuntime().availableProcessors()çš„è¿”å›å€¼ã€‚ç„¶è€Œï¼ŒCompletableFutureå…·æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œå› ä¸ºå®ƒå…è®¸ä½ å¯¹æ‰§è¡Œå™¨(Executor)è¿›è¡Œé…ç½®ï¼Œå°¤å…¶æ˜¯çº¿ç¨‹æ± çš„å¤§å°ï¼Œè®©å®ƒä»¥æ›´é€‚åˆåº”ç”¨éœ€æ±‚çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œæ»¡è¶³ç¨‹åºçš„è¦æ±‚ï¼Œè€Œè¿™æ˜¯å¹¶è¡ŒæµAPIæ— æ³•æä¾›çš„ã€‚é¡ºåºæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œçš„åŸç†å¯¹æ¯”ï¼š å›¾11-4çš„ä¸ŠåŠéƒ¨åˆ†å±•ç¤ºäº†ä½¿ç”¨å•ä¸€æµæ°´çº¿å¤„ç†æµçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œæ‰§è¡Œçš„æµç¨‹(ä»¥è™šçº¿æ ‡è¯†)æ˜¯é¡ºåºçš„ã€‚äº‹å®ä¸Šï¼Œæ–°çš„CompletableFutureå¯¹è±¡åªæœ‰åœ¨å‰ä¸€ä¸ªæ“ä½œå®Œå…¨ç»“æŸä¹‹åï¼Œæ‰èƒ½åˆ›å»ºã€‚ä¸æ­¤ç›¸åï¼Œå›¾çš„ä¸‹åŠéƒ¨åˆ†å±•ç¤ºäº†å¦‚ä½•å…ˆå°†CompletableFutureså¯¹è±¡èšé›†åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­(å³å›¾ä¸­ä»¥æ¤­åœ†è¡¨ç¤ºçš„éƒ¨åˆ†)ï¼Œè®©å¯¹è±¡ä»¬å¯ä»¥åœ¨ç­‰å¾…å…¶ä»–å¯¹è±¡å®Œæˆæ“ä½œä¹‹å‰å°±èƒ½å¯åŠ¨ã€‚ 3.4 ä½¿ç”¨CompletableFutureå‘èµ·å¼‚æ­¥è¯·æ±‚WithExecutor 3.5 è°ƒç”¨ç»“æœ: 3.6 å¹¶è¡Œâ€”â€”ä½¿ç”¨æµè¿˜æ˜¯CompletableFuturesç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»çŸ¥é“å¯¹é›†åˆè¿›è¡Œå¹¶è¡Œè®¡ç®—æœ‰ä¸¤ç§æ–¹å¼:è¦ä¹ˆå°†å…¶è½¬åŒ–ä¸ºå¹¶è¡Œæµï¼Œåˆ©ç”¨mapè¿™æ ·çš„æ“ä½œå¼€å±•å·¥ä½œï¼Œè¦ä¹ˆæšä¸¾å‡ºé›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œåœ¨CompletableFutureå†…å¯¹å…¶è¿›è¡Œæ“ä½œã€‚åè€…æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ï¼Œä½ å¯ä»¥è°ƒæ•´çº¿ç¨‹æ± çš„å¤§å°ï¼Œè€Œè¿™èƒ½å¸®åŠ©ä½ ç¡®ä¿æ•´ä½“çš„è®¡ç®—ä¸ä¼šå› ä¸ºçº¿ç¨‹éƒ½åœ¨ç­‰å¾…I/Oè€Œå‘ç”Ÿé˜»å¡ã€‚ å¦‚æœä½ è¿›è¡Œçš„æ˜¯è®¡ç®—å¯†é›†å‹çš„æ“ä½œï¼Œå¹¶ä¸”æ²¡æœ‰I/Oï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨Streamæ¥å£ï¼Œå› ä¸ºå®ç°ç®€å•ï¼ŒåŒæ—¶æ•ˆç‡ä¹Ÿå¯èƒ½æ˜¯æœ€é«˜çš„(å¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯è®¡ç®—å¯†é›†å‹çš„ï¼Œé‚£å°±æ²¡æœ‰å¿…è¦åˆ›å»ºæ¯”å¤„ç†å™¨æ ¸æ•°æ›´å¤šçš„çº¿ç¨‹)ã€‚ å¦‚æœä½ å¹¶è¡Œçš„å·¥ä½œå•å…ƒè¿˜æ¶‰åŠç­‰å¾…I/Oçš„æ“ä½œ(åŒ…æ‹¬ç½‘ç»œè¿æ¥ç­‰å¾…)ï¼Œé‚£ä¹ˆä½¿ç”¨CompletableFutureçµæ´»æ€§æ›´å¥½ï¼Œä½ å¯ä»¥åƒå‰æ–‡è®¨è®ºçš„é‚£æ ·ï¼Œä¾æ®ç­‰å¾…/è®¡ç®—ï¼Œæˆ–è€… W/Cçš„æ¯”ç‡è®¾å®šéœ€è¦ä½¿ç”¨çš„çº¿ç¨‹æ•°ã€‚è¿™ç§æƒ…å†µä¸ä½¿ç”¨å¹¶è¡Œæµçš„å¦ä¸€ä¸ªåŸå› æ˜¯ï¼Œå¤„ç†æµçš„æµæ°´çº¿ä¸­å¦‚æœå‘ç”ŸI/Oç­‰å¾…ï¼Œæµçš„å»¶è¿Ÿæ€§ä¼šè®©æˆ‘ä»¬å¾ˆéš¾åˆ¤æ–­åˆ°åº•ä»€ä¹ˆæ—¶å€™è§¦å‘äº†ç­‰å¾…ã€‚ 4. å¯¹å¤šä¸ªå¼‚æ­¥ä»»åŠ¡è¿›è¡Œæµæ°´çº¿æ“ä½œ4.1 æ¡ˆä¾‹é€šè¿‡åœ¨shopæ„æˆçš„æµä¸Šé‡‡ç”¨æµæ°´çº¿æ–¹å¼æ‰§è¡Œä¸‰æ¬¡mapæ“ä½œï¼Œæˆ‘ä»¬å¾—åˆ°äº†ç»“æœã€‚ ç¬¬ä¸€ä¸ªæ“ä½œå°†æ¯ä¸ªshopå¯¹è±¡è½¬æ¢æˆäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åŒ…å«äº†è¯¥ shopä¸­æŒ‡å®šå•†å“çš„ä»·æ ¼å’ŒæŠ˜æ‰£ä»£ç ã€‚ ç¬¬äºŒä¸ªæ“ä½œå¯¹è¿™äº›å­—ç¬¦ä¸²è¿›è¡Œäº†è§£æï¼Œåœ¨Quoteå¯¹è±¡ä¸­å¯¹å®ƒä»¬è¿›è¡Œè½¬æ¢ã€‚ ç¬¬ä¸‰ä¸ªmapä¼šæ“ä½œè”ç³»è¿œç¨‹çš„DiscountæœåŠ¡ï¼Œè®¡ç®—å‡ºæœ€ç»ˆçš„æŠ˜æ‰£ä»·æ ¼ï¼Œå¹¶è¿”å›è¯¥ä»·æ ¼åŠæä¾›è¯¥ä»·æ ¼å•†å“çš„shopã€‚ ä»£ç å¦‚å›¾: åŸç†å›¾ï¼š Java 8çš„CompletableFuture APIæä¾›äº†åä¸ºthenComposeçš„æ–¹æ³•ï¼Œå®ƒå°±æ˜¯ä¸“é—¨ä¸ºè¿™ä¸€ç›®çš„è€Œè®¾è®¡çš„ï¼ŒthenComposeæ–¹æ³•å…è®¸ä½ å¯¹ä¸¤ä¸ªå¼‚æ­¥æ“ä½œè¿›è¡Œæµæ°´çº¿ï¼Œç¬¬ä¸€ä¸ªæ“ä½œå®Œæˆæ—¶ï¼Œå°†å…¶ç»“æœä½œä¸ºå‚æ•°ä¼ é€’ç»™ç¬¬äºŒä¸ªæ“ä½œã€‚æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥åˆ›å»ºä¸¤ä¸ªCompletableFutureså¯¹è±¡ï¼Œå¯¹ç¬¬ä¸€ä¸ªCompletableFutureå¯¹è±¡è°ƒç”¨thenComposeï¼Œå¹¶å‘å…¶ä¼ é€’ä¸€ä¸ªå‡½æ•°ã€‚å½“ç¬¬ä¸€ä¸ª CompletableFutureæ‰§è¡Œå®Œæ¯•åï¼Œå®ƒçš„ç»“æœå°†ä½œä¸ºè¯¥å‡½æ•°çš„å‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯ä»¥ç¬¬ä¸€ ä¸ªCompletableFutureçš„è¿”å›åšè¾“å…¥è®¡ç®—å‡ºçš„ç¬¬äºŒä¸ªCompletableFutureå¯¹è±¡ã€‚thenComposeæ–¹æ³•åƒCompletableFutureç±»ä¸­çš„å…¶ä»–æ–¹æ³•ä¸€æ ·ï¼Œä¹Ÿæä¾›äº†ä¸€ä¸ªä»¥Asyncåç¼€ç»“å°¾çš„ç‰ˆæœ¬thenComposeAsyncã€‚é€šå¸¸è€Œè¨€ï¼Œåç§°ä¸­ä¸å¸¦Asyncçš„æ–¹æ³•å’Œå®ƒçš„å‰ä¸€ä¸ªä»»åŠ¡ä¸€æ ·ï¼Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œ;è€Œåç§°ä»¥Asyncç»“å°¾çš„æ–¹æ³•ä¼šå°†åç»­çš„ä»»åŠ¡æäº¤åˆ°ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ‰€ä»¥æ¯ä¸ªä»»åŠ¡æ˜¯ç”±ä¸åŒçš„çº¿ç¨‹å¤„ç†çš„ã€‚ 4.2 thenCombineæ–¹æ³•å°†ä¸¤ä¸ªCompletableFutureå¯¹è±¡ç»“åˆèµ·æ¥ï¼Œæ— è®ºä»–ä»¬æ˜¯å¦å­˜åœ¨ä¾èµ–ã€‚thenCombineæ–¹æ³•ï¼Œå®ƒæ¥æ”¶åä¸ºBiFunctionçš„ç¬¬äºŒå‚æ•°ï¼Œè¿™ä¸ªå‚æ•° å®šä¹‰äº†å½“ä¸¤ä¸ªCompletableFutureå¯¹è±¡å®Œæˆè®¡ç®—åï¼Œç»“æœå¦‚ä½•åˆå¹¶ã€‚åŒthenComposeæ–¹æ³•ä¸€æ ·ï¼Œ thenCombineæ–¹æ³•ä¹Ÿæä¾›æœ‰ä¸€ä¸ªAsyncçš„ç‰ˆæœ¬ã€‚è¿™é‡Œï¼Œå¦‚æœä½¿ç”¨thenCombineAsyncä¼šå¯¼è‡´BiFunctionä¸­å®šä¹‰çš„åˆå¹¶æ“ä½œè¢«æäº¤åˆ°çº¿ç¨‹æ± ä¸­ï¼Œç”±å¦ä¸€ä¸ªä»»åŠ¡ä»¥å¼‚æ­¥çš„æ–¹å¼æ‰§è¡Œã€‚ ä»£ç å›¾ï¼š åŸç†å›¾ï¼š 4.3 å“åº”CompletableFutureçš„completionäº‹ä»¶Java 8çš„CompletableFutureé€šè¿‡thenAcceptæ–¹æ³•æä¾›äº†è¿™ä¸€åŠŸèƒ½ï¼Œå®ƒæ¥æ”¶ CompletableFutureæ‰§è¡Œå®Œæ¯•åçš„è¿”å›å€¼åšå‚æ•°ã€‚thenAcceptæ–¹æ³•ä¹Ÿæä¾› äº†ä¸€ä¸ªå¼‚æ­¥ç‰ˆæœ¬ï¼Œåä¸ºthenAcceptAsyncã€‚å¼‚æ­¥ç‰ˆæœ¬çš„æ–¹æ³•ä¼šå¯¹å¤„ç†ç»“æœçš„æ¶ˆè´¹è€…è¿›è¡Œè°ƒåº¦ï¼Œ ä»çº¿ç¨‹æ± ä¸­é€‰æ‹©ä¸€ä¸ªæ–°çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œä¸å†ç”±åŒä¸€ä¸ªçº¿ç¨‹å®ŒæˆCompletableFutureçš„æ‰€æœ‰ä»» åŠ¡ã€‚å› ä¸ºä½ æƒ³è¦é¿å…ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ›´é‡è¦çš„æ˜¯ä½ å¸Œæœ›é¿å…åœ¨ç­‰å¾…çº¿ç¨‹ä¸Šæµªè´¹æ—¶é—´ï¼Œå°½å¿«å“åº”CompletableFutureçš„completionäº‹ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰é‡‡ç”¨å¼‚æ­¥ç‰ˆæœ¬ã€‚ 4.3.1 å®æˆ˜ 5. å°ç»“ æ‰§è¡Œæ¯”è¾ƒæ“ä½œæ—¶,å°¤å…¶æ˜¯é‚£äº›ä¾èµ–ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹æœåŠ¡çš„æ“ä½œï¼Œä½¿ç”¨å¼‚æ­¥ä»»åŠ¡å¯ä»¥æ”¹å–„ç¨‹åºçš„æ€§èƒ½ï¼ŒåŠ å¿«ç¨‹åºçš„å“åº”é€Ÿåº¦ã€‚ ä½ åº”è¯¥å°½å¯èƒ½åœ°ä¸ºå®¢æˆ·æä¾›å¼‚æ­¥APIã€‚ä½¿ç”¨CompletableFutureç±»æä¾›çš„ç‰¹æ€§ï¼Œä½ èƒ½å¤Ÿè½»æ¾åœ°å®ç°è¿™ä¸€ç›®æ ‡ã€‚ CompletableFutureç±»è¿˜æä¾›äº†å¼‚å¸¸ç®¡ç†çš„æœºåˆ¶ï¼Œè®©ä½ æœ‰æœºä¼šæŠ›å‡º/ç®¡ç†å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œä¸­å‘ç”Ÿçš„å¼‚å¸¸ã€‚ å°†åŒæ­¥APIçš„è°ƒç”¨å°è£…åˆ°ä¸€ä¸ªCompletableFutureä¸­ï¼Œä½ èƒ½å¤Ÿä»¥å¼‚æ­¥çš„æ–¹å¼ä½¿ç”¨å…¶ç»“æœã€‚ å¦‚æœå¼‚æ­¥ä»»åŠ¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæˆ–è€…å®ƒä»¬ä¹‹é—´æŸä¸€äº›çš„ç»“æœæ˜¯å¦ä¸€äº›çš„è¾“å…¥ï¼Œä½ å¯ä»¥å°†è¿™äº›å¼‚æ­¥ä»»åŠ¡æ„é€ æˆ–è€…åˆå¹¶æˆä¸€ä¸ªã€‚ ä½ å¯ä»¥ä¸ºCompletableFutureæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨Futureæ‰§è¡Œå®Œæ¯•æˆ–è€…å®ƒä»¬è®¡ç®—çš„ç»“æœå¯ç”¨æ—¶ï¼Œé’ˆå¯¹æ€§åœ°æ‰§è¡Œä¸€äº›ç¨‹åºã€‚ ä½ å¯ä»¥å†³å®šåœ¨ä»€ä¹ˆæ—¶å€™ç»“æŸç¨‹åºçš„è¿è¡Œï¼Œæ˜¯ç­‰å¾…ç”±CompletableFutureå¯¹è±¡æ„æˆçš„åˆ—è¡¨ä¸­æ‰€æœ‰çš„å¯¹è±¡éƒ½æ‰§è¡Œå®Œæ¯•ï¼Œè¿˜æ˜¯åªè¦å…¶ä¸­ä»»ä½•ä¸€ä¸ªé¦–å…ˆå®Œæˆå°±ä¸­æ­¢ç¨‹åºçš„è¿è¡Œã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/24/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%2011%EF%BC%9ACompletableFuture%EF%BC%9A%E7%BB%84%E5%90%88%E5%BC%8F%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 12ï¼šæ–°çš„æ—¥æœŸå’Œæ—¶é—´API","text":"åœ¨Java 1.0ä¸­ï¼Œå¯¹æ—¥æœŸå’Œæ—¶é—´çš„æ”¯æŒåªèƒ½ä¾èµ–java.util.Dateç±»ã€‚åŒæ—¶è¿™ä¸ªç±»è¿˜æœ‰ä¸¤ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼šå¹´ä»½çš„èµ·å§‹é€‰æ‹©æ˜¯1900å¹´ï¼Œæœˆä»½çš„èµ·å§‹ä»0å¼€å§‹ã€‚ åœ¨Java 1.1ä¸­ï¼ŒDateç±»ä¸­çš„å¾ˆå¤šæ–¹æ³•è¢«åºŸå¼ƒï¼Œå–è€Œä»£ä¹‹çš„æ˜¯java.util.Calendarç±»ã€‚ç„¶è€ŒCalendarç±»ä¹Ÿæœ‰ç±»ä¼¼çš„é—®é¢˜å’Œè®¾è®¡ç¼ºé™·ï¼Œå¯¼è‡´ä½¿ç”¨è¿™äº›æ–¹æ³•å†™å‡ºçš„ä»£ç éå¸¸å®¹æ˜“å‡ºé”™ã€‚ DateFormatæ–¹æ³•ä¹Ÿæœ‰å®ƒè‡ªå·±çš„é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™æ„å‘³ç€ä¸¤ä¸ªçº¿ç¨‹å¦‚æœå°è¯•ä½¿ç”¨åŒä¸€ä¸ªformatterè§£ææ—¥æœŸï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°æ— æ³•é¢„æœŸçš„ç»“æœã€‚ 1. ä½¿ç”¨LocalDate å’ŒLocalTime1.1 LocalDateJava 8æä¾›æ–°çš„æ—¥æœŸå’Œæ—¶é—´API,LocalDateç±»å®ä¾‹æ˜¯ä¸€ä¸ªä¸å¯å˜å¯¹è±¡ï¼Œåªæä¾›ç®€å•çš„æ—¥æœŸå¹¶ä¸”ä¸å«å½“å¤©æ—¶é—´ä¿¡æ¯ã€‚æ­¤å¤–ä¹Ÿä¸é™„å¸¦ä»»ä½•ä¸æ—¶åŒºç›¸å…³çš„ä¿¡æ¯ã€‚ é€šè¿‡é™æ€å·¥å‚æ–¹æ³•ofåˆ›å»ºä¸€ä¸ªLocalDateå®ä¾‹ã€‚LocalDateå®ä¾‹æä¾›äº†å¤šç§æ–¹æ³•æ¥è¯»å–å¸¸ç”¨çš„å€¼ï¼Œæ¯”å¦‚å¹´ä»½ã€æœˆä»½ã€æ˜ŸæœŸå‡ ç­‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ 12345678910111213141516171819202122LocalDate localDate = LocalDate.of(2014, 3, 18);int year = localDate.getYear();Month month = localDate.getMonth();int day = localDate.getDayOfMonth();DayOfWeek dow = localDate.getDayOfWeek();int len = localDate.lengthOfMonth();boolean leap = localDate.isLeapYear();// ä½¿ç”¨å·¥å‚æ–¹æ³•ä»ç³»ç»Ÿæ—¶é’Ÿä¸­è·å–å½“å‰çš„æ—¥æœŸLocalDate today = LocalDate.now();System.out.println(String.format(\"year:%s\\nmonth:%s\\nday:%s\\ndow:%s\\nlen:%s\\nleap:%s\", year, month, day, dow, len, leap));System.out.println(today);ç»“æœï¼šyear:2014month:MARCHday:18dow:TUESDAYlen:31leap:false2019-03-27 Java 8æ—¥æœŸ-æ—¶é—´ç±»éƒ½æä¾›äº†ç±»ä¼¼çš„å·¥å‚æ–¹æ³•ã€‚é€šè¿‡ä¼ é€’TemporalFieldå‚æ•°ç»™getæ–¹æ³•æ‹¿åˆ°åŒæ ·çš„ä¿¡æ¯ã€‚TemporalFieldæ¥å£å®šä¹‰äº†å¦‚ä½•è®¿é—®temporalå¯¹è±¡æŸä¸ªå­—æ®µçš„å€¼ã€‚ChronoFieldæšä¸¾å®ç°TemporalFieldæ¥å£,å¯ä»¥ä½¿ç”¨getæ–¹æ³•å¾—åˆ°æšä¸¾å…ƒç´ çš„å€¼ã€‚ 123int year = localDate.get(ChronoField.YEAR);int month = localDate.get(ChronoField.MONTH_OF_YEAR);int day = localDate.get(ChronoField.DAY_OF_MONTH); 1.2 LocalTimeä½¿ç”¨LocalTimeç±»è¡¨ç¤ºæ—¶é—´,å¯ä»¥ä½¿ç”¨ofé‡è½½çš„ä¸¤ä¸ªå·¥å‚æ–¹æ³•åˆ›å»ºLocalTimeçš„å®ä¾‹ã€‚ ç¬¬ä¸€ä¸ªé‡è½½å‡½æ•°æ¥æ”¶å°æ—¶å’Œåˆ†é’Ÿ ç¬¬äºŒä¸ªé‡è½½å‡½æ•°åŒæ—¶è¿˜æ¥æ”¶ç§’ã€‚ LocalTimeç±»ä¹Ÿæä¾›äº†ä¸€äº›getæ–¹æ³•è®¿é—®è¿™äº›å˜é‡çš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ 12345678910LocalTime localTime = LocalTime.of(13, 45, 20);int hour = localTime.getHour();int minute = localTime.getMinute();int second = localTime.getSecond();System.out.println(String.format(\"hour:%s\\nminute:%s\\nsecond:%s\", hour, minute, second));æ‰“å°ç»“æœï¼šhour:13minute:45second:20 LocalDateå’ŒLocalTimeéƒ½å¯ä»¥é€šè¿‡è§£æä»£è¡¨å®ƒä»¬çš„å­—ç¬¦ä¸²åˆ›å»ºã€‚ä½¿ç”¨é™æ€æ–¹æ³•parseå¯ä»¥å®ç°ï¼š 12LocalDate date = LocalDate.parse(\"2019-03-27\");LocalTime time = LocalTime.parse(\"20:17:08\"); å¯ä»¥å‘parseæ–¹æ³•ä¼ é€’ä¸€ä¸ªDateTimeFormatterã€‚è¯¥ç±»çš„å®ä¾‹å®šä¹‰äº†å¦‚ä½•æ ¼å¼åŒ–ä¸€ä¸ªæ—¥æœŸæˆ–è€…æ—¶é—´å¯¹è±¡ã€‚ç”¨æ¥æ›¿æ¢è€ç‰ˆjava.util.DateFormatã€‚å¦‚æœä¼ é€’çš„å­—ç¬¦ä¸²å‚æ•°æ— æ³•è¢«è§£æä¸ºåˆæ³•çš„LocalDateæˆ–LocalTimeå¯¹è±¡ï¼Œè¿™ä¸¤ä¸ªparseæ–¹æ³•éƒ½ä¼šæŠ›å‡ºä¸€ä¸ªç»§æ‰¿è‡ªRuntimeExceptionçš„DateTimeParseExceptionå¼‚å¸¸ã€‚ 2. åˆå¹¶æ—¥æœŸå’Œæ—¶é—´å¤åˆç±»LocalDateTimeï¼Œæ˜¯LocalDateå’ŒLocalTimeçš„åˆä½“ã€‚å®ƒåŒæ—¶è¡¨ç¤ºäº†æ—¥æœŸå’Œæ—¶é—´ï¼Œä¸å¸¦æœ‰æ—¶åŒºä¿¡æ¯ã€‚å¯ä»¥ç›´æ¥åˆ›å»ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡åˆå¹¶æ—¥æœŸå’Œæ—¶é—´å¯¹è±¡æ„é€ ã€‚ 12345678LocalTime time = LocalTime.of(21, 31, 50);LocalDate date = LocalDate.of(2019, 03, 27);LocalDateTime dt1 = LocalDateTime.of(2017, Month.NOVEMBER, 07, 22, 31, 51);LocalDateTime dt2 = LocalDateTime.of(date, time);LocalDateTime dt3 = date.atTime(22, 21, 14);LocalDateTime dt4 = date.atTime(time);LocalDateTime dt5 = time.atDate(date); åˆ›å»ºLocalDateTimeå¯¹è±¡ ç›´æ¥åˆ›å»º é€šè¿‡atTimeæ–¹æ³•å‘LocalDateä¼ é€’ä¸€ä¸ªæ—¶é—´å¯¹è±¡ é€šè¿‡atDateæ–¹æ³•å‘LocalTimeä¼ é€’ä¸€ä¸ªæ—¶é—´å¯¹è±¡ ä¹Ÿå¯ä»¥ä½¿ç”¨toLocalDateæˆ–è€…toLocalTimeæ–¹æ³•ï¼Œä»LocalDateTimeä¸­æå–LocalDateæˆ–è€…LocalTimeç»„ä»¶ï¼š 12LocalDate date1 = dt1.toLocalDate();LocalTime time1 = dt1.toLocalTime(); 3. æœºå™¨çš„æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ä»è®¡ç®—æœºçš„è§’åº¦æ¥çœ‹ï¼Œâ€2019å¹´03æœˆ27æ—¥11:20:03â€è¿™æ ·çš„æ–¹å¼æ˜¯ä¸å®¹æ˜“ç†è§£çš„,è®¡ç®—æœºæ›´åŠ å®¹æ˜“ç†è§£å»ºæ¨¡æ—¶é—´æœ€è‡ªç„¶çš„æ ¼å¼æ˜¯è¡¨ç¤ºä¸€ä¸ªæŒç»­æ—¶é—´æ®µä¸ŠæŸä¸ªç‚¹çš„å•ä¸€å¤§æ•´å‹æ•°ã€‚æ–°çš„java.time.Instantç±»å¯¹æ—¶é—´å»ºæ¨¡çš„æ–¹å¼ï¼ŒåŸºæœ¬ä¸Šå®ƒæ˜¯ä»¥Unixå…ƒå¹´æ—¶é—´ï¼ˆä¼ ç»Ÿçš„è®¾å®šä¸ºUTCæ—¶åŒº1970å¹´1æœˆ1æ—¥åˆå¤œæ—¶åˆ†ï¼‰å¼€å§‹æ‰€ç»å†çš„ç§’æ•°è¿›è¡Œè®¡ç®—ã€‚ 3.1 åˆ›å»ºInstant é™æ€å·¥å‚æ–¹æ³•ofEpochSecondä¼ é€’ä¸€ä¸ªä»£è¡¨ç§’æ•°çš„å€¼åˆ›å»ºä¸€ä¸ªè¯¥ç±»çš„å®ä¾‹ã€‚ é™æ€å·¥å‚æ–¹æ³•ofEpochSecondè¿˜æœ‰ä¸€ä¸ªå¢å¼ºçš„é‡è½½ç‰ˆæœ¬ï¼Œå®ƒæ¥æ”¶ç¬¬äºŒä¸ªä»¥çº³ç§’ä¸ºå•ä½çš„å‚æ•°å€¼ï¼Œå¯¹ä¼ å…¥ä½œä¸ºç§’æ•°çš„å‚æ•°è¿›è¡Œè°ƒæ•´ã€‚é‡è½½çš„ç‰ˆæœ¬ä¼šè°ƒæ•´çº³ç§’å‚æ•°ï¼Œç¡®ä¿ä¿å­˜çš„çº³ç§’åˆ†ç‰‡åœ¨0åˆ°999 999999ä¹‹é—´ã€‚ 123456Instant.ofEpochSecond(3);Instant.ofEpochSecond(3, 0);// 2 ç§’ä¹‹åå†åŠ ä¸Š100ä¸‡çº³ç§’ï¼ˆ1ç§’ï¼‰Instant.ofEpochSecond(2, 1_000_000_000);// 4ç§’ä¹‹å‰çš„100ä¸‡çº³ç§’ï¼ˆ1ç§’ï¼‰Instant.ofEpochSecond(4, -1_000_000_000); 3.2 å·¥å‚æ–¹æ³•nowInstantç±»ä¹Ÿæ”¯æŒé™æ€å·¥å‚æ–¹æ³•nowï¼Œå®ƒèƒ½å¤Ÿè·å–å½“å‰æ—¶åˆ»çš„æ—¶é—´æˆ³ã€‚ 1234Instant now = Instant.now();System.out.println(now);2019-03-27T03:26:39.451Z Instantçš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†ä¾¿äºæœºå™¨ä½¿ç”¨,å®ƒåŒ…å«çš„æ˜¯ç”±ç§’åŠçº³ç§’æ‰€æ„æˆçš„æ•°å­—ã€‚å› æ­¤Instantæ— æ³•å¤„ç†é‚£äº›æˆ‘ä»¬éå¸¸å®¹æ˜“ç†è§£çš„æ—¶é—´å•ä½ã€‚ 12345int day = Instant.now().get(ChronoField.DAY_OF_MONTH);å®ƒä¼šæŠ›å‡ºä¸‹é¢è¿™æ ·çš„å¼‚å¸¸ï¼šException in thread \"main\" java.time.temporal.UnsupportedTemporalTypeException: Unsupported field: DayOfMonthä½†æ˜¯ä½ å¯ä»¥é€šè¿‡Durationå’ŒPeriodç±»ä½¿ç”¨Instantï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šå¯¹è¿™éƒ¨åˆ†å†…å®¹è¿›è¡Œä»‹ç»ã€‚ 4. Durationå’ŒPeriod4.1 Durationæ‰€æœ‰ç±»éƒ½å®ç°äº†Temporalæ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰å¦‚ä½•è¯»å–å’Œæ“çºµä¸ºæ—¶é—´å»ºæ¨¡çš„å¯¹è±¡çš„å€¼ã€‚å¦‚æœéœ€è¦åˆ›å»ºä¸¤ä¸ªTemporalå¯¹è±¡ä¹‹é—´çš„duration,å°±éœ€è¦Durationç±»çš„é™æ€å·¥å‚æ–¹æ³•betweenã€‚å¯ä»¥åˆ›å»ºä¸¤ä¸ªLocalTimeså¯¹è±¡ã€ä¸¤ä¸ªLocalDateTimeså¯¹è±¡ï¼Œæˆ–è€…ä¸¤ä¸ªInstantå¯¹è±¡ä¹‹é—´çš„durationï¼š 12345678910111213141516LocalTime time1 = LocalTime.of(21, 50, 10);LocalTime time2 = LocalTime.of(22, 50, 10);LocalDateTime dateTime1 = LocalDateTime.of(2019, 03, 27, 21, 20, 40);LocalDateTime dateTime2 = LocalDateTime.of(2019, 03, 27, 21, 20, 40);Instant instant1 = Instant.ofEpochSecond(1000 * 60 * 2);Instant instant2 = Instant.ofEpochSecond(1000 * 60 * 3);Duration d1 = Duration.between(time1, time2);Duration d2 = Duration.between(dateTime1, dateTime2);Duration d3 = Duration.between(instant1, instant2);// PT1H ç›¸å·®1å°æ—¶System.out.println(\"d1:\" + d1);// PT2H ç›¸å·®2å°æ—¶System.out.println(\"d2:\" + d2);// PT16H40M ç›¸å·®16å°æ—¶40åˆ†é’ŸSystem.out.println(\"d3:\" + d3); LocalDateTimeæ˜¯ä¸ºäº†ä¾¿äºäººé˜…è¯»ä½¿ç”¨ï¼ŒInstantæ˜¯ä¸ºäº†ä¾¿äºæœºå™¨å¤„ç†ï¼Œæ‰€ä»¥ä¸èƒ½å°†äºŒè€…æ··ç”¨ã€‚å¦‚æœåœ¨è¿™ä¸¤ç±»å¯¹è±¡ä¹‹é—´åˆ›å»ºdurationï¼Œä¼šè§¦å‘ä¸€ä¸ªDateTimeExceptionå¼‚å¸¸ã€‚æ­¤å¤–ï¼Œç”±äºDurationç±»ä¸»è¦ç”¨äºä»¥ç§’å’Œçº³ç§’è¡¡é‡æ—¶é—´çš„é•¿çŸ­ï¼Œä½ ä¸èƒ½ä»…å‘betweenæ–¹æ³•ä¼ é€’ä¸€ä¸ªLocalDateå¯¹è±¡åšå‚æ•°ã€‚ 4.2 Periodä½¿ç”¨Periodç±»ä»¥å¹´ã€æœˆæˆ–è€…æ—¥çš„æ–¹å¼å¯¹å¤šä¸ªæ—¶é—´å•ä½å»ºæ¨¡ã€‚ä½¿ç”¨è¯¥ç±»çš„å·¥å‚æ–¹æ³•betweenï¼Œå¯ä»¥ä½¿ç”¨å¾—åˆ°ä¸¤ä¸ªLocalDateä¹‹é—´çš„æ—¶é•¿ã€‚ 123Period period = Period.between(LocalDate.of(2019, 03, 7), LocalDate.of(2019, 03, 17));// ç›¸å·®10å¤©System.out.println(\"Period between:\" + period); Durationå’ŒPeriodç±»éƒ½æä¾›äº†å¾ˆå¤šéå¸¸æ–¹ä¾¿çš„å·¥å‚ç±»ï¼Œç›´æ¥åˆ›å»ºå¯¹åº”çš„å®ä¾‹ã€‚ 1234567Duration threeMinutes = Duration.ofMinutes(3);Duration fourMinutes = Duration.of(4, ChronoUnit.MINUTES);Period tenDay = Period.ofDays(10);Period threeWeeks = Period.ofWeeks(3);Period twoYearsSixMonthsOneDay = Period.of(2, 6, 1);Durationç±»å’ŒPeriodç±»å…±äº«äº†å¾ˆå¤šç›¸ä¼¼çš„æ–¹æ³•ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å‚è€ƒå®˜ç½‘çš„æ–‡æ¡£ã€‚ æˆªè‡³ç›®å‰ï¼Œæˆ‘ä»¬ä»‹ç»çš„è¿™äº›æ—¥æœŸ-æ—¶é—´å¯¹è±¡éƒ½æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œè¿™æ˜¯ä¸ºäº†æ›´å¥½åœ°æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¿æŒé¢†åŸŸæ¨¡å¼ä¸€è‡´æ€§è€Œåšå‡ºçš„é‡å¤§è®¾è®¡å†³å®šã€‚å½“ç„¶ï¼Œæ–°çš„æ—¥æœŸå’Œæ—¶é—´APIä¹Ÿæä¾›äº†ä¸€äº›ä¾¿åˆ©çš„æ–¹æ³•æ¥åˆ›å»ºè¿™äº›å¯¹è±¡çš„å¯å˜ç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨å·²æœ‰çš„LocalDateå®ä¾‹ä¸Šå¢åŠ 3å¤©ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šä»‹ç»å¦‚ä½•ä¾æ®æŒ‡å®šçš„æ¨¡å¼ï¼Œæ¯”å¦‚dd/MM/yyyyï¼Œåˆ›å»ºæ—¥æœŸ-æ—¶é—´æ ¼å¼å™¨ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨è¿™ç§æ ¼å¼å™¨è§£æå’Œè¾“å‡ºæ—¥æœŸã€‚ 5. æ“çºµã€è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸå¦‚æœå·²ç»æœ‰ä¸€ä¸ªLocalDateå¯¹è±¡ï¼Œæƒ³è¦åˆ›å»ºå®ƒçš„ä¸€ä¸ªä¿®æ”¹ç‰ˆï¼Œæœ€ç›´æ¥ä¹Ÿæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨withAttributeæ–¹æ³•ã€‚withAttributeæ–¹æ³•ä¼šåˆ›å»ºå¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå¹¶æŒ‰ç…§éœ€è¦ä¿®æ”¹å®ƒçš„å±æ€§ã€‚ 12345// è¿™æ®µä»£ç ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªä¿®æ”¹äº†å±æ€§çš„å¯¹è±¡ã€‚å®ƒä»¬éƒ½ä¸ä¼šä¿®æ”¹åŸæ¥çš„å¯¹è±¡ï¼LocalDate date1 = LocalDate.of(2017, 12, 15);LocalDate date2 = date1.withYear(2019);LocalDate date3 = date2.withDayOfMonth(25);LocalDate date4 = date3.with(ChronoField.MONTH_OF_YEAR, 9); å®ƒä»¬éƒ½å£°æ˜äºTemporalæ¥å£ï¼Œæ‰€æœ‰çš„æ—¥æœŸå’Œæ—¶é—´APIç±»éƒ½å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å®šä¹‰äº†å•ç‚¹çš„æ—¶é—´ï¼Œæ¯”å¦‚LocalDateã€LocalTimeã€LocalDateTimeä»¥åŠInstantã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œä½¿ç”¨getå’Œwithæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†Temporalå¯¹è±¡å€¼çš„è¯»å–å’Œä¿®æ”¹åŒºåˆ†å¼€ã€‚å¦‚æœTemporalå¯¹è±¡ä¸æ”¯æŒè¯·æ±‚è®¿é—®çš„å­—æ®µï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ªUnsupportedTemporalTypeExceptionå¼‚å¸¸ï¼Œæ¯”å¦‚è¯•å›¾è®¿é—®Instantå¯¹è±¡çš„ChronoField.MONTH_OF_YEARå­—æ®µï¼Œæˆ–è€…LocalDateå¯¹è±¡çš„ChronoField.NANO_OF_SECONDå­—æ®µæ—¶éƒ½ä¼šæŠ›å‡ºè¿™æ ·çš„å¼‚å¸¸ã€‚ 12345// ä»¥å£°æ˜çš„æ–¹å¼æ“çºµLocalDateå¯¹è±¡,å¯ä»¥åŠ ä¸Šæˆ–è€…å‡å»ä¸€æ®µæ—¶é—´LocalDate date1 = LocalDate.of(2014, 10, 19);LocalDate date2 = date1.plusWeeks(1);LocalDate date3 = date2.minusYears(3);LocalDate date4 = date3.plus(6, ChronoUnit.MONTHS); ä¸æˆ‘ä»¬åˆšæ‰ä»‹ç»çš„getå’Œwithæ–¹æ³•ç±»ä¼¼æœ€åä¸€è¡Œä½¿ç”¨çš„plusæ–¹æ³•ä¹Ÿæ˜¯é€šç”¨æ–¹æ³•ï¼Œå®ƒå’Œminusæ–¹æ³•éƒ½å£°æ˜äºTemporalæ¥å£ä¸­ã€‚é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯¹TemporalUnitå¯¹è±¡åŠ ä¸Šæˆ–è€…å‡å»ä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬èƒ½éå¸¸æ–¹ä¾¿åœ°å°†Temporalå¯¹è±¡å‰æº¯æˆ–è€…å›æ»šè‡³æŸä¸ªæ—¶é—´æ®µï¼Œé€šè¿‡ChronoUnitæšä¸¾æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®ç°TemporalUnitæ¥å£ã€‚ 6. ä½¿ç”¨TemporalAdjusteræœ‰æ—¶éœ€è¦è¿›è¡Œä¸€äº›æ›´åŠ å¤æ‚çš„æ“ä½œï¼Œæ¯”å¦‚ï¼Œå°†æ—¥æœŸè°ƒæ•´åˆ°ä¸‹ä¸ªå‘¨æ—¥ã€ä¸‹ä¸ªå·¥ä½œæ—¥ï¼Œæˆ–è€…æ˜¯æœ¬æœˆçš„æœ€åä¸€å¤©ã€‚å¯ä»¥ä½¿ç”¨é‡è½½ç‰ˆæœ¬çš„withæ–¹æ³•ï¼Œå‘å…¶ä¼ é€’ä¸€ä¸ªæä¾›äº†æ›´å¤šå®šåˆ¶åŒ–é€‰æ‹©çš„TemporalAdjusterå¯¹è±¡ï¼Œæ›´åŠ çµæ´»åœ°å¤„ç†æ—¥æœŸã€‚ 1234// å¯¹äºæœ€å¸¸è§çš„ç”¨ä¾‹ï¼Œæ—¥æœŸå’Œæ—¶é—´APIå·²ç»æä¾›äº†å¤§é‡é¢„å®šä¹‰çš„TemporalAdjusterã€‚å¯ä»¥é€šè¿‡TemporalAdjusterç±»çš„é™æ€å·¥å‚æ–¹æ³•è®¿é—®ã€‚LocalDate date1 = LocalDate.of(2013, 12, 11);LocalDate date2 = date1.with(TemporalAdjusters.nextOrSame(DayOfWeek.MONDAY));LocalDate date3 = date2.with(TemporalAdjusters.lastDayOfMonth()); ä½¿ç”¨TemporalAdjusterå¯ä»¥è¿›è¡Œæ›´åŠ å¤æ‚çš„æ—¥æœŸæ“ä½œï¼Œæ–¹æ³•çš„åç§°å¾ˆç›´è§‚ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆé¢„æœŸçš„é¢„å®šä¹‰çš„TemporalAdjusterï¼Œå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„TemporalAdjusterã€‚TemporalAdjusteræ¥å£åªå£°æ˜ä¸€ä¸ªæ–¹æ³•ï¼ˆå³å‡½æ•°å¼æ¥å£ï¼‰ã€‚å®ç°è¯¥æ¥å£éœ€è¦å®šä¹‰å¦‚ä½•å°†ä¸€ä¸ªTemporalå¯¹è±¡è½¬æ¢ä¸ºå¦ä¸€ä¸ªTemporalå¯¹è±¡,å¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªUnaryOperatorã€‚ 1234@FunctionalInterfacepublic interface TemporalAdjuster { Temporal adjustInto(Temporal temporal);} 7. æ‰“å°è¾“å‡ºåŠè§£ææ—¥æœŸ-æ—¶é—´å¯¹è±¡æ–°çš„java.time.formatåŒ…å°±æ˜¯ç‰¹åˆ«ä¸ºæ ¼å¼åŒ–ä»¥åŠè§£ææ—¥æœŸ-æ—¶é—´å¯¹è±¡è€Œè®¾è®¡çš„ã€‚å…¶ä¸­æœ€é‡è¦çš„ç±»æ˜¯DateTimeFormatterã€‚åˆ›å»ºæ ¼å¼å™¨æœ€ç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡å®ƒçš„é™æ€å·¥å‚æ–¹æ³•ä»¥åŠå¸¸é‡ã€‚æ‰€æœ‰çš„DateTimeFormatterå®ä¾‹éƒ½èƒ½ç”¨äºä»¥ä¸€å®šçš„æ ¼å¼åˆ›å»ºä»£è¡¨ç‰¹å®šæ—¥æœŸæˆ–æ—¶é—´çš„å­—ç¬¦ä¸²ã€‚ 123456LocalDate date = LocalDate.of(2013, 10, 11);String s1 = date.format(DateTimeFormatter.BASIC_ISO_DATE);String s2 = date.format(DateTimeFormatter.ISO_LOCAL_DATE);201310112013-10-11 é€šè¿‡è§£æä»£è¡¨æ—¥æœŸæˆ–æ—¶é—´çš„å­—ç¬¦ä¸²é‡æ–°åˆ›å»ºè¯¥æ—¥æœŸå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å‚æ–¹æ³•parseé‡æ–°åˆ›å»ºã€‚ 12LocalDate date2 = LocalDate.parse(\"20141007\", DateTimeFormatter.BASIC_ISO_DATE);LocalDate date3 = LocalDate.parse(\"2014-10-07\", DateTimeFormatter.ISO_LOCAL_DATE); DateTimeFormatterå®ä¾‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€çš„java.util.DateFormatçº¿ç¨‹ä¸å®‰å…¨ã€‚å•ä¾‹æ¨¡å¼åˆ›å»ºæ ¼å¼å™¨å®ä¾‹ï¼Œåœ¨å¤šä¸ªçº¿ç¨‹é—´å…±äº«å®ä¾‹æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ofPatterné™æ€å·¥å‚æ–¹æ³•ï¼ŒæŒ‰ç…§æŸä¸ªç‰¹å®šçš„æ¨¡å¼åˆ›å»ºæ ¼å¼å™¨ã€‚ 123DateTimeFormatter formatter = DateTimeFormatter.ofPattern(\"dd/MM/yyyy\");String formattedDateStr = date.format(formatter);LocalDate date1 = LocalDate.parse(formattedDateStr, formatter); ofPatternæ–¹æ³•ä¹Ÿæä¾›äº†ä¸€ä¸ªé‡è½½çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä¼ å…¥Localeåˆ›å»ºæ ¼å¼å™¨ã€‚ 1234DateTimeFormatter italianFormatter = DateTimeFormatter.ofPattern(\"d. MMMM yyyy\", Locale.ITALIAN);LocalDate date = LocalDate.of(2015, 11, 14);String formattedDate = date.format(italianFormatter);LocalDate date1 = LocalDate.parse(formattedDate, italianFormatter); DateTimeFormatterBuilderç±»è¿˜æä¾›äº†æ›´å¤æ‚çš„æ ¼å¼å™¨,ä»¥æä¾›æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶ã€‚åŒæ—¶ä¹Ÿæä¾›éå¸¸å¼ºå¤§çš„è§£æåŠŸèƒ½ï¼Œæ¯”å¦‚åŒºåˆ†å¤§å°å†™çš„è§£æã€æŸ”æ€§è§£æã€å¡«å……ï¼Œä»¥åŠåœ¨æ ¼å¼å™¨ä¸­æŒ‡å®šå¯é€‰èŠ‚ç­‰ç­‰ã€‚ é€šè¿‡DateTimeFormatterBuilderè‡ªå®šä¹‰æ ¼å¼å™¨ 12345678910DateTimeFormatter italianFormatter = new DateTimeFormatterBuilder() .appendText(ChronoField.DAY_OF_MONTH) .appendLiteral(\". \") .appendText(ChronoField.MONTH_OF_YEAR) .appendLiteral(\" \") .appendText(ChronoField.YEAR) .parseCaseInsensitive() .toFormatter(Locale.ITALIAN);LocalDate now = LocalDate.now();String s = now.format(italianFormatter); 8. å¤„ç†ä¸åŒçš„æ—¶åŒºå’Œå†æ³•æ–°ç‰ˆæ—¥æœŸå’Œæ—¶é—´APIæ–°å¢åŠ çš„é‡è¦åŠŸèƒ½æ˜¯æ—¶åŒºçš„å¤„ç†ã€‚æ–°çš„java.time.ZoneIdç±»æ›¿ä»£è€ç‰ˆjava.util.TimeZoneã€‚è·Ÿå…¶ä»–æ—¥æœŸå’Œæ—¶é—´ç±»ä¸€æ ·ï¼ŒZoneIdç±»ä¹Ÿæ˜¯æ— æ³•ä¿®æ”¹çš„ã€‚æ˜¯æŒ‰ç…§ä¸€å®šçš„è§„åˆ™å°†åŒºåŸŸåˆ’åˆ†æˆçš„æ ‡å‡†æ—¶é—´ç›¸åŒçš„åŒºé—´ã€‚åœ¨ZoneRulesè¿™ä¸ªç±»ä¸­åŒ…å«äº†40ä¸ªæ—¶åŒºå®ä¾‹,å¯ä»¥é€šè¿‡è°ƒç”¨ZoneIdçš„getRules()å¾—åˆ°æŒ‡å®šæ—¶åŒºçš„è§„åˆ™,æ¯ä¸ªç‰¹å®šçš„ZoneIdå¯¹è±¡éƒ½ç”±ä¸€ä¸ªåœ°åŒºIDæ ‡è¯†ã€‚ 1ZoneId shanghaiZone = ZoneId.of(\"Asia/Shanghai\"); Java 8çš„æ–°æ–¹æ³•toZoneIdå°†ä¸€ä¸ªè€çš„æ—¶åŒºå¯¹è±¡è½¬æ¢ä¸ºZoneIdã€‚åœ°åŒºIDéƒ½ä¸ºâ€œ{åŒºåŸŸ}/{åŸå¸‚}â€çš„æ ¼å¼ï¼Œåœ°åŒºé›†åˆçš„è®¾å®šéƒ½ç”±è‹±ç‰¹ç½‘ç¼–å·åˆ†é…æœºæ„ï¼ˆIANAï¼‰çš„æ—¶åŒºæ•°æ®åº“æä¾›ã€‚ 1ZoneId zoneId = TimeZone.getDefault().toZoneId(); ZoneIdå¯¹è±¡å¯ä»¥ä¸LocalDateã€LocalDateTimeæˆ–è€…æ˜¯Instantå¯¹è±¡æ•´åˆæ„é€ ä¸ºæˆZonedDateTimeå®ä¾‹ï¼Œå®ƒä»£è¡¨äº†ç›¸å¯¹äºæŒ‡å®šæ—¶åŒºçš„æ—¶é—´ç‚¹ã€‚ 12345678910111213141516LocalDate date = LocalDate.of(2019, 03, 27);ZonedDateTime zdt1 = date.atStartOfDay(shanghaiZone);LocalDateTime dateTime = LocalDateTime.of(2015, 12, 21, 11, 11, 11);ZonedDateTime zdt2 = dateTime.atZone(shanghaiZone);Instant instant = Instant.now();ZonedDateTime zdt3 = instant.atZone(shanghaiZone);é€šè¿‡ZoneIdï¼Œä½ è¿˜å¯ä»¥å°†LocalDateTimeè½¬æ¢ä¸ºInstantï¼šLocalDateTime dateTime = LocalDateTime.of(2016, 10, 14, 15, 35);Instant instantFromDateTime = dateTime.toInstant(shanghaiZone);ä½ ä¹Ÿå¯ä»¥é€šè¿‡åå‘çš„æ–¹å¼å¾—åˆ°LocalDateTimeå¯¹è±¡ï¼šInstant instant = Instant.now();LocalDateTime timeFromInstant = LocalDateTime.ofInstant(instant, shanghaiZone); å¦ä¸€ç§æ¯”è¾ƒé€šç”¨çš„è¡¨è¾¾æ—¶åŒºçš„æ–¹å¼æ˜¯åˆ©ç”¨å½“å‰æ—¶åŒºå’ŒUTC/æ ¼æ—å°¼æ²»çš„å›ºå®šåå·®ã€‚ä½¿ç”¨ZoneIdçš„ä¸€ä¸ªå­ç±»ZoneOffsetï¼Œè¡¨ç¤ºçš„æ˜¯å½“å‰æ—¶é—´å’Œä¼¦æ•¦æ ¼æ—å°¼æ²»å­åˆçº¿æ—¶é—´çš„å·®å¼‚ï¼š 1ZoneOffset newYorkOffset = ZoneOffset.of(\"-05:00\"); 9. æ€»ç»“ Java 8ä¹‹å‰è€ç‰ˆçš„java.util.Dateç±»ä»¥åŠå…¶ä»–ç”¨äºå»ºæ¨¡æ—¥æœŸæ—¶é—´çš„ç±»æœ‰å¾ˆå¤šä¸ä¸€è‡´åŠè®¾è®¡ä¸Šçš„ç¼ºé™·ï¼ŒåŒ…æ‹¬æ˜“å˜æ€§ä»¥åŠç³Ÿç³•çš„åç§»å€¼ã€é»˜è®¤å€¼å’Œå‘½åã€‚ æ–°ç‰ˆçš„æ—¥æœŸå’Œæ—¶é—´APIä¸­ï¼Œæ—¥æœŸ-æ—¶é—´å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚ æ–°çš„APIæä¾›äº†ä¸¤ç§ä¸åŒçš„æ—¶é—´è¡¨ç¤ºæ–¹å¼ï¼Œæœ‰æ•ˆåœ°åŒºåˆ†äº†è¿è¡Œæ—¶äººå’Œæœºå™¨çš„ä¸åŒéœ€æ±‚ã€‚ ä½ å¯ä»¥ç”¨ç»å¯¹æˆ–è€…ç›¸å¯¹çš„æ–¹å¼æ“çºµæ—¥æœŸå’Œæ—¶é—´ï¼Œæ“ä½œçš„ç»“æœæ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œè€çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚ TemporalAdjusterè®©ä½ èƒ½å¤Ÿç”¨æ›´ç²¾ç»†çš„æ–¹å¼æ“çºµæ—¥æœŸï¼Œä¸å†å±€é™äºä¸€æ¬¡åªèƒ½æ”¹å˜å®ƒçš„ä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”ä½ è¿˜å¯æŒ‰ç…§éœ€æ±‚å®šä¹‰è‡ªå·±çš„æ—¥æœŸè½¬æ¢å™¨ã€‚ ä½ ç°åœ¨å¯ä»¥æŒ‰ç…§ç‰¹å®šçš„æ ¼å¼éœ€æ±‚ï¼Œå®šä¹‰è‡ªå·±çš„æ ¼å¼å™¨ï¼Œæ‰“å°è¾“å‡ºæˆ–è€…è§£ææ—¥æœŸï€­æ—¶é—´å¯¹è±¡ã€‚è¿™äº›æ ¼å¼å™¨å¯ä»¥é€šè¿‡æ¨¡æ¿åˆ›å»ºï¼Œä¹Ÿå¯ä»¥è‡ªå·±ç¼–ç¨‹åˆ›å»ºï¼Œå¹¶ä¸”å®ƒä»¬éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ ä½ å¯ä»¥ç”¨ç›¸å¯¹äºæŸä¸ªåœ°åŒº/ä½ç½®çš„æ–¹å¼ï¼Œæˆ–è€…ä»¥ä¸UTC/æ ¼æ—å°¼æ²»æ—¶é—´çš„ç»å¯¹åå·®çš„æ–¹å¼è¡¨ç¤ºæ—¶åŒºï¼Œå¹¶å°†å…¶åº”ç”¨åˆ°æ—¥æœŸï€­æ—¶é—´å¯¹è±¡ä¸Šï¼Œå¯¹å…¶è¿›è¡Œæœ¬åœ°åŒ–ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/26/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%2012%EF%BC%9A%E6%96%B0%E7%9A%84%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4API/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 5ï¼šä½¿ç”¨æµ","text":"æµè®©ä½ ä»å¤–éƒ¨è¿­ä»£è½¬å‘å†…éƒ¨è¿­ä»£ï¼Œforå¾ªç¯æ˜¾ç¤ºè¿­ä»£ä¸ç”¨å†å†™äº†ï¼Œæµå†…éƒ¨ç®¡ç†å¯¹é›†åˆæ•°æ®çš„è¿­ä»£ã€‚è¿™ç§å¤„ç†æ•°æ®çš„æ–¹å¼å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºä½ è®©Stream APIç®¡ç†å¦‚ä½•å¤„ç†æ•°æ®ã€‚è¿™æ ·Stream APIå°±å¯ä»¥åœ¨èƒŒåè¿›è¡Œå¤šç§ä¼˜åŒ–ã€‚æ­¤å¤–ï¼Œä½¿ç”¨å†…éƒ¨è¿­ä»£çš„è¯ï¼ŒStream APIå¯ä»¥å†³å®šå¹¶è¡Œè¿è¡Œä½ çš„ä»£ç ã€‚è¿™è¦æ˜¯ç”¨å¤–éƒ¨è¿­ä»£çš„è¯å°±åŠä¸åˆ°äº†ï¼Œå› ä¸ºä½ åªèƒ½ç”¨å•ä¸€çº¿ç¨‹æŒ¨ä¸ªè¿­ä»£ã€‚ 1. ç­›é€‰å’Œåˆ‡ç‰‡1.1 ç”¨è°“è¯ç­›é€‰è¯¥æ“ä½œä¼šæ¥å—ä¸€ä¸ªè°“è¯(ä¸€ä¸ªè¿”å› booleançš„å‡½æ•°)ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰ç¬¦åˆè°“è¯çš„å…ƒç´ çš„æµã€‚ç­›é€‰å‡ºæ‰€æœ‰ç´ èœ 123List&lt;Dish&gt; vegetarianMenu = menu.stream() .filter(Dish::isVegetarian) .collect(toList()); 1.2 ç­›é€‰å„å¼‚çš„å…ƒç´ è¿”å›ä¸€ä¸ªå…ƒç´ å„å¼‚(æ ¹æ®æµæ‰€ç”Ÿæˆå…ƒç´ çš„ hashCodeå’Œequalsæ–¹æ³•å®ç°)çš„æµã€‚ç­›é€‰å‡ºåˆ—è¡¨ä¸­æ‰€æœ‰çš„å¶æ•°ï¼Œå¹¶ç¡®ä¿æ²¡æœ‰é‡å¤ã€‚ 12345List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4);numbers.stream() .filter(i -&gt; i % 2 == 0) .distinct() .forEach(System.out::println); 1.3 æˆªçŸ­æµæµæ”¯æŒlimit(n)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¸è¶…è¿‡ç»™å®šé•¿åº¦çš„æµã€‚æ‰€éœ€çš„é•¿åº¦ä½œä¸ºå‚æ•°ä¼ é€’ç»™limitã€‚å¦‚æœæµæ˜¯æœ‰åºçš„ï¼Œåˆ™æœ€å¤šä¼šè¿”å›å‰nä¸ªå…ƒç´ ã€‚é€‰å‡ºçƒ­é‡è¶…è¿‡300å¡è·¯é‡Œçš„å¤´ä¸‰é“èœ 1234List&lt;Dish&gt; dishes = menu.stream() .filter(d -&gt; d.getCalories() &gt; 300) .limit(3) .collect(toList()); limitä¹Ÿå¯ä»¥ç”¨åœ¨æ— åºæµä¸Šï¼Œæ¯”å¦‚æºæ˜¯ä¸€ä¸ªSetã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œlimitçš„ç»“æœä¸ä¼šä»¥ ä»»ä½•é¡ºåºæ’åˆ—ã€‚ 1.4 è·³è¿‡å…ƒç´ æµè¿˜æ”¯æŒskip(n)æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰nä¸ªå…ƒç´ çš„æµã€‚å¦‚æœæµä¸­å…ƒç´ ä¸è¶³nä¸ªï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæµã€‚è·³è¿‡è¶…è¿‡300å¡è·¯é‡Œçš„å¤´ä¸¤é“èœï¼Œå¹¶è¿”å›å‰©ä¸‹çš„ã€‚ 1234List&lt;Dish&gt; dishes = menu.stream() .filter(d -&gt; d.getCalories() &gt; 300) .skip(2) .collect(toList()); 2. æ˜ å°„2.1 å¯¹æµä¸­æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°æµæ”¯æŒmapæ–¹æ³•ï¼Œå®ƒä¼šæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚æå–æµä¸­èœè‚´çš„åç§°ï¼š 123List&lt;String&gt; dishNames = menu.stream() .map(Dish::getName) .collect(toList()); 2.2 æµçš„æ‰å¹³åŒ–flatmapæ–¹æ³•è®©ä½ æŠŠä¸€ä¸ªæµä¸­çš„æ¯ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰çš„æµè¿æ¥èµ·æ¥æˆä¸ºä¸€ä¸ªæµã€‚å•ä¸ªæµéƒ½è¢«åˆå¹¶èµ·æ¥ï¼Œå³æ‰å¹³åŒ–ä¸ºä¸€ä¸ªæµã€‚ä¾‹å¦‚ï¼Œç»™å®šå•è¯åˆ—è¡¨ [â€œHelloâ€,â€Worldâ€]ï¼Œä½ æƒ³è¦è¿”å›åˆ—è¡¨[â€œHâ€,â€eâ€,â€lâ€, â€œoâ€,â€Wâ€,â€râ€,â€dâ€]ã€‚ 123456List&lt;String&gt; words = Arrays.asList(\"Java 8\", \"Lambdas\", \"In\", \"Actionâ€);List&lt;String&gt; uniqueCharacters = words.stream() .map(w -&gt; w.split(\"\")) .flatMap(Arrays::stream) .distinct() .collect(Collectors.toList()); 3. æŸ¥æ‰¾å’ŒåŒ¹é…3.1 æ£€æŸ¥è°“è¯æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ anyMatchæ–¹æ³•å¯ä»¥å›ç­”â€œæµä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå…ƒç´ èƒ½åŒ¹é…ç»™å®šçš„è°“è¯â€ã€‚anyMatchæ–¹æ³•è¿”å›ä¸€ä¸ªbooleanï¼Œå› æ­¤æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥çœ‹çœ‹èœå•é‡Œé¢æ˜¯å¦æœ‰ç´ é£Ÿå¯é€‰æ‹©: 123if(menu.stream().anyMatch(Dish::isVegetarian)){System.out.println(\"The menu is (somewhat) vegetarian friendly!!\");} 3.2 æ£€æŸ¥è°“è¯æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ allMatchæ–¹æ³•çš„å·¥ä½œåŸç†å’ŒanyMatchç±»ä¼¼ï¼Œä½†å®ƒä¼šçœ‹çœ‹æµä¸­çš„å…ƒç´ æ˜¯å¦éƒ½èƒ½åŒ¹é…ç»™å®šçš„è°“è¯ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥çœ‹çœ‹èœå“æ˜¯å¦æœ‰åˆ©å¥åº·(å³æ‰€æœ‰èœçš„çƒ­é‡éƒ½ä½äº1000å¡è·¯é‡Œ): 1boolean isHealthy = menu.stream().allMatch(d -&gt; d.getCalories() &lt; 1000); å’ŒallMatchç›¸å¯¹çš„æ˜¯noneMatchã€‚å®ƒå¯ä»¥ç¡®ä¿æµä¸­æ²¡æœ‰ä»»ä½•å…ƒç´ ä¸ç»™å®šçš„è°“è¯åŒ¹é…ã€‚æ¯”å¦‚ï¼Œ ä½ å¯ä»¥ç”¨noneMatché‡å†™å‰é¢çš„ä¾‹å­: 1boolean isHealthy = menu.stream().noneMatch(d -&gt; d.getCalories() &gt;= 1000); anyMatchã€allMatchå’ŒnoneMatchè¿™ä¸‰ä¸ªæ“ä½œéƒ½ç”¨åˆ°äº†æˆ‘ä»¬æ‰€è°“çš„çŸ­è·¯ï¼Œè¿™å°±æ˜¯å¤§å®¶ç†Ÿæ‚‰ çš„Javaä¸­&amp;&amp;å’Œ||è¿ç®—ç¬¦çŸ­è·¯åœ¨æµä¸­çš„ç‰ˆæœ¬ã€‚ 3.3 æŸ¥æ‰¾å…ƒç´ findAnyæ–¹æ³•å°†è¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ ã€‚å®ƒå¯ä»¥ä¸å…¶ä»–æµæ“ä½œç»“åˆä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œä½ å¯èƒ½æƒ³æ‰¾åˆ°ä¸€é“ç´ é£Ÿèœè‚´ã€‚ä½ å¯ä»¥ç»“åˆä½¿ç”¨filterå’ŒfindAnyæ–¹æ³•æ¥å®ç°è¿™ä¸ªæŸ¥è¯¢: 123Optional&lt;Dish&gt; dish =menu.stream() .filter(Dish::isVegetarian) .findAny(); Optionalç±»(java.util.Optional)æ˜¯ä¸€ä¸ªå®¹å™¨ç±»ï¼Œä»£è¡¨ä¸€ä¸ªå€¼å­˜åœ¨æˆ–ä¸å­˜åœ¨ã€‚Optionalé‡Œé¢å‡ ç§å¯ä»¥è¿«ä½¿ä½ æ˜¾å¼åœ°æ£€æŸ¥å€¼æ˜¯å¦å­˜åœ¨æˆ–å¤„ç†å€¼ä¸å­˜åœ¨çš„æƒ…å½¢çš„æ–¹æ³•ä¹Ÿä¸é”™ã€‚ isPresent()å°†åœ¨OptionalåŒ…å«å€¼çš„æ—¶å€™è¿”å›true, å¦åˆ™è¿”å›falseã€‚ ifPresent(Consumer block)ä¼šåœ¨å€¼å­˜åœ¨çš„æ—¶å€™æ‰§è¡Œç»™å®šçš„ä»£ç å—ã€‚ T get()ä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™æŠ›å‡ºä¸€ä¸ªNoSuchElementå¼‚å¸¸ã€‚ T orElse(T other)ä¼šåœ¨å€¼å­˜åœ¨æ—¶è¿”å›å€¼ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ªé»˜è®¤å€¼ã€‚ 3.4 æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºæ­¤æœ‰ä¸€ä¸ªfindFirst æ–¹æ³•ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºfindanyã€‚ ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªæ•°å­—åˆ—è¡¨ï¼Œä¸‹é¢çš„ä»£ç èƒ½æ‰¾å‡ºç¬¬ä¸€ä¸ªå¹³æ–¹ èƒ½è¢«3æ•´é™¤çš„æ•°: 12345List&lt;Integer&gt; someNumbers = Arrays.asList(1, 2, 3, 4, 5);Optional&lt;Integer&gt; firstSquareDivisibleByThree = someNumbers.stream() .map(x -&gt; x * x) .filter(x -&gt; x % 3 == 0) .findFirst(); // 9 4. å½’çº¦å½’çº¦æ“ä½œ (å°†æµå½’çº¦æˆä¸€ä¸ªå€¼)ã€‚ç”¨å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„æœ¯è¯­æ¥è¯´ï¼Œè¿™ç§°ä¸ºæŠ˜å (fold)ï¼Œå› ä¸ºä½ å¯ä»¥å°†è¿™ä¸ªæ“ä½œçœ‹æˆæŠŠä¸€å¼ é•¿é•¿çš„çº¸(ä½ çš„æµ)åå¤æŠ˜å æˆä¸€ä¸ªå°æ–¹å—ï¼Œè€Œè¿™å°±æ˜¯æŠ˜å æ“ä½œçš„ç»“æœã€‚ 4.1 å…ƒç´ æ±‚å’Œreduceæ“ä½œæ˜¯å¦‚ä½•ä½œç”¨äºä¸€ä¸ªæµçš„:Lambdaåå¤ç»“åˆæ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°æµè¢«å½’çº¦æˆä¸€ä¸ªå€¼ã€‚reduceæ¥å—ä¸¤ä¸ªå‚æ•°: ä¸€ä¸ªåˆå§‹å€¼ï¼Œè¿™é‡Œæ˜¯0; ä¸€ä¸ªBinaryOperatoræ¥å°†ä¸¤ä¸ªå…ƒç´ ç»“åˆèµ·æ¥äº§ç”Ÿä¸€ä¸ªæ–°å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯ lambda (a, b) -&gt; a + bã€‚ 1int sum = numbers.stream().reduce(0, (a, b) -&gt; a + b); reduceè¿˜æœ‰ä¸€ä¸ªé‡è½½çš„å˜ä½“ï¼Œå®ƒä¸æ¥å—åˆå§‹å€¼ï¼Œä½†æ˜¯ä¼šè¿”å›ä¸€ä¸ªOptionalå¯¹è±¡: 1Optional&lt;Integer&gt; sum = numbers.stream().reduce((a, b) -&gt; (a + b)); 4.2 æœ€å¤§å€¼å’Œæœ€å°å€¼ä½¿ç”¨reduceæ¥è®¡ç®—æµä¸­çš„æœ€å¤§å€¼ 1Optional&lt;Integer&gt; max = numbers.stream().reduce(Integer::max); è¦è®¡ç®—æœ€å°å€¼ï¼Œä½ éœ€è¦æŠŠInteger.minä¼ ç»™reduceæ¥æ›¿æ¢Integer.max: 1Optional&lt;Integer&gt; min = numbers.stream().reduce(Integer::min); 4.3 å°ç»“ 5. å®æˆ˜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970public class ExecDemo { public static void main(String[] args) { Trader raoul = new Trader(\"Raoul\", \"Cambridge\"); Trader mario = new Trader(\"Mario\",\"Milan\"); Trader alan = new Trader(\"Alan\",\"Cambridge\"); Trader brian = new Trader(\"Brian\",\"Cambridge\"); List&lt;Transaction&gt; transactions = Arrays.asList( new Transaction(brian, 2011, 300), new Transaction(raoul, 2012, 1000), new Transaction(raoul, 2011, 400), new Transaction(mario, 2012, 710), new Transaction(mario, 2012, 700), new Transaction(alan, 2012, 950) ); System.out.println(\"(1) æ‰¾å‡º2011å¹´å‘ç”Ÿçš„æ‰€æœ‰äº¤æ˜“ï¼Œå¹¶æŒ‰äº¤æ˜“é¢æ’åº(ä»ä½åˆ°é«˜)ã€‚\"); List&lt;Transaction&gt; collect = transactions.stream() .filter(t -&gt; t.getYear() == 2011) .sorted(Comparator.comparing(Transaction::getValue)) .collect(Collectors.toList()); System.out.println(collect); System.out.println(\"\\n(2) äº¤æ˜“å‘˜éƒ½åœ¨å“ªäº›ä¸åŒçš„åŸå¸‚å·¥ä½œè¿‡?\"); List&lt;String&gt; collect1 = transactions.stream() .map(transaction -&gt; transaction.getTrader().getCity()) .distinct() .collect(Collectors.toList()); System.out.println(collect1); // [Cambridge, Milan] System.out.println(\"\\n(3) æŸ¥æ‰¾æ‰€æœ‰æ¥è‡ªäºå‰‘æ¡¥çš„äº¤æ˜“å‘˜ï¼Œå¹¶æŒ‰å§“åæ’åºã€‚\"); List&lt;Trader&gt; collect2 = transactions.stream() .map(Transaction::getTrader) .filter(trader -&gt; trader.getCity().equals(\"Cambridge\")) .distinct() .sorted(Comparator.comparing(Trader::getName)) .collect(Collectors.toList()); System.out.println(collect2); System.out.println(\"\\n(4) è¿”å›æ‰€æœ‰äº¤æ˜“å‘˜çš„å§“åå­—ç¬¦ä¸²ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åºã€‚\"); String reduce = transactions.stream() .map(transaction -&gt; transaction.getTrader().getName()) .distinct() .sorted() .reduce(\"\", (n1, n2) -&gt; n1 + n2); System.out.println(reduce); System.out.println(\"\\n(5) æœ‰æ²¡æœ‰äº¤æ˜“å‘˜æ˜¯åœ¨ç±³å…°å·¥ä½œçš„?\"); boolean b = transactions.stream() .anyMatch(transaction -&gt; transaction.getTrader().getCity().equals(\"Milan\")); System.out.println(b); System.out.println(\"\\n(6) æ‰“å°ç”Ÿæ´»åœ¨å‰‘æ¡¥çš„äº¤æ˜“å‘˜çš„æ‰€æœ‰äº¤æ˜“é¢ã€‚\"); transactions.stream() .filter(transaction -&gt; transaction.getTrader().getCity().equals(\"Cambridge\")) .map(Transaction::getValue) .forEach(System.out::println); System.out.println(\"\\n(7) æ‰€æœ‰äº¤æ˜“ä¸­ï¼Œæœ€é«˜çš„äº¤æ˜“é¢æ˜¯å¤šå°‘?\"); transactions.stream() .map(Transaction::getValue) .reduce(Integer::max) .ifPresent(System.out::println); System.out.println(\"\\n(8) æ‰¾åˆ°äº¤æ˜“é¢æœ€å°çš„äº¤æ˜“ã€‚\"); transactions.stream() .map(Transaction::getValue) .reduce(Integer::min) .ifPresent(System.out::println); } 6. æ•°å€¼æµ6.1 åŸå§‹ç±»å‹æµç‰¹åŒ–Java 8å¼•å…¥äº†ä¸‰ä¸ªåŸå§‹ç±»å‹ç‰¹åŒ–æµæ¥å£æ¥è§£å†³è¿™ä¸ªé—®é¢˜:IntStreamã€DoubleStreamå’Œ LongStreamï¼Œåˆ†åˆ«å°†æµä¸­çš„å…ƒç´ ç‰¹åŒ–ä¸ºintã€longå’Œdoubleï¼Œä»è€Œé¿å…äº†æš—å«çš„è£…ç®±æˆæœ¬ã€‚ 6.1.1 æ˜ å°„åˆ°æ•°å€¼æµå°†æµè½¬æ¢ä¸ºç‰¹åŒ–ç‰ˆæœ¬çš„å¸¸ç”¨æ–¹æ³•æ˜¯mapToIntã€mapToDoubleå’ŒmapToLongã€‚è¿™äº›æ–¹æ³•å’Œå‰ é¢è¯´çš„mapæ–¹æ³•çš„å·¥ä½œæ–¹å¼ä¸€æ ·ï¼Œåªæ˜¯å®ƒä»¬è¿”å›çš„æ˜¯ä¸€ä¸ªç‰¹åŒ–æµï¼Œè€Œä¸æ˜¯Streamã€‚ä¾‹å¦‚ï¼Œä½  å¯ä»¥åƒä¸‹é¢è¿™æ ·ç”¨mapToIntå¯¹menuä¸­çš„å¡è·¯é‡Œæ±‚å’Œ: 123int calories = menu.stream() // è¿”å›ä¸€ä¸ª Stream&lt;Dish&gt; .mapToInt(Dish::getCalories) // è¿”å›ä¸€ä¸ª IntStream .sum(); è¯·æ³¨æ„ï¼Œå¦‚æœæµæ˜¯ç©ºçš„ï¼Œsumé»˜è®¤è¿”å›0ã€‚IntStreamè¿˜æ”¯æŒå…¶ä»–çš„æ–¹ä¾¿æ–¹æ³•ï¼Œå¦‚maxã€minã€averageç­‰ã€‚ 6.1.2 è½¬æ¢å›å¯¹è±¡æµè¦æŠŠåŸå§‹æµè½¬æ¢æˆä¸€èˆ¬æµ(æ¯ä¸ªintéƒ½ä¼šè£…ç®±æˆä¸€ä¸ª Integer)ï¼Œå¯ä»¥ä½¿ç”¨boxedæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º: 12IntStream intStream = menu.stream().mapToInt(Dish::getCalories); //å°†Streamè½¬æ¢ä¸ºæ•°å€¼æµStream&lt;Integer&gt; stream = intStream.boxed(); // å°†æ•°å€¼æµè½¬æ¢ä¸ºStream 6.1.3 é»˜è®¤å€¼OptionalIntå¯¹äºä¸‰ç§åŸå§‹æµç‰¹åŒ–ï¼Œä¹Ÿåˆ†åˆ«æœ‰ä¸€ä¸ªOptionalåŸå§‹ç±» å‹ç‰¹åŒ–ç‰ˆæœ¬:OptionalIntã€OptionalDoubleå’ŒOptionalLongã€‚ä¾‹å¦‚ï¼Œè¦æ‰¾åˆ°IntStreamä¸­çš„æœ€å¤§å…ƒç´ ï¼Œå¯ä»¥è°ƒç”¨maxæ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªOptionalInt: 1OptionalInt maxCalories = menu.stream().mapToInt(Dish::getCalories).max(); 6.2 æ•°å€¼èŒƒå›´Java 8å¼•å…¥äº†ä¸¤ä¸ªå¯ä»¥ç”¨äºIntStreamå’ŒLongStreamçš„é™æ€æ–¹æ³•ï¼Œå¸®åŠ©ç”Ÿæˆè¿™ç§èŒƒå›´: rangeå’ŒrangeClosedã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ¥å—èµ·å§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ¥å—ç»“æŸå€¼ã€‚ä½†rangeæ˜¯ä¸åŒ…å«ç»“æŸå€¼çš„ï¼Œè€ŒrangeClosedåˆ™åŒ…å«ç»“æŸå€¼ã€‚ 12IntStream evenNumbers = IntStream.range(1, 100) .filter(n -&gt; n % 2 == 0); // ä¸€ä¸ªä»1åˆ°100çš„å¶æ•°æµ è¡¨ç¤ºèŒƒå›´[1, 100)IntStream evenNumbers = IntStream.rangeClosed(1, 100) .filter(n -&gt; n % 2 == 0); // ä¸€ä¸ªä»1åˆ°100çš„å¶æ•°æµ è¡¨ç¤ºèŒƒå›´[1, 100] 7. æ„å»ºæµ7.1 ç”±å€¼åˆ›å»ºæµä½ å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•Stream.ofï¼Œé€šè¿‡æ˜¾å¼å€¼åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒå¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ç›´æ¥ä½¿ç”¨Stream.ofåˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²æµã€‚ç„¶åï¼Œä½ å¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼Œå†ä¸€ä¸ªä¸ªæ‰“å°å‡ºæ¥: 12Stream&lt;String&gt; stream = Stream.of(\"Java 8 \", \"Lambdas \", \"In \", \"Action\"); stream.map(String::toUpperCase).forEach(System.out::println); ä½ å¯ä»¥ä½¿ç”¨emptyå¾—åˆ°ä¸€ä¸ªç©ºæµï¼Œå¦‚ä¸‹æ‰€ç¤º: 1Stream&lt;String&gt; emptyStream = Stream.empty(); 7.2 ç”±æ•°ç»„åˆ›å»ºæµä½ å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•Arrays.streamä»æ•°ç»„åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªåŸå§‹ç±»å‹intçš„æ•°ç»„è½¬æ¢æˆä¸€ä¸ªIntStreamï¼Œå¦‚ä¸‹æ‰€ç¤º: 12int[] numbers = {2, 3, 5, 7, 11, 13}; int sum = Arrays.stream(numbers).sum(); 7.3 ç”±æ–‡ä»¶ç”ŸæˆæµJavaä¸­ç”¨äºå¤„ç†æ–‡ä»¶ç­‰I/Oæ“ä½œçš„NIO API(éé˜»å¡ I/O)å·²æ›´æ–°ï¼Œä»¥ä¾¿åˆ©ç”¨Stream APIã€‚ java.nio.file.Filesä¸­çš„å¾ˆå¤šé™æ€æ–¹æ³•éƒ½ä¼šè¿”å›ä¸€ä¸ªæµã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¾ˆæœ‰ç”¨çš„æ–¹æ³•æ˜¯ Files.linesï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç”±æŒ‡å®šæ–‡ä»¶ä¸­çš„å„è¡Œæ„æˆçš„å­—ç¬¦ä¸²æµã€‚ 7.4 ç”±å‡½æ•°ç”Ÿæˆæµ:åˆ›å»ºæ— é™æµStream APIæä¾›äº†ä¸¤ä¸ªé™æ€æ–¹æ³•æ¥ä»å‡½æ•°ç”Ÿæˆæµ:Stream.iterateå’ŒStream.generateã€‚ è¿™ä¸¤ä¸ªæ“ä½œå¯ä»¥åˆ›å»ºæ‰€è°“çš„æ— é™æµ:ä¸åƒä»å›ºå®šé›†åˆåˆ›å»ºçš„æµé‚£æ ·æœ‰å›ºå®šå¤§å°çš„æµã€‚ç”±iterate 2 å’Œgenerateäº§ç”Ÿçš„æµä¼šç”¨ç»™å®šçš„å‡½æ•°æŒ‰éœ€åˆ›å»ºå€¼ï¼Œå› æ­¤å¯ä»¥æ— ç©·æ— å°½åœ°è®¡ç®—ä¸‹å»!ä¸€èˆ¬æ¥è¯´ï¼Œ åº”è¯¥ä½¿ç”¨limit(n)æ¥å¯¹è¿™ç§æµåŠ ä»¥é™åˆ¶ï¼Œä»¥é¿å…æ‰“å°æ— ç©·å¤šä¸ªå€¼ã€‚ 7.4.1 è¿­ä»£123Stream.iterate(0, n -&gt; n + 2) .limit(10) .forEach(System.out::println); æ­¤æ“ä½œå°†ç”Ÿæˆä¸€ä¸ªæ— é™æµâ€”â€”è¿™ä¸ªæµæ²¡æœ‰ç»“å°¾ï¼Œå› ä¸ºå€¼æ˜¯æŒ‰éœ€è®¡ç®—çš„ï¼Œå¯ä»¥æ°¸è¿œè®¡ç®—ä¸‹å»ã€‚æˆ‘ä»¬è¯´è¿™ä¸ªæµæ˜¯æ— ç•Œçš„ã€‚æ­£å¦‚æˆ‘ä»¬å‰é¢æ‰€è®¨è®ºçš„ï¼Œè¿™æ˜¯æµå’Œé›†åˆä¹‹é—´çš„ä¸€ä¸ªå…³é”®åŒºåˆ«ã€‚æˆ‘ä»¬ä½¿ç”¨limitæ–¹æ³•æ¥æ˜¾å¼é™åˆ¶æµçš„å¤§å°ã€‚è¿™é‡Œåªé€‰æ‹©äº†å‰10ä¸ªå¶æ•°ã€‚ç„¶åå¯ä»¥è°ƒç”¨forEachç»ˆç«¯æ“ä½œæ¥æ¶ˆè´¹æµï¼Œå¹¶åˆ†åˆ«æ‰“å°æ¯ä¸ªå…ƒç´ ã€‚ 7.4.2 ç”Ÿæˆä¸iterateæ–¹æ³•ç±»ä¼¼ï¼Œgenerateæ–¹æ³•ä¹Ÿå¯è®©ä½ æŒ‰éœ€ç”Ÿæˆä¸€ä¸ªæ— é™æµã€‚ä½†generateä¸æ˜¯ä¾æ¬¡ å¯¹æ¯ä¸ªæ–°ç”Ÿæˆçš„å€¼åº”ç”¨å‡½æ•°çš„ã€‚å®ƒæ¥å—ä¸€ä¸ªSupplierç±»å‹çš„Lambdaæä¾›æ–°çš„å€¼ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ç”¨æ³•:è¿™æ®µä»£ç å°†ç”Ÿæˆä¸€ä¸ªæµï¼Œå…¶ä¸­æœ‰äº”ä¸ª0åˆ°1ä¹‹é—´çš„éšæœºåŒç²¾åº¦æ•°ã€‚ 123Stream.generate(Math::random) .limit(5) .forEach(System.out::println); 8. å°ç»“è¿™ä¸€ç« å¾ˆé•¿ï¼Œä½†æ˜¯å¾ˆæœ‰æ”¶è·!ç°åœ¨ä½ å¯ä»¥æ›´é«˜æ•ˆåœ°å¤„ç†é›†åˆäº†ã€‚äº‹å®ä¸Šï¼Œæµè®©ä½ å¯ä»¥ç®€æ´åœ°è¡¨è¾¾å¤æ‚çš„æ•°æ®å¤„ç†æŸ¥è¯¢ã€‚æ­¤å¤–ï¼Œæµå¯ä»¥é€æ˜åœ°å¹¶è¡ŒåŒ–ã€‚ä»¥ä¸‹æ˜¯ä½ åº”ä»æœ¬ç« ä¸­å­¦åˆ°çš„å…³é”®æ¦‚å¿µã€‚ Streams APIå¯ä»¥è¡¨è¾¾å¤æ‚çš„æ•°æ®å¤„ç†æŸ¥è¯¢ã€‚å¸¸ç”¨çš„æµæ“ä½œæ€»ç»“åœ¨è¡¨5-1ä¸­ã€‚ ä½ å¯ä»¥ä½¿ç”¨filterã€distinctã€skipå’Œlimitå¯¹æµåšç­›é€‰å’Œåˆ‡ç‰‡ã€‚ ä½ å¯ä»¥ä½¿ç”¨mapå’ŒflatMapæå–æˆ–è½¬æ¢æµä¸­çš„å…ƒç´ ã€‚ ä½ å¯ä»¥ä½¿ç”¨findFirstå’ŒfindAnyæ–¹æ³•æŸ¥æ‰¾æµä¸­çš„å…ƒç´ ã€‚ä½ å¯ä»¥ç”¨allMatchã€noneMatchå’ŒanyMatchæ–¹æ³•è®©æµåŒ¹é…ç»™å®šçš„è°“è¯ã€‚ è¿™äº›æ–¹æ³•éƒ½åˆ©ç”¨äº†çŸ­è·¯:æ‰¾åˆ°ç»“æœå°±ç«‹å³åœæ­¢è®¡ç®—;æ²¡æœ‰å¿…è¦å¤„ç†æ•´ä¸ªæµã€‚ ä½ å¯ä»¥åˆ©ç”¨reduceæ–¹æ³•å°†æµä¸­æ‰€æœ‰çš„å…ƒç´ è¿­ä»£åˆå¹¶æˆä¸€ä¸ªç»“æœï¼Œä¾‹å¦‚æ±‚å’Œæˆ–æŸ¥æ‰¾æœ€å¤§å…ƒç´ ã€‚ filterå’Œmapç­‰æ“ä½œæ˜¯æ— çŠ¶æ€çš„ï¼Œå®ƒä»¬å¹¶ä¸å­˜å‚¨ä»»ä½•çŠ¶æ€ã€‚reduceç­‰æ“ä½œè¦å­˜å‚¨çŠ¶æ€æ‰èƒ½è®¡ç®—å‡ºä¸€ä¸ªå€¼ã€‚sortedå’Œdistinctç­‰æ“ä½œä¹Ÿè¦å­˜å‚¨çŠ¶æ€ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦æŠŠæµä¸­çš„æ‰€æœ‰å…ƒç´ ç¼“å­˜èµ·æ¥æ‰èƒ½è¿”å›ä¸€ä¸ªæ–°çš„æµã€‚è¿™ç§æ“ä½œç§°ä¸ºæœ‰çŠ¶æ€æ“ä½œã€‚ æµæœ‰ä¸‰ç§åŸºæœ¬çš„åŸå§‹ç±»å‹ç‰¹åŒ–:IntStreamã€DoubleStreamå’ŒLongStreamã€‚å®ƒä»¬çš„æ“ä½œä¹Ÿæœ‰ç›¸åº”çš„ç‰¹åŒ–ã€‚ æµä¸ä»…å¯ä»¥ä»é›†åˆåˆ›å»ºï¼Œä¹Ÿå¯ä»å€¼ã€æ•°ç»„ã€æ–‡ä»¶ä»¥åŠiterateä¸generateç­‰ç‰¹å®šæ–¹æ³•åˆ›å»ºã€‚ æ— é™æµæ˜¯æ²¡æœ‰å›ºå®šå¤§å°çš„æµã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/10/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%205%EF%BC%9A%E4%BD%BF%E7%94%A8%E6%B5%81/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 7ï¼šå¹¶è¡Œæ•°æ®å¤„ç†ä¸æ€§èƒ½","text":"åœ¨Java 7ä¹‹å‰ï¼Œå¹¶è¡Œå¤„ç†æ•°æ®é›†åˆéå¸¸éº»çƒ¦ã€‚ç¬¬ä¸€ï¼Œä½ å¾—æ˜ç¡®åœ°æŠŠåŒ…å«æ•°æ®çš„æ•°æ®ç»“æ„åˆ†æˆè‹¥å¹²å­éƒ¨åˆ†ã€‚ç¬¬äºŒï¼Œä½ è¦ç»™æ¯ä¸ªå­éƒ¨åˆ†åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ã€‚ç¬¬ä¸‰ï¼Œä½ éœ€è¦åœ¨æ°å½“çš„æ—¶å€™å¯¹å®ƒä»¬è¿›è¡ŒåŒæ­¥æ¥é¿å…ä¸å¸Œæœ›å‡ºç°çš„ç«äº‰æ¡ä»¶ï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆï¼Œæœ€åæŠŠè¿™äº›éƒ¨åˆ†ç»“æœåˆå¹¶èµ·æ¥ã€‚Java 7å¼•å…¥äº†ä¸€ä¸ªå«ä½œåˆ†æ”¯/åˆå¹¶çš„æ¡†æ¶ï¼Œè®©è¿™äº›æ“ä½œæ›´ç¨³å®šã€æ›´ä¸æ˜“å‡ºé”™ã€‚Streamæ¥å£è®©ä½ ä¸ç”¨å¤ªè´¹åŠ›æ°”å°±èƒ½å¯¹æ•°æ®é›†æ‰§è¡Œå¹¶è¡Œæ“ä½œã€‚å®ƒå…è®¸ä½ å£°æ˜æ€§åœ°å°†é¡ºåºæµå˜ä¸ºå¹¶è¡Œæµã€‚æ­¤å¤–ï¼Œä½ å°†çœ‹åˆ°Javaæ˜¯å¦‚ä½•å˜æˆæ³•çš„ï¼Œæˆ–è€…æ›´å®é™…åœ°æ¥è¯´ï¼Œ æµæ˜¯å¦‚ä½•åœ¨å¹•ååº”ç”¨Java 7å¼•å…¥çš„åˆ†æ”¯/åˆå¹¶æ¡†æ¶çš„ã€‚ 1. å¹¶è¡Œæµå¹¶è¡Œæµå°±æ˜¯ä¸€ä¸ªæŠŠå†…å®¹åˆ†æˆå¤šä¸ªæ•°æ®å—ï¼Œå¹¶ç”¨ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å¤„ç†æ¯ä¸ªæ•°æ®å—çš„æµã€‚ 12345678910111213public static long sequentialSum(long n) { return Stream.iterate(1L, i -&gt; i + 1) .limit(n) .reduce(0L, Long::sum);}ä¼ ç»Ÿå†™æ³•ï¼špublic static long iterativeSum(long n) { long result = 0; for (long i = 1L; i &lt;= n; i++) { result += i; } return result;} 1.1 å°†é¡ºåºæµè½¬æ¢ä¸ºå¹¶è¡Œæµå¯ä»¥æŠŠæµè½¬æ¢æˆå¹¶è¡Œæµï¼Œä»è€Œè®©å‰é¢çš„å‡½æ•°å½’çº¦è¿‡ç¨‹(ä¹Ÿå°±æ˜¯æ±‚å’Œ)å¹¶è¡Œè¿è¡Œâ€”â€”å¯¹é¡ºåºæµè°ƒç”¨parallelæ–¹æ³•: 123456public static long parallelSum(long n) { return Stream.iterate(1L, i -&gt; i + 1) .limit(n) .parallel() .reduce(0L, Long::sum);} åœ¨ç°å®ä¸­ï¼Œå¯¹é¡ºåºæµè°ƒç”¨parallelæ–¹æ³•å¹¶ä¸æ„å‘³ç€æµæœ¬èº«æœ‰ä»»ä½•å®é™…çš„å˜åŒ–ã€‚å®ƒåœ¨å†…éƒ¨å®é™…ä¸Šå°±æ˜¯è®¾äº†ä¸€ä¸ªbooleanæ ‡å¿—ï¼Œè¡¨ç¤ºä½ æƒ³è®©è°ƒç”¨parallelä¹‹åè¿›è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½å¹¶è¡Œæ‰§è¡Œã€‚ç±»ä¼¼åœ°ï¼Œä½ åªéœ€è¦å¯¹å¹¶è¡Œæµè°ƒç”¨sequentialæ–¹æ³•å°±å¯ä»¥æŠŠå®ƒå˜æˆé¡ºåºæµã€‚è¯·æ³¨æ„ï¼Œä½ å¯èƒ½ä»¥ä¸ºæŠŠè¿™ä¸¤ä¸ªæ–¹æ³•ç»“åˆèµ·æ¥ï¼Œå°±å¯ä»¥æ›´ç»†åŒ–åœ°æ§åˆ¶åœ¨éå†æµæ—¶å“ªäº›æ“ä½œè¦å¹¶è¡Œæ‰§è¡Œï¼Œå“ªäº›è¦é¡ºåºæ‰§è¡Œã€‚ é…ç½®å¹¶è¡Œæµä½¿ç”¨çš„çº¿ç¨‹æ± çœ‹çœ‹æµçš„parallelæ–¹æ³•ï¼Œä½ å¯èƒ½ä¼šæƒ³ï¼Œå¹¶è¡Œæµç”¨çš„çº¿ç¨‹æ˜¯ä»å“ªæ¥çš„?æœ‰å¤šå°‘ä¸ª?æ€ä¹ˆè‡ªå®šä¹‰è¿™ä¸ªè¿‡ç¨‹å‘¢?å¹¶è¡Œæµå†…éƒ¨ä½¿ç”¨äº†é»˜è®¤çš„ForkJoinPoolï¼Œå®ƒé»˜è®¤çš„çº¿ç¨‹æ•°é‡å°±æ˜¯ä½ çš„å¤„ç†å™¨æ•°é‡ï¼Œè¿™ä¸ªå€¼æ˜¯ç”±Runtime.getRuntime().available- Processors()å¾—åˆ°çš„ã€‚ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ç³»ç»Ÿå±æ€§ java.util.concurrent.ForkJoinPool.common.parallelismæ¥æ”¹å˜çº¿ç¨‹æ± å¤§å°ï¼Œå¦‚ä¸‹æ‰€ç¤º:System.setProperty(â€œjava.util.concurrent.ForkJoinPool.common.parallelismâ€,â€12â€);è¿™æ˜¯ä¸€ä¸ªå…¨å±€è®¾ç½®ï¼Œå› æ­¤å®ƒå°†å½±å“ä»£ç ä¸­æ‰€æœ‰çš„å¹¶è¡Œæµã€‚åè¿‡æ¥è¯´ï¼Œç›®å‰è¿˜æ— æ³•ä¸“ä¸ºæŸä¸ªå¹¶è¡ŒæµæŒ‡å®šè¿™ä¸ªå€¼ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œè®©ForkJoinPoolçš„å¤§å°ç­‰äºå¤„ç†å™¨æ•°é‡æ˜¯ä¸ªä¸é”™çš„é»˜è®¤å€¼ï¼Œé™¤éä½ æœ‰å¾ˆå¥½çš„ç†ç”±ï¼Œå¦åˆ™æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ä¸è¦ä¿®æ”¹å®ƒã€‚ 1.2 æµ‹é‡æµæ€§èƒ½å¹¶è¡Œç¼–ç¨‹å¯èƒ½å¾ˆå¤æ‚ï¼Œæœ‰æ—¶å€™ç”šè‡³æœ‰ç‚¹è¿åç›´è§‰ã€‚å¦‚æœç”¨å¾—ä¸å¯¹(æ¯”å¦‚é‡‡ç”¨äº†ä¸€ ä¸ªä¸æ˜“å¹¶è¡ŒåŒ–çš„æ“ä½œï¼Œå¦‚iterate)ï¼Œå®ƒç”šè‡³å¯èƒ½è®©ç¨‹åºçš„æ•´ä½“æ€§èƒ½æ›´å·®ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨é‚£ä¸ªçœ‹ä¼¼ç¥å¥‡çš„parallelæ“ä½œæ—¶ï¼Œäº†è§£èƒŒååˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆæ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚å¹¶è¡ŒåŒ–å¹¶ä¸æ˜¯æ²¡æœ‰ä»£ä»·çš„ã€‚å¹¶è¡ŒåŒ–è¿‡ç¨‹æœ¬èº«éœ€è¦å¯¹æµåšé€’å½’åˆ’åˆ†ï¼ŒæŠŠæ¯ä¸ªå­æµçš„å½’çº³æ“ä½œåˆ†é…åˆ°ä¸åŒçš„çº¿ç¨‹ï¼Œç„¶åæŠŠè¿™äº›æ“ä½œçš„ç»“æœåˆå¹¶æˆä¸€ä¸ªå€¼ã€‚ä½†åœ¨å¤šä¸ªå†…æ ¸ä¹‹é—´ç§»åŠ¨æ•°æ®çš„ä»£ä»·ä¹Ÿå¯èƒ½æ¯”ä½ æƒ³çš„è¦å¤§ï¼Œæ‰€ä»¥å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯è¦ä¿è¯åœ¨å†…æ ¸ä¸­å¹¶è¡Œæ‰§è¡Œå·¥ä½œçš„æ—¶é—´æ¯”åœ¨å†…æ ¸ä¹‹é—´ä¼ è¾“æ•°æ®çš„æ—¶é—´é•¿ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ä¸å¯èƒ½æˆ–ä¸æ–¹ä¾¿å¹¶è¡ŒåŒ–ã€‚ç„¶è€Œï¼Œåœ¨ä½¿ç”¨ å¹¶è¡ŒStreamåŠ é€Ÿä»£ç ä¹‹å‰ï¼Œä½ å¿…é¡»ç¡®ä¿ç”¨å¾—å¯¹;å¦‚æœç»“æœé”™äº†ï¼Œç®—å¾—å¿«å°±æ¯«æ— æ„ä¹‰äº†ã€‚ 1.3 æ­£ç¡®ä½¿ç”¨å¹¶è¡Œæµé”™ç”¨å¹¶è¡Œæµè€Œäº§ç”Ÿé”™è¯¯çš„é¦–è¦åŸå› ï¼Œå°±æ˜¯ä½¿ç”¨çš„ç®—æ³•æ”¹å˜äº†æŸäº›å…±äº«çŠ¶æ€ã€‚ä¸‹é¢æ˜¯å¦ä¸€ç§å®ç°å¯¹å‰nä¸ªè‡ªç„¶æ•°æ±‚å’Œçš„æ–¹æ³•ï¼Œä½†è¿™ä¼šæ”¹å˜ä¸€ä¸ªå…±äº«ç´¯åŠ å™¨: 123456789public static long sideEffectSum(long n) { Accumulator accumulator = new Accumulator(); LongStream.rangeClosed(1, n).forEach(accumulator::add) return accumulator.total;}public class Accumulator { public long total = 0; public void add(long value) { total += value; }} è¿™æ®µä»£ç æœ¬èº«ä¸Šå°±æ˜¯é¡ºåºçš„ï¼Œå› ä¸ºæ¯æ¬¡è®¿é—®totaléƒ½ä¼šå‡ºç°æ•°æ®ç«äº‰ã€‚æ¥ä¸‹æ¥å°†è¿™æ®µä»£ç æ”¹ä¸ºå¹¶è¡Œï¼š 123456789101112public static long sideEffectParallelSum(long n) { Accumulator accumulator = new Accumulator(); LongStream.rangeClosed(1, n).parallel().forEach(accumulator::add); return accumulator.total;}System.out.println(\"SideEffect parallel sum done in: \" + measurePerf(ParallelStreams::sideEffectParallelSum, 10_000_000L) +\" msecs\" );Result: 5959989000692Result: 7425264100768Result: 6827235020033Result: 7192970417739Result: 6714157975331Result: 7715125932481SideEffect parallel sum done in: 49 msecs è¿™å›æ–¹æ³•çš„æ€§èƒ½æ— å…³ç´§è¦äº†ï¼Œå”¯ä¸€è¦ç´§çš„æ˜¯æ¯æ¬¡æ‰§è¡Œéƒ½ä¼šè¿”å›ä¸åŒçš„ç»“æœï¼Œéƒ½ç¦»æ­£ç¡®å€¼50000005000000å·®å¾ˆè¿œã€‚è¿™æ˜¯ç”±äºå¤šä¸ªçº¿ç¨‹åœ¨åŒæ—¶è®¿é—®ç´¯åŠ å™¨ï¼Œæ‰§è¡Œtotal += valueï¼Œè€Œè¿™ä¸€å¥ô±µç„¶çœ‹ä¼¼ç®€å•ï¼Œå´ä¸æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚é—®é¢˜çš„æ ¹æºåœ¨äºï¼ŒforEachä¸­è°ƒç”¨çš„æ–¹æ³•æœ‰å‰¯ä½œç”¨ï¼Œå®ƒä¼šæ”¹å˜å¤šä¸ªçº¿ç¨‹å…±äº«çš„å¯¹è±¡çš„å¯å˜çŠ¶æ€ã€‚è¦æ˜¯ä½ æƒ³ç”¨å¹¶è¡ŒStreamåˆä¸æƒ³å¼•å‘ç±»ä¼¼çš„æ„å¤–ï¼Œå°±å¿…é¡»é¿å…è¿™ç§æƒ…å†µã€‚ç°åœ¨ä½ çŸ¥é“äº†ï¼Œå…±äº«å¯å˜çŠ¶æ€ä¼šå½±å“å¹¶è¡Œæµä»¥åŠå¹¶è¡Œè®¡ç®—ã€‚ 1.4 é«˜æ•ˆä½¿ç”¨å¹¶è¡Œæµ å¦‚æœæœ‰ç–‘é—®ï¼Œæµ‹é‡ã€‚æŠŠé¡ºåºæµè½¬æˆå¹¶è¡Œæµè½»è€Œæ˜“ä¸¾ï¼Œä½†å´ä¸ä¸€å®šæ˜¯å¥½äº‹ã€‚æˆ‘ä»¬åœ¨æœ¬èŠ‚ä¸­å·²ç»æŒ‡å‡ºï¼Œå¹¶è¡Œæµå¹¶ä¸æ€»æ˜¯æ¯”é¡ºåºæµå¿«ã€‚æ­¤å¤–ï¼Œå¹¶è¡Œæµæœ‰æ—¶å€™ä¼šå’Œä½ çš„ç›´è§‰ä¸ä¸€è‡´ï¼Œæ‰€ä»¥åœ¨è€ƒè™‘é€‰æ‹©é¡ºåºæµè¿˜æ˜¯å¹¶è¡Œæµæ—¶ï¼Œç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€é‡è¦çš„å»ºè®®å°±æ˜¯ç”¨é€‚å½“çš„åŸºå‡†æ¥æ£€æŸ¥å…¶æ€§èƒ½ã€‚ ç•™æ„è£…ç®±ã€‚è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±æ“ä½œä¼šå¤§å¤§é™ä½æ€§èƒ½ã€‚Java 8ä¸­æœ‰åŸå§‹ç±»å‹æµ(IntStreamã€ LongStreamã€DoubleStream)æ¥é¿å…è¿™ç§æ“ä½œï¼Œä½†å‡¡æœ‰å¯èƒ½éƒ½åº”è¯¥ç”¨è¿™äº›æµã€‚ æœ‰äº›æ“ä½œæœ¬èº«åœ¨å¹¶è¡Œæµä¸Šçš„æ€§èƒ½å°±æ¯”é¡ºåºæµå·®ã€‚ç‰¹åˆ«æ˜¯limitå’ŒfindFirstç­‰ä¾èµ–äºå…ƒç´ é¡ºåºçš„æ“ä½œï¼Œå®ƒä»¬åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œçš„ä»£ä»·éå¸¸å¤§ã€‚ä¾‹å¦‚ï¼ŒfindAnyä¼šæ¯”findFirstæ€§èƒ½å¥½ï¼Œå› ä¸ºå®ƒä¸ä¸€å®šè¦æŒ‰é¡ºåºæ¥æ‰§è¡Œã€‚ä½ æ€»æ˜¯å¯ä»¥è°ƒç”¨unorderedæ–¹æ³•æ¥æŠŠæœ‰åºæµå˜æˆæ— åºæµã€‚é‚£ä¹ˆï¼Œå¦‚æœä½ éœ€è¦æµä¸­çš„nä¸ªå…ƒç´ è€Œä¸æ˜¯ä¸“é—¨è¦å‰nä¸ªçš„è¯ï¼Œå¯¹æ— åºå¹¶è¡Œæµè°ƒç”¨ limitå¯èƒ½ä¼šæ¯”å•ä¸ªæœ‰åºæµ(æ¯”å¦‚æ•°æ®æºæ˜¯ä¸€ä¸ªList)æ›´é«˜æ•ˆã€‚ è¿˜è¦è€ƒè™‘æµçš„æ“ä½œæµæ°´çº¿çš„æ€»è®¡ç®—æˆæœ¬ã€‚è®¾Næ˜¯è¦å¤„ç†çš„å…ƒç´ çš„æ€»æ•°ï¼ŒQæ˜¯ä¸€ä¸ªå…ƒç´ é€šè¿‡ æµæ°´çº¿çš„å¤§è‡´å¤„ç†æˆæœ¬ï¼Œåˆ™N*Qå°±æ˜¯è¿™ä¸ªå¯¹æˆæœ¬çš„ä¸€ä¸ªç²—ç•¥çš„å®šæ€§ä¼°è®¡ã€‚Qå€¼è¾ƒé«˜å°±æ„å‘³ç€ä½¿ç”¨å¹¶è¡Œæµæ—¶æ€§èƒ½å¥½çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ã€‚ å¯¹äºè¾ƒå°çš„æ•°æ®é‡ï¼Œé€‰æ‹©å¹¶è¡Œæµå‡ ä¹ä»æ¥éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„å†³å®šã€‚å¹¶è¡Œå¤„ç†å°‘æ•°å‡ ä¸ªå…ƒç´ çš„å¥½å¤„è¿˜æŠµä¸ä¸Šå¹¶è¡ŒåŒ–é€ æˆçš„é¢å¤–å¼€é”€ã€‚ è¦è€ƒè™‘æµèƒŒåçš„æ•°æ®ç»“æ„æ˜¯å¦æ˜“äºåˆ†è§£ã€‚ä¾‹å¦‚ï¼ŒArrayListçš„æ‹†åˆ†æ•ˆô¶²æ¯”LinkedList é«˜å¾—å¤šï¼Œå› ä¸ºå‰è€…ç”¨ä¸ç€éå†å°±å¯ä»¥å¹³å‡æ‹†åˆ†ï¼Œè€Œåè€…åˆ™å¿…é¡»éå†ã€‚å¦å¤–ï¼Œç”¨rangeå·¥å‚æ–¹æ³•åˆ›å»ºçš„åŸå§‹ç±»å‹æµä¹Ÿå¯ä»¥å¿«é€Ÿåˆ†è§£ã€‚æœ€åï¼Œä½ å°†åœ¨7.3èŠ‚ä¸­å­¦åˆ°ï¼Œä½ å¯ä»¥è‡ªå·±å®ç°Spliteratoræ¥å®Œå…¨æŒæ¡åˆ†è§£è¿‡ç¨‹ã€‚ æµè‡ªèº«çš„ç‰¹ç‚¹ï¼Œä»¥åŠæµæ°´çº¿ä¸­çš„ä¸­é—´æ“ä½œä¿®æ”¹æµçš„æ–¹å¼ï¼Œéƒ½å¯èƒ½ä¼šæ”¹å˜åˆ†è§£è¿‡ç¨‹çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªSIZEDæµå¯ä»¥åˆ†æˆå¤§å°ç›¸ç­‰çš„ä¸¤éƒ¨åˆ†ï¼Œè¿™æ ·æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥æ¯”è¾ƒé«˜æ•ˆåœ°å¹¶è¡Œå¤„ç†ï¼Œä½†ç­›é€‰æ“ä½œå¯èƒ½ä¸¢å¼ƒçš„å…ƒç´ ä¸ªæ•°å´æ— æ³•é¢„æµ‹ï¼Œå¯¼è‡´æµæœ¬èº«çš„å¤§å°æœªçŸ¥ã€‚ è¿˜è¦è€ƒè™‘ç»ˆô²§æ“ä½œä¸­åˆå¹¶æ­¥éª¤çš„ä»£ä»·æ˜¯å¤§æ˜¯å°(ä¾‹å¦‚Collectorä¸­çš„combineræ–¹æ³•)ã€‚ å¦‚æœè¿™ä¸€æ­¥ä»£ä»·å¾ˆå¤§ï¼Œé‚£ä¹ˆç»„åˆæ¯ä¸ªå­æµäº§ç”Ÿçš„éƒ¨åˆ†ç»“æœæ‰€ä»˜å‡ºçš„ä»£ä»·å°±å¯èƒ½ä¼šè¶…å‡ºé€šè¿‡å¹¶è¡Œæµå¾—åˆ°çš„æ€§èƒ½æå‡ã€‚ å¹¶è¡ŒæµèƒŒåä½¿ç”¨çš„åŸºç¡€æ¶æ„æ˜¯Java 7ä¸­å¼•å…¥çš„åˆ†æ”¯/åˆå¹¶æ¡†æ¶ã€‚ 2. åˆ†æ”¯/åˆå¹¶æ¡†æ¶åˆ†æ”¯/åˆå¹¶æ¡†æ¶çš„ç›®çš„æ˜¯ä»¥é€’å½’æ–¹å¼å°†å¯ä»¥å¹¶è¡Œçš„ä»»åŠ¡æ‹†åˆ†æˆæ›´å°çš„ä»»åŠ¡ï¼Œç„¶åå°†æ¯ä¸ªå­ä»»åŠ¡çš„ç»“æœåˆå¹¶èµ·æ¥ç”Ÿæˆæ•´ä½“ç»“æœã€‚å®ƒæ˜¯ExecutorServiceæ¥å£çš„ä¸€ä¸ªå®ç°ï¼Œå®ƒæŠŠå­ä»»åŠ¡åˆ†é…ç»™çº¿ç¨‹æ± (ç§°ä¸ºForkJoinPool)ä¸­çš„å·¥ä½œçº¿ç¨‹ã€‚ 2.1 ä½¿ç”¨RecursiveTaskè¦æŠŠä»»åŠ¡æäº¤åˆ°è¿™ä¸ªæ± ï¼Œå¿…é¡»åˆ›å»ºRecursiveTaskçš„ä¸€ä¸ªå­ç±»ï¼Œå…¶ä¸­Ræ˜¯å¹¶è¡ŒåŒ–ä»»åŠ¡(ä»¥ åŠæ‰€æœ‰å­ä»»åŠ¡)äº§ç”Ÿçš„ç»“æœç±»å‹ï¼Œæˆ–è€…å¦‚æœä»»åŠ¡ä¸è¿”å›ç»“æœï¼Œåˆ™æ˜¯RecursiveActionç±»å‹(å½“ç„¶å®ƒå¯èƒ½ä¼šæ›´æ–°å…¶ä»–éå±€éƒ¨æœºæ„)ã€‚è¦å®šä¹‰RecursiveTaskï¼Œåªéœ€å®ç°å®ƒå”¯ä¸€çš„æŠ½è±¡æ–¹æ³• compute: 1protected abstract R compute(); è¿™ä¸ªæ–¹æ³•åŒæ—¶å®šä¹‰äº†å°†ä»»åŠ¡æ‹†åˆ†æˆå­ä»»åŠ¡çš„é€»è¾‘ï¼Œä»¥åŠæ— æ³•å†æ‹†åˆ†æˆ–ä¸æ–¹ä¾¿å†æ‹†åˆ†æ—¶ï¼Œç”Ÿæˆå•ä¸ªå­ä»»åŠ¡ç»“æœçš„é€»è¾‘ã€‚ä¸‹å›¾è¡¨ç¤ºäº†é€’å½’ä»»åŠ¡çš„æ‹†åˆ†è¿‡ç¨‹ï¼š è®©æˆ‘ä»¬è¯•ç€ç”¨è¿™ä¸ªæ¡†æ¶ä¸ºä¸€ä¸ªæ•°å­—èŒƒå›´(è¿™é‡Œç”¨ä¸€ä¸ª long[]æ•°ç»„è¡¨ç¤º)æ±‚å’Œã€‚å¦‚å‰æ‰€è¿°ï¼Œä½ éœ€è¦å…ˆä¸ºRecursiveTaskç±»åšä¸€ä¸ªå®ç°ï¼Œå°±æ˜¯ä¸‹é¢ä»£ç æ¸…å•ä¸­çš„ForkJoinSumCalculatorã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940public class ForkJoinSumCalculator extends RecursiveTask&lt;Long&gt; { private final long[] numbers; private final int start; private final int end; public static final long THRESHOLD = 10_000; public ForkJoinSumCalculator(long[] numbers) { this(numbers, 0, numbers.length); } public ForkJoinSumCalculator(long[] numbers, int start, int end) { this.numbers = numbers; this.start = start; this.end = end; } @Override protected Long compute() { int length = end - start; if (length &lt;= THRESHOLD) { return computeSequentially(); } ForkJoinSumCalculator leftTask = new ForkJoinSumCalculator(numbers, start, start + length / 2); leftTask.fork(); ForkJoinSumCalculator rightTask = new ForkJoinSumCalculator(numbers, start + length / 2, end); Long rightResult = rightTask.compute(); Long leftResult = leftTask.join(); return leftResult + rightResult; } private long computeSequentially() { long sum = 0; for (int i = start; i &lt; end; i++) { sum += numbers[i]; } return sum; }} è¿™é‡Œç”¨äº†ä¸€ä¸ªLongStreamæ¥ç”ŸæˆåŒ…å«å‰nä¸ªè‡ªç„¶æ•°çš„æ•°ç»„ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªForkJoinTask (RecursiveTaskçš„çˆ¶ç±»)ï¼Œå¹¶æŠŠæ•°ç»„ä¼ é€’ç»™ä»£ç æ¸…å•7-2æ‰€ç¤ºForkJoinSumCalculatorçš„å…¬å…±æ„é€ å‡½æ•°ã€‚æœ€åï¼Œä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ForkJoinPoolï¼Œå¹¶æŠŠä»»åŠ¡ä¼ ç»™å®ƒçš„è°ƒç”¨æ–¹æ³• ã€‚åœ¨ForkJoinPoolä¸­æ‰§è¡Œæ—¶ï¼Œæœ€åä¸€ä¸ªæ–¹æ³•è¿”å›çš„å€¼å°±æ˜¯ForkJoinSumCalculatorç±»å®šä¹‰çš„ä»»åŠ¡ç»“æœã€‚è¯·æ³¨æ„åœ¨å®é™…åº”ç”¨æ—¶ï¼Œä½¿ç”¨å¤šä¸ªForkJoinPoolæ˜¯æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰çš„ã€‚æ­£æ˜¯å‡ºäºè¿™ä¸ªåŸå› ï¼Œä¸€èˆ¬æ¥è¯´æŠŠå®ƒå®ä¾‹åŒ–ä¸€æ¬¡ï¼Œç„¶åæŠŠå®ä¾‹ä¿å­˜åœ¨é™æ€å­—æ®µä¸­ï¼Œä½¿ä¹‹æˆä¸ºå•ä¾‹ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è½¯ä»¶ä¸­ä»»ä½•éƒ¨åˆ†æ–¹ä¾¿åœ°é‡ç”¨äº†ã€‚è¿™é‡Œåˆ›å»ºæ—¶ç”¨äº†å…¶é»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°ï¼Œè¿™æ„å‘³ç€æƒ³è®©çº¿ç¨‹æ± ä½¿ç”¨JVMèƒ½å¤Ÿä½¿ç”¨çš„æ‰€æœ‰å¤„ç†å™¨ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œè¯¥æ„é€ å‡½æ•°å°†ä½¿ç”¨Runtime.availableProcessorsçš„è¿”å›å€¼æ¥å†³å®šçº¿ç¨‹ô¶ˆä½¿ç”¨çš„çº¿ç¨‹æ•°ã€‚è¯·æ³¨æ„availableProcessorsæ–¹æ³•è™½ç„¶çœ‹èµ·æ¥æ˜¯å¤„ç†å™¨ï¼Œ ä½†å®ƒå®é™…ä¸Šè¿”å›çš„æ˜¯å¯ç”¨å†…æ ¸çš„æ•°é‡ï¼ŒåŒ…æ‹¬è¶…çº¿ç¨‹ç”Ÿæˆçš„è™šæ‹Ÿå†…æ ¸ã€‚å½“æŠŠForkJoinSumCalculatorä»»åŠ¡ä¼ ç»™ForkJoinPoolæ—¶ï¼Œè¿™ä¸ªä»»åŠ¡å°±ç”±ô¶ˆä¸­çš„ä¸€ä¸ªçº¿ç¨‹ æ‰§è¡Œï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šè°ƒç”¨ä»»åŠ¡çš„computeæ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šæ£€æŸ¥ä»»åŠ¡æ˜¯å¦å°åˆ°è¶³ä»¥é¡ºåºæ‰§è¡Œï¼Œå¦‚æœä¸å¤Ÿå°åˆ™ä¼šæŠŠè¦æ±‚å’Œçš„æ•°ç»„åˆ†æˆä¸¤åŠï¼Œåˆ†ç»™ä¸¤ä¸ªæ–°çš„ForkJoinSumCalculatorï¼Œè€Œå®ƒä»¬ä¹Ÿç”±ForkJoinPoolå®‰æ’æ‰§è¡Œã€‚å› æ­¤ï¼Œè¿™ä¸€è¿‡ç¨‹å¯ä»¥é€’å½’é‡å¤ï¼ŒæŠŠåŸä»»åŠ¡åˆ†ä¸ºæ›´å°çš„ä»»åŠ¡ï¼Œç›´åˆ°æ»¡è¶³ä¸æ–¹ä¾¿æˆ–ä¸å¯èƒ½å†è¿›ä¸€æ­¥æ‹†åˆ†çš„æ¡ä»¶(æœ¬ä¾‹ä¸­æ˜¯æ±‚å’Œçš„é¡¹ç›®æ•°å°äºç­‰äº10000)ã€‚è¿™æ—¶ä¼šé¡ºåºè®¡ç®—æ¯ä¸ªä»»åŠ¡çš„ç»“æœï¼Œç„¶åç”±åˆ†æ”¯è¿‡ç¨‹åˆ›å»ºçš„(éšå«çš„)ä»»åŠ¡äºŒå‰æ ‘éå†å›åˆ°å®ƒçš„æ ¹ã€‚æ¥ä¸‹æ¥ä¼šåˆå¹¶æ¯ä¸ªå­ä»»åŠ¡çš„éƒ¨åˆ†ç»“æœï¼Œä»è€Œå¾—åˆ°æ€»ä»»åŠ¡çš„ç»“æœã€‚è¿™ä¸€è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ 2.2 ä½¿ç”¨åˆ†æ”¯/åˆå¹¶æ¡†æ¶çš„æœ€ä½³åšæ³• å¯¹ä¸€ä¸ªä»»åŠ¡è°ƒç”¨joinæ–¹æ³•ä¼šé˜»å¡è°ƒç”¨æ–¹ï¼Œç›´åˆ°è¯¥ä»»åŠ¡åšå‡ºç»“æœã€‚å› æ­¤ï¼Œæœ‰å¿…è¦åœ¨ä¸¤ä¸ªå­ä»»åŠ¡çš„è®¡ç®—éƒ½å¼€å§‹ä¹‹åå†è°ƒç”¨å®ƒã€‚å¦åˆ™ï¼Œä½ å¾—åˆ°çš„ç‰ˆæœ¬ä¼šæ¯”åŸå§‹çš„é¡ºåºç®—æ³•æ›´æ…¢æ›´å¤æ‚ï¼Œå› ä¸ºæ¯ä¸ªå­ä»»åŠ¡éƒ½å¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªå­ä»»åŠ¡å®Œæˆæ‰èƒ½å¯åŠ¨ã€‚ ä¸åº”è¯¥åœ¨RecursiveTaskå†…éƒ¨ä½¿ç”¨ForkJoinPoolçš„invokeæ–¹æ³•ã€‚ç›¸åï¼Œä½ åº”è¯¥å§‹ç»ˆç›´æ¥è°ƒç”¨computeæˆ–forkæ–¹æ³•ï¼Œåªæœ‰é¡ºåºä»£ç æ‰åº”è¯¥ç”¨invokeæ¥å¯åŠ¨å¹¶è¡Œè®¡ç®—ã€‚ å¯¹å­ä»»åŠ¡è°ƒç”¨forkæ–¹æ³•å¯ä»¥æŠŠå®ƒæ’è¿›ForkJoinPoolã€‚åŒæ—¶å¯¹å·¦è¾¹å’Œå³è¾¹çš„å­ä»»åŠ¡è°ƒç”¨å®ƒä¼¼ä¹å¾ˆè‡ªç„¶ï¼Œä½†è¿™æ ·åšçš„æ•ˆô¶²è¦æ¯”ç›´æ¥å¯¹å…¶ä¸­ä¸€ä¸ªè°ƒç”¨computeä½ã€‚è¿™æ ·åšä½ å¯ä»¥ä¸ºå…¶ä¸­ä¸€ä¸ªå­ä»»åŠ¡é‡ç”¨åŒä¸€çº¿ç¨‹ï¼Œä»è€Œé¿å…åœ¨çº¿ç¨‹æ± ä¸­å¤šåˆ†é…ä¸€ä¸ªä»»åŠ¡é€ æˆçš„å¼€é”€ã€‚ è°ƒè¯•ä½¿ç”¨åˆ†æ”¯/åˆå¹¶æ¡†æ¶çš„å¹¶è¡Œè®¡ç®—å¯èƒ½æœ‰ç‚¹æ£˜æ‰‹ã€‚ç‰¹åˆ«æ˜¯ä½ å¹³å¸¸éƒ½åœ¨ä½ å–œæ¬¢çš„IDEé‡Œé¢çœ‹æ ˆè·Ÿè¸ª(stack trace)æ¥æ‰¾é—®é¢˜ï¼Œä½†æ”¾åœ¨åˆ†æ”¯-åˆå¹¶å¹¶è®¡ç®—ä¸Šå°±ä¸è¡Œäº†ï¼Œå› ä¸ºè°ƒç”¨computeçš„çº¿ç¨‹å¹¶ä¸æ˜¯æ¦‚å¿µä¸Šçš„è°ƒç”¨æ–¹ï¼Œåè€…æ˜¯è°ƒç”¨forkçš„é‚£ä¸ªã€‚ å’Œå¹¶è¡Œæµä¸€æ ·ï¼Œä½ ä¸åº”ç†æ‰€å½“ç„¶åœ°è®¤ä¸ºåœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šä½¿ç”¨åˆ†æ”¯/åˆå¹¶æ¡†æ¶å°±æ¯”é¡ºåºè®¡ç®—å¿«ã€‚æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼Œä¸€ä¸ªä»»åŠ¡å¯ä»¥åˆ†è§£æˆå¤šä¸ªç‹¬ç«‹çš„å­ä»»åŠ¡ï¼Œæ‰èƒ½è®©æ€§èƒ½åœ¨å¹¶è¡ŒåŒ–æ—¶æœ‰æ‰€æå‡ã€‚æ‰€æœ‰è¿™äº›å­ä»»åŠ¡çš„è¿è¡Œæ—¶é—´éƒ½åº”è¯¥æ¯”åˆ†å‡ºæ–°ä»»åŠ¡æ‰€èŠ±çš„æ—¶é—´é•¿;ä¸€ä¸ªæƒ¯ç”¨æ–¹æ³•æ˜¯æŠŠè¾“å…¥/è¾“å‡ºæ”¾åœ¨ä¸€ä¸ªå­ä»»åŠ¡é‡Œï¼Œè®¡ç®—æ”¾åœ¨å¦ä¸€ä¸ªé‡Œï¼Œè¿™æ ·è®¡ç®—å°±å¯ä»¥å’Œè¾“å…¥/è¾“å‡ºåŒæ—¶è¿›è¡Œã€‚æ­¤å¤–ï¼Œåœ¨æ¯”è¾ƒåŒä¸€ç®—æ³•çš„é¡ºåºå’Œå¹¶è¡Œç‰ˆæœ¬çš„æ€§èƒ½æ—¶è¿˜æœ‰åˆ«çš„å› ç´ è¦è€ƒè™‘ã€‚å°±åƒä»»ä½•å…¶ä»–Javaä»£ç ä¸€æ ·ï¼Œåˆ†æ”¯/åˆå¹¶æ¡†æ¶éœ€è¦â€œé¢„çƒ­â€æˆ–è€…è¯´è¦æ‰§è¡Œå‡ éæ‰ä¼šè¢«JITç¼–è¯‘å™¨ä¼˜åŒ–ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æµ‹é‡æ€§èƒ½ä¹‹å‰è·‘å‡ éç¨‹åºå¾ˆé‡è¦ï¼Œæˆ‘ä»¬çš„æµ‹è¯•æ¡†æ¶å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚åŒæ—¶è¿˜è¦çŸ¥é“ï¼Œç¼–è¯‘å™¨å†…ç½®çš„ä¼˜åŒ–å¯èƒ½ä¼šä¸ºé¡ºåºç‰ˆæœ¬å¸¦æ¥ä¸€äº›ä¼˜ô²µ(ä¾‹å¦‚æ‰§è¡Œæ­»ç åˆ†æâ€”â€”åˆ å»ä»æœªè¢«ä½¿ç”¨çš„è®¡ç®—)ã€‚ 2.3 å·¥ä½œçªƒå–å®é™…ä¸­ï¼Œæ¯ä¸ªå­ä»»åŠ¡æ‰€èŠ±çš„æ—¶é—´å¯èƒ½å¤©å·®åœ°åˆ«ï¼Œè¦ä¹ˆæ˜¯å› ä¸ºåˆ’åˆ†ç­–ç•¥æ•ˆç‡ä½ï¼Œè¦ä¹ˆæ˜¯æœ‰ä¸å¯é¢„çŸ¥çš„åŸå› ï¼Œæ¯”å¦‚ç£ç›˜è®¿é—®æ…¢ï¼Œæˆ–æ˜¯éœ€è¦å’Œå¤–éƒ¨ä»»åŠ¡åè°ƒæ‰§è¡Œã€‚åˆ†æ”¯/åˆå¹¶æ¡†æ¶å·¥ç¨‹ç”¨ä¸€ç§ç§°ä¸ºå·¥ä½œçªƒå–(work stealing)çš„æŠ€æœ¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™æ„å‘³ç€è¿™äº›ä»»åŠ¡å·®ä¸å¤šè¢«å¹³å‡åˆ†é…åˆ°ForkJoinPoolä¸­çš„æ‰€æœ‰çº¿ç¨‹ä¸Šã€‚æ¯ä¸ªçº¿ç¨‹éƒ½ä¸ºåˆ†é…ç»™å®ƒçš„ä»»åŠ¡ä¿å­˜ä¸€ä¸ªåŒå‘é“¾å¼é˜Ÿåˆ—ï¼Œæ¯å®Œæˆä¸€ä¸ªä»»åŠ¡ï¼Œå°±ä¼šä»é˜Ÿåˆ—å¤´ä¸Šå–å‡ºä¸‹ä¸€ä¸ªä»»åŠ¡å¼€å§‹æ‰§è¡Œã€‚åŸºäºå‰é¢æ‰€è¿°çš„åŸå› ï¼ŒæŸä¸ªçº¿ç¨‹å¯èƒ½æ—©æ—©å®Œæˆäº†åˆ†é…ç»™å®ƒçš„æ‰€æœ‰ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„é˜Ÿåˆ—å·²ç»ç©ºäº†ï¼Œè€Œå…¶ä»–çš„çº¿ç¨‹è¿˜å¾ˆå¿™ã€‚è¿™æ—¶ï¼Œè¿™ä¸ªçº¿ç¨‹å¹¶æ²¡æœ‰é—²ä¸‹æ¥ï¼Œè€Œæ˜¯éšæœºé€‰äº†ä¸€ä¸ªåˆ«çš„çº¿ç¨‹ï¼Œä»é˜Ÿåˆ—çš„å°¾å·´ä¸Šâ€œå·èµ°â€ä¸€ä¸ªä»»åŠ¡ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸€ç›´ç»§ç»­ä¸‹å»ï¼Œç›´åˆ°æ‰€æœ‰çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€æœ‰çš„é˜Ÿåˆ—éƒ½æ¸…ç©ºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦åˆ’æˆè®¸å¤šå°ä»»åŠ¡è€Œä¸æ˜¯å°‘æ•°å‡ ä¸ªå¤§ä»»åŠ¡ï¼Œè¿™æœ‰åŠ©äºæ›´å¥½åœ°åœ¨å·¥ä½œçº¿ç¨‹ä¹‹é—´å¹³è¡¡è´Ÿè½½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ç§å·¥ä½œçªƒå–ç®—æ³•ç”¨äºåœ¨æ± ä¸­çš„å·¥ä½œçº¿ç¨‹ä¹‹é—´é‡æ–°åˆ†é…å’Œå¹³è¡¡ä»»åŠ¡ã€‚ 3. SpliteratorSpliteratoræ˜¯Java 8ä¸­åŠ å…¥çš„å¦ä¸€ä¸ªæ–°æ¥å£;è¿™ä¸ªåå­—ä»£è¡¨â€œå¯åˆ†è¿­ä»£å™¨â€(splitable iterator)ã€‚å’ŒIteratorä¸€æ ·ï¼ŒSpliteratorä¹Ÿç”¨äºéå†æ•°æ®æºä¸­çš„å…ƒç´ ï¼Œä½†å®ƒæ˜¯ä¸ºäº†å¹¶è¡Œæ‰§è¡Œè€Œè®¾è®¡çš„ã€‚ 123456public interface Spliterator&lt;T&gt; { boolean tryAdvance(Consumer&lt;? super T&gt; action); Spliterator&lt;T&gt; trySplit(); long estimateSize(); int characteristics();} ä¸å¾€å¸¸ä¸€æ ·ï¼ŒTæ˜¯Spliteratoréå†çš„å…ƒç´ çš„ç±»å‹ã€‚tryAdvanceæ–¹æ³•çš„è¡Œä¸ºç±»ä¼¼äºæ™®é€šçš„ Iteratorï¼Œå› ä¸ºå®ƒä¼šæŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªä½¿ç”¨Spliteratorä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸”å¦‚æœè¿˜æœ‰å…¶ä»–å…ƒç´ è¦éå†å°±è¿”å›trueã€‚ä½†trySplitæ˜¯ä¸“ä¸ºSpliteratoræ¥å£è®¾è®¡çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥æŠŠä¸€äº›å…ƒç´ åˆ’å‡ºå»åˆ†ç»™ç¬¬äºŒä¸ªSpliterator(ç”±è¯¥æ–¹æ³•è¿”å›)ï¼Œè®©å®ƒä»¬ä¸¤ä¸ªå¹¶è¡Œå¤„ç†ã€‚Spliteratorè¿˜å¯é€šè¿‡ estimateSizeæ–¹æ³•ä¼°è®¡è¿˜å‰©ä¸‹å¤šå°‘å…ƒç´ è¦éå†ï¼Œå› ä¸ºå³ä½¿ä¸é‚£ä¹ˆç¡®åˆ‡ï¼Œèƒ½å¿«é€Ÿç®—å‡ºæ¥æ˜¯ä¸€ä¸ªå€¼ä¹Ÿæœ‰åŠ©äºè®©æ‹†åˆ†å‡åŒ€ä¸€ç‚¹ã€‚ 3.1 æ‹†åˆ†è¿‡ç¨‹å°†Streamæ‹†åˆ†æˆå¤šä¸ªéƒ¨åˆ†çš„ç®—æ³•æ˜¯ä¸€ä¸ªé€’ô°’è¿‡ç¨‹ï¼Œå¦‚å›¾7-6æ‰€ç¤ºã€‚ç¬¬ä¸€æ­¥æ˜¯å¯¹ç¬¬ä¸€ä¸ª Spliteratorè°ƒç”¨trySplitï¼Œç”Ÿæˆç¬¬äºŒä¸ªSpliteratorã€‚ç¬¬äºŒæ­¥å¯¹è¿™ä¸¤ä¸ªSpliteratorè°ƒç”¨ trysplitï¼Œè¿™æ ·æ€»å…±å°±æœ‰äº†å››ä¸ªSpliteratorã€‚è¿™ä¸ªæ¡†æ¶ä¸æ–­å¯¹Spliteratorè°ƒç”¨trySplitç›´åˆ°å®ƒè¿”å›nullï¼Œè¡¨æ˜å®ƒå¤„ç†çš„æ•°æ®ç»“æ„ä¸èƒ½å†åˆ†å‰²ï¼Œå¦‚ç¬¬ä¸‰æ­¥æ‰€ç¤ºã€‚æœ€åï¼Œè¿™ä¸ªé€’å½’æ‹†åˆ†è¿‡ç¨‹åˆ°ç¬¬å››æ­¥å°±ç»ˆæ­¢äº†ï¼Œè¿™æ—¶æ‰€æœ‰çš„Spliteratoråœ¨è°ƒç”¨trySplitæ—¶éƒ½è¿”å›äº†nullã€‚ Spliteratorçš„ç‰¹æ€§ Spliteratoræ¥å£å£°æ˜çš„æœ€åä¸€ä¸ªæŠ½è±¡æ–¹æ³•æ˜¯characteristicsï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªintï¼Œä»£ è¡¨Spliteratoræœ¬èº«ç‰¹æ€§é›†çš„ç¼–ç ã€‚ ä½¿ç”¨Spliteratorçš„å®¢æˆ·å¯ä»¥ç”¨è¿™äº›ç‰¹æ€§æ¥æ›´å¥½åœ°æ§åˆ¶å’Œä¼˜åŒ–å®ƒçš„ä½¿ç”¨ã€‚ è¡¨7-2æ€»ç»“äº†è¿™äº›ç‰¹æ€§ã€‚(ä¸å¹¸çš„æ˜¯ï¼Œè™½ç„¶å®ƒä»¬åœ¨æ¦‚å¿µä¸Šä¸æ”¶é›†å™¨çš„ç‰¹æ€§æœ‰é‡å ï¼Œç¼–ç å´ä¸ä¸€æ ·ã€‚) 3.2 å®ç°è‡ªå®šä¹‰Spliteratorç•¥ 4. å°ç»“åœ¨æœ¬ç« ä¸­ï¼Œä½ äº†è§£äº†ä»¥ä¸‹å†…å®¹ã€‚ å†…éƒ¨è¿­ä»£è®©ä½ å¯ä»¥å¹¶è¡Œå¤„ç†ä¸€ä¸ªæµï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­æ˜¾å¼ä½¿ç”¨å’Œô·¡è°ƒä¸åŒçš„çº¿ç¨‹ã€‚ è™½ç„¶å¹¶è¡Œå¤„ç†ä¸€ä¸ªæµå¾ˆå®¹æ˜“ï¼Œå´ä¸èƒ½ä¿è¯ç¨‹åºåœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¿è¡Œå¾—æ›´å¿«ã€‚å¹¶è¡Œè½¯ä»¶çš„è¡Œä¸ºå’Œæ€§èƒ½æœ‰æ—¶æ˜¯è¿åç›´è§‰çš„ï¼Œå› æ­¤ä¸€å®šè¦æµ‹é‡ï¼Œç¡®ä¿ä½ å¹¶æ²¡æœ‰æŠŠç¨‹åºæ‹–å¾—æ›´æ…¢ã€‚ åƒå¹¶è¡Œæµé‚£æ ·å¯¹ä¸€ä¸ªæ•°æ®é›†å¹¶è¡Œæ‰§è¡Œæ“ä½œå¯ä»¥æå‡æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯è¦å¤„ç†çš„å…ƒç´ æ•°é‡åºå¤§ï¼Œæˆ–å¤„ç†å•ä¸ªå…ƒç´ ç‰¹åˆ«è€—æ—¶çš„æ—¶å€™ã€‚ ä»æ€§èƒ½è§’åº¦æ¥çœ‹ï¼Œä½¿ç”¨æ­£ç¡®çš„æ•°æ®ç»“æ„ï¼Œå¦‚å°½å¯èƒ½åˆ©ç”¨åŸå§‹æµè€Œä¸æ˜¯ä¸€èˆ¬åŒ–çš„æµï¼Œå‡ ä¹æ€»æ˜¯æ¯”å°è¯•å¹¶è¡ŒåŒ–æŸäº›æ“ä½œæ›´ä¸ºé‡è¦ã€‚ åˆ†æ”¯/åˆå¹¶æ¡†æ¶è®©ä½ å¾—ä»¥ç”¨é€’å½’æ–¹å¼å°†å¯ä»¥å¹¶è¡Œçš„ä»»åŠ¡æ‹†åˆ†æˆæ›´å°çš„ä»»åŠ¡ï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œç„¶åå°†å„ä¸ªå­ä»»åŠ¡çš„ç»“æœåˆå¹¶èµ·æ¥ç”Ÿæˆæ•´ä½“ç»“æœã€‚ Spliteratorå®šä¹‰äº†å¹¶è¡Œæµå¦‚ä½•æ‹†åˆ†å®ƒè¦éå†çš„æ•°æ®ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/17/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%207%EF%BC%9A%E5%B9%B6%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%8E%E6%80%A7%E8%83%BD/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 8ï¼šé‡æ„ã€æµ‹è¯•å’Œè°ƒè¯•","text":"æˆ‘ä»¬ä¼šä»‹ç»å‡ ç§æ–¹æ³•ï¼Œå¸®åŠ©ä½ é‡æ„ä»£ç ï¼Œä»¥é€‚é…ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œè®©ä½ çš„ä»£ç å…·å¤‡æ›´å¥½çš„å¯è¯»æ€§å’Œçµæ´»æ€§ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šè®¨è®ºç›®å‰æ¯”è¾ƒæµè¡Œçš„å‡ ç§é¢å‘å¯¹è±¡çš„è®¾è®¡æ¨¡å¼ï¼ŒåŒ…æ‹¬ç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼ï¼Œä»¥åŠå·¥å‚æ¨¡å¼ï¼Œåœ¨ç»“åˆLambdaè¡¨è¾¾å¼ä¹‹åå˜å¾—æ›´ç®€æ´çš„æƒ…å†µã€‚æœ€åï¼Œæˆ‘ä»¬ä¼šä»‹ç»å¦‚ä½•æµ‹è¯•å’Œè°ƒè¯•ä½¿ç”¨Lambdaè¡¨è¾¾å¼å’ŒStream APIçš„ä»£ç ã€‚ 1. ä¸ºæ”¹å–„å¯è¯»æ€§å’Œçµæ´»æ€§é‡æ„ä»£ç 1.1 æ”¹å–„ä»£ç çš„å¯è¯»æ€§Java 8çš„æ–°ç‰¹æ€§ä¹Ÿå¯ä»¥å¸®åŠ©æå‡ä»£ç çš„å¯è¯»æ€§: ä½¿ç”¨Java 8ï¼Œä½ å¯ä»¥å‡å°‘å†—é•¿çš„ä»£ç ï¼Œè®©ä»£ç æ›´æ˜“äºç†è§£ é€šè¿‡æ–¹æ³•å¼•ç”¨å’ŒStream APIï¼Œä½ çš„ä»£ç ä¼šå˜å¾—æ›´ç›´è§‚ åˆ©ç”¨Lambdaè¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ä»¥åŠStreamæ”¹å–„ç¨‹åºä»£ç çš„å¯è¯»æ€§: é‡æ„ä»£ç ï¼Œç”¨Lambdaè¡¨è¾¾å¼å–ä»£åŒ¿åç±» ç”¨æ–¹æ³•å¼•ç”¨é‡æ„Lambdaè¡¨è¾¾å¼ ç”¨Stream APIé‡æ„å‘½ä»¤å¼çš„æ•°æ®å¤„ç† 1.2 ä»åŒ¿åå†…éƒ¨ç±»åˆ°Lambdaè¡¨è¾¾å¼çš„è½¬æ¢å°†å®ç°å•ä¸€æŠ½è±¡æ–¹æ³•çš„åŒ¿åç±»è½¬æ¢ä¸ºLambdaè¡¨è¾¾å¼ 12345678// ä¼ ç»Ÿçš„æ–¹å¼ï¼Œä½¿ç”¨åŒ¿åç±»Runnable r1 = new Runnable(){ public void run(){ System.out.println(\"Hello\"); }}// æ–°çš„æ–¹å¼ï¼Œä½¿ç”¨Lambdaè¡¨è¾¾å¼Runnable r2 = () -&gt; System.out.println(\"Hello\"); åŒ¿å ç±»å’ŒLambdaè¡¨è¾¾å¼ä¸­çš„thiså’Œsuperçš„å«ä¹‰æ˜¯ä¸åŒçš„ã€‚åœ¨åŒ¿åç±»ä¸­ï¼Œthisä»£è¡¨çš„æ˜¯ç±»è‡ªèº«ï¼Œä½†æ˜¯åœ¨Lambdaä¸­ï¼Œå®ƒä»£è¡¨çš„æ˜¯åŒ…å«ç±»ã€‚å…¶æ¬¡ï¼ŒåŒ¿åç±»å¯ä»¥å±è”½åŒ…å«ç±»çš„å˜é‡ï¼Œè€ŒLambdaè¡¨è¾¾å¼ä¸èƒ½(å®ƒä»¬ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯)ï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç : 1234567891011int a = 10;Runnable r1 = () -&gt; { int a = 2; // ç¼–è¯‘é”™è¯¯ System.out.println(a);};Runnable r2 = new Runnable() { public void run() { int a = 2; // æ­£å¸¸ System.out.println(a); }} åœ¨æ¶‰åŠé‡ô°´çš„ä¸Šä¸‹æ–‡é‡Œï¼Œå°†åŒ¿åç±»è½¬æ¢ä¸ºLambdaè¡¨è¾¾å¼å¯èƒ½å¯¼è‡´æœ€ç»ˆçš„ä»£ç æ›´åŠ æ™¦æ¶©ã€‚å®é™…ä¸Šï¼ŒåŒ¿åç±»çš„ç±»å‹æ˜¯åœ¨åˆå§‹åŒ–æ—¶ç¡®å®šçš„ï¼Œè€ŒLambdaçš„ç±»å‹å–å†³äºå®ƒçš„ä¸Šä¸‹æ–‡ã€‚é€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£é—®é¢˜æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚æˆ‘ä»¬å‡è®¾ä½ ç”¨ä¸RunnableåŒæ ·çš„ç­¾åå£°æ˜äº†ä¸€ä¸ªå‡½æ•°æ¥å£ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºTask: 1234567891011121314interface Task{ public void execute();}public static void doSomething(Runnable r){ r.run(); }public static void doSomething(Task a){ a.execute(); }doSomething(new Task() { public void execute() { System.out.println(\"Danger danger!!\"); }});// doSomething(Runnable) å’Œ doSomething(Task) éƒ½åŒ¹é…è¯¥ç±»å‹doSomething(() -&gt; System.out.println(\"Danger danger!!\"));// ä½¿ç”¨æ˜¾å¼çš„ç±»å‹è½¬æ¢æ¥è§£å†³è¿™ç§æ¨¡æ£±ä¸¤å¯çš„æƒ…å†µdoSomething((Task)() -&gt; System.out.println(\"Danger danger!!\")); ç›®å‰å¤§å¤šæ•°çš„é›†æˆå¼€å‘ç¯å¢ƒï¼Œæ¯”å¦‚NetBeanså’ŒIntelliJéƒ½æ”¯æŒè¿™ç§é‡æ„ï¼Œå®ƒä»¬èƒ½è‡ªåŠ¨åœ°å¸®ä½ æ£€æŸ¥ï¼Œé¿å…å‘ç”Ÿè¿™äº›é—®é¢˜ã€‚ 1.3 ä»Lambdaè¡¨è¾¾å¼åˆ°æ–¹æ³•å¼•ç”¨çš„è½¬æ¢12345678Map&lt;CaloricLevel, List&lt;Dish&gt;&gt; dishesByCaloricLevel = menu.stream() .collect( groupingBy(dish -&gt; { if (dish.getCalories() &lt;= 400) return CaloricLevel.DIET; else if (dish.getCalories() &lt;= 700) return CaloricLevel.NORMAL; else return CaloricLevel.FAT;})); å°†Lambdaè¡¨è¾¾å¼çš„å†…å®¹æŠ½å–åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ä¸­ï¼Œå°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™groupingByæ–¹æ³•ã€‚å˜æ¢ä¹‹åï¼Œä»£ç å˜å¾—æ›´åŠ ç®€æ´ï¼Œç¨‹åºçš„æ„å›¾ä¹Ÿæ›´åŠ æ¸…æ™°äº†ã€‚ 1Map&lt;CaloricLevel, List&lt;Dish&gt;&gt; dishesByCaloricLevel = menu.stream().collect(groupingBy(Dish::getCaloricLevel)); 1.4 ä»å‘½ä»¤å¼çš„æ•°æ®å¤„ç†åˆ‡æ¢åˆ°Streamæˆ‘ä»¬å»ºè®®ä½ å°†æ‰€æœ‰ä½¿ç”¨è¿­ä»£å™¨è¿™ç§æ•°æ®å¤„ç†æ¨¡å¼å¤„ç†é›†åˆçš„ä»£ç éƒ½è½¬æ¢æˆStream APIçš„æ–¹å¼ã€‚ä¸ºä»€ä¹ˆå‘¢?Stream APIèƒ½æ›´æ¸…æ™°åœ°è¡¨è¾¾æ•°æ®å¤„ç†ç®¡é“çš„æ„å›¾ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œé€šè¿‡çŸ­è·¯å’Œå»¶è¿Ÿè½½å…¥ä»¥åŠåˆ©ç”¨ç¬¬7ç« ä»‹ç»çš„ç°ä»£è®¡ç®—æœºçš„å¤šæ ¸æ¶æ„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Streamè¿›è¡Œä¼˜åŒ–ã€‚ 123456789101112// å‘½ä»¤å¼ç‰ˆæœ¬List&lt;String&gt; dishNames = new ArrayList&lt;&gt;(); for(Dish dish: menu){ if(dish.getCalories() &gt; 300){ dishNames.add(dish.getName()); }}// ä½¿ç”¨Stream APImenu.parallelStream() .filter(d -&gt; d.getCalories() &gt; 300) .map(Dish::getName) .collect(toList()); 1.5 å¢åŠ ä»£ç çš„çµæ´»æ€§æ²¡æœ‰å‡½æ•°å¼æ¥å£å°±æ— æ³•ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œå› æ­¤ä»£ç ä¸­éœ€è¦å¼•å…¥å‡½æ•°å¼æ¥å£ã€‚å¼•å…¥å‡½æ•°å¼æ¥å£çš„ä¸¤ç§é€šç”¨æ¨¡å¼ï¼š æœ‰æ¡ä»¶çš„å»¶è¿Ÿæ‰§è¡Œ ç¯ç»•æ‰§è¡Œ 2. ä½¿ç”¨Lambdaé‡æ„é¢å‘å¯¹è±¡çš„è®¾è®¡æ¨¡å¼ä½¿ç”¨Lambdaè¡¨è¾¾å¼åï¼Œå¾ˆå¤šç°å­˜çš„ç•¥æ˜¾è‡ƒè‚¿çš„é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼èƒ½å¤Ÿç”¨æ›´ç²¾ç®€çš„æ–¹å¼å®ç°äº†ã€‚è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šé’ˆå¯¹äº”ä¸ªè®¾è®¡æ¨¡å¼å±•å¼€è®¨è®ºï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯: ç­–ç•¥æ¨¡å¼ æ¨¡æ¿æ–¹æ³• è§‚å¯Ÿè€…æ¨¡å¼ è´£ä»»é“¾æ¨¡å¼ å·¥å‚æ¨¡å¼ 2.1 ç­–ç•¥æ¨¡å¼ç­–ç•¥æ¨¡å¼ä»£è¡¨äº†è§£å†³ä¸€ç±»ç®—æ³•çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œä½ å¯ä»¥åœ¨è¿è¡Œæ—¶é€‰æ‹©ä½¿ç”¨å“ªç§æ–¹æ¡ˆã€‚ç­–ç•¥æ¨¡å¼åŒ…å«ä¸‰éƒ¨åˆ†å†…å®¹ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚ ä¸€ä¸ªä»£è¡¨æŸä¸ªç®—æ³•çš„æ¥å£(å®ƒæ˜¯ç­–ç•¥æ¨¡å¼çš„æ¥å£)ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ªè¯¥æ¥å£çš„å…·ä½“å®ç°ï¼Œå®ƒä»¬ä»£è¡¨äº†ç®—æ³•çš„å¤šç§å®ç°(æ¯”å¦‚ï¼Œå®ä½“ç±»ConcreteStrategyAæˆ–è€…ConcreteStrategyB)ã€‚ ä¸€ä¸ªæˆ–å¤šä¸ªä½¿ç”¨ç­–ç•¥å¯¹è±¡çš„å®¢æˆ·ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738public interface ValidationStrategy { boolean execute(String s);}public class IsAllLowerCase implements ValidationStrategy { @Override public boolean execute(String s) { return s.matches(\"[a-z]+\"); }}public class IsNumber implements ValidationStrategy { @Override public boolean execute(String s) { return s.matches(\"\\\\d+\"); }}public class Validator { private final ValidationStrategy strategy; public Validator(ValidationStrategy strategy) { this.strategy = strategy; } public boolean validate(String s) { return strategy.execute(s); }}public class StrategyDemo { public static void main(String[] args) { Validator numericValidator = new Validator(new IsNumber()); boolean b1 = numericValidator.validate(\"aaaa\"); Validator lowerCaseValidator = new Validator(new IsAllLowerCase()); boolean b2 = lowerCaseValidator.validate(\"bbbb\"); System.out.println(b1 + \" \" + b2); Validator numericValidator1 = new Validator((String s) -&gt; s.matches(\"[a-z]+\")); boolean b11 = numericValidator1.validate(\"aaaa\"); Validator lowerCaseValidator1 = new Validator((String s) -&gt; s.matches(\"\\\\d+\")); boolean b21 = lowerCaseValidator.validate(\"bbbb\"); System.out.println(b11 + \" \" + b21); }} 2.2 æ¨¡æ¿æ–¹æ³•æ¨¡æ¿ æ–¹æ³•æ¨¡å¼åœ¨ä½ â€œå¸Œæœ›ä½¿ç”¨è¿™ä¸ªç®—æ³•ï¼Œä½†æ˜¯éœ€è¦å¯¹å…¶ä¸­çš„æŸäº›è¡Œè¿›è¡Œæ”¹è¿›ï¼Œæ‰èƒ½è¾¾åˆ°å¸Œæœ›çš„æ•ˆæœâ€ æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ 123456789101112131415161718192021222324public abstract class OnlineBanking { public void processCustomer(int id) { Customer c = DataUtil.getCustomerWithId(id); makeCustomerHappy(c); } abstract void makeCustomerHappy(Customer c);}public class OnlineBankingLambda { public void processCustomer(int id, Consumer&lt;Customer&gt; consumer) { Customer c = DataUtil.getCustomerWithId(id); consumer.accept(c); }}public class TemplateMethod { public static void main(String[] args) { new OnlineBanking() { @Override void makeCustomerHappy(Customer c) { System.out.println(c.getName() + \" happy!\"); } }.processCustomer(1); new OnlineBankingLambda().processCustomer(1, (Customer c) -&gt; System.out.println(c.getName() + \" happy!\")); }} 2.3 è§‚å¯Ÿè€…æ¨¡å¼è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸è§çš„æ–¹æ¡ˆï¼ŒæŸäº›äº‹ä»¶å‘ç”Ÿæ—¶(æ¯”å¦‚çŠ¶æ€è½¬å˜)ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡(é€šå¸¸æˆ‘ä»¬ç§°ä¹‹ä¸ºä¸»é¢˜)éœ€è¦è‡ªåŠ¨åœ°é€šçŸ¥å…¶ä»–å¤šä¸ªå¯¹è±¡(ç§°ä¸ºè§‚å¯Ÿè€…)ï¼Œå°±ä¼šé‡‡ç”¨è¯¥æ–¹æ¡ˆã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public interface Observer { void notify(String tweet);}public class NYTime implements Observer { @Override public void notify(String tweet) { if(tweet != null &amp;&amp; tweet.contains(\"money\")){ System.out.println(\"Breaking news in NY! \" + tweet); } }}public class Guardian implements Observer { @Override public void notify(String tweet) { if(tweet != null &amp;&amp; tweet.contains(\"queen\")){ System.out.println(\"Yet another news in London... \" + tweet); } }}public class LeMonde implements Observer { @Override public void notify(String tweet) { if(tweet != null &amp;&amp; tweet.contains(\"wine\")){ System.out.println(\"Today cheese, wine and news! \" + tweet); } }}public interface Subject { void registerObserver(Observer o); void nofityObservers(String tweet);}public class Feed implements Subject { private final List&lt;Observer&gt; observers = new ArrayList&lt;&gt;(); @Override public void registerObserver(Observer o) { this.observers.add(o); } @Override public void nofityObservers(String tweet) { observers.forEach(o -&gt; o.notify(tweet)); }}public class ObserverDemo { public static void main(String[] args) { Feed f = new Feed(); f.registerObserver(new NYTime()); f.registerObserver(new Guardian()); f.registerObserver(new LeMonde()); f.nofityObservers(\"The queen said her favourite book is Java 8 in Action!\"); f.registerObserver((String tweet) -&gt; { if (tweet != null &amp;&amp; tweet.contains(\"money\")) { System.out.println(\"Breaking news in NY! \" + tweet); } }); f.registerObserver((String tweet) -&gt; { if (tweet != null &amp;&amp; tweet.contains(\"queen\")) { System.out.println(\"Yet another news in London... \" + tweet); } }); }} 2.4 è´£ä»»é“¾æ¨¡å¼è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå¤„ç†å¯¹è±¡åºåˆ—(æ¯”å¦‚æ“ä½œåºåˆ—)çš„é€šç”¨æ–¹æ¡ˆã€‚ä¸€ä¸ªå¤„ç†å¯¹è±¡å¯èƒ½éœ€è¦åœ¨å®Œæˆä¸€äº›å·¥ä½œä¹‹åï¼Œå°†ç»“æœä¼ é€’ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ¥ç€åšä¸€äº›å·¥ä½œï¼Œå†è½¬äº¤ç»™ä¸‹ä¸€ä¸ªå¤„ç†å¯¹è±¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940public abstract class ProcessingObject&lt;T&gt; { protected ProcessingObject&lt;T&gt; successor; public void setSuccessor(ProcessingObject&lt;T&gt; successor) { this.successor = successor; } public T handle(T input) { T r = handleWork(input); if (successor != null) { return successor.handle(r); } return r; } abstract protected T handleWork(T input);}public class HeaderTextProcessing extends ProcessingObject&lt;String&gt; { @Override protected String handleWork(String input) { return \"From Raoul, Mario and Alan: \" + input; }}public class SpellCheckerProcessing extends ProcessingObject&lt;String&gt; { @Override protected String handleWork(String input) { return input.replaceAll(\"labda\", \"lambda\"); }}public class ChainOfResponsibilityDemo { public static void main(String[] args) { ProcessingObject&lt;String&gt; p1 = new HeaderTextProcessing(); ProcessingObject&lt;String&gt; p2 = new SpellCheckerProcessing(); p1.setSuccessor(p2); String result = p1.handle(\"Aren't labdas really sexy?!!\"); System.out.println(result); UnaryOperator&lt;String&gt; headerProcessing = (String text) -&gt; \"From Raoul, Mario and Alan: \" + text; UnaryOperator&lt;String&gt; spellCheckerProcessing = (String text) -&gt; text.replaceAll(\"labda\", \"lambda\"); Function&lt;String, String&gt; pipeline = headerProcessing.andThen(spellCheckerProcessing); String result1 = pipeline.apply(\"Aren't labdas really sexy?!!\"); System.out.println(result1); }} 2.5 å·¥å‚æ¨¡å¼ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œä½ æ— éœ€å‘å®¢æˆ·æš´éœ²å®ä¾‹åŒ–çš„é€»è¾‘å°±èƒ½å®Œæˆå¯¹è±¡çš„åˆ›å»ºã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344public interface Product {}@Datapublic class Loan implements Product {}@Datapublic class Stock implements Product {}@Datapublic class Bond implements Product {}public class ProductFactory { public static Product createProduct(String name) { switch (name) { case \"loan\": return new Loan(); case \"stock\": return new Stock(); case \"bond\": return new Bond(); default: throw new RuntimeException(\"No such product \" + name); } } public static void main(String[] args) { Product p = ProductFactory.createProduct(\"loan\"); System.out.println(p); }}public class ProductFactoryLambda { private final static Map&lt;String, Supplier&lt;Product&gt;&gt; map = new HashMap&lt;&gt;(); static { map.put(\"loan\", Loan::new); map.put(\"stock\", Stock::new); map.put(\"bond\", Bond::new); } public static Product createProduct(String name) { Supplier&lt;Product&gt; p = map.get(name); if (p != null) { return p.get(); } throw new IllegalArgumentException(\"No such product \" + name); } public static void main(String[] args) { Product p = ProductFactoryLambda.createProduct(\"loan\"); System.out.println(p); }} 3. æµ‹è¯•Lambdaè¡¨è¾¾å¼ç•¥ 4. è°ƒè¯•Lambdaè¡¨è¾¾å¼4.1 æŸ¥çœ‹æ ˆè·Ÿè¸ª123456789101112public class Debugging{ 11 public static void main(String[] args) { List&lt;Point&gt; points = Arrays.asList(new Point(12, 2), null); points.stream().map(p -&gt; p.getX()).forEach(System.out::println); }}è¿è¡Œè¿™æ®µä»£ç ä¼šäº§ç”Ÿä¸‹é¢çš„æ ˆè·Ÿè¸ª:Exception in thread \"main\" java.lang.NullPointerExceptionat Debugging.lambda$main$0(Debugging.java:6)at Debugging$$Lambda$5/284720968.apply(Unknown Source)at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)at java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948) æˆ‘ä»¬éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œæ¶‰åŠLambdaè¡¨è¾¾å¼çš„æ ˆô±¡ô´­å¯èƒ½éå¸¸éš¾ç†è§£ã€‚è¿™æ˜¯Javaç¼–è¯‘å™¨æœªæ¥ç‰ˆæœ¬å¯ä»¥æ”¹è¿›çš„ä¸€ä¸ªæ–¹é¢ã€‚ 4.2 ä½¿ç”¨æ—¥å¿—è°ƒè¯•peekçš„è®¾è®¡åˆè¡·å°±æ˜¯åœ¨æµçš„æ¯ä¸ªå…ƒç´ æ¢å¤è¿è¡Œä¹‹å‰ï¼Œæ’å…¥æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œã€‚ä½†æ˜¯å®ƒä¸åƒforEaché‚£æ ·æ¢å¤æ•´ä¸ªæµçš„è¿è¡Œï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªå…ƒç´ ä¸Šå®Œæˆæ“ä½œä¹‹åï¼Œå®ƒåªä¼šå°†æ“ä½œé¡ºæ‰¿åˆ°æµæ°´çº¿ä¸­çš„ä¸‹ä¸€ä¸ªæ“ä½œã€‚å›¾8-4è§£é‡Šäº†peekçš„æ“ä½œæµç¨‹ã€‚ 12345678910111213141516171819202122List&lt;Integer&gt; result = numbers.stream() .peek(x -&gt; System.out.println(\"from stream: \" + x)) .map(x -&gt; x + 17) .peek(x -&gt; System.out.println(\"after map: \" + x)) .filter(x -&gt; x % 2 == 0) .peek(x -&gt; System.out.println(\"after filter: \" + x)) .limit(3) .peek(x -&gt; System.out.println(\"after limit: \" + x)) .collect(toList());è¾“å‡ºç»“æœï¼šfrom stream: 2after map: 19from stream: 3after map: 20after filter: 20after limit: 20from stream: 4after map: 21from stream: 5after map: 22after filter: 22after limit: 22 5. å°ç»“ Lambdaè¡¨è¾¾å¼èƒ½æå‡ä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ã€‚ å¦‚æœä½ çš„ä»£ç ä¸­ä½¿ç”¨äº†åŒ¿åç±»ï¼Œå°½é‡ç”¨Lambdaè¡¨è¾¾å¼æ›¿æ¢å®ƒä»¬ï¼Œä½†æ˜¯è¦æ³¨æ„äºŒè€…é—´è¯­ä¹‰çš„å¾®å¦™å·®åˆ«ï¼Œæ¯”å¦‚å…³é”®å­—thisï¼Œä»¥åŠå˜é‡éšè—ã€‚ Lambdaè¡¨è¾¾å¼æ¯”èµ·æ¥ï¼Œæ–¹æ³•å¼•ç”¨çš„å¯è¯»æ€§æ›´å¥½ã€‚ å°½é‡ä½¿ç”¨Stream APIæ›¿æ¢è¿­ä»£å¼çš„é›†åˆå¤„ç†ã€‚ Lambdaè¡¨è¾¾å¼æœ‰åŠ©äºé¿å…ä½¿ç”¨é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼æ—¶å®¹æ˜“å‡ºç°çš„ô³‚åŒ–çš„æ¨¡æ¿ä»£ç ï¼Œå…¸å‹çš„æ¯”å¦‚ç­–ç•¥æ¨¡å¼ã€æ¨¡æ¿æ–¹æ³•ã€è§‚å¯Ÿè€…æ¨¡å¼ã€è´£ä»»é“¾æ¨¡å¼ï¼Œä»¥åŠå·¥å‚æ¨¡å¼ã€‚ å³ä½¿é‡‡ç”¨äº†Lambdaè¡¨è¾¾å¼ï¼Œä¹ŸåŒæ ·å¯ä»¥è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œä½†æ˜¯é€šå¸¸ä½ åº”è¯¥å…³æ³¨ä½¿ç”¨äº†Lambdaè¡¨è¾¾å¼çš„æ–¹æ³•çš„è¡Œä¸ºã€‚ å°½é‡å°†å¤æ‚çš„Lambdaè¡¨è¾¾å¼æŠ½è±¡åˆ°æ™®é€šæ–¹æ³•ä¸­ã€‚ Lambdaè¡¨è¾¾å¼ä¼šè®©æ ˆè·Ÿè¸ªçš„åˆ†æå˜å¾—æ›´ä¸ºå¤æ‚ã€‚ æµæä¾›çš„peekæ–¹æ³•åœ¨åˆ†æStreamæµæ°´çº¿æ—¶ï¼Œèƒ½å°†ä¸­é—´å˜é‡çš„å€¼è¾“å‡ºåˆ°æ—¥å¿—ä¸­ï¼Œæ˜¯éå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/18/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%208%EF%BC%9A%E9%87%8D%E6%9E%84%E3%80%81%E6%B5%8B%E8%AF%95%E5%92%8C%E8%B0%83%E8%AF%95/"},{"title":"ã€ŠJava 8 in Actionã€‹Chapter 9ï¼šé»˜è®¤æ–¹æ³•","text":"ä¼ ç»Ÿä¸Šï¼ŒJavaç¨‹åºçš„æ¥å£æ˜¯å°†ç›¸å…³æ–¹æ³•æŒ‰ç…§çº¦å®šç»„åˆåˆ°ä¸€èµ·çš„æ–¹å¼ã€‚å®ç°æ¥å£çš„ç±»å¿…é¡»ä¸ºæ¥å£ä¸­å®šä¹‰çš„æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªå®ç°ï¼Œæˆ–è€…ä»çˆ¶ç±»ä¸­ç»§æ‰¿å®ƒçš„å®ç°ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦ç±»åº“çš„è®¾è®¡è€…éœ€è¦æ›´æ–°æ¥å£ï¼Œå‘å…¶ä¸­åŠ å…¥æ–°çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹å¼å°±ä¼šå‡ºç°é—®é¢˜ã€‚ç°å®æƒ…å†µæ˜¯ï¼Œç°å­˜çš„å®ä½“ç±»å¾€å¾€ä¸åœ¨æ¥å£è®¾è®¡è€…çš„æ§åˆ¶èŒƒå›´ä¹‹å†…ï¼Œè¿™äº›å®ä½“ç±»ä¸ºäº†é€‚é…æ–°çš„æ¥å£çº¦å®šä¹Ÿéœ€è¦è¿›è¡Œä¿®æ”¹ã€‚ç”±äºJava 8çš„APIåœ¨ç°å­˜çš„æ¥å£ä¸Šå¼•å…¥äº†éå¸¸å¤šçš„æ–°æ–¹æ³•ï¼Œè¿™ç§å˜åŒ–å¸¦æ¥çš„é—®é¢˜ä¹Ÿæ„ˆåŠ ä¸¥é‡ï¼Œä¸€ä¸ªä¾‹å­å°±æ˜¯å‰å‡ ç« ä¸­ä½¿ç”¨è¿‡çš„ List æ¥å£ä¸Šçš„ sort æ–¹æ³•ã€‚æƒ³è±¡ä¸€ä¸‹å…¶ä»–å¤‡é€‰é›†åˆæ¡†æ¶çš„ç»´æŠ¤äººå‘˜ä¼šå¤šä¹ˆæŠ“ç‹‚å§ï¼ŒåƒGuavaå’ŒApache Commonsè¿™æ ·çš„æ¡†æ¶ç°åœ¨éƒ½éœ€è¦ä¿®æ”¹å®ç°äº† List æ¥å£çš„æ‰€æœ‰ç±»ï¼Œä¸ºå…¶æ·»åŠ sort æ–¹æ³•çš„å®ç°ã€‚Java 8ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜å¼•å…¥äº†ä¸€ç§æ–°çš„æœºåˆ¶ã€‚Java 8ä¸­çš„æ¥å£ç°åœ¨æ”¯æŒåœ¨å£°æ˜æ–¹æ³•çš„åŒæ—¶æä¾›å®ç°ï¼Œé€šè¿‡ä¸¤ç§æ–¹å¼å¯ä»¥å®Œæˆè¿™ç§æ“ä½œã€‚å…¶ä¸€ï¼ŒJava 8å…è®¸åœ¨æ¥å£å†…å£°æ˜é™æ€æ–¹æ³•ã€‚å…¶äºŒï¼ŒJava 8å¼•å…¥äº†ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå«é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡é»˜è®¤æ–¹æ³•ä½ å¯ä»¥æŒ‡å®šæ¥å£æ–¹æ³•çš„é»˜è®¤å®ç°ã€‚æ¢å¥è¯è¯´ï¼Œæ¥å£èƒ½æä¾›æ–¹æ³•çš„å…·ä½“å®ç°ã€‚å› æ­¤ï¼Œå®ç°æ¥å£çš„ç±»å¦‚æœä¸æ˜¾å¼åœ°æä¾›è¯¥æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œå°±ä¼šè‡ªåŠ¨ç»§æ‰¿é»˜è®¤çš„å®ç°ã€‚è¿™ç§æœºåˆ¶å¯ä»¥ä½¿ä½ å¹³æ»‘åœ°è¿›è¡Œæ¥å£çš„ä¼˜åŒ–å’Œæ¼”è¿›ã€‚å®é™…ä¸Šï¼Œåˆ°ç›®å‰ä¸ºæ­¢ä½ å·²ç»ä½¿ç”¨äº†å¤šä¸ªé»˜è®¤æ–¹æ³•ã€‚ä¸¤ä¸ªä¾‹å­å°±æ˜¯ä½ å‰é¢å·²ç»è§è¿‡çš„ List æ¥å£ä¸­çš„ sort ï¼Œä»¥åŠ Collection æ¥å£ä¸­çš„ stream ã€‚ ç¬¬1ç« ä¸­ List æ¥å£ä¸­çš„ sort æ–¹æ³•æ˜¯Java 8ä¸­å…¨æ–°çš„æ–¹æ³•ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š 123default void sort(Comparator&lt;? super E&gt; c){ Collections.sort(this, c);} è¯·æ³¨æ„è¿”å›ç±»å‹ä¹‹å‰çš„æ–° default ä¿®é¥°ç¬¦ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬èƒ½å¤ŸçŸ¥é“ä¸€ä¸ªæ–¹æ³•æ˜¯å¦ä¸ºé»˜è®¤æ–¹æ³•ã€‚è¿™é‡Œ sort æ–¹æ³•è°ƒç”¨äº† Collections.sort æ–¹æ³•è¿›è¡Œæ’åºæ“ä½œã€‚ç”±äºæœ‰äº†è¿™ä¸ªæ–°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç›´æ¥é€šè¿‡è°ƒç”¨ sort ï¼Œå¯¹åˆ—è¡¨ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºã€‚ 12List&lt;Integer&gt; numbers = Arrays.asList(3, 5, 1, 2, 6);numbers.sort(Comparator.naturalOrder()); ä¸è¿‡é™¤æ­¤ä¹‹å¤–ï¼Œè¿™æ®µä»£ç ä¸­è¿˜æœ‰äº›å…¶ä»–çš„æ–°ä¸œè¥¿ã€‚æˆ‘ä»¬è°ƒç”¨äº†Comparator.naturalOrder æ–¹æ³•ã€‚è¿™æ˜¯ Comparator æ¥å£çš„ä¸€ä¸ªå…¨æ–°çš„é™æ€æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ªComparator å¯¹è±¡ï¼Œå¹¶æŒ‰è‡ªç„¶åºåˆ—å¯¹å…¶ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼ˆå³æ ‡å‡†çš„å­—æ¯æ•°å­—æ–¹å¼æ’åºï¼‰ã€‚ç¬¬4ç« ä¸­çš„ Collection ä¸­çš„ stream æ–¹æ³•çš„å®šä¹‰å¦‚ä¸‹ï¼š 123default Stream&lt;E&gt; stream() { return StreamSupport.stream(spliterator(), false);} æˆ‘ä»¬åœ¨ä¹‹å‰çš„å‡ ç« ä¸­å¤§é‡ä½¿ç”¨äº†è¯¥æ–¹æ³•æ¥å¤„ç†é›†åˆï¼Œè¿™é‡Œ stream æ–¹æ³•ä¸­è°ƒç”¨äº†SteamSupport.stream æ–¹æ³•æ¥è¿”å›ä¸€ä¸ªæµã€‚ä½ æ³¨æ„åˆ° stream æ–¹æ³•çš„ä¸»ä½“æ˜¯å¦‚ä½•è°ƒç”¨ spliterator æ–¹æ³•çš„äº†å—ï¼Ÿå®ƒä¹Ÿæ˜¯ Collection æ¥å£çš„ä¸€ä¸ªé»˜è®¤æ–¹æ³•ã€‚æ¥å£å’ŒæŠ½è±¡ç±»è¿˜æ˜¯æœ‰ä¸€äº›æœ¬è´¨çš„åŒºåˆ«ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€ç« ä¸­ä¼šé’ˆå¯¹æ€§åœ°è¿›è¡Œè®¨è®ºã€‚ç®€è€Œè¨€ä¹‹ï¼Œå‘æ¥å£æ·»åŠ æ–¹æ³•æ˜¯è¯¸å¤šé—®é¢˜çš„ç½ªæ¶ä¹‹æºï¼›ä¸€æ—¦æ¥å£å‘ç”Ÿå˜åŒ–ï¼Œå®ç°è¿™äº›æ¥å£çš„ç±»å¾€å¾€ä¹Ÿéœ€è¦æ›´æ–°ï¼Œæä¾›æ–°æ·»æ–¹æ³•çš„å®ç°æ‰èƒ½é€‚é…æ¥å£çš„å˜åŒ–ã€‚å¦‚æœä½ å¯¹æ¥å£ä»¥åŠå®ƒæ‰€æœ‰ç›¸å…³çš„å®ç°æœ‰å®Œå…¨çš„æ§åˆ¶ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä¸ªå¤§é—®é¢˜ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µæ˜¯æå°‘çš„ã€‚è¿™å°±æ˜¯å¼•å…¥é»˜è®¤æ–¹æ³•çš„ç›®çš„ï¼šå®ƒè®©ç±»å¯ä»¥è‡ªåŠ¨åœ°ç»§æ‰¿æ¥å£çš„ä¸€ä¸ªé»˜è®¤å®ç°ã€‚ 1. ä¸æ–­æ¼”è¿›çš„ API1.1 åˆå§‹ç‰ˆæœ¬çš„ APIResizable æ¥å£çš„æœ€åˆç‰ˆæœ¬æä¾›äº†ä¸‹é¢è¿™äº›æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536public interface Drawable { void draw();}public interface Resizable extends Drawable { int getWidth(); void setWidth(int width); int getHeight(); void setHeight(int height); void setAbsoluteSize(int width, int height);}ç”¨æˆ·æ ¹æ®è‡ªèº«çš„éœ€æ±‚å®ç°äº† Resizable æ¥å£ï¼Œåˆ›å»ºäº† Ellipse ç±»ï¼špublic class Ellipse implements Resizable { ...}ä»–å®ç°äº†ä¸€ä¸ªå¤„ç†å„ç§ Resizable å½¢çŠ¶ï¼ˆåŒ…æ‹¬ Ellipse ï¼‰çš„æ¸¸æˆï¼špublic class Square implements Resizable { ...}public class Triangle implements Resizable { ...}public class Game { public static void main(String[] args) { List&lt;Resizable&gt; resizableShapes = Arrays.asList(new Square(), new Triangle(), new Ellipse()); Utils.paint(resizableShapes); }}public class Utils { public static void paint(List&lt;Resizable&gt; list) { list.forEach(r -&gt; { r.setAbsoluteSize(42, 42); r.draw(); }); }} 1.2 ç¬¬äºŒç‰ˆ APIåº“ä¸Šçº¿ä½¿ç”¨å‡ ä¸ªæœˆä¹‹åï¼Œä½ æ”¶åˆ°å¾ˆå¤šè¯·æ±‚ï¼Œè¦æ±‚ä½ æ›´æ–° Resizable çš„å®ç°ï¼Œè®© Square Triangle ä»¥åŠå…¶ä»–çš„å½¢çŠ¶éƒ½èƒ½æ”¯æŒ setRelativeSize æ–¹æ³•ã€‚ä¸ºäº†æ»¡è¶³è¿™äº›æ–°çš„éœ€æ±‚ï¼Œä½ å‘å¸ƒäº†ç¬¬äºŒç‰ˆAPIã€‚ 12345678public interface Resizable extends Drawable { int getWidth(); void setWidth(int width); int getHeight(); void setHeight(int height); void setAbsoluteSize(int width, int height); void setRelativeSize(int wFactor, int hFactor);} å¯¹ Resizable æ¥å£çš„æ›´æ–°å¯¼è‡´äº†ä¸€ç³»åˆ—çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œæ¥å£ç°åœ¨è¦æ±‚å®ƒæ‰€æœ‰çš„å®ç°ç±»æ·»åŠ setRelativeSize æ–¹æ³•çš„å®ç°ã€‚ä½†æ˜¯ç”¨æˆ·æœ€åˆå®ç°çš„ Ellipse ç±»å¹¶æœªåŒ…å« setRelativeSizeæ–¹æ³•ã€‚å‘æ¥å£æ·»åŠ æ–°æ–¹æ³•æ˜¯äºŒè¿›åˆ¶å…¼å®¹çš„ï¼Œè¿™æ„å‘³ç€å¦‚æœä¸é‡æ–°ç¼–è¯‘è¯¥ç±»ï¼Œå³ä½¿ä¸å®ç°æ–°çš„æ–¹æ³•ï¼Œç°æœ‰ç±»çš„å®ç°ä¾æ—§å¯ä»¥è¿è¡Œã€‚ä¸è¿‡ï¼Œç”¨æˆ·å¯èƒ½ä¿®æ”¹ä»–çš„æ¸¸æˆï¼Œåœ¨ä»–çš„ Utils.paint æ–¹æ³•ä¸­è°ƒç”¨setRelativeSize æ–¹æ³•ï¼Œå› ä¸º paint æ–¹æ³•æ¥å—ä¸€ä¸ª Resizable å¯¹è±¡åˆ—è¡¨ä½œä¸ºå‚æ•°ã€‚å¦‚æœä¼ é€’çš„æ˜¯ä¸€ä¸ª Ellipse å¯¹è±¡ï¼Œç¨‹åºå°±ä¼šæŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ï¼Œå› ä¸ºå®ƒå¹¶æœªå®ç° setRelativeSize æ–¹æ³•ï¼š 1Exception in thread \"main\" java.lang.AbstractMethodError:lambdasinaction.chap9.Ellipse.setRelativeSize(II)V å…¶æ¬¡ï¼Œå¦‚æœç”¨æˆ·è¯•å›¾é‡æ–°ç¼–è¯‘æ•´ä¸ªåº”ç”¨ï¼ˆåŒ…æ‹¬ Ellipse ç±»ï¼‰ï¼Œä»–ä¼šé­é‡ä¸‹é¢çš„ç¼–è¯‘é”™è¯¯ï¼š 12Error:(9, 8) java: com.lujiahao.learnjava8.chapter9.Ellipseä¸æ˜¯æŠ½è±¡çš„, å¹¶ä¸”æœªè¦†ç›–com.lujiahao.learnjava8.chapter9.Resizableä¸­çš„æŠ½è±¡æ–¹æ³•setRelativeSize(int,int) è¿™å°±æ˜¯é»˜è®¤æ–¹æ³•è¯•å›¾è§£å†³çš„é—®é¢˜ã€‚å®ƒè®©ç±»åº“çš„è®¾è®¡è€…æ”¾å¿ƒåœ°æ”¹è¿›åº”ç”¨ç¨‹åºæ¥å£ï¼Œæ— éœ€æ‹…å¿§å¯¹é—ç•™ä»£ç çš„å½±å“ï¼Œè¿™æ˜¯å› ä¸ºå®ç°æ›´æ–°æ¥å£çš„ç±»ç°åœ¨ä¼šè‡ªåŠ¨ç»§æ‰¿ä¸€ä¸ªé»˜è®¤çš„æ–¹æ³•å®ç°ã€‚ å˜æ›´å¯¹Javaç¨‹åºçš„å½±å“å¤§ä½“å¯ä»¥åˆ†æˆä¸‰ç§ç±»å‹çš„å…¼å®¹æ€§ï¼Œåˆ†åˆ«æ˜¯: äºŒè¿›åˆ¶çº§çš„å…¼å®¹ æºä»£ç çº§çš„å…¼å®¹ å‡½æ•°è¡Œä¸ºçš„å…¼å®¹ 2. æ¦‚è¿°é»˜è®¤æ–¹æ³•é»˜è®¤æ–¹æ³•ç”± default ä¿®é¥°ç¬¦ä¿®é¥°ï¼Œå¹¶åƒç±»ä¸­å£°æ˜çš„å…¶ä»–æ–¹æ³•ä¸€æ ·åŒ…å«æ–¹æ³•ä½“ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·åœ¨é›†åˆåº“ä¸­å®šä¹‰ä¸€ä¸ªåä¸ºSized çš„æ¥å£ï¼Œåœ¨å…¶ä¸­å®šä¹‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³• size ï¼Œä»¥åŠä¸€ä¸ªé»˜è®¤æ–¹æ³• isEmpty ï¼š 123456public interface Sized { int size(); default boolean isEmpty() { return size() == 0; }} è¿™æ ·ä»»ä½•ä¸€ä¸ªå®ç°äº† Sized æ¥å£çš„ç±»éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿ isEmpty çš„å®ç°ã€‚å› æ­¤ï¼Œå‘æä¾›äº†é»˜è®¤å®ç°çš„æ¥å£æ·»åŠ æ–¹æ³•å°±ä¸æ˜¯æºç å…¼å®¹çš„ã€‚é»˜è®¤æ–¹æ³•åœ¨Java 8çš„APIä¸­å·²ç»å¤§é‡åœ°ä½¿ç”¨äº†ã€‚æœ¬ç« å·²ç»ä»‹ç»è¿‡æˆ‘ä»¬å‰ä¸€ç« ä¸­å¤§é‡ä½¿ç”¨çš„ Collection æ¥å£çš„ stream æ–¹æ³•å°±æ˜¯é»˜è®¤æ–¹æ³•ã€‚ List æ¥å£çš„ sort æ–¹æ³•ä¹Ÿæ˜¯é»˜è®¤æ–¹æ³•ã€‚ç¬¬3ç« ä»‹ç»çš„å¾ˆå¤šå‡½æ•°å¼æ¥å£ï¼Œæ¯”å¦‚ Predicate ã€ Function ä»¥åŠ Comparator ä¹Ÿå¼•å…¥äº†æ–°çš„é»˜è®¤æ–¹æ³•ï¼Œæ¯”å¦‚ Predicate.and æˆ–è€… Function.andThen ï¼ˆè®°ä½ï¼Œå‡½æ•°å¼æ¥å£åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé»˜è®¤æ–¹æ³•æ˜¯ç§éæŠ½è±¡æ–¹æ³•ï¼‰ã€‚ 3. é»˜è®¤æ–¹æ³•çš„ä½¿ç”¨æ¨¡å¼3.1 å¯é€‰æ–¹æ³•ç±»å®ç°äº†æ¥å£ï¼Œä¸è¿‡å´åˆ»æ„åœ°å°†ä¸€äº›æ–¹æ³•çš„å®ç°ç•™ç™½ã€‚æˆ‘ä»¬ä»¥Iterator æ¥å£ä¸ºä¾‹æ¥è¯´ã€‚ Iterator æ¥å£å®šä¹‰äº† hasNext ã€ next ï¼Œè¿˜å®šä¹‰äº† remove æ–¹æ³•ã€‚Java 8ä¹‹å‰ï¼Œç”±äºç”¨æˆ·é€šå¸¸ä¸ä¼šä½¿ç”¨è¯¥æ–¹æ³•ï¼Œ remove æ–¹æ³•å¸¸è¢«å¿½ç•¥ã€‚å› æ­¤ï¼Œå®ç° Interator æ¥å£çš„ç±»é€šå¸¸ä¼šä¸º remove æ–¹æ³•æ”¾ç½®ä¸€ä¸ªç©ºçš„å®ç°ï¼Œè¿™äº›éƒ½æ˜¯äº›æ¯«æ— ç”¨å¤„çš„æ¨¡æ¿ä»£ç ã€‚é‡‡ç”¨é»˜è®¤æ–¹æ³•ä¹‹åï¼Œä½ å¯ä»¥ä¸ºè¿™ç§ç±»å‹çš„æ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤çš„å®ç°ï¼Œè¿™æ ·å®ä½“ç±»å°±æ— éœ€åœ¨è‡ªå·±çš„å®ç°ä¸­æ˜¾å¼åœ°æä¾›ä¸€ä¸ªç©ºæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œåœ¨Java 8ä¸­ï¼Œ Iterator æ¥å£å°±ä¸º remove æ–¹æ³•æä¾›äº†ä¸€ä¸ªé»˜è®¤å®ç°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567public interface Iterator&lt;E&gt; { ... default void remove() { throw new UnsupportedOperationException(\"remove\"); } ...} 3.2 è¡Œä¸ºçš„å¤šç»§æ‰¿é»˜è®¤æ–¹æ³•è®©ä¹‹å‰æ— æ³•æƒ³è±¡çš„äº‹å„¿ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼å¾—ä»¥å®ç°ï¼Œå³è¡Œä¸ºçš„å¤šç»§æ‰¿ã€‚è¿™æ˜¯ä¸€ç§è®©ç±»ä»å¤šä¸ªæ¥æºé‡ç”¨ä»£ç çš„èƒ½åŠ›ã€‚ Javaçš„ç±»åªèƒ½ç»§æ‰¿å•ä¸€çš„ç±»ï¼Œä½†æ˜¯ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šæ¥å£ã€‚è¦ç¡®è®¤ä¹Ÿå¾ˆç®€å•ï¼Œä¸‹é¢æ˜¯Java APIä¸­å¯¹ ArrayList ç±»çš„å®šä¹‰ï¼š 123public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable {} 3.2.1 ç±»å‹çš„å¤šç»§æ‰¿è¿™ä¸ªä¾‹å­ä¸­ ArrayList ç»§æ‰¿äº†ä¸€ä¸ªç±»ï¼Œå®ç°äº†å…­ä¸ªæ¥å£ã€‚å› æ­¤ ArrayList å®é™…æ˜¯ä¸ƒä¸ªç±»å‹çš„ç›´æ¥å­ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š AbstractList ã€ List ã€ RandomAccess ã€ Cloneable ã€ Serializable ã€Iterable å’Œ Collection ã€‚æ‰€ä»¥ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œæˆ‘ä»¬æ—©å°±æœ‰äº†ç±»å‹çš„å¤šç»§æ‰¿ã€‚ç”±äºJava 8ä¸­æ¥å£æ–¹æ³•å¯ä»¥åŒ…å«å®ç°ï¼Œç±»å¯ä»¥ä»å¤šä¸ªæ¥å£ä¸­ç»§æ‰¿å®ƒä»¬çš„è¡Œä¸ºï¼ˆå³å®ç°çš„ä»£ç ï¼‰ã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å…¥æ‰‹ï¼Œçœ‹çœ‹å¦‚ä½•å……åˆ†åˆ©ç”¨è¿™ç§èƒ½åŠ›æ¥ä¸ºæˆ‘ä»¬æœåŠ¡ã€‚ä¿æŒæ¥å£çš„ç²¾è‡´æ€§å’Œæ­£äº¤æ€§èƒ½å¸®åŠ©ä½ åœ¨ç°æœ‰çš„ä»£ç åŸºä¸Šæœ€å¤§ç¨‹åº¦åœ°å®ç°ä»£ç å¤ç”¨å’Œè¡Œä¸ºç»„åˆã€‚ 3.2.2 åˆ©ç”¨æ­£äº¤æ–¹æ³•çš„ç²¾ç®€æ¥å£å‡è®¾ä½ éœ€è¦ä¸ºä½ æ­£åœ¨åˆ›å»ºçš„æ¸¸æˆå®šä¹‰å¤šä¸ªå…·æœ‰ä¸åŒç‰¹è´¨çš„å½¢çŠ¶ã€‚æœ‰çš„å½¢çŠ¶éœ€è¦è°ƒæ•´å¤§å°ï¼Œä½†æ˜¯ä¸éœ€è¦æœ‰æ—‹è½¬çš„åŠŸèƒ½ï¼›æœ‰çš„éœ€è¦èƒ½æ—‹è½¬å’Œç§»åŠ¨ï¼Œä½†æ˜¯ä¸éœ€è¦è°ƒæ•´å¤§å°ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä½ æ€ä¹ˆè®¾è®¡æ‰èƒ½å°½å¯èƒ½åœ°é‡ç”¨ä»£ç ï¼Ÿä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„ Rotatable æ¥å£ï¼Œå¹¶æä¾›ä¸¤ä¸ªæŠ½è±¡æ–¹æ³• setRotationAngle å’ŒgetRotationAngle ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567public interface Rotatable { int getRotationAngle(); void setRotationAngle(int angleInDegrees); default void rotateBy(int angleInDegrees) { setRotationAngle((getRotationAngle() + angleInDegrees) % 360); }} è¿™ç§æ–¹å¼å’Œæ¨¡æ¿è®¾è®¡æ¨¡å¼æœ‰äº›ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»¥å…¶ä»–æ–¹æ³•éœ€è¦å®ç°çš„æ–¹æ³•å®šä¹‰å¥½æ¡†æ¶ç®—æ³•ã€‚ç°åœ¨ï¼Œå®ç°äº† Rotatable çš„æ‰€æœ‰ç±»éƒ½éœ€è¦æä¾› setRotationAngle å’Œ getRotationAngleçš„å®ç°ï¼Œä½†ä¸æ­¤åŒæ—¶å®ƒä»¬ä¹Ÿä¼šå¤©ç„¶åœ°ç»§æ‰¿ rotateBy çš„é»˜è®¤å®ç°ã€‚ç±»ä¼¼åœ°ï¼Œä½ å¯ä»¥å®šä¹‰ä¹‹å‰çœ‹åˆ°çš„ä¸¤ä¸ªæ¥å£ Moveable å’Œ Resizable ã€‚å®ƒä»¬éƒ½åŒ…å«äº†é»˜è®¤å®ç°ã€‚ä¸‹é¢æ˜¯ Moveable çš„ä»£ç ï¼š 1234567891011121314151617181920212223public interface Moveable { int getX(); void setX(int x); int getY(); void setY(int y); default void moveHorizontally(int distance) { setX(getX() + distance); } default void moveVertically(int distance) { setY(getY() + distance); }}ä¸‹é¢æ˜¯ Resizable çš„ä»£ç ï¼špublic interface Resizable extends Drawable { int getWidth(); void setWidth(int width); int getHeight(); void setHeight(int height); void setAbsoluteSize(int width, int height); default void setRelativeSize(int wFactor, int hFactor){ setAbsoluteSize(getWidth() / wFactor, getHeight() / hFactor); }} 3.2.3 ç»„åˆæ¥å£é€šè¿‡ç»„åˆè¿™äº›æ¥å£ï¼Œä½ ç°åœ¨å¯ä»¥ä¸ºä½ çš„æ¸¸æˆåˆ›å»ºä¸åŒçš„å®ä½“ç±»ã€‚æ¯”å¦‚ï¼Œ Monster å¯ä»¥ç§»åŠ¨ã€æ—‹è½¬å’Œç¼©æ”¾ã€‚ 123public class Monster implements Rotatable, Moveable, Resizable { ...} Monster ç±»ä¼šè‡ªåŠ¨ç»§æ‰¿ Rotatable ã€ Moveable å’Œ Resizable æ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼ŒMonster ç»§æ‰¿äº† rotateBy ã€ moveHorizontally ã€ moveVertically å’Œ setRelativeSize çš„å®ç°ã€‚ä½ ç°åœ¨å¯ä»¥ç›´æ¥è°ƒç”¨ä¸åŒçš„æ–¹æ³•ï¼š 123Monster m = new Monster();m.rotateBy(180);m.moveVertically(10); åƒä½ çš„æ¸¸æˆä»£ç é‚£æ ·ä½¿ç”¨é»˜è®¤å®ç°æ¥å®šä¹‰ç®€å•çš„æ¥å£è¿˜æœ‰å¦ä¸€ä¸ªå¥½å¤„ã€‚å‡è®¾ä½ éœ€è¦ä¿®æ”¹moveVertically çš„å®ç°ï¼Œè®©å®ƒæ›´é«˜æ•ˆåœ°è¿è¡Œã€‚ä½ å¯ä»¥åœ¨ Moveable æ¥å£å†…ç›´æ¥ä¿®æ”¹å®ƒçš„å®ç°ï¼Œæ‰€æœ‰å®ç°è¯¥æ¥å£çš„ç±»ä¼šè‡ªåŠ¨ç»§æ‰¿æ–°çš„ä»£ç ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾ç”¨æˆ·å¹¶æœªå®šä¹‰è‡ªå·±çš„æ–¹æ³•å®ç°ï¼‰ã€‚é€šè¿‡å‰é¢çš„ä»‹ç»ï¼Œä½ å·²ç»äº†è§£äº†é»˜è®¤æ–¹æ³•å¤šç§å¼ºå¤§çš„ä½¿ç”¨æ¨¡å¼ã€‚ä¸è¿‡ä¹Ÿå¯èƒ½è¿˜æœ‰ä¸€äº›ç–‘æƒ‘ï¼šå¦‚æœä¸€ä¸ªç±»åŒæ—¶å®ç°äº†ä¸¤ä¸ªæ¥å£ï¼Œè¿™ä¸¤ä¸ªæ¥å£æ°å·§åˆæä¾›äº†åŒæ ·çš„é»˜è®¤æ–¹æ³•ç­¾åï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿç±»ä¼šé€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªæ–¹æ³•ï¼Ÿè¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥çš„ä¸€èŠ‚è¿›è¡Œè®¨è®ºã€‚ 4. è§£å†³å†²çªçš„è§„åˆ™éšç€é»˜è®¤æ–¹æ³•åœ¨Java 8ä¸­å¼•å…¥ï¼Œæœ‰å¯èƒ½å‡ºç°ä¸€ä¸ªç±»ç»§æ‰¿äº†å¤šä¸ªæ–¹æ³•è€Œå®ƒä»¬ä½¿ç”¨çš„å´æ˜¯åŒæ ·çš„å‡½æ•°ç­¾åã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç±»ä¼šé€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªå‡½æ•°ï¼Ÿæ¥ä¸‹æ¥çš„ä¾‹å­ä¸»è¦ç”¨äºè¯´æ˜å®¹æ˜“å‡ºé—®é¢˜çš„åœºæ™¯ï¼Œå¹¶ä¸è¡¨ç¤ºè¿™äº›åœºæ™¯åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ä¼šç»å¸¸å‘ç”Ÿã€‚ 12345678910111213141516public interface A { default void hello() { System.out.println(\"Hello from A\"); }}public interface B extends A { default void hello() { System.out.println(\"Hello from B\"); }}public class C implements A, B { public static void main(String[] args) { // çŒœçŒœæ‰“å°çš„æ˜¯ä»€ä¹ˆï¼Ÿ new C().hello(); }} æ­¤å¤–ï¼Œä½ å¯èƒ½æ—©å°±å¯¹C++è¯­è¨€ä¸­è‘—åçš„è±å½¢ç»§æ‰¿é—®é¢˜æœ‰æ‰€äº†è§£ï¼Œè±å½¢ç»§æ‰¿é—®é¢˜ä¸­ä¸€ä¸ªç±»åŒæ—¶ç»§æ‰¿äº†å…·æœ‰ç›¸åŒå‡½æ•°ç­¾åçš„ä¸¤ä¸ªæ–¹æ³•ã€‚åˆ°åº•è¯¥é€‰æ‹©å“ªä¸€ä¸ªå®ç°å‘¢ï¼Ÿ Java 8ä¹Ÿæä¾›äº†è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ¡ˆã€‚è¯·æ¥ç€é˜…è¯»ä¸‹é¢çš„å†…å®¹ã€‚ 4.1 è§£å†³é—®é¢˜çš„ä¸‰æ¡è§„åˆ™å¦‚æœä¸€ä¸ªç±»ä½¿ç”¨ç›¸åŒçš„å‡½æ•°ç­¾åä»å¤šä¸ªåœ°æ–¹ï¼ˆæ¯”å¦‚å¦ä¸€ä¸ªç±»æˆ–æ¥å£ï¼‰ç»§æ‰¿äº†æ–¹æ³•ï¼Œé€šè¿‡ä¸‰æ¡è§„åˆ™å¯ä»¥è¿›è¡Œåˆ¤æ–­ã€‚ ç±»ä¸­çš„æ–¹æ³•ä¼˜å…ˆçº§æœ€é«˜ã€‚ç±»æˆ–çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºä»»ä½•å£°æ˜ä¸ºé»˜è®¤æ–¹æ³•çš„ä¼˜å…ˆçº§ã€‚ å¦‚æœæ— æ³•ä¾æ®ç¬¬ä¸€æ¡è¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆå­æ¥å£çš„ä¼˜å…ˆçº§æ›´é«˜ï¼šå‡½æ•°ç­¾åç›¸åŒæ—¶ï¼Œä¼˜å…ˆé€‰æ‹©æ‹¥æœ‰æœ€å…·ä½“å®ç°çš„é»˜è®¤æ–¹æ³•çš„æ¥å£ï¼Œå³å¦‚æœ B ç»§æ‰¿äº† A ï¼Œé‚£ä¹ˆ B å°±æ¯” A æ›´åŠ å…·ä½“ã€‚ æœ€åï¼Œå¦‚æœè¿˜æ˜¯æ— æ³•åˆ¤æ–­ï¼Œç»§æ‰¿äº†å¤šä¸ªæ¥å£çš„ç±»å¿…é¡»é€šè¿‡æ˜¾å¼è¦†ç›–å’Œè°ƒç”¨æœŸæœ›çš„æ–¹æ³•ï¼Œæ˜¾å¼åœ°é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªé»˜è®¤æ–¹æ³•çš„å®ç°ã€‚ 4.2 è±å½¢ç»§æ‰¿é—®é¢˜ äº†è§£å³å¯ 5. å°ç»“ Java 8ä¸­çš„æ¥å£å¯ä»¥é€šè¿‡é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•æä¾›æ–¹æ³•çš„ä»£ç å®ç°ã€‚ é»˜è®¤æ–¹æ³•çš„å¼€å¤´ä»¥å…³é”®å­— default ä¿®é¥°ï¼Œæ–¹æ³•ä½“ä¸å¸¸è§„çš„ç±»æ–¹æ³•ç›¸åŒã€‚ å‘å‘å¸ƒçš„æ¥å£æ·»åŠ æŠ½è±¡æ–¹æ³•ä¸æ˜¯æºç å…¼å®¹çš„ã€‚ é»˜è®¤æ–¹æ³•çš„å‡ºç°èƒ½å¸®åŠ©åº“çš„è®¾è®¡è€…ä»¥åå‘å…¼å®¹çš„æ–¹å¼æ¼”è¿›APIã€‚ é»˜è®¤æ–¹æ³•å¯ä»¥ç”¨äºåˆ›å»ºå¯é€‰æ–¹æ³•å’Œè¡Œä¸ºçš„å¤šç»§æ‰¿ã€‚ æˆ‘ä»¬æœ‰åŠæ³•è§£å†³ç”±äºä¸€ä¸ªç±»ä»å¤šä¸ªæ¥å£ä¸­ç»§æ‰¿äº†æ‹¥æœ‰ç›¸åŒå‡½æ•°ç­¾åçš„æ–¹æ³•è€Œå¯¼è‡´çš„å†²çªã€‚ ç±»æˆ–è€…çˆ¶ç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ä¼˜å…ˆçº§é«˜äºä»»ä½•é»˜è®¤æ–¹æ³•ã€‚å¦‚æœå‰ä¸€æ¡æ— æ³•è§£å†³å†²çªï¼Œé‚£å°±é€‰æ‹©åŒå‡½æ•°ç­¾åçš„æ–¹æ³•ä¸­å®ç°å¾—æœ€å…·ä½“çš„é‚£ä¸ªæ¥å£çš„æ–¹æ³•ã€‚ ä¸¤ä¸ªé»˜è®¤æ–¹æ³•éƒ½åŒæ ·å…·ä½“æ—¶ï¼Œä½ éœ€è¦åœ¨ç±»ä¸­è¦†ç›–è¯¥æ–¹æ³•ï¼Œæ˜¾å¼åœ°é€‰æ‹©ä½¿ç”¨å“ªä¸ªæ¥å£ä¸­æä¾›çš„é»˜è®¤æ–¹æ³•ã€‚ èµ„æºè·å– å…¬ä¼—å·å›å¤ : Java8 å³å¯è·å–ã€ŠJava 8 in Actionã€‹ä¸­è‹±æ–‡ç‰ˆ! Tips æ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/03/19/%E3%80%8AJava%208%20in%20Action%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E3%80%8AJava%208%20in%20Action%E3%80%8BChapter%209%EF%BC%9A%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95/"},{"title":"ã€ŠMySQLå¿…çŸ¥å¿…ä¼šã€‹ç¬¬6-7ç«  è¿‡æ»¤æ•°æ®ä¸æ•°æ®è¿‡æ»¤","text":"1. WHEREå­å¥æ ¹æ®WHEREå­å¥ä¸­æŒ‡å®šçš„æœç´¢æ¡ä»¶è¿›è¡Œè¿‡æ»¤,WHEREå­å¥åœ¨è¡¨åä¹‹åç»™å‡º. 12345678mysql&gt; select prod_name,prod_price from products where prod_price = 2.50;+---------------+------------+| prod_name | prod_price |+---------------+------------+| Carrots | 2.50 || TNT (1 stick) | 2.50 |+---------------+------------+2 rows in set (0.02 sec) åœ¨åŒæ—¶ä½¿ç”¨ORDERBYå’ŒWHEREå­å¥æ—¶ï¼Œåº”è¯¥è®©ORDER BYä½äºWHEREä¹‹åï¼Œå¦åˆ™å°†ä¼šäº§ç”Ÿé”™è¯¯ 2. WHEREå­å¥æ“ä½œç¬¦ æ“ä½œç¬¦ è¯´æ˜ = ç­‰äº &lt;&gt; ä¸ç­‰äº != ä¸ç­‰äº &lt; å°äº &lt;= å°äºç­‰äº &gt; å¤§äº &gt;= å¤§äºç­‰äº BETWEEN åœ¨æŒ‡å®šçš„ä¸¤ä¸ªå€¼ä¹‹é—´ 3. WHEREå­å¥æ“ä½œ3.1 æ£€ç´¢å•ä¸ªå€¼1234567mysql&gt; select prod_name,prod_price from products where prod_name = 'fuses';+-----------+------------+| prod_name | prod_price |+-----------+------------+| Fuses | 3.42 |+-----------+------------+1 row in set (0.00 sec) MySQLåœ¨æ‰§è¡ŒåŒ¹é…æ—¶é»˜è®¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥fusesä¸FusesåŒ¹é…ã€‚ 3.2 ä¸åŒ¹é…æ£€æŸ¥12345678910111213mysql&gt; select vend_id,prod_name from products where vend_id &lt;&gt; 1003;+---------+--------------+| vend_id | prod_name |+---------+--------------+| 1001 | .5 ton anvil || 1001 | 1 ton anvil || 1001 | 2 ton anvil || 1002 | Fuses || 1005 | JetPack 1000 || 1005 | JetPack 2000 || 1002 | Oil can |+---------+--------------+7 rows in set (0.00 sec) `&lt;&gt;`å’Œ`!=`çš„ä½œç”¨æ˜¯ç›¸åŒçš„,ä¸Šé¢çš„è¯­å¥è¿˜å¯ä»¥å†™ä½œ: `select vend_id,prod_name from products where vend_id != 1003;` å¦‚æœä»”ç»†è§‚å¯Ÿä¸Šè¿°WHEREå­å¥ä¸­ä½¿ç”¨çš„æ¡ä»¶ï¼Œä¼šçœ‹åˆ°æœ‰çš„å€¼æ‹¬åœ¨å•å¼•å·å†…(å¦‚å‰é¢ä½¿ç”¨çš„â€™fusesâ€™)ï¼Œè€Œæœ‰çš„å€¼æœªæ‹¬èµ·æ¥ã€‚å•å¼•å·ç”¨æ¥é™å®šå­—ç¬¦ä¸²ã€‚å¦‚æœå°†å€¼ä¸ä¸²ç±»å‹çš„åˆ—è¿›è¡Œæ¯”è¾ƒï¼Œåˆ™éœ€è¦é™å®šå¼•å·ã€‚ç”¨æ¥ä¸æ•°å€¼åˆ—è¿›è¡Œæ¯”è¾ƒçš„å€¼ä¸ç”¨å¼•å·ã€‚ 3.3 èŒƒå›´æ£€æŸ¥æ£€æŸ¥æŸä¸ªèŒƒå›´çš„å€¼ï¼Œå¯ä½¿ç”¨BETWEENæ“ä½œç¬¦ã€‚å®ƒéœ€è¦ä¸¤ä¸ªå€¼ï¼Œå³èŒƒå›´çš„å¼€å§‹å€¼å’Œç»“æŸå€¼ã€‚ 1234567891011mysql&gt; select prod_name,prod_price from products where prod_price between 5 and 10;+----------------+------------+| prod_name | prod_price |+----------------+------------+| .5 ton anvil | 5.99 || 1 ton anvil | 9.99 || Bird seed | 10.00 || Oil can | 8.99 || TNT (5 sticks) | 10.00 |+----------------+------------+5 rows in set (0.00 sec) 3.4 ç©ºå€¼æ£€æŸ¥NULL æ— å€¼(no value)ï¼Œå®ƒä¸å­—æ®µåŒ…å«0ã€ç©ºå­—ç¬¦ä¸²æˆ–ä»…ä»…åŒ…å«ç©ºæ ¼ä¸åŒã€‚ 12345678mysql&gt; select cust_id from customers where cust_email is null;+---------+| cust_id |+---------+| 10002 || 10005 |+---------+2 rows in set (0.00 sec) 4. ç»„åˆWHEREå­å¥4.1 ANDæ“ä½œç¬¦é€šè¿‡ä¸æ­¢ä¸€ä¸ªåˆ—è¿›è¡Œè¿‡æ»¤ï¼Œå¯ä½¿ç”¨ANDæ“ä½œç¬¦ç»™WHEREå­å¥é™„åŠ æ¡ä»¶ã€‚ç”¨åœ¨WHEREå­å¥ä¸­çš„å…³é”®å­—ï¼Œç”¨æ¥æŒ‡ç¤ºæ£€ç´¢æ»¡è¶³æ‰€æœ‰ç»™å®šæ¡ä»¶çš„è¡Œã€‚ 1234567891011mysql&gt; select prod_id,prod_price,prod_name from products where vend_id = 1003 and prod_price &lt;= 10;+---------+------------+----------------+| prod_id | prod_price | prod_name |+---------+------------+----------------+| FB | 10.00 | Bird seed || FC | 2.50 | Carrots || SLING | 4.49 | Sling || TNT1 | 2.50 | TNT (1 stick) || TNT2 | 10.00 | TNT (5 sticks) |+---------+------------+----------------+5 rows in set (0.00 sec) æ·»åŠ å¤šä¸ªè¿‡æ»¤æ¡ä»¶ï¼Œæ¯æ·»åŠ ä¸€æ¡å°±è¦ä½¿ç”¨ä¸€ä¸ªANDã€‚ 4.2 ORæ“ä½œç¬¦ORæ“ä½œç¬¦å‘Šè¯‰DBMSåŒ¹é…ä»»ä¸€æ¡ä»¶è€Œä¸æ˜¯åŒæ—¶åŒ¹é…ä¸¤ä¸ªæ¡ä»¶ã€‚ 123456789101112131415mysql&gt; select prod_name,prod_price from products where vend_id = 1002 or vend_id = 1003;+----------------+------------+| prod_name | prod_price |+----------------+------------+| Detonator | 13.00 || Bird seed | 10.00 || Carrots | 2.50 || Fuses | 3.42 || Oil can | 8.99 || Safe | 50.00 || Sling | 4.49 || TNT (1 stick) | 2.50 || TNT (5 sticks) | 10.00 |+----------------+------------+9 rows in set (0.00 sec) 4.3 è®¡ç®—æ¬¡åºSQL(åƒå¤šæ•°è¯­è¨€ä¸€æ ·)åœ¨å¤„ç†ORæ“ä½œç¬¦å‰ï¼Œä¼˜å…ˆå¤„ç†ANDæ“ä½œç¬¦ã€‚ 12345678910mysql&gt; select prod_name,prod_price from products where (vend_id = 1002 or vend_id = 1003) and prod_price &gt;=10;+----------------+------------+| prod_name | prod_price |+----------------+------------+| Detonator | 13.00 || Bird seed | 10.00 || Safe | 50.00 || TNT (5 sticks) | 10.00 |+----------------+------------+4 rows in set (0.00 sec) åœ†æ‹¬å·å…·æœ‰è¾ƒANDæˆ–ORæ“ä½œç¬¦é«˜çš„è®¡ç®—æ¬¡åºï¼ŒDBMSé¦–å…ˆè¿‡æ»¤åœ†æ‹¬å·å†…çš„ORæ¡ä»¶ã€‚ä»»ä½•æ—¶å€™ä½¿ç”¨å…·æœ‰ANDå’ŒORæ“ä½œç¬¦çš„WHEREå­å¥ï¼Œéƒ½åº”è¯¥ä½¿ç”¨åœ†æ‹¬å·æ˜ç¡®åœ°åˆ†ç»„æ“ä½œç¬¦ã€‚ä¸è¦è¿‡åˆ†ä¾èµ–é»˜è®¤è®¡ç®—æ¬¡åºï¼Œå³ä½¿å®ƒç¡®å®æ˜¯ä½ æƒ³è¦çš„ä¸œè¥¿ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä½¿ç”¨åœ†æ‹¬å·æ²¡æœ‰ä»€ä¹ˆåå¤„ï¼Œå®ƒèƒ½æ¶ˆé™¤æ­§ä¹‰ã€‚ 5. INæ“ä½œç¬¦INæ“ä½œç¬¦ç”¨æ¥æŒ‡å®šæ¡ä»¶èŒƒå›´ï¼ŒèŒƒå›´ä¸­çš„æ¯ä¸ªæ¡ä»¶éƒ½å¯ä»¥è¿›è¡ŒåŒ¹é…ã€‚INå–åˆæ³•å€¼çš„ç”±é€—å·åˆ†éš”çš„æ¸…å•ï¼Œå…¨éƒ½æ‹¬åœ¨åœ†æ‹¬å·ä¸­ã€‚ 123456789101112131415mysql&gt; select prod_name,prod_price from products where vend_id in (1002,1003) order by prod_name;+----------------+------------+| prod_name | prod_price |+----------------+------------+| Bird seed | 10.00 || Carrots | 2.50 || Detonator | 13.00 || Fuses | 3.42 || Oil can | 8.99 || Safe | 50.00 || Sling | 4.49 || TNT (1 stick) | 2.50 || TNT (5 sticks) | 10.00 |+----------------+------------+9 rows in set (0.00 sec) INæ“ä½œç¬¦ WHEREå­å¥ä¸­ç”¨æ¥æŒ‡å®šè¦åŒ¹é…å€¼çš„æ¸…å•çš„å…³é”®å­—ï¼ŒåŠŸèƒ½ä¸ORç›¸å½“ã€‚ INæ“ä½œç¬¦çš„ä¼˜ç‚¹: åœ¨ä½¿ç”¨é•¿çš„åˆæ³•é€‰é¡¹æ¸…å•æ—¶ï¼ŒINæ“ä½œç¬¦çš„è¯­æ³•æ›´æ¸…æ¥šä¸”æ›´ç›´è§‚ã€‚ åœ¨ä½¿ç”¨INæ—¶ï¼Œè®¡ç®—çš„æ¬¡åºæ›´å®¹æ˜“ç®¡ç†(å› ä¸ºä½¿ç”¨çš„æ“ä½œç¬¦æ›´å°‘)ã€‚ INæ“ä½œç¬¦ä¸€èˆ¬æ¯”ORæ“ä½œç¬¦æ¸…å•æ‰§è¡Œæ›´å¿«ã€‚ INçš„æœ€å¤§ä¼˜ç‚¹æ˜¯å¯ä»¥åŒ…å«å…¶ä»–SELECTè¯­å¥ï¼Œä½¿å¾—èƒ½å¤Ÿæ›´åŠ¨æ€åœ°å»ºç«‹WHEREå­å¥ã€‚ç¬¬14ç« å°†å¯¹æ­¤è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚ 6. NOTæ“ä½œç¬¦WHEREå­å¥ä¸­çš„NOTæ“ä½œç¬¦æœ‰ä¸”åªæœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œé‚£å°±æ˜¯å¦å®šå®ƒä¹‹åæ‰€è·Ÿçš„ä»»ä½•æ¡ä»¶ã€‚ 1234567891011mysql&gt; select prod_name,prod_price from products where vend_id not in (1002,1003) order by prod_name;+--------------+------------+| prod_name | prod_price |+--------------+------------+| .5 ton anvil | 5.99 || 1 ton anvil | 9.99 || 2 ton anvil | 14.99 || JetPack 1000 | 35.00 || JetPack 2000 | 55.00 |+--------------+------------+5 rows in set (0.00 sec) MySQLæ”¯æŒä½¿ç”¨NOTå¯¹INã€BETWEENå’Œ EXISTSå­å¥å–åï¼Œè¿™ä¸å¤šæ•°å…¶ä»–DBMSå…è®¸ä½¿ç”¨NOTå¯¹å„ç§æ¡ä»¶å–åæœ‰å¾ˆå¤§çš„å·®åˆ«ã€‚ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/12/20/MySQL/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E7%AC%AC6-7%E7%AB%A0%20%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%BF%87%E6%BB%A4/"},{"title":"ã€ŠMySQLå¿…çŸ¥å¿…ä¼šã€‹ç¬¬1-3ç«  MySQLä»‹ç»","text":"1. æœ¯è¯­ä»‹ç» æ•°æ®åº“(database) : ä¿å­˜æœ‰ç»„ç»‡çš„æ•°æ®çš„å®¹å™¨(é€šå¸¸æ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–ä¸€ç»„æ–‡ä»¶) è¡¨(table) : æŸç§ç‰¹å®šç±»å‹æ•°æ®çš„ç»“æ„åŒ–æ¸…å•(å…·æœ‰å”¯ä¸€æ€§,åŒä¸€æ•°æ®åº“ä¸­è¡¨åä¸èƒ½ç›¸åŒ,ä¸åŒæ•°æ®åº“å¯ä»¥ç›¸åŒ) æ¨¡å¼(schema) : å…³äºæ•°æ®åº“å’Œè¡¨çš„å¸ƒå±€åŠç‰¹æ€§çš„ä¿¡æ¯ åˆ—(column) : è¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µ,æ‰€æœ‰è¡¨éƒ½æ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ç»„æˆ æ•°æ®ç±»å‹(datatype) : æ‰€å®¹è®¸çš„æ•°æ®çš„ç±»å‹.æ¯ä¸ªè¡¨åˆ—éƒ½æœ‰ç›¸åº”çš„æ•°æ®ç±»å‹,å®ƒé™åˆ¶è¯¥åˆ—ä¸­å­˜å‚¨çš„æ•°æ® è¡Œ(row) : è¡¨ä¸­çš„ä¸€ä¸ªè®°å½• ä¸»é”®(primary key) : ä¸€åˆ—(æˆ–ä¸€ç»„åˆ—),å…¶å€¼èƒ½å¤Ÿå”¯ä¸€åŒºåˆ†è¡¨ä¸­çš„æ¯è¡Œ,ä¸»é”®åˆ—ä¸å…è®¸NULLå€¼ å…³é”®å­—(key word) : MySQLè¯­è¨€ä¿ç•™å­—,ä¸å¯ç”¨å…³é”®å­—å‘½åè¡¨æˆ–åˆ— 2. SQL / DBMS / MySQL2.1 SQLä¼˜ç‚¹: SQLä¸æ˜¯æŸä¸ªç‰¹å®šæ•°æ®åº“ä¾›åº”å•†çš„ä¸“æœ‰è¯­è¨€,å‡ ä¹æ‰€æœ‰é‡è¦çš„DBMSéƒ½æ”¯æŒSQL SQLç®€å•æ˜“å­¦ SQLç®€å•çµæ´»,å¯ä»¥è¿›è¡Œåˆ†å‚å¤æ‚å’Œé«˜çº§çš„æ•°æ®åº“æ“ä½œ 2.2 æ•°æ®åº“ç®¡ç†ç³»ç»ŸDBMS åŸºäºå…±äº«æ–‡ä»¶ç³»ç»Ÿ Microsoft Access / FileMarker åŸºäºå®¢æˆ·æœº-æœåŠ¡å™¨ MySQL / Oracle / Microsoft SQL Server 2.3 MySQLä¼˜ç‚¹ ä½æˆæœ¬ é«˜æ€§èƒ½ å¯ä¿¡èµ– ç®€å•æ˜“ç”¨ 3. MySQLå·¥å…·3.1 å‘½ä»¤è¡Œç™»å½•å‘½ä»¤: 1mysql -h localhost -P 3306 -uroot -p1234 æ³¨æ„ :æœ€åè¿™ä¸ª-på’Œå¯†ç ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼å…¶ä»–çš„-hæˆ–è€…-uå’Œå‚æ•°é—´çš„ç©ºæ ¼æ˜¯å¯æœ‰å¯æ— çš„ ç™»å½•åæç¤º: 123456789101112131415root@c67b08791485:/# mysql -h localhost -P 3306 -u root -p1234mysql: [Warning] Using a password on the command line interface can be insecure.Welcome to the MySQL monitor. Commands end with ; or \\g.Your MySQL connection id is 5Server version: 5.7.6-m16 MySQL Community Server (GPL)Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.mysql&gt; 3.2 Navicat å…¶ä»–å·¥å…·,è¯·è‡ªè¡ŒGoogle 4. ç®€å•SQLè¯­å¥4.1 æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“1234567891011121314mysql&gt; show databases;+--------------------+| Database |+--------------------+| information_schema || eladmin || example || lfstudio || mysql || performance_schema || shiro || shiro2 |+--------------------+18 rows in set (0.01 sec) æˆ‘è¿™é‡Œæœ‰ä¸€äº›è‡ªå·±æµ‹è¯•çš„æ•°æ®åº“ 4.2 åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“12345mysql&gt; use shiro2;Reading table information for completion of table and column namesYou can turn off this feature to get a quicker startup with -ADatabase changed 4.3 æ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨123456789mysql&gt; show tables;+-----------------------+| Tables_in_shiro2 |+-----------------------+| base_admin_permission || base_admin_role || base_admin_user |+-----------------------+3 rows in set (0.00 sec) 4.4 æ˜¾ç¤ºæŒ‡å®šè¡¨ä¸­æ‰€æœ‰åˆ—12345678910111213mysql&gt; show columns from base_admin_role;+-------------+--------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+-------------+--------------+------+-----+---------+----------------+| id | int(11) | NO | PRI | NULL | auto_increment || role_name | varchar(30) | NO | | NULL | || role_desc | varchar(100) | YES | | NULL | || permissions | varchar(20) | YES | | NULL | || create_time | varchar(64) | YES | | NULL | || update_time | varchar(64) | YES | | NULL | || role_status | int(1) | NO | | 1 | |+-------------+--------------+------+-----+---------+----------------+7 rows in set (0.00 sec) å®ƒå¯¹æ¯ä¸ªå­—æ®µè¿”å›ä¸€è¡Œï¼Œè¡Œä¸­åŒ…å«å­—æ®µåã€æ•°æ® ç±»å‹ã€æ˜¯å¦å…è®¸NULLã€é”®ä¿¡æ¯ã€é»˜è®¤å€¼ä»¥åŠå…¶ä»–ä¿¡æ¯ 12345678910111213mysql&gt; describe base_admin_role;+-------------+--------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+-------------+--------------+------+-----+---------+----------------+| id | int(11) | NO | PRI | NULL | auto_increment || role_name | varchar(30) | NO | | NULL | || role_desc | varchar(100) | YES | | NULL | || permissions | varchar(20) | YES | | NULL | || create_time | varchar(64) | YES | | NULL | || update_time | varchar(64) | YES | | NULL | || role_status | int(1) | NO | | 1 | |+-------------+--------------+------+-----+---------+----------------+7 rows in set (0.00 sec) DESCRIBEè¯­å¥ MySQLæ”¯æŒç”¨DESCRIBEä½œä¸ºSHOW COLUMNS FROMçš„ä¸€ç§å¿«æ·æ–¹å¼ã€‚æ¢å¥è¯è¯´,DESCRIBE base_admin_role;æ˜¯ SHOW COLUMNS FROM base_admin_role;çš„ä¸€ç§å¿«æ·æ–¹å¼ã€‚ 4.5 å…¶ä»–showè¯­å¥ SHOW STATUSï¼Œç”¨äºæ˜¾ç¤ºå¹¿æ³›çš„æœåŠ¡å™¨çŠ¶æ€ä¿¡æ¯ SHOW CREATE DATABASEå’ŒSHOW CREATE TABLEï¼Œåˆ†åˆ«ç”¨æ¥æ˜¾ç¤ºåˆ›å»ºç‰¹å®šæ•°æ®åº“æˆ–è¡¨çš„MySQLè¯­å¥ SHOW GRANTSï¼Œç”¨æ¥æ˜¾ç¤ºæˆäºˆç”¨æˆ·(æ‰€æœ‰ç”¨æˆ·æˆ–ç‰¹å®šç”¨æˆ·)çš„å®‰å…¨æƒé™ SHOW ERRORSå’ŒSHOW WARNINGSï¼Œç”¨æ¥æ˜¾ç¤ºæœåŠ¡å™¨é”™è¯¯æˆ–è­¦å‘Šæ¶ˆæ¯ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/12/19/MySQL/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E7%AC%AC1-3%E7%AB%A0%20MySQL%E4%BB%8B%E7%BB%8D/"},{"title":"03.0 Eurekaç®€ä»‹","text":"1. Eurekaç®€ä»‹Eureka æ˜¯ Netflix çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œä¹Ÿæ˜¯æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ã€‚Eureka æ˜¯ä¸€ä¸ªåŸºäº REST çš„æœåŠ¡ï¼Œç”¨äºå®šä½æœåŠ¡ï¼Œä»¥å®ç°äº‘ç«¯ä¸­é—´å±‚æœåŠ¡å‘ç°å’Œæ•…éšœè½¬ç§»ã€‚æœåŠ¡æ³¨å†Œä¸å‘ç°å¯¹äºå¾®æœåŠ¡æ¶æ„æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ï¼Œæœ‰äº†æœåŠ¡å‘ç°ä¸æ³¨å†Œï¼Œåªéœ€è¦ä½¿ç”¨æœåŠ¡çš„æ ‡è¯†ç¬¦ï¼Œå°±å¯ä»¥è®¿é—®åˆ°æœåŠ¡ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹æœåŠ¡è°ƒç”¨çš„é…ç½®æ–‡ä»¶äº†ã€‚ åŠŸèƒ½ç±»ä¼¼äºdubboçš„æ³¨å†Œä¸­å¿ƒï¼Œæ¯”å¦‚Zookeeperã€‚ Netflixåœ¨è®¾è®¡Eurekaæ—¶éµå®ˆçš„å°±æ˜¯APåŸåˆ™ CAPåŸåˆ™åˆç§°CAPå®šç†ï¼ŒæŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒConsistencyï¼ˆä¸€è‡´æ€§ï¼‰ã€ Availabilityï¼ˆå¯ç”¨æ€§ï¼‰ã€Partition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰ï¼Œä¸‰è€…ä¸å¯å…¼å¾—é¡¹ç›®åœ°å€ : https://github.com/Netflix/eureka 2. Eurekaæ¶æ„Spring Cloud å°è£…äº† Netflix å…¬å¸å¼€å‘çš„ Eureka æ¨¡å—æ¥ å®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°(è¯·å¯¹æ¯”Zookeeper)ã€‚ Eureka é‡‡ç”¨äº† C-S çš„è®¾è®¡æ¶æ„ã€‚Eureka Server ä½œä¸ºæœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚è€Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œä½¿ç”¨ Eureka çš„å®¢æˆ·ç«¯è¿æ¥åˆ° Eureka Serverå¹¶ç»´æŒå¿ƒè·³è¿æ¥ã€‚è¿™æ ·ç³»ç»Ÿçš„ç»´æŠ¤äººå‘˜å°±å¯ä»¥é€šè¿‡ Eureka Server æ¥ç›‘æ§ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚SpringCloud çš„ä¸€äº›å…¶ä»–æ¨¡å—ï¼ˆæ¯”å¦‚Zuulï¼‰å°±å¯ä»¥é€šè¿‡ Eureka Server æ¥å‘ç°ç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œå¹¶æ‰§è¡Œç›¸å…³çš„é€»è¾‘ã€‚ è¯·æ³¨æ„å’Œ Dubbo çš„æ¶æ„å¯¹æ¯” Eureka åŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼šEureka Server å’Œ Eureka Client Eureka Serveræä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡ã€‚å„ä¸ªèŠ‚ç‚¹å¯åŠ¨åï¼Œä¼šåœ¨EurekaServerä¸­è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·EurekaServerä¸­çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒæœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çš„çœ‹åˆ° Eureka Clientæ˜¯ä¸€ä¸ªJavaå®¢æˆ·ç«¯ã€‚ç”¨äºç®€åŒ–Eureka Serverçš„äº¤äº’ï¼Œå®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå…·å¤‡ä¸€ä¸ªå†…ç½®çš„ã€ä½¿ç”¨è½®è¯¢(round-robin)è´Ÿè½½ç®—æ³•çš„è´Ÿè½½å‡è¡¡å™¨ã€‚åœ¨åº”ç”¨å¯åŠ¨åï¼Œå°†ä¼šå‘Eureka Serverå‘é€å¿ƒè·³(é»˜è®¤å‘¨æœŸä¸º30ç§’)ã€‚å¦‚æœEureka Serveråœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEureka Serverå°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤ï¼ˆé»˜è®¤90ç§’ï¼‰ 3. ä¸‰å‘˜å¤§å°† Eureka Server æä¾›æœåŠ¡æ³¨å†Œå’Œå‘ç° Service Provider æœåŠ¡æä¾›æ–¹å°†è‡ªèº«æœåŠ¡æ³¨å†Œåˆ°Eurekaï¼Œä»è€Œä½¿æœåŠ¡æ¶ˆè´¹æ–¹èƒ½å¤Ÿæ‰¾åˆ° Service Consumer æœåŠ¡æ¶ˆè´¹æ–¹ä»Eurekaè·å–æ³¨å†ŒæœåŠ¡åˆ—è¡¨ï¼Œä»è€Œèƒ½å¤Ÿæ¶ˆè´¹æœåŠ¡ èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/23/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/03.0%20Eureka%E7%AE%80%E4%BB%8B/"},{"title":"ã€ŠMySQLå¿…çŸ¥å¿…ä¼šã€‹ç¬¬4-5ç«  SELECTæ£€ç´¢ä¸æ’åº","text":"1. SELECT è¯­å¥1.1 æ£€ç´¢å•ä¸ªåˆ—å…³é”®å­—SELECTåå†™éœ€è¦æŸ¥è¯¢çš„åˆ—å 123456789mysql&gt; select prod_name from products;+----------------+| prod_name |+----------------+| Fuses || JetPack 1000 || TNT (5 sticks) |+----------------+14 rows in set (0.00 sec) å¤šæ¡SQLè¯­å¥å¿…é¡»ä½¿ç”¨åˆ†å·(;)åˆ†éš”,æ¨èåšæ³•. SQLè¯­å¥ä¸åŒºåˆ†å¤§å°å†™ 1.2 æ£€ç´¢å¤šä¸ªåˆ—å’Œæ£€ç´¢å•åˆ—ç±»ä¼¼,å…³é”®å­—SELECTåå†™éœ€è¦æŸ¥è¯¢çš„åˆ—å,é€—å·åˆ†éš” 123456789mysql&gt; select prod_id,prod_name,prod_price from products;+---------+----------------+------------+| prod_id | prod_name | prod_price |+---------+----------------+------------+| ANV01 | .5 ton anvil | 5.99 || ANV02 | 1 ton anvil | 9.99 || ANV03 | 2 ton anvil | 14.99 |+---------+----------------+------------+14 rows in set (0.00 sec) 1.3 æ£€ç´¢æ‰€æœ‰åˆ—ä½¿ç”¨é€šé…ç¬¦(*)å³å¯ 1select * from products; æœ€å¥½åˆ«ä½¿ç”¨*é€šé…ç¬¦,è™½ç„¶æ­¤ç§å†™æ³•æ–¹ä¾¿,ä½†æ˜¯ç´¢å¼•ä¸éœ€è¦çš„åˆ—é€šå¸¸ä¼šé™ä½æ£€ç´¢å’Œåº”ç”¨ç¨‹åºçš„æ€§èƒ½ 1.4 æ£€ç´¢ä¸åŒè¡Œå¹¶å»é‡ä½¿ç”¨å…³é”®å­—DISTINCT,æŒ‡ç¤ºMySQLåªè¿”å›ä¸åŒå€¼,ä»è€Œè¾¾åˆ°å»é‡ç›®çš„. 12345678910111213141516171819202122mysql&gt; select vend_id from products;+---------+| vend_id |+---------+| 1001 || 1002 || 1003 || 1003 || 1005 |+---------+14 rows in set (0.00 sec)mysql&gt; select distinct vend_id from products;+---------+| vend_id |+---------+| 1001 || 1002 || 1003 || 1005 |+---------+4 rows in set (0.01 sec) DISTINCTå…³é”®å­—å¿…é¡»ç›´æ¥æ”¾åœ¨åˆ—åçš„å‰é¢ ä¸èƒ½ä¸åˆ†ä½¿ç”¨DISTINCT,å³DISTINCTå…³é”®å­—åº”ç”¨äºæ‰€æœ‰åˆ—è€Œä¸ä»…æ˜¯å‰ç½®å®ƒçš„åˆ— 1.5 é™åˆ¶ç»“æœ Limitä½¿ç”¨åªè¿”å›æŒ‡å®šä¸ªæ•°çš„ç»“æœ,åœ¨è¯­å¥åä½¿ç”¨å…³é”®å­— limit,å…³é”®å­—ååŠ è¡Œæ•°å³å¯ 12345678mysql&gt; select prod_name from products limit 2;+--------------+| prod_name |+--------------+| .5 ton anvil || 1 ton anvil |+--------------+2 rows in set (0.00 sec) æŒ‡å®šæ£€ç´¢çš„å¼€å§‹è¡Œå’Œè¡Œæ•° limit m,n 12345678mysql&gt; select prod_name from products limit 0,2;+--------------+| prod_name |+--------------+| .5 ton anvil || 1 ton anvil |+--------------+2 rows in set (0.00 sec) ç¬¬ä¸€ä¸ªæ•°ä¸ºå¼€å§‹ä½ç½®,ç¬¬äºŒä¸ªæ•°ä¸ºè¦æ£€ç´¢å‡ºæ¥çš„è¡Œæ•°. ä¸Šé¢è¯­å¥çš„æ„æ€ : ä»ç¬¬0è¡Œå¼€å§‹,æ£€ç´¢å‡º2è¡Œçš„æ•°æ®. åœ¨LIMITä¸­æŒ‡å®šè¦æ£€ç´¢çš„è¡Œæ•°ä¸ºæ£€ç´¢çš„æœ€å¤§è¡Œæ•°,å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„è¡Œ,MySQLå°†åªè¿”å›å®ƒèƒ½è¿”å›çš„é‚£ä¹ˆå¤šè¡Œ. 1.6 ä½¿ç”¨å®Œå…¨é™å®šçš„è¡¨åå®Œå…¨é™å®šçš„è¡¨åå¯ä»¥é»˜è®¤ä¸æ·»åŠ ,ä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹(åç»­ä»‹ç»)å®Œå…¨é™å®šçš„è¡¨åè¿˜æ˜¯éå¸¸æœ‰å¿…é¡»è¦çš„. 123456789mysql&gt; select products.prod_name from products;+----------------+| prod_name |+----------------+| .5 ton anvil || 1 ton anvil || 2 ton anvil |+----------------+14 rows in set (0.00 sec) 2. æ’åºæ£€ç´¢æ•°æ®2.1 æŒ‰å•ä¸ªåˆ—æ’åºæ•°æ®é»˜è®¤æ£€ç´¢å‡ºæ¥çš„é¡ºåºæ˜¯æŒ‰ç…§æ•°æ®æœ€åˆåœ¨è¡¨ä¸­è¢«æ·»åŠ çš„é¡ºåº,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ORDER BYå­å¥æ¥æ˜¾ç¤ºçš„æŒ‡å®šæ’åºå­—æ®µ. 1234567891011121314151617181920mysql&gt; select prod_name from products order by prod_name;+----------------+| prod_name |+----------------+| .5 ton anvil || 1 ton anvil || 2 ton anvil || Bird seed || Carrots || Detonator || Fuses || JetPack 1000 || JetPack 2000 || Oil can || Safe || Sling || TNT (1 stick) || TNT (5 sticks) |+----------------+14 rows in set (0.00 sec) æ­¤å¤„æ˜¯æŒ‰ç…§å­—å…¸ä¹¦åºæ’åº 2.2 æŒ‰å¤šä¸ªåˆ—æ’åºå¤šä¸ªåˆ—æ’åº,åªè¦æŒ‡å®šåˆ—å,åˆ—åä¹‹é—´ç”¨é€—å·åˆ†éš”å³å¯.æ£€ç´¢ä¸‰ä¸ªåˆ—,é¦–å…ˆæŒ‰ä»·æ ¼æ’åº,ç„¶åå†æŒ‰åç§°æ’åº: 1234567891011121314151617181920mysql&gt; select prod_id,prod_price,prod_name from products order by prod_price,prod_name;+---------+------------+----------------+| prod_id | prod_price | prod_name |+---------+------------+----------------+| FC | 2.50 | Carrots || TNT1 | 2.50 | TNT (1 stick) || FU1 | 3.42 | Fuses || SLING | 4.49 | Sling || ANV01 | 5.99 | .5 ton anvil || OL1 | 8.99 | Oil can || ANV02 | 9.99 | 1 ton anvil || FB | 10.00 | Bird seed || TNT2 | 10.00 | TNT (5 sticks) || DTNTR | 13.00 | Detonator || ANV03 | 14.99 | 2 ton anvil || JP1000 | 35.00 | JetPack 1000 || SAFE | 50.00 | Safe || JP2000 | 55.00 | JetPack 2000 |+---------+------------+----------------+14 rows in set (0.00 sec) æ­¤ä¾‹ä¸­,ä»…åœ¨å¤šä¸ªè¡Œå…·æœ‰ç›¸åŒçš„prod_priceå€¼æ—¶æ‰å¯¹äº§å“æŒ‰prod_nameè¿›è¡Œæ’åº.å¦‚æœprod_priceåˆ—ä¸­æ‰€æœ‰çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„,åˆ™ä¸ä¼šæŒ‰prod_nameæ’åº. 2.3 æŒ‡å®šæ’åºæ–¹å‘æ•°æ®æ’åºåˆ†ä¸ºä¸¤ç§ : å‡åº(ASC)å’Œé™åº(DESC). é»˜è®¤çš„æ’åºæ–¹å¼æ˜¯å‡åº. DESCå…³é”®å­—åªåº”ç”¨åˆ°ç›´æ¥ä½äºå…¶å‰é¢çš„åˆ—å,å¦‚æœæƒ³åœ¨å¤šä¸ªåˆ—ä¸Šè¿›è¡Œé™åºæ’åº,å°±å¿…é¡»å¯¹æ¯ä¸ªåˆ—æŒ‡å®šDESCå…³é”®å­— 1234567891011121314151617181920mysql&gt; select prod_id,prod_price,prod_name from products order by prod_price desc,prod_name desc;+---------+------------+----------------+| prod_id | prod_price | prod_name |+---------+------------+----------------+| JP2000 | 55.00 | JetPack 2000 || SAFE | 50.00 | Safe || JP1000 | 35.00 | JetPack 1000 || ANV03 | 14.99 | 2 ton anvil || DTNTR | 13.00 | Detonator || TNT2 | 10.00 | TNT (5 sticks) || FB | 10.00 | Bird seed || ANV02 | 9.99 | 1 ton anvil || OL1 | 8.99 | Oil can || ANV01 | 5.99 | .5 ton anvil || SLING | 4.49 | Sling || FU1 | 3.42 | Fuses || TNT1 | 2.50 | TNT (1 stick) || FC | 2.50 | Carrots |+---------+------------+----------------+14 rows in set (0.00 sec) åœ¨å­—å…¸æ’åºä¸­,Aè¢«è§†ä¸ºä¸aç›¸åŒ,è¿™æ˜¯MySQLç­‰å¤§å¤šæ•°æ•°æ®åº“ç®¡ç†ç³»ç»Ÿé»˜è®¤è¡Œä¸º,å¦‚æœæƒ³è¦æ›´æ”¹éœ€è¦DBAçš„å¸®åŠ© 2.4 ORDER BYä¸LIMITç»„åˆORDER BYä¸LIMITç»„åˆ,å¯ä»¥æ‰¾å‡ºä¸€åˆ—ä¸­æœ€é«˜æˆ–æœ€ä½çš„å€¼ 1234567mysql&gt; select prod_price from products order by prod_price desc limit 1;+------------+| prod_price |+------------+| 55.00 |+------------+1 row in set (0.00 sec) ORDER BYå­å¥å¿…é¡»åœ¨FROMå­å¥ä¹‹å,LIMITå­å¥å¿…é¡»åœ¨ORDER BYå­å¥ä¹‹åä½†æ˜¯è¿™ä¸¤ä¸ªå…³é”®å­—è”åˆä½¿ç”¨ä¼šæœ‰é—®é¢˜,åé¢ä¼šå•ç‹¬è®²è§£. Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/12/19/MySQL/%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/%E7%AC%AC4-5%E7%AB%A0%20SELECT%E6%A3%80%E7%B4%A2%E4%B8%8E%E6%8E%92%E5%BA%8F/"},{"title":"01.SpringCloudå…¥é—¨æ¦‚è¿°","text":"1. æ˜¯ä»€ä¹ˆSpringCloudï¼ŒåŸºäºSpringBootæä¾›äº†ä¸€å¥—å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Œé…ç½®ä¸­å¿ƒï¼Œå…¨é“¾è·¯ç›‘æ§ï¼ŒæœåŠ¡ç½‘å…³ï¼Œè´Ÿè½½å‡è¡¡ï¼Œç†”æ–­å™¨ç­‰ç»„ä»¶ï¼Œé™¤äº†åŸºäºNetFlixçš„å¼€æºç»„ä»¶åšé«˜åº¦æŠ½è±¡å°è£…ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›é€‰å‹ä¸­ç«‹çš„å¼€æºç»„ä»¶ã€‚ SpringCloudåˆ©ç”¨SpringBootçš„å¼€å‘ä¾¿åˆ©æ€§å·§å¦™åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€è®¾æ–½çš„å¼€å‘ï¼ŒSpringCloudä¸ºå¼€å‘äººå‘˜æä¾›äº†å¿«é€Ÿæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€äº›å·¥å…·ï¼ŒåŒ…æ‹¬é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€è·¯ç”±ã€å¾®ä»£ç†ã€äº‹ä»¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«é€‰ã€åˆ†å¸ƒå¼ä¼šè¯ç­‰ç­‰,å®ƒä»¬éƒ½å¯ä»¥ç”¨SpringBootçš„å¼€å‘é£æ ¼åšåˆ°ä¸€é”®å¯åŠ¨å’Œéƒ¨ç½²ã€‚ SpringBootå¹¶æ²¡æœ‰é‡å¤åˆ¶é€ è½®å­ï¼Œå®ƒåªæ˜¯å°†ç›®å‰å„å®¶å…¬å¸å¼€å‘çš„æ¯”è¾ƒæˆç†Ÿã€ç»å¾—èµ·å®é™…è€ƒéªŒçš„æœåŠ¡æ¡†æ¶ç»„åˆèµ·æ¥ï¼Œé€šè¿‡SpringBooté£æ ¼è¿›è¡Œå†å°è£…å±è”½æ‰äº†å¤æ‚çš„é…ç½®å’Œå®ç°åŸç†ï¼Œ æœ€ç»ˆç»™å¼€å‘è€…ç•™å‡ºäº†ä¸€å¥—ç®€å•æ˜“æ‡‚ã€æ˜“éƒ¨ç½²å’Œæ˜“ç»´æŠ¤çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘å·¥å…·åŒ… 1.1 SpringCloudå’ŒSpringBootå¯¹æ¯”SpringBootä¸“æ³¨äºå¿«é€Ÿæ–¹ä¾¿çš„å¼€å‘å•ä¸ªä¸ªä½“å¾®æœåŠ¡ã€‚SpringCloudæ˜¯å…³æ³¨å…¨å±€çš„å¾®æœåŠ¡åè°ƒæ•´ç†æ²»ç†æ¡†æ¶ï¼Œå®ƒå°†SpringBootå¼€å‘çš„ä¸€ä¸ªä¸ªå•ä½“å¾®æœåŠ¡æ•´åˆå¹¶ç®¡ç†èµ·æ¥ï¼Œä¸ºå„ä¸ªå¾®æœåŠ¡ä¹‹é—´æä¾›ï¼Œé…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€è·¯ç”±ã€å¾®ä»£ç†ã€äº‹ä»¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«é€‰ã€åˆ†å¸ƒå¼ä¼šè¯ç­‰ç­‰é›†æˆæœåŠ¡SpringBootå¯ä»¥ç¦»å¼€SpringCloudç‹¬ç«‹ä½¿ç”¨å¼€å‘é¡¹ç›®ï¼Œ ä½†æ˜¯SpringCloudç¦»ä¸å¼€SpringBootï¼Œå±äºä¾èµ–çš„å…³ç³»ã€‚SpringBootä¸“æ³¨äºå¿«é€Ÿã€æ–¹ä¾¿çš„å¼€å‘å•ä¸ªå¾®æœåŠ¡ä¸ªä½“ï¼ŒSpringCloudå…³æ³¨å…¨å±€çš„æœåŠ¡æ²»ç†æ¡†æ¶ã€‚ 1.2 SpringCloudå’ŒDubbo æœ€å¤§åŒºåˆ«ï¼šSpringCloudæŠ›å¼ƒäº†Dubboçš„RPCé€šä¿¡ï¼Œé‡‡ç”¨çš„æ˜¯åŸºäºHTTPçš„RESTæ–¹å¼ã€‚ ä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸¤ç§æ–¹å¼å„æœ‰ä¼˜åŠ£ã€‚è™½ç„¶ä»ä¸€å®šç¨‹åº¦ä¸Šæ¥è¯´ï¼Œåè€…ç‰ºç‰²äº†æœåŠ¡è°ƒç”¨çš„æ€§èƒ½ï¼Œä½†ä¹Ÿé¿å…äº†ä¸Šé¢æåˆ°çš„åŸç”ŸRPCå¸¦æ¥çš„é—®é¢˜ã€‚è€Œä¸”RESTç›¸æ¯”RPCæ›´ä¸ºçµæ´»ï¼ŒæœåŠ¡æä¾›æ–¹å’Œè°ƒç”¨æ–¹çš„ä¾èµ–åªä¾é ä¸€çº¸å¥‘çº¦ï¼Œä¸å­˜åœ¨ä»£ç çº§åˆ«çš„å¼ºä¾èµ–ï¼Œè¿™åœ¨å¼ºè°ƒå¿«é€Ÿæ¼”åŒ–çš„å¾®æœåŠ¡ç¯å¢ƒä¸‹ï¼Œæ˜¾å¾—æ›´åŠ åˆé€‚ã€‚ å“ç‰Œæœºä¸ç»„è£…æœºçš„åŒºåˆ«ã€‚å¾ˆæ˜æ˜¾ï¼ŒSpring Cloudçš„åŠŸèƒ½æ¯”DUBBOæ›´åŠ å¼ºå¤§ï¼Œæ¶µç›–é¢æ›´å¹¿ï¼Œè€Œä¸”ä½œä¸ºSpringçš„æ‹³å¤´é¡¹ç›®ï¼Œå®ƒä¹Ÿèƒ½å¤Ÿä¸Spring Frameworkã€Spring Bootã€Spring Dataã€Spring Batchç­‰å…¶ä»–Springé¡¹ç›®å®Œç¾èåˆï¼Œè¿™äº›å¯¹äºå¾®æœåŠ¡è€Œè¨€æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½¿ç”¨Dubboæ„å»ºçš„å¾®æœåŠ¡æ¶æ„å°±åƒç»„è£…ç”µè„‘ï¼Œå„ç¯èŠ‚æˆ‘ä»¬çš„é€‰æ‹©è‡ªç”±åº¦å¾ˆé«˜ï¼Œä½†æ˜¯æœ€ç»ˆç»“æœå¾ˆæœ‰å¯èƒ½å› ä¸ºä¸€æ¡å†…å­˜è´¨é‡ä¸è¡Œå°±ç‚¹ä¸äº®äº†ï¼Œæ€»æ˜¯è®©äººä¸æ€ä¹ˆæ”¾å¿ƒï¼Œä½†æ˜¯å¦‚æœä½ æ˜¯ä¸€åé«˜æ‰‹ï¼Œé‚£è¿™äº›éƒ½ä¸æ˜¯é—®é¢˜ï¼›è€ŒSpring Cloudå°±åƒå“ç‰Œæœºï¼Œåœ¨Spring Sourceçš„æ•´åˆä¸‹ï¼Œåšäº†å¤§é‡çš„å…¼å®¹æ€§æµ‹è¯•ï¼Œä¿è¯äº†æœºå™¨æ‹¥æœ‰æ›´é«˜çš„ç¨³å®šæ€§ï¼Œä½†æ˜¯å¦‚æœè¦åœ¨ä½¿ç”¨éåŸè£…ç»„ä»¶å¤–çš„ä¸œè¥¿ï¼Œå°±éœ€è¦å¯¹å…¶åŸºç¡€æœ‰è¶³å¤Ÿçš„äº†è§£ã€‚ ç¤¾åŒºæ”¯æŒä¸æ›´æ–°åŠ›åº¦æœ€ä¸ºé‡è¦çš„æ˜¯ï¼ŒDUBBOåœæ­¢äº†5å¹´å·¦å³çš„æ›´æ–°ï¼Œè™½ç„¶2017.7é‡å¯äº†ã€‚å¯¹äºæŠ€æœ¯å‘å±•çš„æ–°éœ€æ±‚ï¼Œéœ€è¦ç”±å¼€å‘è€…è‡ªè¡Œæ‹“å±•å‡çº§ï¼ˆæ¯”å¦‚å½“å½“ç½‘å¼„å‡ºäº†DubboXï¼‰ï¼Œè¿™å¯¹äºå¾ˆå¤šæƒ³è¦é‡‡ç”¨å¾®æœåŠ¡æ¶æ„çš„ä¸­å°è½¯ä»¶ç»„ç»‡ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªåˆé€‚çš„ï¼Œä¸­å°å…¬å¸æ²¡æœ‰è¿™ä¹ˆå¼ºå¤§çš„æŠ€æœ¯èƒ½åŠ›å»ä¿®æ”¹Dubboæºç +å‘¨è¾¹çš„ä¸€æ•´å¥—è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªå…¬å¸éƒ½æœ‰é˜¿é‡Œçš„å¤§ç‰›+çœŸå®çš„çº¿ä¸Šç”Ÿäº§ç¯å¢ƒæµ‹è¯•è¿‡ã€‚ 2. èƒ½å¹²å˜› Distributed/versioned configuration(åˆ†å¸ƒå¼/ç‰ˆæœ¬æ§åˆ¶é…ç½®) Service registration and discovery(æœåŠ¡æ³¨å†Œä¸å‘ç°) Routing(è·¯ç”±) Service-to-service calls(æœåŠ¡åˆ°æœåŠ¡çš„è°ƒç”¨) Load balancing(è´Ÿè½½å‡è¡¡é…ç½®) Circuit Breakers(æ–­è·¯å™¨) Distributed messaging(åˆ†å¸ƒå¼æ¶ˆæ¯ç®¡ç†) ç­‰ç­‰ 3.èµ„æ–™æ¨è å®˜ç½‘ : http://projects.spring.io/spring-cloud/ GitHub : https://springcloud.cc/spring-cloud-netflix.html SpringCloudä¸­å›½ç¤¾åŒº : http://springcloud.cn/ SpringCloudä¸­æ–‡ç½‘ : https://springcloud.cc/ 4. æ€ä¹ˆç©SpringCloudä¸»è¦åŒ…å«å¦‚ä¸‹æŠ€æœ¯æ ˆ æœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼ˆEurekaï¼‰ æœåŠ¡æ¶ˆè´¹è€…ï¼ˆrest+Ribbonï¼‰ æœåŠ¡æ¶ˆè´¹è€…ï¼ˆFeignï¼‰ æ–­è·¯å™¨ï¼ˆHystrixï¼‰ æ–­è·¯å™¨ç›‘æ§(Hystrix Dashboard) è·¯ç”±ç½‘å…³(Zuul) åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ(Spring Cloud Config) æ¶ˆæ¯æ€»çº¿(Spring Cloud Bus) æœåŠ¡é“¾è·¯è¿½è¸ª(Spring Cloud Sleuth) 5. SpringCloudå›½å†…ä½¿ç”¨æƒ…å†µè¯¦è§ : https://github.com/SpringCloud/spring-cloud-document/issues/1 èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/21/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/01.SpringCloud%E5%85%A5%E9%97%A8%E6%A6%82%E8%BF%B0/"},{"title":"00.å¾®æœåŠ¡æ¦‚è¿°","text":"0. å‰è¨€ æœ¬æ–‡ä¸ºã€ŠSpringCloud-å°šç¡…è°·ã€‹è¯¾ç¨‹æ–‡å­—æ€»ç»“ æ–‡ç« å†…å®¹æ¥æºä¸ºè¯¾ç¨‹è§†é¢‘å’Œæ€ç»´å¯¼å›¾ æ„Ÿè°¢å¼€æº è¯¾ç¨‹è§†é¢‘ : https://www.bilibili.com/video/av64847970 1. æ˜¯ä»€ä¹ˆä¸šç•Œå¤§ç‰›é©¬ä¸.ç¦å‹’ï¼ˆMartin Fowlerï¼‰è¿™æ ·æè¿°å¾®æœåŠ¡ : https://martinfowler.com/articles/microservices.html å°±ç›®å‰è€Œè¨€ï¼Œå¯¹äºå¾®æœåŠ¡ä¸šç•Œå¹¶æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„ã€æ ‡å‡†çš„å®šä¹‰ï¼ˆWhile there is no precise definition of this architectural styleï¼‰ ä½†é€šå¸¸è€Œè¨€ï¼Œå¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼æˆ–è€…è¯´æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†æˆä¸€ç»„å°çš„æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨å…¶ç‹¬ç«‹çš„è‡ªå·±çš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¹‹é—´äº’ç›¸åè°ƒã€äº’ç›¸é…åˆï¼Œä¸ºç”¨æˆ·æä¾›æœ€ç»ˆä»·å€¼ã€‚æœåŠ¡ä¹‹é—´é‡‡ç”¨è½»é‡çº§çš„é€šä¿¡æœºåˆ¶äº’ç›¸æ²Ÿé€šï¼ˆé€šå¸¸æ˜¯åŸºäºHTTPçš„RESTful APIï¼‰ã€‚ æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€ç±»ç”Ÿäº§ç¯å¢ƒç­‰ã€‚å¦å¤–ï¼Œåº”å°½é‡é¿å…ç»Ÿä¸€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€å·¥å…·å¯¹å…¶è¿›è¡Œæ„å»ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸è½»é‡çº§çš„é›†ä¸­å¼ç®¡ç†æ¥åè°ƒè¿™äº›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨ã€‚ å¾®æœåŠ¡åŒ–çš„æ ¸å¿ƒå°±æ˜¯å°†ä¼ ç»Ÿçš„ä¸€ç«™å¼åº”ç”¨,æ ¹æ®ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„æœåŠ¡,å½»åº•åœ°å»è€¦åˆ,æ¯ä¸€ä¸ªå¾®æœåŠ¡æä¾›å•ä¸ªä¸šåŠ¡åŠŸèƒ½,ä¸€ä¸ªæœåŠ¡åšä¸€ä»¶äº‹,ä»æŠ€æœ¯è§’åº¦çœ‹å°±æ˜¯ä¸€ç§å°è€Œç‹¬ç«‹çš„å¤„ç†è¿‡ç¨‹,ç±»ä¼¼è¿›ç¨‹æ¦‚å¿µ,èƒ½å¤Ÿè‡ªè¡Œå•ç‹¬å¯åŠ¨æˆ–é”€æ¯,æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“. 2. å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„å¾®æœåŠ¡å¼ºè°ƒçš„æ˜¯æœåŠ¡çš„å¤§å°ï¼Œå®ƒå…³æ³¨çš„æ˜¯æŸä¸€ä¸ªç‚¹ï¼Œæ˜¯å…·ä½“è§£å†³æŸä¸€ä¸ªé—®é¢˜/æä¾›è½åœ°å¯¹åº”æœåŠ¡çš„ä¸€ä¸ªæœåŠ¡åº”ç”¨,ç‹­æ„çš„çœ‹,å¯ä»¥çœ‹ä½œEclipseé‡Œé¢çš„ä¸€ä¸ªä¸ªå¾®æœåŠ¡å·¥ç¨‹/æˆ–è€…Module å¾®æœåŠ¡æ¶æ„å¾®æœåŠ¡æ¶æ„æ˜¯â¼€ç§æ¶æ„æ¨¡å¼ï¼Œå®ƒæå€¡å°†å•â¼€åº”â½¤ç¨‹åºåˆ’åˆ†æˆâ¼€ç»„â¼©çš„æœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´äº’ç›¸åè°ƒã€äº’ç›¸é…åˆï¼Œä¸ºâ½¤æˆ·æä¾›æœ€ç»ˆä»·å€¼ã€‚æ¯ä¸ªæœåŠ¡è¿â¾åœ¨å…¶ç‹¬â½´çš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¸æœåŠ¡é—´é‡‡â½¤è½»é‡çº§çš„é€šä¿¡æœºåˆ¶äº’ç›¸åä½œï¼ˆé€šå¸¸æ˜¯åŸºäºHTTPåè®®çš„RESTful APIï¼‰ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›â¾æ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬â½´çš„éƒ¨ç½²åˆ°â½£äº§ç¯å¢ƒã€ç±»â½£äº§ç¯å¢ƒç­‰ã€‚å¦å¤–ï¼Œåº”å½“å°½é‡é¿å…ç»Ÿâ¼€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„â¼€ä¸ªæœåŠ¡â½½â¾”ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹â½‚ï¼Œé€‰æ‹©åˆé€‚çš„è¯­â¾”ã€â¼¯å…·å¯¹å…¶è¿›â¾æ„å»ºã€‚ 3. å¾®æœåŠ¡ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ æ¯ä¸ªæœåŠ¡è¶³å¤Ÿå†…èšï¼Œè¶³å¤Ÿå°ï¼Œä»£ç å®¹æ˜“ç†è§£è¿™æ ·èƒ½èšç„¦ä¸€ä¸ªæŒ‡å®šçš„ä¸šåŠ¡åŠŸèƒ½æˆ–ä¸šåŠ¡éœ€æ±‚ å¼€å‘ç®€å•ã€å¼€å‘æ•ˆç‡æé«˜ï¼Œä¸€ä¸ªæœåŠ¡å¯èƒ½å°±æ˜¯ä¸“ä¸€çš„åªå¹²ä¸€ä»¶äº‹ å¾®æœåŠ¡èƒ½å¤Ÿè¢«å°å›¢é˜Ÿå•ç‹¬å¼€å‘ï¼Œè¿™ä¸ªå°å›¢é˜Ÿæ˜¯2åˆ°5äººçš„å¼€å‘äººå‘˜ç»„æˆ å¾®æœåŠ¡æ˜¯æ¾è€¦åˆçš„ï¼Œæ˜¯æœ‰åŠŸèƒ½æ„ä¹‰çš„æœåŠ¡ï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µæˆ–éƒ¨ç½²é˜¶æ®µéƒ½æ˜¯ç‹¬ç«‹çš„ å¾®æœåŠ¡èƒ½ä½¿ç”¨ä¸åŒçš„è¯­è¨€å¼€å‘ æ˜“äºå’Œç¬¬ä¸‰æ–¹é›†æˆï¼Œå¾®æœåŠ¡å…è®¸å®¹æ˜“ä¸”çµæ´»çš„æ–¹å¼é›†æˆè‡ªåŠ¨éƒ¨ç½²ï¼Œé€šè¿‡æŒç»­é›†æˆå·¥å…·ï¼Œå¦‚Jenkins, Hudson, bamboo å¾®æœåŠ¡æ˜“äºè¢«ä¸€ä¸ªå¼€å‘äººå‘˜ç†è§£ï¼Œä¿®æ”¹å’Œç»´æŠ¤ï¼Œè¿™æ ·å°å›¢é˜Ÿèƒ½å¤Ÿæ›´å…³æ³¨è‡ªå·±çš„å·¥ä½œæˆæœã€‚æ— éœ€é€šè¿‡åˆä½œæ‰èƒ½ä½“ç°ä»·å€¼ å¾®æœåŠ¡å…è®¸ä½ åˆ©ç”¨èåˆæœ€æ–°æŠ€æœ¯ å¾®æœåŠ¡åªæ˜¯ä¸šåŠ¡é€»è¾‘çš„ä»£ç ï¼Œä¸ä¼šå’ŒHTML,CSS æˆ–å…¶ä»–ç•Œé¢ç»„ä»¶æ··åˆ æ¯ä¸ªå¾®æœåŠ¡éƒ½æœ‰è‡ªå·±çš„å­˜å‚¨èƒ½åŠ›ï¼Œå¯ä»¥æœ‰è‡ªå·±çš„æ•°æ®åº“ã€‚ä¹Ÿå¯ä»¥æœ‰ç»Ÿä¸€æ•°æ®åº“ ç¼ºç‚¹ å¼€å‘äººå‘˜è¦å¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§ å¤šæœåŠ¡è¿ç»´éš¾åº¦ï¼Œéšç€æœåŠ¡çš„å¢åŠ ï¼Œè¿ç»´çš„å‹åŠ›ä¹Ÿåœ¨å¢å¤§ ç³»ç»Ÿéƒ¨ç½²ä¾èµ– æœåŠ¡é—´é€šä¿¡æˆæœ¬ æ•°æ®ä¸€è‡´æ€§ ç³»ç»Ÿé›†æˆæµ‹è¯• æ€§èƒ½ç›‘æ§â€¦â€¦ 4. å¾®æœåŠ¡æŠ€æœ¯æ ˆ 5. é€‰æ‹©SpringCloudçš„ç†ç”± æ•´ä½“è§£å†³æ–¹æ¡ˆå’Œæ¡†æ¶æˆç†Ÿ ç¤¾åŒºçƒ­åº¦é«˜ å¯ç»´æŠ¤æ€§å¥½ å­¦ä¹ æ›²çº¿ 6.å›½å†…å„å¤§å…¬å¸å¾®æœåŠ¡æŠ€æœ¯ é˜¿é‡Œ Dubbo/HSF äº¬ä¸œ JSF æ–°æµªå¾®åš Motan å½“å½“ç½‘ DubboX 7. å„å¾®æœåŠ¡æ¡†æ¶å¯¹æ¯” èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/20/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/00.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A6%82%E8%BF%B0/"},{"title":"03.2 Eurekaè‡ªæˆ‘ä¿æŠ¤å’ŒæœåŠ¡å‘ç°","text":"1. è‡ªæˆ‘ä¿æŠ¤1.1 æ¼”ç¤ºå…ˆåå¯åŠ¨eurekaå’Œproviderï¼Œproviderç©ºç½®ä¸€æ®µæ—¶é—´å³å¯çœ‹åˆ°ã€‚ 1.2 æ•…éšœç°è±¡ 1.3 å¯¼è‡´åŸå› ä»€ä¹ˆæ˜¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Ÿ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœEurekaServeråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šæ³¨é”€è¯¥å®ä¾‹ï¼ˆé»˜è®¤90ç§’ï¼‰ã€‚ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿæ—¶ï¼Œå¾®æœåŠ¡ä¸EurekaServerä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä»¥ä¸Šè¡Œä¸ºå¯èƒ½å˜å¾—éå¸¸å±é™©äº†â€”â€”å› ä¸ºå¾®æœåŠ¡æœ¬èº«å…¶å®æ˜¯å¥åº·çš„ï¼Œæ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚Eurekaé€šè¿‡â€œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼â€æ¥è§£å†³è¿™ä¸ªé—®é¢˜â€”â€”å½“EurekaServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶ï¼ˆå¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ä¸€æ—¦è¿›å…¥è¯¥æ¨¡å¼ï¼ŒEurekaServerå°±ä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ï¼‰ã€‚å½“ç½‘ç»œæ•…éšœæ¢å¤åï¼Œè¯¥Eureka ServerèŠ‚ç‚¹ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ åœ¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä¸­ï¼ŒEureka Serverä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†æ³¨é”€ä»»ä½•æœåŠ¡å®ä¾‹ã€‚å½“å®ƒæ”¶åˆ°çš„å¿ƒè·³æ•°é‡æ–°æ¢å¤åˆ°é˜ˆå€¼ä»¥ä¸Šæ—¶ï¼Œè¯¥Eureka ServerèŠ‚ç‚¹å°±ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚å®ƒçš„è®¾è®¡å“²å­¦å°±æ˜¯å®å¯ä¿ç•™é”™è¯¯çš„æœåŠ¡æ³¨å†Œä¿¡æ¯ï¼Œä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¯èƒ½å¥åº·çš„æœåŠ¡å®ä¾‹ã€‚ä¸€å¥è¯è®²è§£ï¼šå¥½æ­»ä¸å¦‚èµ–æ´»ç€ ç»¼ä¸Šï¼Œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼æ˜¯ä¸€ç§åº”å¯¹ç½‘ç»œå¼‚å¸¸çš„å®‰å…¨ä¿æŠ¤æªæ–½ã€‚å®ƒçš„æ¶æ„å“²å­¦æ˜¯å®å¯åŒæ—¶ä¿ç•™æ‰€æœ‰å¾®æœåŠ¡ï¼ˆå¥åº·çš„å¾®æœåŠ¡å’Œä¸å¥åº·çš„å¾®æœåŠ¡éƒ½ä¼šä¿ç•™ï¼‰ï¼Œä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¥åº·çš„å¾®æœåŠ¡ã€‚ä½¿ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œå¯ä»¥è®©Eurekaé›†ç¾¤æ›´åŠ çš„å¥å£®ã€ç¨³å®šã€‚ åœ¨Spring Cloudä¸­ï¼Œå¯ä»¥ä½¿ç”¨eureka.server.enable-self-preservation = false ç¦ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ 2.æœåŠ¡å‘ç°å¯¹äºæ³¨å†Œè¿›eurekaé‡Œé¢çš„å¾®æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡æœåŠ¡å‘ç°æ¥è·å¾—è¯¥æœåŠ¡çš„ä¿¡æ¯ 2.1 ä¿®æ”¹microservicecloud-provider-dept-8001å·¥ç¨‹çš„DeptControllerå¢åŠ å¦‚ä¸‹ä»£ç  1234567891011121314@Autowiredprivate DiscoveryClient client;@RequestMapping(value = \"/dept/discovery\", method = RequestMethod.GET)public Object discovery() { List&lt;String&gt; list = client.getServices(); System.out.println(\"**********\" + list); List&lt;ServiceInstance&gt; srvList = client.getInstances(\"MICROSERVICECLOUD-DEPT\"); for (ServiceInstance element : srvList) { System.out.println(element.getServiceId() + \"\\t\" + element.getHost() + \"\\t\" + element.getPort() + \"\\t\" + element.getUri()); } return this.client;} å¯¼åŒ…æ³¨æ„äº‹é¡¹ ï¼š//import com.netflix.discovery.DiscoveryClient;import org.springframework.cloud.client.ServiceInstance;import org.springframework.cloud.client.discovery.DiscoveryClient;è¦å¯¼å…¥springcloudçš„DiscoveryClient 2.2 DeptProvider8001_Appä¸»å¯åŠ¨ç±»12345678910@SpringBootApplication// æœ¬æœåŠ¡å¯åŠ¨åä¼šè‡ªåŠ¨æ³¨å†Œè¿› eureka æœåŠ¡ä¸­@EnableEurekaClient// æœåŠ¡å‘ç°@EnableDiscoveryClientpublic class ProviderDept8001Application { public static void main(String[] args) { SpringApplication.run(ProviderDept8001Application.class, args); }} 2.3 ä¿®æ”¹microservicecloud-consumer-dept-80å·¥ç¨‹çš„DeptController_Consumerå¢åŠ ä¸‹é¢ä»£ç  12345//æµ‹è¯•@EnableDiscoveryClient,æ¶ˆè´¹ç«¯å¯ä»¥è°ƒç”¨æœåŠ¡å‘ç°@RequestMapping(value=\"/consumer/dept/discovery\")public Object discovery() { return restTemplate.getForObject(REST_URL_PREFIX+\"/dept/discovery\", Object.class);} 2.4 æµ‹è¯•è®¿é—®URLhttp://localhost:8001/dept/discoveryhttp://localhost/consumer/dept/discovery èµ„æºè·å–å…¬ä¼—å·å›å¤ : Eurekaè‡ªæˆ‘ä¿æŠ¤å’ŒæœåŠ¡å‘ç° è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/25/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/03.2%20Eureka%E8%87%AA%E6%88%91%E4%BF%9D%E6%8A%A4%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/"},{"title":"03.4 Eurekaå’ŒZookeeperå¯¹æ¯”","text":"1. CAPCAPç†è®ºçš„æ ¸å¿ƒæ˜¯ï¼šä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶å¾ˆå¥½çš„æ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ï¼Œæœ€å¤šåªèƒ½åŒæ—¶è¾ƒå¥½çš„æ»¡è¶³ä¸¤ä¸ªã€‚å› æ­¤ï¼Œæ ¹æ® CAP åŸç†å°† NoSQL æ•°æ®åº“åˆ†æˆäº†æ»¡è¶³ CA åŸåˆ™ã€æ»¡è¶³ CP åŸåˆ™å’Œæ»¡è¶³ AP åŸåˆ™ä¸‰å¤§ç±»ï¼š CA - å•ç‚¹é›†ç¾¤ï¼Œæ»¡è¶³ä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸åœ¨å¯æ‰©å±•æ€§ä¸Šä¸å¤ªå¼ºå¤§ã€‚ CP - æ»¡è¶³ä¸€è‡´æ€§ï¼Œåˆ†åŒºå®¹å¿å¿…çš„ç³»ç»Ÿï¼Œé€šå¸¸æ€§èƒ½ä¸æ˜¯ç‰¹åˆ«é«˜ã€‚ AP - æ»¡è¶³å¯ç”¨æ€§ï¼Œåˆ†åŒºå®¹å¿æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸å¯èƒ½å¯¹ä¸€è‡´æ€§è¦æ±‚ä½ä¸€äº›ã€‚ 2. Eureka VS ZookeeperäºŒè€…éƒ½ä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ŒEurekaæ¯”Zookeeperå¥½åœ¨å“ªé‡Œ?è‘—åçš„CAPç†è®ºæŒ‡å‡ºï¼Œä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³C(ä¸€è‡´æ€§)ã€A(å¯ç”¨æ€§)å’ŒP(åˆ†åŒºå®¹é”™æ€§)ã€‚ç”±äºåˆ†åŒºå®¹é”™æ€§Påœ¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¿…é¡»è¦ä¿è¯çš„ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½åœ¨Aå’ŒCä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚ 2.1 Zookeeperä¿è¯CPå½“å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡åˆ—è¡¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿æ³¨å†Œä¸­å¿ƒè¿”å›çš„æ˜¯å‡ åˆ†é’Ÿä»¥å‰çš„æ³¨å†Œä¿¡æ¯ï¼Œä½†ä¸èƒ½æ¥å—æœåŠ¡ç›´æ¥downæ‰ä¸å¯ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡æ³¨å†ŒåŠŸèƒ½å¯¹å¯ç”¨æ€§çš„è¦æ±‚è¦é«˜äºä¸€è‡´æ€§ã€‚ä½†æ˜¯zkä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼Œå½“masterèŠ‚ç‚¹å› ä¸ºç½‘ç»œæ•…éšœä¸å…¶ä»–èŠ‚ç‚¹å¤±å»è”ç³»æ—¶ï¼Œå‰©ä½™èŠ‚ç‚¹ä¼šé‡æ–°è¿›è¡Œleaderé€‰ä¸¾ã€‚é—®é¢˜åœ¨äºï¼Œé€‰ä¸¾leaderçš„æ—¶é—´å¤ªé•¿ï¼Œ30 ~ 120s, ä¸”é€‰ä¸¾æœŸé—´æ•´ä¸ªzké›†ç¾¤éƒ½æ˜¯ä¸å¯ç”¨çš„ï¼Œè¿™å°±å¯¼è‡´åœ¨é€‰ä¸¾æœŸé—´æ³¨å†ŒæœåŠ¡ç˜«ç—ªã€‚åœ¨äº‘éƒ¨ç½²çš„ç¯å¢ƒä¸‹ï¼Œå› ç½‘ç»œé—®é¢˜ä½¿å¾—zké›†ç¾¤å¤±å»masterèŠ‚ç‚¹æ˜¯è¾ƒå¤§æ¦‚ç‡ä¼šå‘ç”Ÿçš„äº‹ï¼Œè™½ç„¶æœåŠ¡èƒ½å¤Ÿæœ€ç»ˆæ¢å¤ï¼Œä½†æ˜¯æ¼«é•¿çš„é€‰ä¸¾æ—¶é—´å¯¼è‡´çš„æ³¨å†Œé•¿æœŸä¸å¯ç”¨æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚ 2.2 Eurekaä¿è¯APEurekaçœ‹æ˜ç™½äº†è¿™ä¸€ç‚¹ï¼Œå› æ­¤åœ¨è®¾è®¡æ—¶å°±ä¼˜å…ˆä¿è¯å¯ç”¨æ€§ã€‚ Eurekaå„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ ï¼Œå‡ ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¸ä¼šå½±å“æ­£å¸¸èŠ‚ç‚¹çš„å·¥ä½œï¼Œå‰©ä½™çš„èŠ‚ç‚¹ä¾ç„¶å¯ä»¥æä¾›æ³¨å†Œå’ŒæŸ¥è¯¢æœåŠ¡ã€‚è€ŒEurekaçš„å®¢æˆ·ç«¯åœ¨å‘æŸä¸ªEurekaæ³¨å†Œæˆ–æ—¶å¦‚æœå‘ç°è¿æ¥å¤±è´¥ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ‡æ¢è‡³å…¶å®ƒèŠ‚ç‚¹ï¼Œåªè¦æœ‰ä¸€å°Eurekaè¿˜åœ¨ï¼Œå°±èƒ½ä¿è¯æ³¨å†ŒæœåŠ¡å¯ç”¨(ä¿è¯å¯ç”¨æ€§)ï¼Œåªä¸è¿‡æŸ¥åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„(ä¸ä¿è¯å¼ºä¸€è‡´æ€§)ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒEurekaè¿˜æœ‰ä¸€ç§è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œå¦‚æœåœ¨15åˆ†é’Ÿå†…è¶…è¿‡85%çš„èŠ‚ç‚¹éƒ½æ²¡æœ‰æ­£å¸¸çš„å¿ƒè·³ï¼Œé‚£ä¹ˆEurekaå°±è®¤ä¸ºå®¢æˆ·ç«¯ä¸æ³¨å†Œä¸­å¿ƒå‡ºç°äº†ç½‘ç»œæ•…éšœï¼Œæ­¤æ—¶ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š Eurekaä¸å†ä»æ³¨å†Œåˆ—è¡¨ä¸­ç§»é™¤å› ä¸ºé•¿æ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³è€Œåº”è¯¥è¿‡æœŸçš„æœåŠ¡ Eurekaä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Š(å³ä¿è¯å½“å‰èŠ‚ç‚¹ä¾ç„¶å¯ç”¨) å½“ç½‘ç»œç¨³å®šæ—¶ï¼Œå½“å‰å®ä¾‹æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸­ å› æ­¤ï¼Œ Eurekaå¯ä»¥å¾ˆå¥½çš„åº”å¯¹å› ç½‘ç»œæ•…éšœå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹å¤±å»è”ç³»çš„æƒ…å†µï¼Œè€Œä¸ä¼šåƒzookeeperé‚£æ ·ä½¿æ•´ä¸ªæ³¨å†ŒæœåŠ¡ç˜«ç—ªã€‚ èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/27/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/03.4%20Eureka%E5%92%8CZookeeper%E5%AF%B9%E6%AF%94/"},{"title":"04.1 Ribbonç®€ä»‹","text":"1. ç®€ä»‹Spring Cloud Ribbonæ˜¯åŸºäºNetflix Ribbonå®ç°çš„ä¸€å¥—å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„å·¥å…·ã€‚ ç®€å•çš„è¯´ï¼ŒRibbonæ˜¯Netflixå‘å¸ƒçš„å¼€æºé¡¹ç›®ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æä¾›å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå°†Netflixçš„ä¸­é—´å±‚æœåŠ¡è¿æ¥åœ¨ä¸€èµ·ã€‚Ribbonå®¢æˆ·ç«¯ç»„ä»¶æä¾›ä¸€ç³»åˆ—å®Œå–„çš„é…ç½®é¡¹å¦‚è¿æ¥è¶…æ—¶ï¼Œé‡è¯•ç­‰ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ—å‡ºLoad Balancerï¼ˆç®€ç§°LBï¼‰åé¢æ‰€æœ‰çš„æœºå™¨ï¼ŒRibbonä¼šè‡ªåŠ¨çš„å¸®åŠ©ä½ åŸºäºæŸç§è§„åˆ™ï¼ˆå¦‚ç®€å•è½®è¯¢ï¼Œéšæœºè¿æ¥ç­‰ï¼‰å»è¿æ¥è¿™äº›æœºå™¨ã€‚æˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“ä½¿ç”¨Ribbonå®ç°è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚ 2. è´Ÿè½½å‡è¡¡è´Ÿè½½å‡è¡¡(Load Balance)ï¼Œåœ¨å¾®æœåŠ¡æˆ–åˆ†å¸ƒå¼é›†ç¾¤ä¸­ç»å¸¸ç”¨çš„ä¸€ç§åº”ç”¨ã€‚è´Ÿè½½å‡è¡¡ç®€å•çš„è¯´å°±æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¹³æ‘Šçš„åˆ†é…åˆ°å¤šä¸ªæœåŠ¡ä¸Šï¼Œä»è€Œè¾¾åˆ°ç³»ç»Ÿçš„HAã€‚å¸¸è§çš„è´Ÿè½½å‡è¡¡æœ‰è½¯ä»¶Nginxï¼ŒLVSï¼Œç¡¬ä»¶ F5ç­‰ã€‚ç›¸åº”çš„åœ¨ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ï¼šdubboå’ŒSpringCloudä¸­å‡ç»™æˆ‘ä»¬æä¾›äº†è´Ÿè½½å‡è¡¡ï¼Œ SpringCloudçš„è´Ÿè½½å‡è¡¡ç®—æ³•å¯ä»¥è‡ªå®šä¹‰ã€‚ å¸¸è§ä¸¤ç§å½¢å¼: é›†ä¸­å¼LB å³åœ¨æœåŠ¡çš„æ¶ˆè´¹æ–¹å’Œæä¾›æ–¹ä¹‹é—´ä½¿ç”¨ç‹¬ç«‹çš„LBè®¾æ–½(å¯ä»¥æ˜¯ç¡¬ä»¶ï¼Œå¦‚F5, ä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶ï¼Œå¦‚nginx), ç”±è¯¥è®¾æ–½è´Ÿè´£æŠŠè®¿é—®è¯·æ±‚é€šè¿‡æŸç§ç­–ç•¥è½¬å‘è‡³æœåŠ¡çš„æä¾›æ–¹ï¼› è¿›ç¨‹å†…LB å°†LBé€»è¾‘é›†æˆåˆ°æ¶ˆè´¹æ–¹ï¼Œæ¶ˆè´¹æ–¹ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·çŸ¥æœ‰å“ªäº›åœ°å€å¯ç”¨ï¼Œç„¶åè‡ªå·±å†ä»è¿™äº›åœ°å€ä¸­é€‰æ‹©å‡ºä¸€ä¸ªåˆé€‚çš„æœåŠ¡å™¨ã€‚ Ribbonå°±å±äºè¿›ç¨‹å†…LBï¼Œå®ƒåªæ˜¯ä¸€ä¸ªç±»åº“ï¼Œé›†æˆäºæ¶ˆè´¹æ–¹è¿›ç¨‹ï¼Œæ¶ˆè´¹æ–¹é€šè¿‡å®ƒæ¥è·å–åˆ°æœåŠ¡æä¾›æ–¹çš„åœ°å€ã€‚ 3. å®˜ç½‘ä»‹ç»https://github.com/Netflix/ribbon/wiki/Getting-Started èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/28/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/04.1%20Ribbon%E7%AE%80%E4%BB%8B/"},{"title":"03.3 Eurekaé›†ç¾¤å®æˆ˜","text":"Eurekaé›†ç¾¤å®æˆ˜è®°å½• 1. Eurekaé›†ç¾¤åŸç† ä¸Šå›¾æ˜¯æ¥è‡ªeurekaçš„å®˜æ–¹æ¶æ„å›¾ åŸºäºé›†ç¾¤é…ç½®çš„eureka å¤„äºä¸åŒèŠ‚ç‚¹çš„eurekaé€šè¿‡Replicateè¿›è¡Œæ•°æ®åŒæ­¥ Application Serviceä¸ºæœåŠ¡æä¾›è€… Application Clientä¸ºæœåŠ¡æ¶ˆè´¹è€… Make Remote Callå®Œæˆä¸€æ¬¡æœåŠ¡è°ƒç”¨ æœåŠ¡å¯åŠ¨åå‘Eurekaæ³¨å†Œï¼ŒEureka Serverä¼šå°†æ³¨å†Œä¿¡æ¯å‘å…¶ä»–Eureka Serverè¿›è¡ŒåŒæ­¥ï¼Œå½“æœåŠ¡æ¶ˆè´¹è€…è¦è°ƒç”¨æœåŠ¡æä¾›è€…ï¼Œåˆ™å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡æä¾›è€…åœ°å€ï¼Œç„¶åä¼šå°†æœåŠ¡æä¾›è€…åœ°å€ç¼“å­˜åœ¨æœ¬åœ°ï¼Œä¸‹æ¬¡å†è°ƒç”¨æ—¶ï¼Œåˆ™ç›´æ¥ä»æœ¬åœ°ç¼“å­˜ä¸­å–ï¼Œå®Œæˆä¸€æ¬¡è°ƒç”¨ã€‚å½“æœåŠ¡æ³¨å†Œä¸­å¿ƒEureka Serveræ£€æµ‹åˆ°æœåŠ¡æä¾›è€…å› ä¸ºå®•æœºã€ç½‘ç»œåŸå› ä¸å¯ç”¨æ—¶ï¼Œåˆ™åœ¨æœåŠ¡æ³¨å†Œä¸­å¿ƒå°†æœåŠ¡ç½®ä¸ºDOWNçŠ¶æ€ï¼Œå¹¶æŠŠå½“å‰æœåŠ¡æä¾›è€…çŠ¶æ€å‘è®¢é˜…è€…å‘å¸ƒï¼Œè®¢é˜…è¿‡çš„æœåŠ¡æ¶ˆè´¹è€…æ›´æ–°æœ¬åœ°ç¼“å­˜ã€‚æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨åï¼Œå‘¨æœŸæ€§ï¼ˆé»˜è®¤30ç§’ï¼‰å‘Eureka Serverå‘é€å¿ƒè·³ï¼Œä»¥è¯æ˜å½“å‰æœåŠ¡æ˜¯å¯ç”¨çŠ¶æ€ã€‚Eureka Serveråœ¨ä¸€å®šçš„æ—¶é—´ï¼ˆé»˜è®¤90ç§’ï¼‰æœªæ”¶åˆ°å®¢æˆ·ç«¯çš„å¿ƒè·³ï¼Œåˆ™è®¤ä¸ºæœåŠ¡å®•æœºï¼Œæ³¨é”€è¯¥å®ä¾‹ã€‚ 2. ä¿®æ”¹hostsæ–‡ä»¶ä¸ºäº†æ–¹ä¾¿åˆ†è¾¨ä¸åŒçš„ç»“ç‚¹,åœ¨hostæ–‡ä»¶ä¸­å®šä¹‰ä¸åŒçš„åŸŸåæ¥è¡¨ç¤º,å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹hostsæ–‡ä»¶,ä½†æ˜¯å¹¶ä¸æ¨è.æ¨èä½¿ç”¨SwitchHostså·¥å…·(æ„Ÿå…´è¶£çš„æœ‹å‹è¿™é‡Œä¸‹è½½:https://u20964900.pipipan.com/dir/20964900-35317200-59ca11)hostsæ–‡ä»¶ä¸­å¢åŠ : 1234#å°šç¡…è°·springcloudæ•™ç¨‹127.0.0.1 eureka7001.com127.0.0.1 eureka7002.com127.0.0.1 eureka7003.com 3. ç»„æˆé›†ç¾¤3.1 æ–°å»ºå·¥ç¨‹æ–°å»ºmicroservicecloud-eureka-7002å’Œmicroservicecloud-eureka-7003,ä¹Ÿå¯ä»¥ç›´æ¥å¤åˆ¶7001å·¥ç¨‹. 3.2 çˆ¶å·¥ç¨‹pom.xmlå¢åŠ å¦‚ä¸‹å†…å®¹: 12&lt;module&gt;microservicecloud-eureka-7002&lt;/module&gt;&lt;module&gt;microservicecloud-eureka-7003&lt;/module&gt; 3.3 ä¸‰ä¸ªå­å·¥ç¨‹çš„ymlé…ç½®ä¿®æ”¹:123456789101112131415server: port: 7001eureka: instance: # eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° hostname: eureka7001.com client: # #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ fetch-registry: false service-url: # #è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ #defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ defaultZone: http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ 123456789101112131415server: port: 7002eureka: instance: # eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° hostname: eureka7002.com client: # #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ fetch-registry: false service-url: # #è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ # defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7003.com:7003/eureka/ 123456789101112131415server: port: 7003eureka: instance: # eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° hostname: eureka7003.com client: # #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ fetch-registry: false service-url: # #è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ # defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ 4. ä¿®æ”¹provider ymlæ–‡ä»¶é…ç½®ç”±åŸæ¥çš„å•èŠ‚ç‚¹ä¿®æ”¹ä¸ºé›†ç¾¤æ¨¡å¼ 1234567891011eureka: client: # å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: # defaultZone: http://localhost:7001/eureka defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ instance: # è‡ªå®šä¹‰æœåŠ¡åç§°ä¿¡æ¯ instance-id: microservicecloud-dept8001 # è®¿é—®è·¯å¾„å¯ä»¥æ˜¾ç¤ºIPåœ°å€ prefer-ip-address: true 5. éªŒè¯åˆ†åˆ«å¯åŠ¨eureka7001/7002/7003,ç„¶åå¯åŠ¨provider8001ä¸‹å›¾è¡¨ç¤ºé›†ç¾¤å¯åŠ¨æˆåŠŸ,å¹¶ä¸”æˆåŠŸæ³¨å†Œä¸Šprovider8001æœåŠ¡ èµ„æºè·å–å…¬ä¼—å·å›å¤ : Eurekaé›†ç¾¤å®æˆ˜ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/26/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/03.3%20Eureka%E9%9B%86%E7%BE%A4%E5%AE%9E%E6%88%98/"},{"title":"05.Feignè´Ÿè½½å‡è¡¡","text":"1. Feignç®€ä»‹Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼WebServiceå®¢æˆ·ç«¯ã€‚ä½¿ç”¨Feignèƒ½è®©ç¼–å†™Web Serviceå®¢æˆ·ç«¯æ›´åŠ ç®€å•, å®ƒçš„ä½¿ç”¨æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç„¶ååœ¨ä¸Šé¢æ·»åŠ æ³¨è§£ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒJAX-RSæ ‡å‡†çš„æ³¨è§£ã€‚Feignä¹Ÿæ”¯æŒå¯æ‹”æ’å¼çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚Spring Cloudå¯¹Feignè¿›è¡Œäº†å°è£…ï¼Œä½¿å…¶æ”¯æŒäº†Spring MVCæ ‡å‡†æ³¨è§£å’ŒHttpMessageConvertersã€‚Feignå¯ä»¥ä¸Eurekaå’ŒRibbonç»„åˆä½¿ç”¨ä»¥æ”¯æŒè´Ÿè½½å‡è¡¡ã€‚ Feignæ—¨åœ¨ä½¿ç¼–å†™Java Httpå®¢æˆ·ç«¯å˜å¾—æ›´å®¹æ˜“ã€‚å‰é¢åœ¨ä½¿ç”¨Ribbon+RestTemplateæ—¶ï¼Œåˆ©ç”¨RestTemplateå¯¹httpè¯·æ±‚çš„å°è£…å¤„ç†ï¼Œå½¢æˆäº†ä¸€å¥—æ¨¡ç‰ˆåŒ–çš„è°ƒç”¨æ–¹æ³•ã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”±äºå¯¹æœåŠ¡ä¾èµ–çš„è°ƒç”¨å¯èƒ½ä¸æ­¢ä¸€å¤„ï¼Œ å¾€å¾€ä¸€ä¸ªæ¥å£ä¼šè¢«å¤šå¤„è°ƒç”¨ï¼Œæ‰€ä»¥é€šå¸¸éƒ½ä¼šé’ˆå¯¹æ¯ä¸ªå¾®æœåŠ¡è‡ªè¡Œå°è£…ä¸€äº›å®¢æˆ·ç«¯ç±»æ¥åŒ…è£…è¿™äº›ä¾èµ–æœåŠ¡çš„è°ƒç”¨ã€‚ æ‰€ä»¥ï¼ŒFeignåœ¨æ­¤åŸºç¡€ä¸Šåšäº†è¿›ä¸€æ­¥å°è£…ï¼Œç”±ä»–æ¥å¸®åŠ©æˆ‘ä»¬å®šä¹‰å’Œå®ç°ä¾èµ–æœåŠ¡æ¥å£çš„å®šä¹‰ã€‚åœ¨Feignçš„å®ç°ä¸‹ï¼Œ æˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥é…ç½®å®ƒ(ä»¥å‰æ˜¯Daoæ¥å£ä¸Šé¢æ ‡æ³¨Mapperæ³¨è§£,ç°åœ¨æ˜¯ä¸€ä¸ªå¾®æœåŠ¡æ¥å£ä¸Šé¢æ ‡æ³¨ä¸€ä¸ªFeignæ³¨è§£å³å¯) ï¼Œå³å¯å®Œæˆå¯¹æœåŠ¡æä¾›æ–¹çš„æ¥å£ç»‘å®šï¼Œç®€åŒ–äº†ä½¿ç”¨Spring cloud Ribbonæ—¶ï¼Œè‡ªåŠ¨å°è£…æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯çš„å¼€å‘é‡ã€‚ Feigné›†æˆäº†Ribbonåˆ©ç”¨Ribbonç»´æŠ¤äº†MicroServiceCloud-Deptçš„æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡è½®è¯¢å®ç°äº†å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ã€‚è€Œä¸Ribbonä¸åŒçš„æ˜¯ï¼Œ é€šè¿‡feignåªéœ€è¦å®šä¹‰æœåŠ¡ç»‘å®šæ¥å£ä¸”ä»¥å£°æ˜å¼çš„æ–¹æ³• ï¼Œä¼˜é›…è€Œç®€å•çš„å®ç°äº†æœåŠ¡è°ƒç”¨ 2. å®æˆ˜2.1 ä¿®æ”¹microservicecloud-apiå·¥ç¨‹pomä¸­å¢åŠ feigné…ç½® 12345&lt;!--Feignç›¸å…³--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt;&lt;/dependency&gt; æ–°å»ºserviceåŒ…,å¹¶æ–°å»ºDeptClientService 1234567891011@FeignClient(value = \"MICROSERVICECLOUD-DEPT\")public interface DeptClientService { @RequestMapping(value = \"/dept/get/{id}\", method = RequestMethod.GET) public Dept get(@PathVariable(\"id\") long id); @RequestMapping(value = \"/dept/list\", method = RequestMethod.GET) public List&lt;Dept&gt; list(); @RequestMapping(value = \"/dept/add\", method = RequestMethod.POST) public boolean add(Dept dept);} æœ€åè¦é‡æ–°ç¼–è¯‘æ‰“åŒ…æ­¤æ¨¡å— 1mvn clean &amp;&amp; mvn install 2.2 æ–°å»ºå·¥ç¨‹é€šè¿‡å¤åˆ¶consumer-dept-80å·¥ç¨‹,æ–°å»ºmicroservicecloud-consumer-dept-feign 2.3 pom.xmlé…ç½®å¢åŠ feigné…ç½® 12345&lt;!--Feignç›¸å…³--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt;&lt;/dependency&gt; 2.4 controllerè°ƒç”¨service1234567891011121314151617@RestControllerpublic class DeptController_Feign { @Autowired private DeptClientService service; @RequestMapping(value = \"/consumer/dept/get/{id}\") public Dept get(@PathVariable(\"id\") Long id) { return this.service.get(id); } @RequestMapping(value = \"/consumer/dept/list\") public List&lt;Dept&gt; list() { return this.service.list(); } @RequestMapping(value = \"/consumer/dept/add\") public Object add(Dept dept) { return this.service.add(dept); }} 2.5 ä¿®æ”¹ä¸»å¯åŠ¨ç±»12345678@SpringBootApplication@EnableEurekaClient@EnableFeignClients(basePackages= {\"com.hellodev\"})public class ConsumerDeptFeignApplication { public static void main(String[] args) { SpringApplication.run(ConsumerDeptFeignApplication.class, args); }} 2.6 éªŒè¯é¦–å…ˆå¯åŠ¨Eurekaé›†ç¾¤,é›†ç¾¤å¯åŠ¨æˆåŠŸåå†å¯åŠ¨ä¸‰ä¸ªproviderå·¥ç¨‹ æœ€åå¯åŠ¨consumerå·¥ç¨‹,å¹¶è®¿é—®æ¥å£éªŒè¯ èµ„æºè·å–å…¬ä¼—å·å›å¤ : Feignè´Ÿè½½å‡è¡¡ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/31/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/05.Feign%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"},{"title":"03.1 Eurekaå•æœºå®æˆ˜","text":"Eurekaå•æœºç‰ˆå®æˆ˜è®°å½• 1. Eureka æœåŠ¡ç«¯1.1 microservicecloud-eureka-70011.1.1 åˆ›å»ºModule 1.1.2 çˆ¶å·¥ç¨‹å¢åŠ æ¨¡å—ä¿¡æ¯123&lt;modules&gt; &lt;module&gt;microservicecloud-eureka-7001&lt;/module&gt;&lt;/modules&gt; 1.1.3 pomæ–‡ä»¶12345678910111213141516171819202122232425262728&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-eureka-7001&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;!--eureka-serveræœåŠ¡ç«¯ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 1.1.4 ymlæ–‡ä»¶1234567891011121314server: port: 7001eureka: instance: # eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° hostname: localhost client: # #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œæˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ fetch-registry: false service-url: # #è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 1.1.5 Applicationå¯åŠ¨ç±»å¼€å¯é…ç½®12345678@SpringBootApplication// EurekaServeræœåŠ¡å™¨ç«¯å¯åŠ¨ç±»,æ¥å—å…¶å®ƒå¾®æœåŠ¡æ³¨å†Œè¿›æ¥@EnableEurekaServerpublic class Eureka7001Application { public static void main(String[] args) { SpringApplication.run(Eureka7001Application.class, args); }} 1.1.6 å¯åŠ¨éªŒè¯è®¿é—® : http://localhost:7001 2. Eureka å®¢æˆ·ç«¯2.1 ä¿®æ”¹microservicecloud-provider-dept-8001pom.xmlä¸­å¢åŠ eurekaå®¢æˆ·ç«¯é…ç½® 123456789&lt;!-- å°†å¾®æœåŠ¡providerä¾§æ³¨å†Œè¿› eureka --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;&lt;/dependency&gt; 2.2 ymlä¿®æ”¹å¢åŠ eurekaé…ç½® 12345eureka: client: #å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: defaultZone: http://localhost:7001/eureka 2.3 Applicationå¯åŠ¨ç±»å¼€å¯é…ç½®12345678@SpringBootApplication// æœ¬æœåŠ¡å¯åŠ¨åä¼šè‡ªåŠ¨æ³¨å†Œè¿› eureka æœåŠ¡ä¸­@EnableEurekaClientpublic class ProviderDept8001Application { public static void main(String[] args) { SpringApplication.run(ProviderDept8001Application.class, args); }} 2.4 éªŒè¯å…ˆå¯åŠ¨microservicecloud-eureka-7001,ç„¶åå†å¯åŠ¨microservicecloud-provider-dept-8001,ç•Œé¢å‡ºç°providerçš„æœåŠ¡å³æˆåŠŸ. 3. actuatorä¸æ³¨å†Œå¾®æœåŠ¡ä¿¡æ¯å®Œå–„3.1 ä¸»æœºåç§°:æœåŠ¡åç§°ä¿®æ”¹å½“å‰é—®é¢˜: æ˜¾ç¤ºçš„æ˜¯ipåœ°å€,å¯è¯»æ€§å·®,äº¤æµä¸æ–¹ä¾¿ ä¿®æ”¹microservicecloud-provider-dept-8001çš„ymlé…ç½®æ–‡ä»¶ 12345678eureka: client: # å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: defaultZone: http://localhost:7001/eureka instance: # è‡ªå®šä¹‰æœåŠ¡åç§°ä¿¡æ¯ instance-id: microservicecloud-dept8001 ä¿®æ”¹ä¹‹å 3.2 è®¿é—®ä¿¡æ¯æœ‰IPä¿¡æ¯æç¤ºå½“å‰é—®é¢˜: é¼ æ ‡æ”¾åœ¨æœåŠ¡åç§°ä¸Š,åº•éƒ¨æ²¡æœ‰IPæç¤º ä¿®æ”¹microservicecloud-provider-dept-8001çš„ymlé…ç½®æ–‡ä»¶ 12345678910eureka: client: # å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: defaultZone: http://localhost:7001/eureka instance: # è‡ªå®šä¹‰æœåŠ¡åç§°ä¿¡æ¯ instance-id: microservicecloud-dept8001 # è®¿é—®è·¯å¾„å¯ä»¥æ˜¾ç¤ºIPåœ°å€ prefer-ip-address: true ä¿®æ”¹ä¹‹å 3.3 å¾®æœåŠ¡infoå†…å®¹è¯¦ç»†ä¿¡æ¯å½“å‰é—®é¢˜ : è¶…é“¾æ¥ç‚¹å‡»æœåŠ¡æŠ¥å‘ŠErrorPage ä¿®æ”¹microservicecloud-provider-dept-8001 POM 12345&lt;!-- actuatorç›‘æ§ä¿¡æ¯å®Œå–„ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; æ€»çš„çˆ¶å·¥ç¨‹microservicecloudä¿®æ”¹pom.xmlæ·»åŠ æ„å»ºbuildä¿¡æ¯ 1234567891011121314151617181920&lt;build&gt; &lt;finalName&gt;microservicecloud&lt;/finalName&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;delimiters&gt; &lt;delimit&gt;$&lt;/delimit&gt; &lt;/delimiters&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; ä¿®æ”¹microservicecloud-provider-dept-8001 YMl 123456# å¾®æœåŠ¡ä¿¡æ¯æè¿°info: app.name: atguigu-microservicecloud company.name: www.atguigu.com build.artifactId: ${project.artifactId} build.version: ${project.version} ä¿®æ”¹ä¹‹å èµ„æºè·å–å…¬ä¼—å·å›å¤ : Eurekaå•æœºå®æˆ˜ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/24/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/03.1%20Eureka%E5%8D%95%E6%9C%BA%E5%AE%9E%E6%88%98/"},{"title":"06.0 Hystrixç®€ä»‹","text":"1. åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜å¤æ‚åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¸­çš„åº”ç”¨ç¨‹åºæœ‰æ•°åä¸ªä¾èµ–å…³ç³»ï¼Œæ¯ä¸ªä¾èµ–å…³ç³»åœ¨æŸäº›æ—¶å€™å°†ä¸å¯é¿å…åœ°å¤±è´¥ã€‚ æœåŠ¡é›ªå´©å¤šä¸ªå¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„æ—¶å€™ï¼Œå‡è®¾å¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cï¼Œå¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cåˆè°ƒç”¨å…¶å®ƒçš„å¾®æœåŠ¡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ â€œæ‰‡å‡ºâ€ ã€‚å¦‚æœæ‰‡å‡ºçš„é“¾è·¯ä¸ŠæŸä¸ªå¾®æœåŠ¡çš„è°ƒç”¨å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…ä¸å¯ç”¨ï¼Œå¯¹å¾®æœåŠ¡Açš„è°ƒç”¨å°±ä¼šå ç”¨è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿèµ„æºï¼Œè¿›è€Œå¼•èµ·ç³»ç»Ÿå´©æºƒï¼Œæ‰€è°“çš„â€œé›ªå´©æ•ˆåº”â€. å¯¹äºé«˜æµé‡çš„åº”ç”¨æ¥è¯´ï¼Œå•ä¸€çš„åç«¯ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰èµ„æºéƒ½åœ¨å‡ ç§’é’Ÿå†…é¥±å’Œã€‚æ¯”å¤±è´¥æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™äº›åº”ç”¨ç¨‹åºè¿˜å¯èƒ½å¯¼è‡´æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿå¢åŠ ï¼Œå¤‡ä»½é˜Ÿåˆ—ï¼Œçº¿ç¨‹å’Œå…¶ä»–ç³»ç»Ÿèµ„æºç´§å¼ ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå‘ç”Ÿæ›´å¤šçš„çº§è”æ•…éšœã€‚è¿™äº›éƒ½è¡¨ç¤ºéœ€è¦å¯¹æ•…éšœå’Œå»¶è¿Ÿè¿›è¡Œéš”ç¦»å’Œç®¡ç†ï¼Œä»¥ä¾¿å•ä¸ªä¾èµ–å…³ç³»çš„å¤±è´¥ï¼Œä¸èƒ½å–æ¶ˆæ•´ä¸ªåº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿã€‚ ä¸€èˆ¬æƒ…å†µå¯¹äºæœåŠ¡ä¾èµ–çš„ä¿æŠ¤ä¸»è¦æœ‰3ä¸­è§£å†³æ–¹æ¡ˆï¼š ç†”æ–­æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼ä¸»è¦æ˜¯å‚è€ƒç”µè·¯ç†”æ–­ï¼Œå¦‚æœä¸€æ¡çº¿è·¯ç”µå‹è¿‡é«˜ï¼Œä¿é™©ä¸ä¼šç†”æ–­ï¼Œé˜²æ­¢ç«ç¾ã€‚æ”¾åˆ°æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœæŸä¸ªç›®æ ‡æœåŠ¡è°ƒç”¨æ…¢æˆ–è€…æœ‰å¤§é‡è¶…æ—¶ï¼Œæ­¤æ—¶ï¼Œç†”æ–­è¯¥æœåŠ¡çš„è°ƒç”¨ï¼Œå¯¹äºåç»­è°ƒç”¨è¯·æ±‚ï¼Œä¸åœ¨ç»§ç»­è°ƒç”¨ç›®æ ‡æœåŠ¡ï¼Œç›´æ¥è¿”å›ï¼Œå¿«é€Ÿé‡Šæ”¾èµ„æºã€‚å¦‚æœç›®æ ‡æœåŠ¡æƒ…å†µå¥½è½¬åˆ™æ¢å¤è°ƒç”¨ã€‚ éš”ç¦»æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼å°±åƒå¯¹ç³»ç»Ÿè¯·æ±‚æŒ‰ç±»å‹åˆ’åˆ†æˆä¸€ä¸ªä¸ªå°å²›çš„ä¸€æ ·ï¼Œå½“æŸä¸ªå°å²›è¢«ç«å°‘å…‰äº†ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„å°å²›ã€‚ä¾‹å¦‚å¯ä»¥å¯¹ä¸åŒç±»å‹çš„è¯·æ±‚ä½¿ç”¨çº¿ç¨‹æ± æ¥èµ„æºéš”ç¦»ï¼Œæ¯ç§ç±»å‹çš„è¯·æ±‚äº’ä¸å½±å“ï¼Œå¦‚æœä¸€ç§ç±»å‹çš„è¯·æ±‚çº¿ç¨‹èµ„æºè€—å°½ï¼Œåˆ™å¯¹åç»­çš„è¯¥ç±»å‹è¯·æ±‚ç›´æ¥è¿”å›ï¼Œä¸å†è°ƒç”¨åç»­èµ„æºã€‚è¿™ç§æ¨¡å¼ä½¿ç”¨åœºæ™¯éå¸¸å¤šï¼Œä¾‹å¦‚å°†ä¸€ä¸ªæœåŠ¡æ‹†å¼€ï¼Œå¯¹äºé‡è¦çš„æœåŠ¡ä½¿ç”¨å•ç‹¬æœåŠ¡å™¨æ¥éƒ¨ç½²ï¼Œå†æˆ–è€…å…¬å¸æœ€è¿‘æ¨å¹¿çš„å¤šä¸­å¿ƒã€‚ é™æµæ¨¡å¼ï¼šä¸Šè¿°çš„ç†”æ–­æ¨¡å¼å’Œéš”ç¦»æ¨¡å¼éƒ½å±äºå‡ºé”™åçš„å®¹é”™å¤„ç†æœºåˆ¶ï¼Œè€Œé™æµæ¨¡å¼åˆ™å¯ä»¥ç§°ä¸ºé¢„é˜²æ¨¡å¼ã€‚é™æµæ¨¡å¼ä¸»è¦æ˜¯æå‰å¯¹å„ä¸ªç±»å‹çš„è¯·æ±‚è®¾ç½®æœ€é«˜çš„QPSé˜ˆå€¼ï¼Œè‹¥é«˜äºè®¾ç½®çš„é˜ˆå€¼åˆ™å¯¹è¯¥è¯·æ±‚ç›´æ¥è¿”å›ï¼Œä¸å†è°ƒç”¨åç»­èµ„æºã€‚è¿™ç§æ¨¡å¼ä¸èƒ½è§£å†³æœåŠ¡ä¾èµ–çš„é—®é¢˜ï¼Œåªèƒ½è§£å†³ç³»ç»Ÿæ•´ä½“èµ„æºåˆ†é…é—®é¢˜ï¼Œå› ä¸ºæ²¡æœ‰è¢«é™æµçš„è¯·æ±‚ä¾ç„¶æœ‰å¯èƒ½é€ æˆé›ªå´©æ•ˆåº”ã€‚ 2. Hystrixç®€ä»‹Hystrixæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å»¶è¿Ÿå’Œå®¹é”™çš„å¼€æºåº“ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œè®¸å¤šä¾èµ–ä¸å¯é¿å…çš„ä¼šè°ƒç”¨å¤±è´¥ï¼Œæ¯”å¦‚è¶…æ—¶ã€å¼‚å¸¸ç­‰ï¼ŒHystrixèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªä¾èµ–å‡ºé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå¯¼è‡´æ•´ä½“æœåŠ¡å¤±è´¥ï¼Œé¿å…çº§è”æ•…éšœï¼Œä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚ â€œæ–­è·¯å™¨â€æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœä¹‹åï¼Œé€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ç†”æ–­ä¿é™©ä¸ï¼‰ï¼Œå‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”ï¼ˆFallBackï¼‰ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸ ï¼Œè¿™æ ·å°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€ä¸å¿…è¦åœ°å ç”¨ï¼Œä»è€Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚ 3. HystrixåŠŸèƒ½ æœåŠ¡é™çº§ æœåŠ¡ç†”æ–­ æœåŠ¡é™æµ æ¥è¿‘å®æ—¶çš„ç›‘æ§ ç­‰ç­‰ 3.1 æœåŠ¡é™çº§HystrixæœåŠ¡é™çº§ï¼Œå…¶å®å°±æ˜¯çº¿ç¨‹æ± ä¸­å•ä¸ªçº¿ç¨‹éšœå¤„ç†ï¼Œé˜²æ­¢å•ä¸ªçº¿ç¨‹è¯·æ±‚æ—¶é—´å¤ªé•¿ï¼Œå¯¼è‡´èµ„æºé•¿æœŸè¢«å æœ‰è€Œå¾—ä¸åˆ°é‡Šæ”¾ï¼Œä»è€Œå¯¼è‡´çº¿ç¨‹æ± è¢«å¿«é€Ÿå ç”¨å®Œï¼Œå¯¼è‡´æœåŠ¡å´©æºƒã€‚ Hystrixèƒ½è§£å†³å¦‚ä¸‹é—®é¢˜ï¼š è¯·æ±‚è¶…æ—¶é™çº§ï¼Œçº¿ç¨‹èµ„æºä¸è¶³é™çº§ï¼Œé™çº§ä¹‹åå¯ä»¥è¿”å›è‡ªå®šä¹‰æ•°æ® çº¿ç¨‹æ± éš”ç¦»é™çº§ï¼Œåˆ†å¸ƒå¼æœåŠ¡å¯ä»¥é’ˆå¯¹ä¸åŒçš„æœåŠ¡ä½¿ç”¨ä¸åŒçš„çº¿ç¨‹æ± ï¼Œä»è€Œäº’ä¸å½±å“ è‡ªåŠ¨è§¦å‘é™çº§ä¸æ¢å¤ å®ç°è¯·æ±‚ç¼“å­˜å’Œè¯·æ±‚åˆå¹¶ 3.2 æœåŠ¡ç†”æ–­ç†”æ–­æ¨¡å¼ï¼šè¿™ç§æ¨¡å¼ä¸»è¦æ˜¯å‚è€ƒç”µè·¯ç†”æ–­ï¼Œå¦‚æœä¸€æ¡çº¿è·¯ç”µå‹è¿‡é«˜ï¼Œä¿é™©ä¸ä¼šç†”æ–­ï¼Œé˜²æ­¢ç«ç¾ã€‚æ”¾åˆ°æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœæŸä¸ªç›®æ ‡æœåŠ¡è°ƒç”¨æ…¢æˆ–è€…æœ‰å¤§é‡è¶…æ—¶ï¼Œæ­¤æ—¶ï¼Œç†”æ–­è¯¥æœåŠ¡çš„è°ƒç”¨ï¼Œå¯¹äºåç»­è°ƒç”¨è¯·æ±‚ï¼Œä¸åœ¨ç»§ç»­è°ƒç”¨ç›®æ ‡æœåŠ¡ï¼Œç›´æ¥è¿”å›ï¼Œå¿«é€Ÿé‡Šæ”¾èµ„æºã€‚å¦‚æœç›®æ ‡æœåŠ¡æƒ…å†µå¥½è½¬åˆ™æ¢å¤è°ƒç”¨ã€‚ 3.3 æœåŠ¡é™æµå¤‡æ³¨ï¼šé™æµæ¨¡å¼ä¸»è¦æ˜¯æå‰å¯¹å„ä¸ªç±»å‹çš„è¯·æ±‚è®¾ç½®æœ€é«˜çš„QPSé˜ˆå€¼ï¼Œè‹¥é«˜äºè®¾ç½®çš„é˜ˆå€¼åˆ™å¯¹è¯¥è¯·æ±‚ç›´æ¥è¿”å›ï¼Œä¸å†è°ƒç”¨åç»­èµ„æºã€‚è¿™ç§æ¨¡å¼ä¸èƒ½è§£å†³æœåŠ¡ä¾èµ–çš„é—®é¢˜ï¼Œåªèƒ½è§£å†³ç³»ç»Ÿæ•´ä½“èµ„æºåˆ†é…é—®é¢˜ï¼Œå› ä¸ºæ²¡æœ‰è¢«é™æµçš„è¯·æ±‚ä¾ç„¶æœ‰å¯èƒ½é€ æˆé›ªå´©æ•ˆåº”ã€‚ èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/01/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/06.0%20Hystrix%E7%AE%80%E4%BB%8B/"},{"title":"04.2 Ribbonå®æˆ˜","text":"Ribbonå•æœºé…ç½®ä¸é›†ç¾¤å®æˆ˜ 1. ä¿®æ”¹microservicecloud-consumer-dept-80å·¥ç¨‹1.1 pomæ–‡ä»¶å¢åŠ å†…å®¹12345678910111213&lt;!-- Ribbonç›¸å…³ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;&lt;/dependency&gt; 1.2 ä¿®æ”¹application.yml è¿½åŠ eurekaçš„æœåŠ¡æ³¨å†Œåœ°å€123456eureka: client: register-with-eureka: false #å®¢æˆ·ç«¯ä¸æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: # defaultZone: http://localhost:7001/eureka defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ 1.3 RestTemplateé…ç½®å¯¹ConfigBeanè¿›è¡Œæ–°æ³¨è§£@LoadBalanced è·å¾—Restæ—¶åŠ å…¥Ribbonçš„é…ç½® 12345@Bean@LoadBalanced // è´Ÿè½½å‡è¡¡æ³¨è§£public RestTemplate getRestTemplate() { return new RestTemplate();} 1.4 ä¸»å¯åŠ¨ç±»DeptConsumer80_Appæ·»åŠ @EnableEurekaClient1234567@SpringBootApplication@EnableEurekaClientpublic class ConsumerDept80Application { public static void main(String[] args) { SpringApplication.run(ConsumerDept80Application.class, args); }} 1.5 ä¿®æ”¹DeptController_Consumerå®¢æˆ·ç«¯è®¿é—®ç±»å°†åŸæ¥ç”±urlè®¿é—®æ”¹ä¸ºé€šè¿‡å¾®æœåŠ¡åç§°è®¿é—® 12//private static final String REST_URL_PREFIX = \"http://localhost:8001\";private static final String REST_URL_PREFIX = \"http://MICROSERVICECLOUD-DEPT\"; Ribbonå’ŒEurekaæ•´åˆåConsumerå¯ä»¥ç›´æ¥è°ƒç”¨æœåŠ¡è€Œä¸ç”¨å†å…³å¿ƒåœ°å€å’Œç«¯å£å· 1.6 å•æœºéªŒè¯å…ˆå¯åŠ¨Eurekaé›†ç¾¤,ç„¶åå¯åŠ¨provider-8001æ³¨å†Œåˆ°Eurekaé›†ç¾¤ä¸­,æœ€åå¯åŠ¨consumer-80,åè®¿é—®ä¸‹é¢url 123http://localhost/consumer/dept/get/1http://localhost/consumer/dept/listhttp://localhost/consumer/dept/add?dname=å¤§æ•°æ®éƒ¨ æ­£å¸¸è¿”å›æ•°æ®,å³è¡¨æ˜consumeré…ç½®æ­£ç¡® 2. Ribboné›†ç¾¤2.1 æ¶æ„è¯´æ˜ Ribbonåœ¨å·¥ä½œæ—¶åˆ†æˆä¸¤æ­¥ ç¬¬ä¸€æ­¥å…ˆé€‰æ‹© EurekaServer ,å®ƒä¼˜å…ˆé€‰æ‹©åœ¨åŒä¸€ä¸ªåŒºåŸŸå†…è´Ÿè½½è¾ƒå°‘çš„serverã€‚ ç¬¬äºŒæ­¥å†æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ç­–ç•¥ï¼Œåœ¨ä»serverå–åˆ°çš„æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªåœ°å€ã€‚ å…¶ä¸­Ribbonæä¾›äº†å¤šç§ç­–ç•¥ï¼šæ¯”å¦‚è½®è¯¢ã€éšæœºå’Œæ ¹æ®å“åº”æ—¶é—´åŠ æƒã€‚ 2.2 æ–°å»ºå·¥ç¨‹æ ¹æ®provider-8001å·¥ç¨‹åˆ†åˆ«å¤åˆ¶å‡ºprovider-8002å’Œprovider-8003ä¸¤ä¸ªå·¥ç¨‹,ä¿®æ”¹ç›¸åº”çš„é…ç½® 2.3 æ–°å»ºæ•°æ®åº“8002æ•°æ®åº“è„šæœ¬ 123456789101112131415DROP DATABASE IF EXISTS cloudDB02; CREATE DATABASE cloudDB02 CHARACTER SET UTF8; USE cloudDB02; CREATE TABLE dept ( deptno BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT, dname VARCHAR (60), db_source VARCHAR (60) ); INSERT INTO dept(dname,db_source) VALUES ( 'å¼€å‘éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'äººäº‹éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'è´¢åŠ¡éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'å¸‚åœºéƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'è¿ç»´éƒ¨' ,DATABASE()); SELECT * FROM dept; 8003æ•°æ®åº“è„šæœ¬ 123456789101112131415DROP DATABASE IF EXISTS cloudDB03; CREATE DATABASE cloudDB03 CHARACTER SET UTF8; USE cloudDB03; CREATE TABLE dept ( deptno BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT, dname VARCHAR (60), db_source VARCHAR (60) ); INSERT INTO dept(dname,db_source) VALUES ( 'å¼€å‘éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'äººäº‹éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'è´¢åŠ¡éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'å¸‚åœºéƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'è¿ç»´éƒ¨' ,DATABASE()); SELECT * FROM dept; 2.4 ä¿®æ”¹ä¸¤ä¸ªå·¥ç¨‹çš„ymlæ–‡ä»¶8002 ymlæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334server: port: 8002mybatis: config-location: classpath:mybatis/mybatis.cfg.xml type-aliases-package: com.hellodev.entities mapper-locations: - classpath:mybatis/mapper/**/*.xmlspring: application: name: microservicecloud-dept datasource: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: org.gjt.mm.mysql.Driver url: jdbc:mysql://localhost:3306/cloudDB02 username: root password: 1234 dbcp2: min-idle: 5 initial-size: 5 max-total: 5 max-wait-millis: 200eureka: client: #å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: # defaultZone: http://localhost:7001/eureka defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ instance: instance-id: microservicecloud-dept8002 prefer-ip-address: true #è®¿é—®è·¯å¾„å¯ä»¥æ˜¾ç¤ºIPåœ°å€info: app.name: atguigu-microservicecloud company.name: www.atguigu.com build.artifactId: ${project.artifactId} build.version: ${project.version} 8003 ymlæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334server: port: 8003mybatis: config-location: classpath:mybatis/mybatis.cfg.xml type-aliases-package: com.hellodev.entities mapper-locations: - classpath:mybatis/mapper/**/*.xmlspring: application: name: microservicecloud-dept datasource: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: org.gjt.mm.mysql.Driver url: jdbc:mysql://localhost:3306/cloudDB03 username: root password: 1234 dbcp2: min-idle: 5 initial-size: 5 max-total: 5 max-wait-millis: 200eureka: client: #å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: # defaultZone: http://localhost:7001/eureka defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ instance: instance-id: microservicecloud-dept8003 prefer-ip-address: true #è®¿é—®è·¯å¾„å¯ä»¥æ˜¾ç¤ºIPåœ°å€info: app.name: atguigu-microservicecloud company.name: www.atguigu.com build.artifactId: ${project.artifactId} build.version: ${project.version} 2.5 é›†ç¾¤éªŒè¯é¦–å…ˆå¯åŠ¨Eurekaé›†ç¾¤,é›†ç¾¤å¯åŠ¨æˆåŠŸåå†å¯åŠ¨ä¸‰ä¸ªproviderå·¥ç¨‹ æœ€åå¯åŠ¨consumerå·¥ç¨‹,å¹¶è®¿é—®æ¥å£éªŒè¯ èµ„æºè·å–å…¬ä¼—å·å›å¤ : Ribbonå®æˆ˜ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/29/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/04.2%20Ribbon%E5%AE%9E%E6%88%98/"},{"title":"06.1 HystrixæœåŠ¡ç†”æ–­","text":"ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶ã€‚ å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œ è¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›â€é”™è¯¯â€çš„å“åº”ä¿¡æ¯ã€‚ å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åæ¢å¤è°ƒç”¨é“¾è·¯ã€‚åœ¨SpringCloudæ¡†æ¶é‡Œç†”æ–­æœºåˆ¶é€šè¿‡Hystrixå®ç°ã€‚Hystrixä¼šç›‘æ§å¾®æœåŠ¡é—´è°ƒç”¨çš„çŠ¶å†µï¼Œå½“å¤±è´¥çš„è°ƒç”¨åˆ°ä¸€å®šé˜ˆå€¼ï¼Œç¼ºçœæ˜¯5ç§’å†…20æ¬¡è°ƒç”¨å¤±è´¥å°±ä¼šå¯åŠ¨ç†”æ–­æœºåˆ¶ã€‚ç†”æ–­æœºåˆ¶çš„æ³¨è§£æ˜¯@HystrixCommandã€‚ 1. åˆ›å»ºå·¥ç¨‹å‚è€ƒmicroservicecloud-provider-dept-8001, æ–°å»ºmicroservicecloud-provider-dept-hystrix-8001 2. pom.xmlæ–‡ä»¶ä¸provider-dept-8001ç›¸æ¯”,pomæ–‡ä»¶ä¸­å¢åŠ äº†Hystrixé…ç½® 12345&lt;!--hystrix--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;&lt;/dependency&gt; 3. ymlæ–‡ä»¶ä¸provider-dept-8001ç›¸æ¯”,ymlä¸­ä¿®æ”¹äº†æœåŠ¡æ³¨å†Œè¿›å…¥eurekaçš„å®ä¾‹åç§° 1instance-id: microservicecloud-dept8001-hystrix 4. ä¿®æ”¹DeptControlleråœ¨ç²¾ç®€åŸæ¥ä»£ç çš„åŸºç¡€ä¸Š,å¢åŠ äº†@HystrixCommandæ³¨è§£,ä¸€æ—¦è°ƒç”¨æœåŠ¡æ–¹æ³•å¤±è´¥å¹¶æŠ›å‡ºäº†é”™è¯¯ä¿¡æ¯åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨@HystrixCommandæ ‡æ³¨å¥½çš„fallbackMethodè°ƒç”¨ç±»ä¸­çš„æŒ‡å®šæ–¹æ³•. 12345678910111213141516171819@RestControllerpublic class DeptController { @Autowired private DeptService service; @RequestMapping(value = \"/dept/get/{id}\", method = RequestMethod.GET) @HystrixCommand(fallbackMethod = \"processHystrix_Get\") public Dept get(@PathVariable(\"id\") Long id) { Dept dept = service.get(id); if (dept == null) { throw new RuntimeException(\"è¯¥ID:\" + id + \"æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯\"); } return dept; } public Dept processHystrix_Get(@PathVariable(\"id\") Long id) { return new Dept().setDeptno(id) .setDname(\"è¯¥ID:\" + id + \"æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯,null--@HystrixCommand\") .setDb_source(\"no this database in MySQL\"); }} 5. ä¸»å¯åŠ¨ç±»ä¿®æ”¹123456789101112@SpringBootApplication// æœ¬æœåŠ¡å¯åŠ¨åä¼šè‡ªåŠ¨æ³¨å†Œè¿› eureka æœåŠ¡ä¸­@EnableEurekaClient// æœåŠ¡å‘ç°@EnableDiscoveryClient// å¯¹hystrixç†”æ–­æœºåˆ¶çš„æ”¯æŒ@EnableCircuitBreakerpublic class ProviderDeptHystrix8001Application { public static void main(String[] args) { SpringApplication.run(ProviderDeptHystrix8001Application.class, args); }} 6. éªŒè¯é¦–å…ˆå¯åŠ¨Eurekaé›†ç¾¤,ç„¶åå¯åŠ¨provider-dept-hystrix-8001,ç­‰å¾…æœåŠ¡æ³¨å†Œ æœ€åå¯åŠ¨consumer-dept-8001,å¹¶è®¿é—®éªŒè¯ 123456789101112curl http://localhost/consumer/dept/get/1{ &quot;deptno&quot;: 1, &quot;dname&quot;: &quot;å¼€å‘éƒ¨&quot;, &quot;db_source&quot;: &quot;cloudDB01&quot;}curl http://localhost/consumer/dept/get/112{ &quot;deptno&quot;: 112, &quot;dname&quot;: &quot;è¯¥ID:112æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯,null--@HystrixCommand&quot;, &quot;db_source&quot;: &quot;no this database in MySQL&quot;} èµ„æºè·å–å…¬ä¼—å·å›å¤ : HystrixæœåŠ¡ç†”æ–­ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/02/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/06.1%20Hystrix%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD/"},{"title":"04.3 Ribbonæ ¸å¿ƒç»„ä»¶IRuleå’Œè‡ªå®šä¹‰è§„åˆ™","text":"1. Ribbonè´Ÿè½½å‡è¡¡ç®—æ³• RoundRobinRule è½®è¯¢ç®—æ³•,æ‰€æœ‰æ³¨å†Œä¸­å¿ƒä¸­çš„providerä¼šæŒ‰é¡ºåºè®¿é—® RandomRule éšæœºç®—æ³•,éšæœºè®¿é—®æ³¨å†Œä¸­å¿ƒä¸­çš„provider AvailabilityFilteringRule ä¼šå…ˆè¿‡æ»¤æ‰ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€çš„æœåŠ¡ï¼Œè¿˜æœ‰å¹¶å‘çš„è¿æ¥æ•°é‡è¶…è¿‡é˜ˆå€¼çš„æœåŠ¡ï¼Œç„¶åå¯¹å‰©ä½™çš„æœåŠ¡åˆ—è¡¨æŒ‰ç…§è½®è¯¢ç­–ç•¥è¿›è¡Œè®¿é—® WeightedResponseTimeRule æ ¹æ®å¹³å‡å“åº”æ—¶é—´è®¡ç®—æ‰€æœ‰æœåŠ¡çš„æƒé‡ï¼Œå“åº”æ—¶é—´è¶Šå¿«æœåŠ¡æƒé‡è¶Šå¤§è¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šé«˜ã€‚åˆšå¯åŠ¨æ—¶å¦‚æœç»Ÿè®¡ä¿¡æ¯ä¸è¶³ï¼Œåˆ™ä½¿ç”¨RoundRobinRuleç­–ç•¥ï¼Œç­‰ç»Ÿè®¡ä¿¡æ¯è¶³å¤Ÿï¼Œä¼šåˆ‡æ¢åˆ°WeightedResponseTimeRule RetryRule å…ˆæŒ‰ç…§RoundRobinRuleçš„ç­–ç•¥è·å–æœåŠ¡ï¼Œå¦‚æœè·å–æœåŠ¡å¤±è´¥åˆ™åœ¨æŒ‡å®šæ—¶é—´å†…ä¼šè¿›è¡Œé‡è¯•ï¼Œè·å–å¯ç”¨çš„æœåŠ¡ BestAvailableRule ä¼šå…ˆè¿‡æ»¤æ‰ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€çš„æœåŠ¡ï¼Œç„¶åé€‰æ‹©ä¸€ä¸ªå¹¶å‘é‡æœ€å°çš„æœåŠ¡ ZoneAvoidanceRule é»˜è®¤è§„åˆ™,å¤åˆåˆ¤æ–­serveræ‰€åœ¨åŒºåŸŸçš„æ€§èƒ½å’Œserverçš„å¯ç”¨æ€§é€‰æ‹©æœåŠ¡å™¨ 2. è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ç®—æ³•2.1 ä¿®æ”¹microservicecloud-consumer-dept-80æ–°å»ºpackage com.atguigu.myrule,å¹¶æ–°å»ºè‡ªå®šä¹‰Robbinè§„åˆ™ç±» MySelfRule å®˜æ–¹æ–‡æ¡£æ˜ç¡®ç»™å‡ºäº†è­¦å‘Šï¼šè¿™ä¸ªè‡ªå®šä¹‰é…ç½®ç±»ä¸èƒ½æ”¾åœ¨@ComponentScanæ‰€æ‰«æçš„å½“å‰åŒ…ä¸‹ä»¥åŠå­åŒ…ä¸‹ï¼Œå¦åˆ™æˆ‘ä»¬è‡ªå®šä¹‰çš„è¿™ä¸ªé…ç½®ç±»å°±ä¼šè¢«æ‰€æœ‰çš„Ribbonå®¢æˆ·ç«¯æ‰€å…±äº«ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¾¾ä¸åˆ°ç‰¹æ®ŠåŒ–å®šåˆ¶çš„ç›®çš„äº†ã€‚ 12345678@Configurationpublic class MySelfRule { @Bean public IRule myRule() { // return new RandomRule(); //Ribboné»˜è®¤æ˜¯è½®è¯¢ï¼Œæˆ‘è‡ªå®šä¹‰ä¸ºéšæœº return new NewRandomRule(); }} 2.2 ä¿®æ”¹ä¸»å¯åŠ¨ç±»12345678@SpringBootApplication@EnableEurekaClient@RibbonClient(name=\"MICROSERVICECLOUD-DEPT\", configuration= MySelfRule.class)public class ConsumerDept80Application { public static void main(String[] args) { SpringApplication.run(ConsumerDept80Application.class, args); }} 2.3 è‡ªå®šä¹‰è§„åˆ™è½®è¯¢ç­–ç•¥åŸºç¡€ä¸Šï¼Œæ¯ä¸ªæœåŠ¡å™¨è¦æ±‚è¢«è°ƒç”¨5æ¬¡ã€‚ä¹Ÿå³ä»¥å‰æ˜¯æ¯å°æœºå™¨ä¸€æ¬¡ï¼Œç°åœ¨æ˜¯æ¯å°æœºå™¨5æ¬¡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public class NewRandomRule extends AbstractLoadBalancerRule { private int total = 0; //æ€»å…±è¢«è°ƒç”¨çš„æ¬¡æ•°ï¼Œç›®å‰è¦æ±‚æ¯å°è¢«è°ƒç”¨5æ¬¡ private int currentIndex = 0;//å½“å‰æä¾›æœåŠ¡çš„æœºå™¨å· public Server choose(ILoadBalancer lb, Object key) { if (lb == null) { return null; } Server server = null; while (server == null) { if (Thread.interrupted()) { return null; } List&lt;Server&gt; upList = lb.getReachableServers(); List&lt;Server&gt; allList = lb.getAllServers(); int serverCount = allList.size(); if (serverCount == 0) { /* * No servers. End regardless of pass, because subsequent passes * only get more restrictive. */ return null; }// int index = rand.nextInt(serverCount); // server = upList.get(index); if (total &lt; 5) { server = upList.get(currentIndex); total++; } else { total = 0; currentIndex++; if (currentIndex &gt;= upList.size()) { currentIndex = 0; } } if (server == null) { /* * The only time this should happen is if the server list were * somehow trimmed. This is a transient condition. Retry after * yielding. */ Thread.yield(); continue; } if (server.isAlive()) { return (server); } // Shouldn't actually happen.. but must be transient or a bug. server = null; Thread.yield(); } return server; } @Override public Server choose(Object key) { return choose(getLoadBalancer(), key); } @Override public void initWithNiwsConfig(IClientConfig clientConfig) { }} 2.4 æ•ˆæœæ¼”ç¤º èµ„æºè·å–å…¬ä¼—å·å›å¤ : Ribbonæ ¸å¿ƒç»„ä»¶IRuleå’Œè‡ªå®šä¹‰è§„åˆ™ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/30/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/04.3%20Ribbon%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6IRule%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99/"},{"title":"06.2 HystrixæœåŠ¡é™çº§","text":"æ•´ä½“èµ„æºå¿«ä¸å¤Ÿç”¨ï¼Œå…ˆå°†æŸäº›æœåŠ¡å…³æ‰ï¼Œå¾…æ•´ä½“æ¢å¤åï¼Œå†å¼€å¯å›æ¥ï¼ŒæœåŠ¡é™çº§å¤„ç†æ˜¯åœ¨å®¢æˆ·ç«¯å®ç°å®Œæˆçš„ï¼Œä¸æœåŠ¡ç«¯æ²¡æœ‰å…³ç³»ã€‚ 1. ä¿®æ”¹microservicecloud-apiå·¥ç¨‹æ ¹æ®å·²ç»æœ‰çš„DeptClientServiceæ¥å£æ–°å»ºä¸€ä¸ªå®ç°äº†FallbackFactoryæ¥å£çš„ç±»DeptClientServiceFallbackFactory 12345678910111213141516171819202122@Component//ä¸è¦å¿˜è®°æ·»åŠ ï¼Œä¸è¦å¿˜è®°æ·»åŠ public class DeptClientServiceFallbackFactory implements FallbackFactory&lt;DeptClientService&gt; { @Override public DeptClientService create(Throwable throwable) { return new DeptClientService() { @Override public Dept get(long id) { return new Dept().setDeptno(id) .setDname(\"è¯¥IDï¼š\" + id + \"æ²¡æœ‰æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯,Consumerå®¢æˆ·ç«¯æä¾›çš„é™çº§ä¿¡æ¯,æ­¤åˆ»æœåŠ¡Providerå·²ç»å…³é—­\") .setDb_source(\"no this database in MySQL\"); } @Override public List&lt;Dept&gt; list() { return null; } @Override public boolean add(Dept dept) { return false; } }; }} 2. ä¿®æ”¹DeptClientServiceæ¥å£åœ¨æ³¨è§£@FeignClientä¸­æ·»åŠ fallbackFactoryå±æ€§å€¼ 12345678910//@FeignClient(value = \"MICROSERVICECLOUD-DEPT\")@FeignClient (value = \"MICROSERVICECLOUD-DEPT\", fallbackFactory=DeptClientServiceFallbackFactory.class)public interface DeptClientService { @RequestMapping(value = \"/dept/get/{id}\", method = RequestMethod.GET) public Dept get(@PathVariable(\"id\") long id); @RequestMapping(value = \"/dept/list\", method = RequestMethod.GET) public List&lt;Dept&gt; list(); @RequestMapping(value = \"/dept/add\", method = RequestMethod.POST) public boolean add(Dept dept);} é‡æ–°ç¼–è¯‘microservicecloud-apiå·¥ç¨‹ 3. microservicecloud-consumer-dept-feignå·¥ç¨‹ä¿®æ”¹yml1234567891011server: port: 80feign: hystrix: enabled: trueeureka: client: register-with-eureka: false #å®¢æˆ·ç«¯ä¸æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: # defaultZone: http://localhost:7001/eureka defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ 4. éªŒè¯å¯åŠ¨Eurekaé›†ç¾¤, å†å°†å¾®æœåŠ¡microservicecloud-provider-dept-8001å¯åŠ¨, æœ€åå¯åŠ¨microservicecloud-consumer-dept-feign 123456curl http://localhost/consumer/dept/get/1{ &quot;deptno&quot;: 1, &quot;dname&quot;: &quot;å¼€å‘éƒ¨&quot;, &quot;db_source&quot;: &quot;cloudDB01&quot;} æ•…æ„å…³é—­å¾®æœåŠ¡microservicecloud-provider-dept-8001 123456curl http://localhost/consumer/dept/get/1{ &quot;deptno&quot;: 1, &quot;dname&quot;: &quot;è¯¥IDï¼š1æ²¡æœ‰æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯,Consumerå®¢æˆ·ç«¯æä¾›çš„é™çº§ä¿¡æ¯,æ­¤åˆ»æœåŠ¡Providerå·²ç»å…³é—­&quot;, &quot;db_source&quot;: &quot;no this database in MySQL&quot;} æ­¤æ—¶æœåŠ¡ç«¯providerå·²ç»downäº†ï¼Œä½†æ˜¯æˆ‘ä»¬åšäº†æœåŠ¡é™çº§å¤„ç†ï¼Œè®©å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯ä¸å¯ç”¨æ—¶ä¹Ÿä¼šè·å¾—æç¤ºä¿¡æ¯è€Œä¸ä¼šæŒ‚èµ·è€—æ­»æœåŠ¡å™¨ èµ„æºè·å–å…¬ä¼—å·å›å¤ : HystrixæœåŠ¡é™çº§ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/03/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/06.2%20Hystrix%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7/"},{"title":"07.Zuulè·¯ç”±ç½‘å…³","text":"Zuulè·¯ç”±ç½‘å…³ç®€ä»‹ä¸å®æˆ˜ 1. æ¦‚è¿°ZuulåŒ…å«äº†å¯¹è¯·æ±‚çš„è·¯ç”±å’Œè¿‡æ»¤ä¸¤ä¸ªæœ€ä¸»è¦çš„åŠŸèƒ½,å…¶ä¸­è·¯ç”±åŠŸèƒ½è´Ÿè´£å°†å¤–éƒ¨è¯·æ±‚è½¬å‘åˆ°å…·ä½“çš„å¾®æœåŠ¡å®ä¾‹ä¸Šï¼Œæ˜¯å®ç°å¤–éƒ¨è®¿é—®ç»Ÿä¸€å…¥å£çš„åŸºç¡€è€Œè¿‡æ»¤å™¨åŠŸèƒ½åˆ™è´Ÿè´£å¯¹è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹è¿›è¡Œå¹²é¢„ï¼Œæ˜¯å®ç°è¯·æ±‚æ ¡éªŒã€æœåŠ¡èšåˆç­‰åŠŸèƒ½çš„åŸºç¡€.Zuulå’ŒEurekaè¿›è¡Œæ•´åˆï¼Œå°†Zuulè‡ªèº«æ³¨å†Œä¸ºEurekaæœåŠ¡æ²»ç†ä¸‹çš„åº”ç”¨ï¼ŒåŒæ—¶ä»Eurekaä¸­è·å¾—å…¶ä»–å¾®æœåŠ¡çš„æ¶ˆæ¯ï¼Œä¹Ÿå³ä»¥åçš„è®¿é—®å¾®æœåŠ¡éƒ½æ˜¯é€šè¿‡Zuulè·³è½¬åè·å¾—ã€‚ æ³¨æ„ï¼šZuulæœåŠ¡æœ€ç»ˆè¿˜æ˜¯ä¼šæ³¨å†Œè¿›Eureka ZuulåŠŸèƒ½ ä»£ç† è·¯ç”± è¿‡æ»¤ å®˜ç½‘ : https://github.com/Netflix/zuul/wiki/Getting-Started 2. è·¯ç”±åŸºæœ¬é…ç½®2.1 æ–°å»ºModuleæ¨¡å—microservicecloud-zuul-gateway-9527 2.2 pom.xml123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-zuul-gateway-9527&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt;&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„ api é€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Dept éƒ¨é—¨Entity --&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- zuul è·¯ç”±ç½‘å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zuul&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--hystrix--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- å°†å¾®æœåŠ¡providerä¾§æ³¨å†Œè¿› eureka --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- actuatorç›‘æ§ä¿¡æ¯å®Œå–„ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 2.3 ymlæ–‡ä»¶12345678910111213141516171819202122server: port: 9527spring: application: name: microservicecloud-zuul-gatewayeureka: client: # å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: # defaultZone: http://localhost:7001/eureka defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/,http://eureka7003.com:7003/eureka/ instance: # è‡ªå®šä¹‰æœåŠ¡åç§°ä¿¡æ¯ instance-id: gateway-9527.com # è®¿é—®è·¯å¾„å¯ä»¥æ˜¾ç¤ºIPåœ°å€ prefer-ip-address: true# å¾®æœåŠ¡ä¿¡æ¯æè¿°info: app.name: atguigu-microservicecloud company.name: www.atguigu.com build.artifactId: ${project.artifactId} build.version: ${project.version} 2.4 ä¿®æ”¹hosts1127.0.0.1 myzuul.com 2.5 ä¸»å¯åŠ¨ç±»1234567@SpringBootApplication@EnableZuulProxypublic class ZuulGateway9527Application { public static void main(String[] args) { SpringApplication.run(ZuulGateway9527Application.class, args); }} 2.6 éªŒè¯å¯åŠ¨Eurekaé›†ç¾¤,ç„¶åå¯åŠ¨provider-dept-8001,æœ€åå¯åŠ¨zuul-gateway-9527,è®¿é—®æ¥å£ 123456789101112ä¸ä½¿ç”¨è·¯ç”± : curl http://localhost:8001/dept/get/2{ &quot;deptno&quot;: 2, &quot;dname&quot;: &quot;äººäº‹éƒ¨&quot;, &quot;db_source&quot;: &quot;cloudDB01&quot;}ä½¿ç”¨è·¯ç”± : curl http://myzuul.com:9527/microservicecloud-dept/dept/get/2{ &quot;deptno&quot;: 2, &quot;dname&quot;: &quot;äººäº‹éƒ¨&quot;, &quot;db_source&quot;: &quot;cloudDB01&quot;} 3. è·¯ç”±è®¿é—®æ˜ å°„è§„åˆ™3.1 è‡ªå®šä¹‰å¾®æœåŠ¡åˆ«åä¿®æ”¹yml 12345zuul: # è‡ªå®šä¹‰å¾®æœåŠ¡åˆ«å routes: mydept.serviceId: microservicecloud-dept mydept.path: /mydept/** æ­¤æ—¶å³å¯é€šè¿‡åˆ«åçš„æ–¹å¼è®¿é—®å¾®æœåŠ¡ 1curl http://myzuul.com:9527/mydept/dept/get/1 3.2 éšè—çœŸå®å¾®æœåŠ¡åç§°ä¸Šé¢ä¿®æ”¹æ–¹å¼,è¿˜æ˜¯å¯ä»¥é€šè¿‡çœŸå®å¾®æœåŠ¡åç§°è®¿é—®æ¥å£,è¿™ä¾æ—§æ˜¯ä¸å®‰å…¨çš„,å› æ­¤éœ€è¦éšè—.ä¿®æ”¹yml 12345678zuul: # éšè—çœŸå®æœåŠ¡å,ä¸å¯é€šè¿‡çœŸå®å¾®æœåŠ¡åç§°è®¿é—® å¤šä¸ªå¾®æœåŠ¡å¯ä»¥ç”¨\"*\" # ignored-services: microservicecloud-dept ignored-services: \"*\" # è‡ªå®šä¹‰å¾®æœåŠ¡åˆ«å routes: mydept.serviceId: microservicecloud-dept mydept.path: /mydept/** å†æ¬¡è®¿é—® 12curl http://myzuul.com:9527/microservicecloud-dept/dept/get/2{&quot;timestamp&quot;:1566983040888,&quot;status&quot;:404,&quot;error&quot;:&quot;Not Found&quot;,&quot;message&quot;:&quot;Not Found&quot;,&quot;path&quot;:&quot;/microservicecloud-dept/dept/get/2&quot;} 3.3 è®¾ç½®ç»Ÿä¸€å…¬å…±å‰ç¼€ä¿®æ”¹ymlæ–‡ä»¶ 12345678910zuul: # è®¾ç½®ç»Ÿä¸€å…¬å…±è®¿é—®å‰ç¼€ prefix: /atguigu # éšè—çœŸå®æœåŠ¡å,ä¸å¯é€šè¿‡çœŸå®å¾®æœåŠ¡åç§°è®¿é—® å¤šä¸ªå¾®æœåŠ¡å¯ä»¥ç”¨\"*\" # ignored-services: microservicecloud-dept ignored-services: \"*\" # è‡ªå®šä¹‰å¾®æœåŠ¡åˆ«å routes: mydept.serviceId: microservicecloud-dept mydept.path: /mydept/** ä¹‹åæ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦è¦å¢åŠ ç»Ÿä¸€å‰ç¼€ èµ„æºè·å–å…¬ä¼—å·å›å¤ : Zuulè·¯ç”±ç½‘å…³ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/05/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/07.Zuul%E8%B7%AF%E7%94%B1%E7%BD%91%E5%85%B3/"},{"title":"08.1 SpringCloud Configé…ç½®ä¸­å¿ƒç®€ä»‹","text":"å¾®æœåŠ¡æ„å‘³ç€è¦å°†å•ä½“åº”ç”¨ä¸­çš„ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªå­æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„ç²’åº¦ç›¸å¯¹è¾ƒå°ï¼Œå› æ­¤ç³»ç»Ÿä¸­ä¼šå‡ºç°å¤§é‡çš„æœåŠ¡ã€‚ç”±äºæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦å¿…è¦çš„é…ç½®ä¿¡æ¯æ‰èƒ½è¿è¡Œï¼Œæ‰€ä»¥ä¸€å¥—é›†ä¸­å¼çš„ã€åŠ¨æ€çš„é…ç½®ç®¡ç†è®¾æ–½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚SpringCloudæä¾›äº†ConfigServeræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªå¾®æœåŠ¡è‡ªå·±å¸¦ç€ä¸€ä¸ªapplication.ymlï¼Œä¸Šç™¾ä¸ªé…ç½®æ–‡ä»¶çš„ç®¡ç†. 1. æ˜¯ä»€ä¹ˆSpringCloud Configä¸ºå¾®æœåŠ¡æ¶æ„ä¸­çš„å¾®æœåŠ¡æä¾›é›†ä¸­åŒ–çš„å¤–éƒ¨é…ç½®æ”¯æŒï¼Œé…ç½®æœåŠ¡å™¨ä¸º å„ä¸ªä¸åŒå¾®æœåŠ¡åº”ç”¨ çš„æ‰€æœ‰ç¯å¢ƒæä¾›äº†ä¸€ä¸ª ä¸­å¿ƒåŒ–çš„å¤–éƒ¨é…ç½® ã€‚ 2. æ€ä¹ˆç©SpringCloud Configåˆ†ä¸º æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ† ã€‚ æœåŠ¡ç«¯ä¹Ÿç§°ä¸ºåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¾®æœåŠ¡åº”ç”¨ï¼Œç”¨æ¥è¿æ¥é…ç½®æœåŠ¡å™¨å¹¶ä¸ºå®¢æˆ·ç«¯æä¾›è·å–é…ç½®ä¿¡æ¯ï¼ŒåŠ å¯†/è§£å¯†ä¿¡æ¯ç­‰è®¿é—®æ¥å£ å®¢æˆ·ç«¯åˆ™æ˜¯é€šè¿‡æŒ‡å®šçš„é…ç½®ä¸­å¿ƒæ¥ç®¡ç†åº”ç”¨èµ„æºï¼Œä»¥åŠä¸ä¸šåŠ¡ç›¸å…³çš„é…ç½®å†…å®¹ï¼Œå¹¶åœ¨å¯åŠ¨çš„æ—¶å€™ä»é…ç½®ä¸­å¿ƒè·å–å’ŒåŠ è½½é…ç½®ä¿¡æ¯é…ç½®æœåŠ¡å™¨é»˜è®¤é‡‡ç”¨gitæ¥å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œè¿™æ ·å°±æœ‰åŠ©äºå¯¹ç¯å¢ƒé…ç½®è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡gitå®¢æˆ·ç«¯å·¥å…·æ¥æ–¹ä¾¿çš„ç®¡ç†å’Œè®¿é—®é…ç½®å†…å®¹ã€‚ 3. èƒ½å¹²å˜› é›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶ ä¸åŒç¯å¢ƒä¸åŒé…ç½®ï¼ŒåŠ¨æ€åŒ–çš„é…ç½®æ›´æ–°ï¼Œåˆ†ç¯å¢ƒéƒ¨ç½²æ¯”å¦‚dev/test/prod/beta/release è¿è¡ŒæœŸé—´åŠ¨æ€è°ƒæ•´é…ç½®ï¼Œä¸å†éœ€è¦åœ¨æ¯ä¸ªæœåŠ¡éƒ¨ç½²çš„æœºå™¨ä¸Šç¼–å†™é…ç½®æ–‡ä»¶ï¼ŒæœåŠ¡ä¼šå‘é…ç½®ä¸­å¿ƒç»Ÿä¸€æ‹‰å–é…ç½®è‡ªå·±çš„ä¿¡æ¯ å½“é…ç½®å‘ç”Ÿå˜åŠ¨æ—¶ï¼ŒæœåŠ¡ä¸éœ€è¦é‡å¯å³å¯æ„ŸçŸ¥åˆ°é…ç½®çš„å˜åŒ–å¹¶åº”ç”¨æ–°çš„é…ç½® å°†é…ç½®ä¿¡æ¯ä»¥RESTæ¥å£çš„å½¢å¼æš´éœ² 4. æ•´åˆç”±äºSpringCloud Configé»˜è®¤ä½¿ç”¨Gitæ¥å­˜å‚¨é…ç½®æ–‡ä»¶(ä¹Ÿæœ‰å…¶å®ƒæ–¹å¼,æ¯”å¦‚æ”¯æŒSVNå’Œæœ¬åœ°æ–‡ä»¶)ï¼Œä½†æœ€æ¨èçš„è¿˜æ˜¯Gitï¼Œè€Œä¸”ä½¿ç”¨çš„æ˜¯http/httpsè®¿é—®çš„å½¢å¼ èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/06/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/08.1%20SpringCloud%20Config%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E7%AE%80%E4%BB%8B/"},{"title":"06.3 HystrixæœåŠ¡ç›‘æ§","text":"é™¤äº†éš”ç¦»ä¾èµ–æœåŠ¡çš„è°ƒç”¨ä»¥å¤–ï¼ŒHystrixè¿˜æä¾›äº†å‡†å®æ—¶çš„è°ƒç”¨ç›‘æ§ï¼ˆHystrix Dashboardï¼‰ï¼ŒHystrixä¼šæŒç»­åœ°è®°å½•æ‰€æœ‰é€šè¿‡Hystrixå‘èµ·çš„è¯·æ±‚çš„æ‰§è¡Œä¿¡æ¯ï¼Œå¹¶ä»¥ç»Ÿè®¡æŠ¥è¡¨å’Œå›¾å½¢çš„å½¢å¼å±•ç¤ºç»™ç”¨æˆ·ï¼ŒåŒ…æ‹¬æ¯ç§’æ‰§è¡Œå¤šå°‘è¯·æ±‚å¤šå°‘æˆåŠŸï¼Œå¤šå°‘å¤±è´¥ç­‰ã€‚Netflixé€šè¿‡hystrix-metrics-event-streamé¡¹ç›®å®ç°äº†å¯¹ä»¥ä¸ŠæŒ‡æ ‡çš„ç›‘æ§ã€‚Spring Cloudä¹Ÿæä¾›äº†Hystrix Dashboardçš„æ•´åˆï¼Œå¯¹ç›‘æ§å†…å®¹è½¬åŒ–æˆå¯è§†åŒ–ç•Œé¢ã€‚ 1. æ–°å»ºå·¥ç¨‹microservicecloud-consumer-hystrix-dashboard 2. pom.xmlæ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-consumer-hystrix-dashboard-9001&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;!--è‡ªå·±å®šä¹‰çš„api --&gt; &lt;dependency&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½²--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--Ribbonç›¸å…³--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--feignç›¸å…³--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- hystrixå’Œ hystrix-dashboardç›¸å…³--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix-dashboard&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 3. ymlæ–‡ä»¶12server: port: 9001 4. ä¸»å¯åŠ¨ç±»1234567@SpringBootApplication@EnableHystrixDashboardpublic class ConsumerHystrixDashboard9001Application { public static void main(String[] args) { SpringApplication.run(ConsumerHystrixDashboard9001Application.class, args); }} 5. Providerå¾®æœåŠ¡ç›‘æ§æ‰€æœ‰Providerå¾®æœåŠ¡æä¾›ç±»(8001/8002/8003)éƒ½éœ€è¦ç›‘æ§ä¾èµ–é…ç½®æ£€æŸ¥æ˜¯å¦éƒ½æœ‰ç›‘æ§é…ç½® 12345&lt;!-- actuatorç›‘æ§ä¿¡æ¯å®Œå–„ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; 6. å¯åŠ¨microservicecloud-consumer-hystrix-dashboardè®¿é—® http://localhost:9001/hystrix 7. éªŒè¯å¯åŠ¨Eurekaé›†ç¾¤, å†å¯åŠ¨microservicecloud-provider-dept-hystrix-8001,è®¿é—® 123456curl http://localhost:8001/dept/get/1{ &quot;deptno&quot;: 1, &quot;dname&quot;: &quot;å¼€å‘éƒ¨&quot;, &quot;db_source&quot;: &quot;cloudDB01&quot;} http://localhost:8001/hystrix.stream 8. ç›‘æ§ç•Œé¢8.1 å¡«å†™ç›‘æ§åœ°å€ Delayï¼šè¯¥å‚æ•°ç”¨æ¥æ§åˆ¶æœåŠ¡å™¨ä¸Šè½®è¯¢ç›‘æ§ä¿¡æ¯çš„å»¶è¿Ÿæ—¶é—´ï¼Œé»˜è®¤ä¸º2000æ¯«ç§’ï¼Œå¯ä»¥é€šè¿‡é…ç½®è¯¥å±æ€§æ¥é™ä½å®¢æˆ·ç«¯çš„ç½‘ç»œå’ŒCPUæ¶ˆè€—ã€‚ Titleï¼šè¯¥å‚æ•°å¯¹åº”äº†å¤´éƒ¨æ ‡é¢˜Hystrix Streamä¹‹åçš„å†…å®¹ï¼Œé»˜è®¤ä¼šä½¿ç”¨å…·ä½“ç›‘æ§å®ä¾‹çš„URLï¼Œå¯ä»¥é€šè¿‡é…ç½®è¯¥ä¿¡æ¯æ¥å±•ç¤ºæ›´åˆé€‚çš„æ ‡é¢˜ã€‚ 8.2 ç›‘æ§ç•Œé¢ å®å¿ƒåœ† : å…±æœ‰ä¸¤ç§å«ä¹‰ã€‚å®ƒé€šè¿‡é¢œè‰²çš„å˜åŒ–ä»£è¡¨äº†å®ä¾‹çš„å¥åº·ç¨‹åº¦ï¼Œå®ƒçš„å¥åº·åº¦ä»ç»¿è‰²&lt;é»„è‰²&lt;æ©™è‰²&lt;çº¢è‰²é€’å‡ã€‚è¯¥å®å¿ƒåœ†é™¤äº†é¢œè‰²çš„å˜åŒ–ä¹‹å¤–ï¼Œå®ƒçš„å¤§å°ä¹Ÿä¼šæ ¹æ®å®ä¾‹çš„è¯·æ±‚æµé‡å‘ç”Ÿå˜åŒ–ï¼Œæµé‡è¶Šå¤§è¯¥å®å¿ƒåœ†å°±è¶Šå¤§ã€‚æ‰€ä»¥é€šè¿‡è¯¥å®å¿ƒåœ†çš„å±•ç¤ºï¼Œå°±å¯ä»¥åœ¨å¤§é‡çš„å®ä¾‹ä¸­å¿«é€Ÿçš„å‘ç° æ•…éšœå®ä¾‹å’Œé«˜å‹åŠ›å®ä¾‹ã€‚ æ›²çº¿ : ç”¨æ¥è®°å½•2åˆ†é’Ÿå†…æµé‡çš„ç›¸å¯¹å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è§‚å¯Ÿåˆ°æµé‡çš„ä¸Šå‡å’Œä¸‹é™è¶‹åŠ¿ã€‚ æ•´ä½“è¯´æ˜ åŠ¨å›¾æ¼”ç¤º:å¤šæ¬¡åˆ·æ–°http://localhost:8001/dept/get/1 èµ„æºè·å–å…¬ä¼—å·å›å¤ : HystrixæœåŠ¡ç›‘æ§ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/04/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/06.3%20Hystrix%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/"},{"title":"08.2 SpringCloud ConfigæœåŠ¡ç«¯é…ç½®","text":"SpringCloud ConfigæœåŠ¡ç«¯é…ç½® 1. Gitæ‰˜ç®¡é…ç½®æ–‡ä»¶æœ¬æ–‡ä½¿ç”¨Githubç§æœ‰ä»“åº“æ¥å®ç°,åˆ›å»ºè¿‡ç¨‹ç•¥(é…ç½®æ–‡ä»¶ä¸ºæ•æ„Ÿæ•°æ®,å°½é‡ä½¿ç”¨ç§æœ‰ä»“åº“æ¨¡å¼) åˆ›å»ºå®Œæˆåæ·»åŠ æ–‡ä»¶ application.ymlæ–‡ä»¶ 1234567891011121314151617spring: profiles: active: - dev---spring: #å¼€å‘ç¯å¢ƒ profiles: dev application: name: microservicecloud-config-atguigu-dev---spring: #æµ‹è¯•ç¯å¢ƒ profiles: test application: name: microservicecloud-config-atguigu-test#è¯·ä¿å­˜ä¸ºUTF-8æ ¼å¼ 2. æœåŠ¡ç«¯é…ç½®2.1 æ–°å»ºModuleæ¨¡å—microservicecloud-config-3344å®ƒå³ä¸ºCloudçš„é…ç½®ä¸­å¿ƒæ¨¡å— 2.2 pom.xmlæ–‡ä»¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-config-3344&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt;&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„ api é€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Dept éƒ¨é—¨Entity --&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- springCloud Config--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- é¿å… Config çš„ Git æ’ä»¶æŠ¥é”™ï¼š org /eclipse/ jgit / api /TransportConfigCallback --&gt; &lt;dependency&gt; &lt;groupId&gt;org.eclipse.jgit&lt;/groupId&gt; &lt;artifactId&gt;org.eclipse.jgit&lt;/artifactId&gt; &lt;version&gt;4.10.0.201712302008-r&lt;/version&gt; &lt;/dependency&gt; &lt;!--hystrix--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- å°†å¾®æœåŠ¡providerä¾§æ³¨å†Œè¿› eureka --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- actuatorç›‘æ§ä¿¡æ¯å®Œå–„ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 2.3 ymlæ–‡ä»¶1234567891011server: port: 3344spring: application: name: microservicecloud-config cloud: config: server: git: #GitHubä¸Šé¢çš„gitä»“åº“åå­— uri: git@github.com:lujiahao0708/microservicecloud-config.git 2.4 ä¸»å¯åŠ¨ç±»1234567@SpringBootApplication@EnableConfigServerpublic class Config3344Application { public static void main(String[] args) { SpringApplication.run(Config3344Application.class, args); }} 2.5 hostsæ–‡ä»¶å¢åŠ 1127.0.0.1 config-3344.com 2.6 éªŒè¯å¯åŠ¨config-3344æœåŠ¡,è®¿é—®urlæŸ¥çœ‹ç»“æœ å‰ä¸¤ä¸ªåˆ†åˆ«ä¸ºdevç¯å¢ƒå’Œtestç¯å¢ƒ,æœ€åä¸€ä¸ªä¸ºä¸å­˜åœ¨çš„ç¯å¢ƒ 3. é…ç½®è¯»å–è§„åˆ™/{application}-{profile}.yml http://config-3344.com:3344/application-dev.yml http://config-3344.com:3344/application-test.yml http://config-3344.com:3344/application-xxx.yml(ä¸å­˜åœ¨çš„é…ç½®) /{application}/{profile}[/{label}] http://config-3344.com:3344/application/dev/master http://config-3344.com:3344/application/test/master http://config-3344.com:3344/application/xxx/master /{label}/{application}-{profile}.yml http://config-3344.com:3344/master/application-dev.yml http://config-3344.com:3344/master/application-test.ymlèµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloud ConfigæœåŠ¡ç«¯é…ç½® è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/07/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/08.2%20SpringCloud%20Config%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE/"},{"title":"08.3 SpringCloud Configå®¢æˆ·ç«¯é…ç½®","text":"SpringCloud Configå®¢æˆ·ç«¯é…ç½® 1. åˆ›å»ºå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶åœ¨microservice-configå·¥ç¨‹ä¸­åˆ›å»º microservicecloud-config-client.yml æ–‡ä»¶,å¹¶æ¨é€åˆ°Githubç§æœ‰ä»“åº“ä¸­ 1234567891011121314151617181920212223242526spring: profiles: active: - dev---server: port: 8201spring: profiles: dev application: name: microservicecloud-config-clienteureka: client: service-url: defaultZone: http://eureka-dev.com:7001/eureka/---server: port: 8202spring: profiles: test application: name: microservicecloud-config-clienteureka: client: service-url: defaultZone: http://eureka-test.com:7001/eureka/ 2. åˆ›å»ºå®¢æˆ·ç«¯å·¥ç¨‹2.1 æ–°å»ºmicroservicecloud-config-client-3355ç•¥ 2.2 pom.xmlæ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-config-client-3355&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt;&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„ api é€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Dept éƒ¨é—¨Entity --&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- SpringCloud Config å®¢æˆ·ç«¯ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter- config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--hystrix--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- å°†å¾®æœåŠ¡providerä¾§æ³¨å†Œè¿› eureka --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- actuatorç›‘æ§ä¿¡æ¯å®Œå–„ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 2.3 åˆ›å»ºbootstrap.ymlapplicaiton.ymlæ˜¯ç”¨æˆ·çº§çš„èµ„æºé…ç½®é¡¹bootstrap.ymlæ˜¯ç³»ç»Ÿçº§çš„ï¼Œ ä¼˜å…ˆçº§æ›´åŠ é«˜Spring Cloudä¼šåˆ›å»ºä¸€ä¸ªBootstrap Contextï¼Œä½œä¸ºSpringåº”ç”¨çš„Application Contextçš„ çˆ¶ä¸Šä¸‹æ–‡ ã€‚åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒBootstrap Contextè´Ÿè´£ä»å¤–éƒ¨æºåŠ è½½é…ç½®å±æ€§å¹¶è§£æé…ç½®ã€‚è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡å…±äº«ä¸€ä¸ªä»å¤–éƒ¨è·å–çš„Environmentã€‚Bootstrapå±æ€§æœ‰é«˜ä¼˜å…ˆçº§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¸ä¼šè¢«æœ¬åœ°é…ç½®è¦†ç›–ã€‚Bootstrap contextå’ŒApplication Contextæœ‰ç€ä¸åŒçš„çº¦å®šï¼Œæ‰€ä»¥æ–°å¢äº†ä¸€ä¸ªbootstrap.ymlæ–‡ä»¶ï¼Œä¿è¯Bootstrap Contextå’ŒApplication Contexté…ç½®çš„åˆ†ç¦»ã€‚ 12345678910spring: cloud: config: #éœ€è¦ä»githubä¸Šè¯»å–çš„èµ„æºåç§°ï¼Œæ³¨æ„æ²¡æœ‰ymlåç¼€å name: microservicecloud-config-client #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ profile: dev label: master #æœ¬å¾®æœåŠ¡å¯åŠ¨åå…ˆå»æ‰¾3344å·æœåŠ¡ï¼Œé€šè¿‡SpringCloudConfigè·å–GitHubçš„æœåŠ¡åœ°å€ uri: http://config-3344.com:3344 2.4 åˆ›å»ºapplication.ymlæ–‡ä»¶123spring: application: name: microservicecloud-config-client 2.5 hostsæ–‡ä»¶å¢åŠ 1127.0.0.1 client-config.com 2.6 æ–°å»º ConfigClientRest123456789101112131415@RestControllerpublic class ConfigClientRest { @Value(\"${spring.application.name}\") private String applicationName; @Value(\"${eureka.client.service-url.defaultZone}\") private String eurekaServers; @Value(\"${server.port}\") private String port; @RequestMapping(\"/config\") public String getConfig() { String str = \"applicationName: \" + applicationName + \"\\t eurekaServers:\" + eurekaServers + \"\\t port: \" + port; System.out.println(\"******str: \" + str); return \"applicationName: \" + applicationName + \"\\t eurekaServers:\" + eurekaServers + \"\\t port: \" + port; }} 2.7 ä¸»å¯åŠ¨ç±»123456@SpringBootApplicationpublic class ConfigClient3355Application { public static void main(String[] args) { SpringApplication.run(ConfigClient3355Application.class, args); }} 2.8 éªŒè¯ å…ˆå¯åŠ¨config-3344æœåŠ¡,åœ¨å¯åŠ¨config-client-3355 bootstrap.ymlé‡Œé¢çš„profileå€¼æ˜¯ä»€ä¹ˆï¼Œå†³å®šä»githubä¸Šè¯»å–ä»€ä¹ˆ å‡å¦‚ç›®å‰æ˜¯ profile: dev ,devé»˜è®¤åœ¨githubä¸Šå¯¹åº”çš„ç«¯å£å°±æ˜¯8201,æ¥å£è®¿é—®http://client-config.com:8201/config å‡å¦‚ç›®å‰æ˜¯ profile: test,testé»˜è®¤åœ¨githubä¸Šå¯¹åº”çš„ç«¯å£å°±æ˜¯8202,æ¥å£è®¿é—®http://client-config.com:8202/config æˆåŠŸå®ç°äº†å®¢æˆ·ç«¯3355è®¿é—®SpringCloud Config3344é€šè¿‡GitHubè·å–é…ç½®ä¿¡æ¯ èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloud Configå®¢æˆ·ç«¯é…ç½® è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/08/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/08.3%20SpringCloud%20Config%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE/"},{"title":"08.4 SpringCloud Configé…ç½®å®æˆ˜","text":"éƒ¨é—¨å¾®æœåŠ¡å’Œæ³¨å†Œä¸­å¿ƒå¾®æœåŠ¡æ¥å…¥SpringCloud Configé…ç½®å®æˆ˜ 1. Gité…ç½®æ–‡ä»¶æœ¬åœ°é…ç½®åˆ›å»ºé…ç½®æ–‡ä»¶å¹¶ä¸Šä¼ è‡³Githubç§æœ‰ä»“åº“microservicecloud-config-eureka-client.yml 12345678910111213141516171819202122232425262728293031323334spring: profiles: active: - dev---server: port: 7001 #æ³¨å†Œä¸­å¿ƒå ç”¨7001ç«¯å£,å†’å·åé¢å¿…é¡»è¦æœ‰ç©ºæ ¼spring: profiles: dev application: name: microservicecloud-config-eureka-clienteureka: instance: hostname: eureka7001.com #å†’å·åé¢å¿…é¡»è¦æœ‰ç©ºæ ¼ client: register-with-eureka: false #å½“å‰çš„eureka-serverè‡ªå·±ä¸æ³¨å†Œè¿›æœåŠ¡åˆ—è¡¨ä¸­ fetch-registry: false #ä¸é€šè¿‡eurekaè·å–æ³¨å†Œä¿¡æ¯ service-url: defaultZone: http://eureka7001.com:7001/eureka/---server: port: 7001 #æ³¨å†Œä¸­å¿ƒå ç”¨7001ç«¯å£,å†’å·åé¢å¿…é¡»è¦æœ‰ç©ºæ ¼spring: profiles: test application: name: microservicecloud-config-eureka-clienteureka: instance: hostname: eureka7001.com #å†’å·åé¢å¿…é¡»è¦æœ‰ç©ºæ ¼ client: register-with-eureka: false #å½“å‰çš„eureka-serverè‡ªå·±ä¸æ³¨å†Œè¿›æœåŠ¡åˆ—è¡¨ä¸­ fetch-registry: false #ä¸é€šè¿‡eurekaè·å–æ³¨å†Œä¿¡æ¯ service-url: defaultZone: http://eureka7001.com:7001/eureka/ microservicecloud-config-dept-client.yml 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576spring: profiles: active: - dev---server: port: 8001spring: profiles: dev application: name: microservicecloud-config-dept-client datasource: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: org.gjt.mm.mysql.Driver url: jdbc:mysql://localhost:3306/cloudDB01 username: root password: 123456 dbcp2: min-idle: 5 initial-size: 5 max-total: 5 max-wait-millis: 200mybatis: config-location: classpath:mybatis/mybatis.cfg.xml type-aliases-package: com.hellodev.entities mapper-locations: - classpath:mybatis/mapper/**/*.xmleureka: client: #å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: defaultZone: http://eureka7001.com:7001/eureka instance: instance-id: dept-8001.com prefer-ip-address: trueinfo: app.name: atguigu-microservicecloud-springcloudconfig01 company.name: www.atguigu.com build.artifactId: ${project.artifactId} build.version: ${project.version}---server: port: 8001spring: profiles: test application: name: microservicecloud-config-dept-client datasource: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: org.gjt.mm.mysql.Driver url: jdbc:mysql://localhost:3306/cloudDB02 username: root password: 123456 dbcp2: min-idle: 5 initial-size: 5 max-total: 5 max-wait-millis: 200mybatis: config-location: classpath:mybatis/mybatis.cfg.xml type-aliases-package: com.hellodev.entities mapper-locations: - classpath:mybatis/mapper/**/*.xml eureka: client: #å®¢æˆ·ç«¯æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: defaultZone: http://eureka7001.com:7001/eureka instance: instance-id: dept-8001.com prefer-ip-address: trueinfo: app.name: atguigu-microservicecloud-springcloudconfig02 company.name: www.atguigu.com build.artifactId: ${project.artifactId} build.version: ${project.version} 2. Configç‰ˆçš„eurekaæœåŠ¡ç«¯2.1 æ–°å»ºå·¥ç¨‹åˆ›å»ºmicroservicecloud-config-eureka-client-7001å·¥ç¨‹,æ­¥éª¤çœç•¥. 2.2 POM1234567891011121314151617181920212223242526272829303132333435&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-config-eureka-client-7001&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;!-- SpringCloudConfigé…ç½® --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--eureka-serveræœåŠ¡ç«¯ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 2.3 bootstrap.yml123456789spring: cloud: config: #éœ€è¦ä»githubä¸Šè¯»å–çš„èµ„æºåç§°ï¼Œæ³¨æ„æ²¡æœ‰ymlåç¼€å name: microservicecloud-config-eureka-client profile: dev label: master #SpringCloudConfigè·å–çš„æœåŠ¡åœ°å€ uri: http://config-3344.com:3344 2.4 application.yml123spring: application: name: microservicecloud-config-eureka-client 2.5 ä¸»å¯åŠ¨ç±»12345678@SpringBootApplication// EurekaServeræœåŠ¡å™¨ç«¯å¯åŠ¨ç±»,æ¥å—å…¶å®ƒå¾®æœåŠ¡æ³¨å†Œè¿›æ¥@EnableEurekaServerpublic class ConfigEureka7001Application { public static void main(String[] args) { SpringApplication.run(ConfigEureka7001Application.class, args); }} 2.6 éªŒè¯ å…ˆå¯åŠ¨microservicecloud-config-3344å¾®æœåŠ¡ï¼Œä¿è¯Configæ€»é…ç½®æ˜¯OKçš„ å†å¯åŠ¨microservicecloud-config-eureka-client-7001å¾®æœåŠ¡ è®¿é—®url http://eureka7001.com:7001/ å‡ºç°eureakä¸»é¡µè¡¨ç¤ºæˆåŠŸå¯åŠ¨ 3. Configç‰ˆçš„deptå¾®æœåŠ¡3.1 åˆ›å»ºå·¥ç¨‹å‚è€ƒä¹‹å‰çš„8001æ‹·è´åæ–°å»ºå·¥ç¨‹microservicecloud-config-dept-client-8001 3.2 POM1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-config-dept-client-8001&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt;&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„ api é€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Dept éƒ¨é—¨Entity --&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- SpringCloudConfigé…ç½® --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--å°†å¾®æœåŠ¡providerä¾§æ³¨å†Œè¿›eureka --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--actuatorç›‘æ§ä¿¡æ¯å®Œå–„--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½²--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 3.3 bootstrap.yml1234567891011spring: cloud: config: #éœ€è¦ä»githubä¸Šè¯»å–çš„èµ„æºåç§°ï¼Œæ³¨æ„æ²¡æœ‰ymlåç¼€å name: microservicecloud-config-dept-client #profileé…ç½®æ˜¯ä»€ä¹ˆå°±å–ä»€ä¹ˆé…ç½®dev or test profile: dev# profile: test label: master #SpringCloudConfigè·å–çš„æœåŠ¡åœ°å€ uri: http://config-3344.com:3344 3.4 application.yml123spring: application: name: microservicecloud-config-dept-client 3.5 ä¸»å¯åŠ¨ç±»12345678910@SpringBootApplication// æœ¬æœåŠ¡å¯åŠ¨åä¼šè‡ªåŠ¨æ³¨å†Œè¿› eureka æœåŠ¡ä¸­@EnableEurekaClient// æœåŠ¡å‘ç°@EnableDiscoveryClientpublic class ConfigClientProviderDept8001Application { public static void main(String[] args) { SpringApplication.run(ConfigClientProviderDept8001Application.class, args); }} 3.6 éªŒè¯æœ¬åœ°æ¢é…ç½®æˆdev 123456789101112131415161718192021222324252627282930313233curl http://localhost:8001/dept/list[ { \"deptno\": 1, \"dname\": \"å¼€å‘éƒ¨\", \"db_source\": \"cloudDB01\" }, { \"deptno\": 2, \"dname\": \"äººäº‹éƒ¨\", \"db_source\": \"cloudDB01\" }, { \"deptno\": 3, \"dname\": \"è´¢åŠ¡éƒ¨\", \"db_source\": \"cloudDB01\" }, { \"deptno\": 4, \"dname\": \"å¸‚åœºéƒ¨\", \"db_source\": \"cloudDB01\" }, { \"deptno\": 5, \"dname\": \"è¿ç»´éƒ¨\", \"db_source\": \"cloudDB01\" }, { \"deptno\": 6, \"dname\": \"AI\", \"db_source\": \"cloudDB01\" }] å¯ä»¥çœ‹åˆ°æ•°æ®åº“é…ç½®æ˜¯01 testé…ç½®é»˜è®¤è®¿é—® 12345678910111213141516171819202122232425262728curl http://localhost:8001/dept/list[ { \"deptno\": 1, \"dname\": \"å¼€å‘éƒ¨\", \"db_source\": \"cloudDB02\" }, { \"deptno\": 2, \"dname\": \"äººäº‹éƒ¨\", \"db_source\": \"cloudDB02\" }, { \"deptno\": 3, \"dname\": \"è´¢åŠ¡éƒ¨\", \"db_source\": \"cloudDB02\" }, { \"deptno\": 4, \"dname\": \"å¸‚åœºéƒ¨\", \"db_source\": \"cloudDB02\" }, { \"deptno\": 5, \"dname\": \"è¿ç»´éƒ¨\", \"db_source\": \"cloudDB02\" }] å¯ä»¥çœ‹åˆ°æ•°æ®åº“é…ç½®æ˜¯02 èµ„æºè·å–å…¬ä¼—å·å›å¤ : SpringCloud Configé…ç½®å®æˆ˜ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/09/09/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/08.4%20SpringCloud%20Config%E9%85%8D%E7%BD%AE%E5%AE%9E%E6%88%98/"},{"title":"02.Restå¾®æœåŠ¡æ„å»ºæ¡ˆä¾‹","text":"1. å·¥ç¨‹ç»“æ„MicroServiceCloud |â€” microservicecloud-api # å°è£…æ•´ä½“entity/æ¥å£/å…¬å…±é…ç½®ç­‰ |â€” microservicecloud-provider-dept-8001 # å¾®æœåŠ¡è½åœ°çš„æœåŠ¡æä¾›è€… |â€” microservicecloud-consumer-dept-80 # å¾®æœåŠ¡è°ƒç”¨çš„å®¢æˆ·ç«¯ 2. Spring Cloudå’ŒSpring Bootç‰ˆæœ¬1234567891011121314&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Dalston.SR1&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;1.5.9.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt;&lt;/dependency&gt; 3. MicroServiceCloudçˆ¶å·¥ç¨‹3.1 æ–°å»ºå·¥ç¨‹, packageingé€‰æ‹©pom 3.2 pomæ–‡ä»¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;junit.version&gt;4.12&lt;/junit.version&gt; &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt; &lt;lombok.version&gt;1.16.18&lt;/lombok.version&gt; &lt;project.version&gt;0.0.1&lt;/project.version&gt; &lt;/properties&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Dalston.SR1&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;1.5.9.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.6&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-core&lt;/artifactId&gt; &lt;version&gt;1.2.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;${junit.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt;&lt;/project&gt; 4. microservicecloud-api4.1 åˆ›å»ºModule 4.2 çˆ¶å·¥ç¨‹å¢åŠ æ¨¡å—ä¿¡æ¯123&lt;modules&gt; &lt;module&gt;microservicecloud-api&lt;/module&gt;&lt;/modules&gt; 4.3 pomæ–‡ä»¶1234567891011121314151617181920&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;!-- å­ç±»é‡Œé¢æ˜¾ç¤ºå£°æ˜æ‰èƒ½æœ‰æ˜ç¡®çš„ç»§æ‰¿è¡¨ç°ï¼Œæ— æ„å¤–å°±æ˜¯çˆ¶ç±»çš„é»˜è®¤ç‰ˆæœ¬å¦åˆ™è‡ªå·±å®šä¹‰ --&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;!-- å½“å‰Moduleéœ€è¦ç”¨åˆ°çš„jaråŒ…ï¼ŒæŒ‰è‡ªå·±éœ€æ±‚æ·»åŠ ï¼Œå¦‚æœçˆ¶ç±»å·²ç»åŒ…å«äº†ï¼Œå¯ä»¥ä¸ç”¨å†™ç‰ˆæœ¬å· --&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 4.4 æ–°å»ºentitiesåŒ…å¹¶åˆ›å»ºDeptéƒ¨é—¨ç±»12345678910111213@SuppressWarnings(\"serial\")@NoArgsConstructor@Data@Accessors(chain = true)public class Dept implements Serializable { private Long deptno; //ä¸»é”® private String dname; //éƒ¨é—¨åç§° private String db_source; //æ¥è‡ªé‚£ä¸ªæ•°æ®åº“ï¼Œå› ä¸ºå¾®æœåŠ¡æ¶æ„å¯ä»¥ä¸€ä¸ªæœåŠ¡å¯¹åº”ä¸€ä¸ªæ•°æ®åº“ï¼ŒåŒä¸€ä¸ªä¿¡æ¯è¢«å­˜å‚¨åˆ°ä¸åŒæ•°æ®åº“ public Dept(String dname) { super(); this.dname = dname; }} 4.5 mavenç¼–è¯‘12mvn clean installæ¨¡å—ç¼–è¯‘åå¯ä¾›å…¶ä»–å·¥ç¨‹ä½¿ç”¨,è¾¾åˆ°é€šç”¨ç›®çš„. 5. microservicecloud-provider-dept-80015.1 åˆ›å»ºModule 5.2 çˆ¶å·¥ç¨‹å¢åŠ æ¨¡å—ä¿¡æ¯123&lt;modules&gt; &lt;module&gt;microservicecloud-provider-dept-8001&lt;/module&gt;&lt;/modules&gt; 5.3 pomæ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-provider-dept-8001&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt;&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„ api é€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨ Dept éƒ¨é—¨Entity --&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 5.4 ymlæ–‡ä»¶123456789101112131415161718192021server: port: 8001mybatis: config-location: classpath:mybatis/mybatis.cfg.xml type-aliases-package: com.hellodev.api.entities mapper-locations: - classpath:mybatis/mapper/**/*.xmlspring: application: name: microservicecloud-dept datasource: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: org.gjt.mm.mysql.Driver url: jdbc:mysql://localhost:3306/cloudDB01 username: root password: 1234 dbcp2: min-idle: 5 initial-size: 5 max-total: 5 max-wait-millis: 200 5.5 æ•´åˆmybatisâ€”mybatis.cfg.xmlåœ¨src/main/resourcesç›®å½•ä¸‹æ–°å»ºmybatisæ–‡ä»¶å¤¹,ç„¶ååˆ›å»ºmybatis.cfg.xml 12345678&lt;?xml version = \"1.0\" encoding = \"UTF-8\"?&gt;&lt;!DOCTYPE configuration PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;&lt;configuration&gt; &lt;settings&gt; &lt;setting name=\"cacheEnabled\" value=\"true\"/&gt; &lt;!-- äºŒçº§ç¼“å­˜å¼€å¯ --&gt; &lt;/settings&gt;&lt;/configuration&gt; 5.6 æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬1234567891011121314DROP DATABASE IF EXISTS cloudDB01; CREATE DATABASE cloudDB01 CHARACTER SET UTF8; USE cloudDB01; CREATE TABLE dept( deptno BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT, dname VARCHAR (60), db_source VARCHAR (60) ); INSERT INTO dept(dname,db_source) VALUES ( 'å¼€å‘éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'äººäº‹éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'è´¢åŠ¡éƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'å¸‚åœºéƒ¨' ,DATABASE()); INSERT INTO dept(dname,db_source) VALUES ( 'è¿ç»´éƒ¨' ,DATABASE()); SELECT * FROM dept; 5.7 åˆ›å»ºMapper.xmlåœ¨src/main/resourcesç›®å½•ä¸‹æ–°å»ºmapperæ–‡ä»¶å¤¹,ç„¶ååˆ›å»ºDeptMapper.xml 1234567891011121314&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace=\"com.hellodev.dao.DeptDao\"&gt; &lt;select id=\"findById\" resultType=\"com.hellodev.entities.Dept\" parameterType=\"Long\"&gt; select deptno , dname ,db_source from dept where deptno =#{ deptno }; &lt;/select&gt; &lt;select id=\"findAll\" resultType=\"com.hellodev.entities.Dept\"&gt; select deptno , dname ,db_source from dept ; &lt;/select&gt; &lt;insert id=\"addDept\" parameterType=\"com.hellodev.entities.Dept\"&gt; INSERT INTO dept ( dname ,db_source) VALUES(#{ dname }, DATABASE() ); &lt;/insert&gt;&lt;/mapper&gt; 5.8 ç¼–å†™Daoåˆ›å»ºdaoåŒ…,å¹¶åˆ›å»ºDeptDao.java 123456@Mapperpublic interface DeptDao { public boolean addDept(Dept dept); public Dept findById(Long id); public List&lt;Dept&gt; findAll();} 5.9 ç¼–å†™ServiceåŠå®ç°ç±»åˆ›å»ºserviceåŒ…,å¹¶åˆ›å»ºDeptService.javaå’ŒDeptServiceImpl.java 12345678910111213141516171819202122public interface DeptService { public boolean add(Dept dept); public Dept get(Long id); public List&lt;Dept&gt; list();}@Servicepublic class DeptServiceImpl implements DeptService { @Autowired private DeptDao dao; @Override public boolean add(Dept dept) { return dao.addDept(dept); } @Override public Dept get(Long id) { return dao.findById(id); } @Override public List&lt;Dept&gt; list() { return dao.findAll(); }} 5.10 ç¼–å†™Controlleråˆ›å»ºcontrolleråŒ…,å¹¶åˆ›å»ºDeptController.java 1234567891011121314151617@RestControllerpublic class DeptController { @Autowired private DeptService service; @RequestMapping(value = \"/dept/add\", method = RequestMethod.POST) public boolean add(@RequestBody Dept dept) { return service.add(dept); } @RequestMapping(value = \"/dept/get/{id}\", method = RequestMethod.GET) public Dept get(@PathVariable(\"id\") Long id) { return service.get(id); } @RequestMapping(value = \"/dept/list\", method = RequestMethod.GET) public List&lt;Dept&gt; list() { return service.list(); }} 5.11 éªŒè¯å¯åŠ¨å·¥ç¨‹,å¹¶ä½¿ç”¨curlå‘½ä»¤éªŒè¯ 123456curl http://localhost:8001/dept/get/2{\"deptno\":2,\"dname\":\"äººäº‹éƒ¨\",\"db_source\":\"cloudDB01â€}curl http://localhost:8001/dept/list[{\"deptno\":1,\"dname\":\"å¼€å‘éƒ¨\",\"db_source\":\"cloudDB01\"},{\"deptno\":2,\"dname\":\"äººäº‹éƒ¨\",\"db_source\":\"cloudDB01\"},{\"deptno\":3,\"dname\":\"è´¢åŠ¡éƒ¨\",\"db_source\":\"cloudDB01\"},{\"deptno\":4,\"dname\":\"å¸‚åœºéƒ¨\",\"db_source\":\"cloudDB01\"},{\"deptno\":5,\"dname\":\"è¿ç»´éƒ¨\",\"db_source\":\"cloudDB01\"}] 6. microservicecloud-consumer-dept-806.1 åˆ›å»ºModule 6.2 çˆ¶å·¥ç¨‹å¢åŠ æ¨¡å—ä¿¡æ¯123&lt;modules&gt; &lt;module&gt;microservicecloud-consumer-dept-80&lt;/module&gt;&lt;/modules&gt; 6.3 pomæ–‡ä»¶123456789101112131415161718192021222324252627282930313233&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;atguigu-microservicecloud&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;/parent&gt; &lt;artifactId&gt;microservicecloud-consumer-dept-80&lt;/artifactId&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;!-- è‡ªå·±å®šä¹‰çš„ api --&gt; &lt;groupId&gt;com.hellodev&lt;/groupId&gt; &lt;artifactId&gt;microservicecloud-api&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆï¼Œçƒ­éƒ¨ç½² --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;springloaded&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; 6.4 ymlæ–‡ä»¶12server: port: 80 6.5 é…ç½®RestTemplate RestTemplate : RestTemplateæä¾›äº†å¤šç§ä¾¿æ·è®¿é—®è¿œç¨‹HttpæœåŠ¡çš„æ–¹æ³•ï¼Œæ˜¯ä¸€ç§ç®€å•ä¾¿æ·çš„è®¿é—®restfulæœåŠ¡æ¨¡æ¿ç±»ï¼Œæ˜¯Springæä¾›çš„ç”¨äºè®¿é—®RestæœåŠ¡çš„å®¢æˆ·ç«¯æ¨¡æ¿å·¥å…·é›†(https://docs.spring.io/spring-framework/docs/4.3.7.RELEASE/javadoc-api/org/springframework/web/client/RestTemplate.html) åˆ›å»ºcfgbeanåŒ…,å¹¶åˆ›å»ºConfigBean.java 1234567@Configurationpublic class ConfigBean { @Bean public RestTemplate getRestTemplate() { return new RestTemplate(); }} 6.6 ä½¿ç”¨RestTemplateåˆ›å»ºcontrolleråŒ…,å¹¶åˆ›å»ºDeptController_Consumer.java 12345678910111213141516171819@RestControllerpublic class DeptController_Consumer { private static final String REST_URL_PREFIX = \"http://localhost:8001\"; @Autowired private RestTemplate restTemplate; @RequestMapping(value = \"/consumer/dept/add\") public boolean add(Dept dept) { return restTemplate.postForObject(REST_URL_PREFIX + \"/dept/add\", dept, Boolean.class); } @RequestMapping(value = \"/consumer/dept/get/{id}\") public Dept get(@PathVariable(\"id\") Long id) { return restTemplate.getForObject(REST_URL_PREFIX + \"/dept/get/\" + id, Dept.class); } @SuppressWarnings(\"unchecked\") @RequestMapping(value = \"/consumer/dept/list\") public List&lt;Dept&gt; list() { return restTemplate.getForObject(REST_URL_PREFIX + \"/dept/list\", List.class); }} 6.7 éªŒè¯åˆ†åˆ«å¯åŠ¨microservicecloud-provider-dept-8081å’Œmicroservicecloud-consumer-dept-80 123456curl http://localhost/consumer/dept/get/2{&quot;deptno&quot;:2,&quot;dname&quot;:&quot;äººäº‹éƒ¨&quot;,&quot;db_source&quot;:&quot;cloudDB01â€}curl http://localhost/consumer/dept/list[{&quot;deptno&quot;:1,&quot;dname&quot;:&quot;å¼€å‘éƒ¨&quot;,&quot;db_source&quot;:&quot;cloudDB01&quot;},{&quot;deptno&quot;:2,&quot;dname&quot;:&quot;äººäº‹éƒ¨&quot;,&quot;db_source&quot;:&quot;cloudDB01&quot;},{&quot;deptno&quot;:3,&quot;dname&quot;:&quot;è´¢åŠ¡éƒ¨&quot;,&quot;db_source&quot;:&quot;cloudDB01&quot;},{&quot;deptno&quot;:4,&quot;dname&quot;:&quot;å¸‚åœºéƒ¨&quot;,&quot;db_source&quot;:&quot;cloudDB01&quot;},{&quot;deptno&quot;:5,&quot;dname&quot;:&quot;è¿ç»´éƒ¨&quot;,&quot;db_source&quot;:&quot;cloudDB01&quot;}] ä¸¤ä¸ªæ¥å£è¿”å›å†…å®¹ä¸ä¸Šä¸€ä¸ªå·¥ç¨‹ä¸€è‡´,è¿™è¡¨æ˜æˆ‘ä»¬å·¥ç¨‹æ­£ç¡®ã€‚ èµ„æºè·å–å…¬ä¼—å·å›å¤ : Restå¾®æœåŠ¡æ„å»ºæ¡ˆä¾‹ è·å–æœ¬èŠ‚ä»£ç  å…¬ä¼—å·å›å¤ : SpringCloudæ€ç»´å¯¼å›¾ Tipsæ¬¢è¿æ”¶è—å’Œè½¬å‘ï¼Œæ„Ÿè°¢ä½ çš„æ”¯æŒï¼(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šåç«¯å°å“¥ï¼Œä¸“æ³¨åç«¯å¼€å‘ï¼Œå¸Œæœ›å’Œä½ ä¸€èµ·è¿›æ­¥ï¼","link":"/2019/08/22/SpringCloud/%E5%B0%9A%E7%A1%85%E8%B0%B7-SpringCloud%E6%95%99%E7%A8%8B/02.Rest%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%84%E5%BB%BA%E6%A1%88%E4%BE%8B/"}],"tags":[{"name":"Http","slug":"Http","link":"/tags/Http/"},{"name":"æ‰“åŒ…","slug":"æ‰“åŒ…","link":"/tags/%E6%89%93%E5%8C%85/"},{"name":"Android","slug":"Android","link":"/tags/Android/"},{"name":"gradle","slug":"gradle","link":"/tags/gradle/"},{"name":"jar","slug":"jar","link":"/tags/jar/"},{"name":"aar","slug":"aar","link":"/tags/aar/"},{"name":"Volley","slug":"Volley","link":"/tags/Volley/"},{"name":"JavaEE","slug":"JavaEE","link":"/tags/JavaEE/"},{"name":"åå°","slug":"åå°","link":"/tags/%E5%90%8E%E5%8F%B0/"},{"name":"JavaåŸºç¡€","slug":"JavaåŸºç¡€","link":"/tags/Java%E5%9F%BA%E7%A1%80/"},{"name":"CI&amp;CD","slug":"CI-CD","link":"/tags/CI-CD/"},{"name":"Docker","slug":"Docker","link":"/tags/Docker/"},{"name":"Java","slug":"Java","link":"/tags/Java/"},{"name":"æŒç»­é›†æˆ","slug":"æŒç»­é›†æˆ","link":"/tags/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"},{"name":"åšå®¢ç³»ç»Ÿ","slug":"åšå®¢ç³»ç»Ÿ","link":"/tags/%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F/"},{"name":"æ”¯ä»˜","slug":"æ”¯ä»˜","link":"/tags/%E6%94%AF%E4%BB%98/"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"JavaWebåŸºç¡€","slug":"JavaWebåŸºç¡€","link":"/tags/JavaWeb%E5%9F%BA%E7%A1%80/"},{"name":"Servlet","slug":"Servlet","link":"/tags/Servlet/"},{"name":"JSP","slug":"JSP","link":"/tags/JSP/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","link":"/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"Hibernate","slug":"Hibernate","link":"/tags/Hibernate/"},{"name":"MySQL","slug":"MySQL","link":"/tags/MySQL/"},{"name":"ç›‘å¬å™¨","slug":"ç›‘å¬å™¨","link":"/tags/%E7%9B%91%E5%90%AC%E5%99%A8/"},{"name":"IntellJ","slug":"IntellJ","link":"/tags/IntellJ/"},{"name":"MVC","slug":"MVC","link":"/tags/MVC/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"å•†åŸ","slug":"å•†åŸ","link":"/tags/%E5%95%86%E5%9F%8E/"},{"name":"mac","slug":"mac","link":"/tags/mac/"},{"name":"iterm2","slug":"iterm2","link":"/tags/iterm2/"},{"name":"åˆ†é¡µ","slug":"åˆ†é¡µ","link":"/tags/%E5%88%86%E9%A1%B5/"},{"name":"æ—¥å¿—è§„èŒƒ","slug":"æ—¥å¿—è§„èŒƒ","link":"/tags/%E6%97%A5%E5%BF%97%E8%A7%84%E8%8C%83/"},{"name":"æ·˜æ·˜å•†åŸ","slug":"æ·˜æ·˜å•†åŸ","link":"/tags/%E6%B7%98%E6%B7%98%E5%95%86%E5%9F%8E/"},{"name":"FTP","slug":"FTP","link":"/tags/FTP/"},{"name":"Linux","slug":"Linux","link":"/tags/Linux/"},{"name":"Nginx","slug":"Nginx","link":"/tags/Nginx/"},{"name":"ä¸»é¢˜","slug":"ä¸»é¢˜","link":"/tags/%E4%B8%BB%E9%A2%98/"},{"name":"Chrome","slug":"Chrome","link":"/tags/Chrome/"},{"name":"VSCode","slug":"VSCode","link":"/tags/VSCode/"},{"name":"MacæŠ€å·§","slug":"MacæŠ€å·§","link":"/tags/Mac%E6%8A%80%E5%B7%A7/"},{"name":"Flutter","slug":"Flutter","link":"/tags/Flutter/"},{"name":"å¼€æºé¡¹ç›®","slug":"å¼€æºé¡¹ç›®","link":"/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/"},{"name":"Redis","slug":"Redis","link":"/tags/Redis/"},{"name":"Shiro","slug":"Shiro","link":"/tags/Shiro/"},{"name":"Spring Boot","slug":"Spring-Boot","link":"/tags/Spring-Boot/"},{"name":"Elasticsearch","slug":"Elasticsearch","link":"/tags/Elasticsearch/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","link":"/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"},{"name":"Java8","slug":"Java8","link":"/tags/Java8/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","link":"/tags/%E5%B9%B6%E5%8F%91/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"JVM","slug":"JVM","link":"/tags/JVM/"},{"name":"GitHub Actions","slug":"GitHub-Actions","link":"/tags/GitHub-Actions/"},{"name":"Hexo","slug":"Hexo","link":"/tags/Hexo/"},{"name":"Response","slug":"Response","link":"/tags/Response/"},{"name":"Request","slug":"Request","link":"/tags/Request/"},{"name":"EL","slug":"EL","link":"/tags/EL/"},{"name":"JSTL","slug":"JSTL","link":"/tags/JSTL/"},{"name":"AJAX","slug":"AJAX","link":"/tags/AJAX/"},{"name":"Cookie","slug":"Cookie","link":"/tags/Cookie/"},{"name":"Session","slug":"Session","link":"/tags/Session/"},{"name":"MySql","slug":"MySql","link":"/tags/MySql/"},{"name":"è¿‡æ»¤å™¨","slug":"è¿‡æ»¤å™¨","link":"/tags/%E8%BF%87%E6%BB%A4%E5%99%A8/"},{"name":"MySQLå¿…çŸ¥å¿…ä¼š","slug":"MySQLå¿…çŸ¥å¿…ä¼š","link":"/tags/MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"},{"name":"SpringCloud","slug":"SpringCloud","link":"/tags/SpringCloud/"},{"name":"Spring","slug":"Spring","link":"/tags/Spring/"}],"categories":[{"name":"Android","slug":"Android","link":"/categories/Android/"},{"name":"JavaEE","slug":"JavaEE","link":"/categories/JavaEE/"},{"name":"Docker","slug":"Docker","link":"/categories/Docker/"},{"name":"Simpleblogåšå®¢ç³»ç»Ÿ","slug":"Simpleblogåšå®¢ç³»ç»Ÿ","link":"/categories/Simpleblog%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F/"},{"name":"æŒç»­é›†æˆ","slug":"æŒç»­é›†æˆ","link":"/categories/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/"},{"name":"å·¥å…·æ•™ç¨‹","slug":"å·¥å…·æ•™ç¨‹","link":"/categories/%E5%B7%A5%E5%85%B7%E6%95%99%E7%A8%8B/"},{"name":"æ—¥å¿—","slug":"æ—¥å¿—","link":"/categories/%E6%97%A5%E5%BF%97/"},{"name":"Chrome","slug":"Chrome","link":"/categories/Chrome/"},{"name":"Mac","slug":"Mac","link":"/categories/Mac/"},{"name":"Flutter","slug":"Flutter","link":"/categories/Flutter/"},{"name":"Redis","slug":"Redis","link":"/categories/Redis/"},{"name":"Shiro","slug":"Shiro","link":"/categories/Shiro/"},{"name":"Java","slug":"Java","link":"/categories/Java/"},{"name":"å¹¶å‘","slug":"å¹¶å‘","link":"/categories/%E5%B9%B6%E5%8F%91/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","link":"/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"},{"name":"JVM","slug":"JVM","link":"/categories/JVM/"},{"name":"Hexo","slug":"Hexo","link":"/categories/Hexo/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","link":"/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"MySQLå¿…çŸ¥å¿…ä¼š","slug":"MySQLå¿…çŸ¥å¿…ä¼š","link":"/categories/MySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"},{"name":"SpringCloud","slug":"SpringCloud","link":"/categories/SpringCloud/"}]}